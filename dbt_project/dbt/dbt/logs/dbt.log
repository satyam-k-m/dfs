[0m05:53:45.392725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a13296d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79fc100a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc79fc10280>]}


============================== 05:53:45.396457 | ff88197b-f408-4a20-a489-e3df2795aadc ==============================
[0m05:53:45.396457 [info ] [MainThread]: Running with dbt=1.5.1
[0m05:53:45.397049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m05:53:45.397477 [info ] [MainThread]: dbt version: 1.5.1
[0m05:53:45.397855 [info ] [MainThread]: python version: 3.8.10
[0m05:53:45.398204 [info ] [MainThread]: python path: /usr/bin/python3
[0m05:53:45.398589 [info ] [MainThread]: os info: Linux-5.15.0-1039-azure-x86_64-with-glibc2.29
[0m05:53:45.398939 [info ] [MainThread]: Using profiles.yml file at /home/satyam/airflow/dags/dbt/profiles.yml
[0m05:53:45.399278 [info ] [MainThread]: Using dbt_project.yml file at /home/satyam/airflow/dags/dbt/dbt_project.yml
[0m05:53:45.399615 [info ] [MainThread]: Configuration:
[0m05:53:45.717622 [error] [MainThread]: Encountered an error:
module 'lib' has no attribute 'SSLEAY_VERSION'
[0m05:53:45.733124 [error] [MainThread]: Traceback (most recent call last):
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 415, in debug
    results = task.run()
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/task/debug.py", line 110, in run
    self.test_configuration()
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/task/debug.py", line 294, in test_configuration
    profile_status = self._load_profile()
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/task/debug.py", line 254, in _load_profile
    profile: Profile = Profile.render(
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/config/profile.py", line 401, in from_raw_profiles
    return cls.from_raw_profile_info(
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/config/profile.py", line 355, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/config/profile.py", line 165, in _credentials_from_profile
    cls = load_plugin(typename)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/adapters/factory.py", line 202, in load_plugin
    return FACTORY.load_plugin(name)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/adapters/factory.py", line 57, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "/usr/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/adapters/snowflake/__init__.py", line 2, in <module>
    from dbt.adapters.snowflake.connections import SnowflakeConnectionManager  # noqa
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 17, in <module>
    import snowflake.connector
  File "/home/satyam/.local/lib/python3.8/site-packages/snowflake/connector/__init__.py", line 17, in <module>
    from .connection import SnowflakeConnection
  File "/home/satyam/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 27, in <module>
    from . import errors, proxy
  File "/home/satyam/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 18, in <module>
    from .telemetry_oob import TelemetryService
  File "/home/satyam/.local/lib/python3.8/site-packages/snowflake/connector/telemetry_oob.py", line 21, in <module>
    from .vendored import requests
  File "/home/satyam/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/__init__.py", line 119, in <module>
    from ..urllib3.contrib import pyopenssl
  File "/home/satyam/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py", line 51, in <module>
    import OpenSSL.SSL
  File "/usr/lib/python3/dist-packages/OpenSSL/SSL.py", line 122, in <module>
    SSLEAY_VERSION = _lib.SSLEAY_VERSION
AttributeError: module 'lib' has no attribute 'SSLEAY_VERSION'

[0m05:53:45.734757 [debug] [MainThread]: Command `dbt debug` failed at 05:53:45.734570 after 0.36 seconds
[0m05:53:45.735170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a13296d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a1f1b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7a1f1b880>]}
[0m05:53:45.735598 [debug] [MainThread]: Flushing usage events
[0m05:54:09.228066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d4eab0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d37a8160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d37a81c0>]}


============================== 05:54:09.231338 | d663ae11-0577-4d71-8d34-df357733c389 ==============================
[0m05:54:09.231338 [info ] [MainThread]: Running with dbt=1.5.1
[0m05:54:09.231938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m05:54:09.232374 [info ] [MainThread]: dbt version: 1.5.1
[0m05:54:09.232764 [info ] [MainThread]: python version: 3.8.10
[0m05:54:09.233112 [info ] [MainThread]: python path: /usr/bin/python3
[0m05:54:09.233454 [info ] [MainThread]: os info: Linux-5.15.0-1039-azure-x86_64-with-glibc2.29
[0m05:54:09.233791 [info ] [MainThread]: Using profiles.yml file at /home/satyam/airflow/dags/dbt/profiles.yml
[0m05:54:09.234134 [info ] [MainThread]: Using dbt_project.yml file at /home/satyam/airflow/dags/dbt/dbt_project.yml
[0m05:54:09.234518 [info ] [MainThread]: Configuration:
[0m05:54:09.370481 [error] [MainThread]: Encountered an error:
module 'lib' has no attribute 'SSLEAY_VERSION'
[0m05:54:09.372950 [error] [MainThread]: Traceback (most recent call last):
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 415, in debug
    results = task.run()
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/task/debug.py", line 110, in run
    self.test_configuration()
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/task/debug.py", line 294, in test_configuration
    profile_status = self._load_profile()
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/task/debug.py", line 254, in _load_profile
    profile: Profile = Profile.render(
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/config/profile.py", line 436, in render
    return cls.from_raw_profiles(
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/config/profile.py", line 401, in from_raw_profiles
    return cls.from_raw_profile_info(
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/config/profile.py", line 355, in from_raw_profile_info
    credentials: Credentials = cls._credentials_from_profile(
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/config/profile.py", line 165, in _credentials_from_profile
    cls = load_plugin(typename)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/adapters/factory.py", line 202, in load_plugin
    return FACTORY.load_plugin(name)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/adapters/factory.py", line 57, in load_plugin
    mod: Any = import_module("." + name, "dbt.adapters")
  File "/usr/lib/python3.8/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1014, in _gcd_import
  File "<frozen importlib._bootstrap>", line 991, in _find_and_load
  File "<frozen importlib._bootstrap>", line 975, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 671, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 848, in exec_module
  File "<frozen importlib._bootstrap>", line 219, in _call_with_frames_removed
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/adapters/snowflake/__init__.py", line 2, in <module>
    from dbt.adapters.snowflake.connections import SnowflakeConnectionManager  # noqa
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/adapters/snowflake/connections.py", line 17, in <module>
    import snowflake.connector
  File "/home/satyam/.local/lib/python3.8/site-packages/snowflake/connector/__init__.py", line 17, in <module>
    from .connection import SnowflakeConnection
  File "/home/satyam/.local/lib/python3.8/site-packages/snowflake/connector/connection.py", line 27, in <module>
    from . import errors, proxy
  File "/home/satyam/.local/lib/python3.8/site-packages/snowflake/connector/errors.py", line 18, in <module>
    from .telemetry_oob import TelemetryService
  File "/home/satyam/.local/lib/python3.8/site-packages/snowflake/connector/telemetry_oob.py", line 21, in <module>
    from .vendored import requests
  File "/home/satyam/.local/lib/python3.8/site-packages/snowflake/connector/vendored/requests/__init__.py", line 119, in <module>
    from ..urllib3.contrib import pyopenssl
  File "/home/satyam/.local/lib/python3.8/site-packages/snowflake/connector/vendored/urllib3/contrib/pyopenssl.py", line 51, in <module>
    import OpenSSL.SSL
  File "/usr/lib/python3/dist-packages/OpenSSL/SSL.py", line 122, in <module>
    SSLEAY_VERSION = _lib.SSLEAY_VERSION
AttributeError: module 'lib' has no attribute 'SSLEAY_VERSION'

[0m05:54:09.374032 [debug] [MainThread]: Command `dbt debug` failed at 05:54:09.373889 after 0.16 seconds
[0m05:54:09.374445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d4eab0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d5aae6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8d5aae6d0>]}
[0m05:54:09.374869 [debug] [MainThread]: Flushing usage events
[0m05:59:26.328226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda91c1b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda905281c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda90528220>]}


============================== 05:59:26.331356 | c2160c1c-b243-4d2f-bbe5-08c3ae7a1c15 ==============================
[0m05:59:26.331356 [info ] [MainThread]: Running with dbt=1.5.1
[0m05:59:26.331947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m05:59:26.332375 [info ] [MainThread]: dbt version: 1.5.1
[0m05:59:26.332752 [info ] [MainThread]: python version: 3.8.10
[0m05:59:26.333087 [info ] [MainThread]: python path: /usr/bin/python3
[0m05:59:26.333416 [info ] [MainThread]: os info: Linux-5.15.0-1039-azure-x86_64-with-glibc2.29
[0m05:59:26.333746 [info ] [MainThread]: Using profiles.yml file at /home/satyam/airflow/dags/dbt/profiles.yml
[0m05:59:26.334092 [info ] [MainThread]: Using dbt_project.yml file at /home/satyam/airflow/dags/dbt/dbt_project.yml
[0m05:59:26.334448 [info ] [MainThread]: Configuration:
[0m05:59:26.664221 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:59:26.690856 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:59:26.691421 [info ] [MainThread]: Required dependencies:
[0m05:59:26.691828 [debug] [MainThread]: Executing "git --help"
[0m05:59:26.698237 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:59:26.699026 [debug] [MainThread]: STDERR: "b''"
[0m05:59:26.699391 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:59:26.699791 [info ] [MainThread]: Connection:
[0m05:59:26.700216 [info ] [MainThread]:   account: emuqifz-vy24542
[0m05:59:26.700566 [info ] [MainThread]:   user: satyamkumar
[0m05:59:26.700905 [info ] [MainThread]:   database: learn_dbt
[0m05:59:26.701237 [info ] [MainThread]:   schema: learn_dbt
[0m05:59:26.701578 [info ] [MainThread]:   warehouse: learn_dbt_dw
[0m05:59:26.701907 [info ] [MainThread]:   role: accountadmin
[0m05:59:26.702236 [info ] [MainThread]:   client_session_keep_alive: False
[0m05:59:26.702598 [info ] [MainThread]:   query_tag: None
[0m05:59:26.703463 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m05:59:26.704393 [debug] [MainThread]: Using snowflake connection "debug"
[0m05:59:26.704749 [debug] [MainThread]: On debug: select 1 as id
[0m05:59:26.705064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:59:27.696261 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m05:59:27.698002 [debug] [MainThread]: On debug: Close
[0m05:59:27.800438 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:59:27.801143 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:59:27.802031 [debug] [MainThread]: Command `dbt debug` succeeded at 05:59:27.801856 after 1.49 seconds
[0m05:59:27.802515 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m05:59:27.802934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda91c1b100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8f50ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda8be80310>]}
[0m05:59:27.803483 [debug] [MainThread]: Flushing usage events
[0m05:59:35.840718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c89bc80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c884e80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c884e8370>]}


============================== 05:59:35.843677 | b28007b7-6c59-48ba-b923-79d3229d4849 ==============================
[0m05:59:35.843677 [info ] [MainThread]: Running with dbt=1.5.1
[0m05:59:35.844252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m05:59:36.106372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b28007b7-6c59-48ba-b923-79d3229d4849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c83e49ee0>]}
[0m05:59:36.123214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b28007b7-6c59-48ba-b923-79d3229d4849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c83e1ce80>]}
[0m05:59:36.136571 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m05:59:36.137218 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m05:59:36.137679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b28007b7-6c59-48ba-b923-79d3229d4849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c82de32e0>]}
[0m05:59:36.851373 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payments.sql
[0m05:59:36.866800 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
[0m05:59:36.871023 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
[0m05:59:36.875248 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
[0m05:59:36.879528 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/fact_orders.sql
[0m05:59:36.894321 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.customer.fact_orders' (models/marts/core/fact_orders.sql) depends on a node named 'stg_payment' which was not found
[0m05:59:36.895122 [debug] [MainThread]: Command `dbt run` failed at 05:59:36.894975 after 1.07 seconds
[0m05:59:36.895545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c89bc80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c82ccd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c82ca3700>]}
[0m05:59:36.895979 [debug] [MainThread]: Flushing usage events
[0m06:00:46.238056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26187f5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26171010a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2617101250>]}


============================== 06:00:46.241324 | 821e60c2-d322-4310-a930-7b33e9648fdd ==============================
[0m06:00:46.241324 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:00:46.241940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:00:46.242431 [info ] [MainThread]: dbt version: 1.5.1
[0m06:00:46.242835 [info ] [MainThread]: python version: 3.8.10
[0m06:00:46.243187 [info ] [MainThread]: python path: /usr/bin/python3
[0m06:00:46.243536 [info ] [MainThread]: os info: Linux-5.15.0-1039-azure-x86_64-with-glibc2.29
[0m06:00:46.243893 [info ] [MainThread]: Using profiles.yml file at /home/satyam/airflow/dags/dbt/profiles.yml
[0m06:00:46.244241 [info ] [MainThread]: Using dbt_project.yml file at /home/satyam/airflow/dags/dbt/dbt_project.yml
[0m06:00:46.244578 [info ] [MainThread]: Configuration:
[0m06:00:46.490373 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:00:46.516764 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:00:46.517395 [info ] [MainThread]: Required dependencies:
[0m06:00:46.517819 [debug] [MainThread]: Executing "git --help"
[0m06:00:46.524093 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:00:46.524891 [debug] [MainThread]: STDERR: "b''"
[0m06:00:46.525253 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:00:46.525663 [info ] [MainThread]: Connection:
[0m06:00:46.526091 [info ] [MainThread]:   account: emuqifz-vy24542
[0m06:00:46.526479 [info ] [MainThread]:   user: satyamkumar
[0m06:00:46.526827 [info ] [MainThread]:   database: learn_dbt
[0m06:00:46.527168 [info ] [MainThread]:   schema: learn_dbt
[0m06:00:46.527505 [info ] [MainThread]:   warehouse: learn_dbt_dw
[0m06:00:46.527850 [info ] [MainThread]:   role: accountadmin
[0m06:00:46.528193 [info ] [MainThread]:   client_session_keep_alive: False
[0m06:00:46.528537 [info ] [MainThread]:   query_tag: None
[0m06:00:46.529515 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m06:00:46.530504 [debug] [MainThread]: Using snowflake connection "debug"
[0m06:00:46.530866 [debug] [MainThread]: On debug: select 1 as id
[0m06:00:46.531190 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:00:47.190738 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:47.192564 [debug] [MainThread]: On debug: Close
[0m06:00:47.300321 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:00:47.301091 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:00:47.302012 [debug] [MainThread]: Command `dbt debug` succeeded at 06:00:47.301824 after 1.08 seconds
[0m06:00:47.302508 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:00:47.302990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26187f5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26160e49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2612a366a0>]}
[0m06:00:47.303640 [debug] [MainThread]: Flushing usage events
[0m06:00:52.927058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3d543040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3be4e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3be4e220>]}


============================== 06:00:52.930138 | 9b44739a-b4d5-4ff3-825b-43dbd9ccc32d ==============================
[0m06:00:52.930138 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:00:52.930762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:00:53.198072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b44739a-b4d5-4ff3-825b-43dbd9ccc32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce377b2eb0>]}
[0m06:00:53.214969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b44739a-b4d5-4ff3-825b-43dbd9ccc32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3778d9d0>]}
[0m06:00:53.228062 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:00:53.228752 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:00:53.229232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9b44739a-b4d5-4ff3-825b-43dbd9ccc32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce37768fd0>]}
[0m06:00:53.915056 [debug] [MainThread]: 1699: static parser successfully parsed staging/stripe/stg_payments.sql
[0m06:00:53.929817 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_orders.sql
[0m06:00:53.933918 [debug] [MainThread]: 1699: static parser successfully parsed staging/jaffle_shop/stg_customers.sql
[0m06:00:53.938147 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
[0m06:00:53.942393 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/fact_orders.sql
[0m06:00:53.982930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b44739a-b4d5-4ff3-825b-43dbd9ccc32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3764ffa0>]}
[0m06:00:53.989711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b44739a-b4d5-4ff3-825b-43dbd9ccc32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce377685b0>]}
[0m06:00:53.990363 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m06:00:53.990838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b44739a-b4d5-4ff3-825b-43dbd9ccc32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce37768280>]}
[0m06:00:53.992422 [info ] [MainThread]: 
[0m06:00:53.993245 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:00:53.994709 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m06:00:54.010041 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m06:00:54.010610 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m06:00:54.011010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:00:54.548673 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m06:00:54.551401 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m06:00:54.665475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m06:00:54.674696 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m06:00:54.675178 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m06:00:54.675517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:00:54.976740 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:00:54.979097 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m06:00:55.080386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b44739a-b4d5-4ff3-825b-43dbd9ccc32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce365e3fa0>]}
[0m06:00:55.081589 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:00:55.082168 [info ] [MainThread]: 
[0m06:00:55.092593 [debug] [Thread-1  ]: Began running node model.customer.stg_customers
[0m06:00:55.093260 [info ] [Thread-1  ]: 1 of 5 START sql view model learn_dbt.stg_customers ............................ [RUN]
[0m06:00:55.094071 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_customers)
[0m06:00:55.094520 [debug] [Thread-1  ]: Began compiling node model.customer.stg_customers
[0m06:00:55.097003 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_customers"
[0m06:00:55.097845 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (compile): 06:00:55.094805 => 06:00:55.097572
[0m06:00:55.098244 [debug] [Thread-1  ]: Began executing node model.customer.stg_customers
[0m06:00:55.129814 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_customers"
[0m06:00:55.131054 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_customers"
[0m06:00:55.131511 [debug] [Thread-1  ]: On model.customer.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_customers"} */
create or replace   view learn_dbt.learn_dbt.stg_customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from learn_dbt.jaffle_shop.customers

)

select * from customers
  );
[0m06:00:55.131888 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:00:55.572249 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:00:55.599878 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (execute): 06:00:55.098519 => 06:00:55.599606
[0m06:00:55.600386 [debug] [Thread-1  ]: On model.customer.stg_customers: Close
[0m06:00:55.721219 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b44739a-b4d5-4ff3-825b-43dbd9ccc32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce34485940>]}
[0m06:00:55.722247 [info ] [Thread-1  ]: 1 of 5 OK created sql view model learn_dbt.stg_customers ....................... [[32mSUCCESS 1[0m in 0.63s]
[0m06:00:55.723446 [debug] [Thread-1  ]: Finished running node model.customer.stg_customers
[0m06:00:55.723989 [debug] [Thread-1  ]: Began running node model.customer.stg_orders
[0m06:00:55.724537 [info ] [Thread-1  ]: 2 of 5 START sql view model learn_dbt.stg_orders ............................... [RUN]
[0m06:00:55.725338 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.customer.stg_customers, now model.customer.stg_orders)
[0m06:00:55.725972 [debug] [Thread-1  ]: Began compiling node model.customer.stg_orders
[0m06:00:55.728783 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_orders"
[0m06:00:55.729492 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (compile): 06:00:55.726261 => 06:00:55.729235
[0m06:00:55.729885 [debug] [Thread-1  ]: Began executing node model.customer.stg_orders
[0m06:00:55.733413 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_orders"
[0m06:00:55.734376 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_orders"
[0m06:00:55.734790 [debug] [Thread-1  ]: On model.customer.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_orders"} */
create or replace   view learn_dbt.learn_dbt.stg_orders
  
   as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from learn_dbt.jaffle_shop.orders

)

select * from orders
  );
[0m06:00:55.735392 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:00:56.302753 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:56.306283 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (execute): 06:00:55.730137 => 06:00:56.306020
[0m06:00:56.306758 [debug] [Thread-1  ]: On model.customer.stg_orders: Close
[0m06:00:56.431720 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b44739a-b4d5-4ff3-825b-43dbd9ccc32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3449cd30>]}
[0m06:00:56.432765 [info ] [Thread-1  ]: 2 of 5 OK created sql view model learn_dbt.stg_orders .......................... [[32mSUCCESS 1[0m in 0.71s]
[0m06:00:56.433662 [debug] [Thread-1  ]: Finished running node model.customer.stg_orders
[0m06:00:56.434229 [debug] [Thread-1  ]: Began running node model.customer.stg_payments
[0m06:00:56.435274 [info ] [Thread-1  ]: 3 of 5 START sql view model learn_dbt.stg_payments ............................. [RUN]
[0m06:00:56.436183 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.customer.stg_orders, now model.customer.stg_payments)
[0m06:00:56.436645 [debug] [Thread-1  ]: Began compiling node model.customer.stg_payments
[0m06:00:56.439275 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_payments"
[0m06:00:56.440029 [debug] [Thread-1  ]: Timing info for model.customer.stg_payments (compile): 06:00:56.436935 => 06:00:56.439773
[0m06:00:56.440426 [debug] [Thread-1  ]: Began executing node model.customer.stg_payments
[0m06:00:56.444053 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_payments"
[0m06:00:56.445085 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_payments"
[0m06:00:56.445508 [debug] [Thread-1  ]: On model.customer.stg_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_payments"} */
create or replace   view learn_dbt.learn_dbt.stg_payments
  
   as (
    with payment as 
(
    select 
        id as customer_id ,
        orderid as order_id,
        paymentmethod,
        status,
        amount ,
        created
        from learn_dbt.stripe.payment
)
select * from payment
  );
[0m06:00:56.445888 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:00:56.860482 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:00:56.863972 [debug] [Thread-1  ]: Timing info for model.customer.stg_payments (execute): 06:00:56.440676 => 06:00:56.863702
[0m06:00:56.864462 [debug] [Thread-1  ]: On model.customer.stg_payments: Close
[0m06:00:56.985826 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b44739a-b4d5-4ff3-825b-43dbd9ccc32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce34471730>]}
[0m06:00:56.986910 [info ] [Thread-1  ]: 3 of 5 OK created sql view model learn_dbt.stg_payments ........................ [[32mSUCCESS 1[0m in 0.55s]
[0m06:00:56.987719 [debug] [Thread-1  ]: Finished running node model.customer.stg_payments
[0m06:00:56.988996 [debug] [Thread-1  ]: Began running node model.customer.fact_orders
[0m06:00:56.989697 [info ] [Thread-1  ]: 4 of 5 START sql table model learn_dbt.fact_orders ............................. [RUN]
[0m06:00:56.990729 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.customer.stg_payments, now model.customer.fact_orders)
[0m06:00:56.991194 [debug] [Thread-1  ]: Began compiling node model.customer.fact_orders
[0m06:00:56.995597 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.fact_orders"
[0m06:00:56.996464 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (compile): 06:00:56.991487 => 06:00:56.996170
[0m06:00:56.996904 [debug] [Thread-1  ]: Began executing node model.customer.fact_orders
[0m06:00:57.020889 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.fact_orders"
[0m06:00:57.022492 [debug] [Thread-1  ]: Using snowflake connection "model.customer.fact_orders"
[0m06:00:57.022998 [debug] [Thread-1  ]: On model.customer.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.fact_orders"} */
create or replace transient table learn_dbt.learn_dbt.fact_orders
         as
        (with orders as  (
    select * from learn_dbt.learn_dbt.stg_orders
),

payments as (
    select * from learn_dbt.learn_dbt.stg_payments
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
        );
[0m06:00:57.023418 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:00:58.630827 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m06:00:58.634664 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (execute): 06:00:56.997188 => 06:00:58.634371
[0m06:00:58.635231 [debug] [Thread-1  ]: On model.customer.fact_orders: Close
[0m06:00:58.746968 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b44739a-b4d5-4ff3-825b-43dbd9ccc32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce34488610>]}
[0m06:00:58.748033 [info ] [Thread-1  ]: 4 of 5 OK created sql table model learn_dbt.fact_orders ........................ [[32mSUCCESS 1[0m in 1.76s]
[0m06:00:58.748909 [debug] [Thread-1  ]: Finished running node model.customer.fact_orders
[0m06:00:58.750065 [debug] [Thread-1  ]: Began running node model.customer.dim_customers
[0m06:00:58.750772 [info ] [Thread-1  ]: 5 of 5 START sql table model learn_dbt.dim_customers ........................... [RUN]
[0m06:00:58.751710 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.customer.fact_orders, now model.customer.dim_customers)
[0m06:00:58.752157 [debug] [Thread-1  ]: Began compiling node model.customer.dim_customers
[0m06:00:58.757619 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.dim_customers"
[0m06:00:58.758362 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (compile): 06:00:58.752415 => 06:00:58.758079
[0m06:00:58.758759 [debug] [Thread-1  ]: Began executing node model.customer.dim_customers
[0m06:00:58.761876 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.dim_customers"
[0m06:00:58.763449 [debug] [Thread-1  ]: Using snowflake connection "model.customer.dim_customers"
[0m06:00:58.763889 [debug] [Thread-1  ]: On model.customer.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.dim_customers"} */
create or replace transient table learn_dbt.learn_dbt.dim_customers
         as
        (with customers as (
    select * from learn_dbt.learn_dbt.stg_customers
),

orders as (
    select * from learn_dbt.learn_dbt.fact_orders
),
customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
        );
[0m06:00:58.764292 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:00:59.680715 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:00:59.684228 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (execute): 06:00:58.759011 => 06:00:59.683986
[0m06:00:59.684695 [debug] [Thread-1  ]: On model.customer.dim_customers: Close
[0m06:00:59.783459 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b44739a-b4d5-4ff3-825b-43dbd9ccc32d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce35580610>]}
[0m06:00:59.784526 [info ] [Thread-1  ]: 5 of 5 OK created sql table model learn_dbt.dim_customers ...................... [[32mSUCCESS 1[0m in 1.03s]
[0m06:00:59.785335 [debug] [Thread-1  ]: Finished running node model.customer.dim_customers
[0m06:00:59.787303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:00:59.787659 [debug] [MainThread]: Connection 'model.customer.dim_customers' was properly closed.
[0m06:00:59.788056 [info ] [MainThread]: 
[0m06:00:59.788499 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 5.80 seconds (5.80s).
[0m06:00:59.789949 [debug] [MainThread]: Command end result
[0m06:00:59.797613 [info ] [MainThread]: 
[0m06:00:59.798194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:00:59.798653 [info ] [MainThread]: 
[0m06:00:59.799079 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:00:59.799920 [debug] [MainThread]: Command `dbt run` succeeded at 06:00:59.799771 after 6.89 seconds
[0m06:00:59.800381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3d543040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3771f2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce361a5c70>]}
[0m06:00:59.800825 [debug] [MainThread]: Flushing usage events
[0m06:19:29.743851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb734c18130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7334f98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7334f95b0>]}


============================== 06:19:29.747119 | 23e205ee-22dc-40e9-ab55-4ed688252de2 ==============================
[0m06:19:29.747119 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:19:29.748205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:19:30.011702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23e205ee-22dc-40e9-ab55-4ed688252de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72ee81f70>]}
[0m06:19:30.028597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23e205ee-22dc-40e9-ab55-4ed688252de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72ee849a0>]}
[0m06:19:30.041717 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:19:30.062575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:19:30.063038 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:19:30.069881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23e205ee-22dc-40e9-ab55-4ed688252de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72dce73a0>]}
[0m06:19:30.077439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23e205ee-22dc-40e9-ab55-4ed688252de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72dd460d0>]}
[0m06:19:30.078010 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m06:19:30.078843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23e205ee-22dc-40e9-ab55-4ed688252de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72dcc7fa0>]}
[0m06:19:30.080193 [info ] [MainThread]: 
[0m06:19:30.081329 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:19:30.082588 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m06:19:30.098682 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m06:19:30.099205 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m06:19:30.099616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:19:30.763956 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m06:19:30.766803 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m06:19:30.885727 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m06:19:30.895795 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m06:19:30.896294 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m06:19:30.896670 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:19:31.222608 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:19:31.224933 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m06:19:31.343550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23e205ee-22dc-40e9-ab55-4ed688252de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72dcc7b80>]}
[0m06:19:31.344710 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:19:31.345265 [info ] [MainThread]: 
[0m06:19:31.350015 [debug] [Thread-1  ]: Began running node model.customer.stg_orders
[0m06:19:31.350767 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_orders ............................... [RUN]
[0m06:19:31.351720 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_orders)
[0m06:19:31.352521 [debug] [Thread-1  ]: Began compiling node model.customer.stg_orders
[0m06:19:31.355016 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_orders"
[0m06:19:31.355789 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (compile): 06:19:31.352824 => 06:19:31.355509
[0m06:19:31.356194 [debug] [Thread-1  ]: Began executing node model.customer.stg_orders
[0m06:19:31.394987 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_orders"
[0m06:19:31.396173 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_orders"
[0m06:19:31.396652 [debug] [Thread-1  ]: On model.customer.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_orders"} */
create or replace   view learn_dbt.learn_dbt.stg_orders
  
   as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from learn_dbt.jaffle_shop.orders

)

select * from orders
  );
[0m06:19:31.397414 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:19:31.909876 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:19:31.935548 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (execute): 06:19:31.356448 => 06:19:31.935288
[0m06:19:31.936052 [debug] [Thread-1  ]: On model.customer.stg_orders: Close
[0m06:19:32.031314 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23e205ee-22dc-40e9-ab55-4ed688252de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72c76cd00>]}
[0m06:19:32.032300 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_orders .......................... [[32mSUCCESS 1[0m in 0.68s]
[0m06:19:32.033108 [debug] [Thread-1  ]: Finished running node model.customer.stg_orders
[0m06:19:32.034932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:19:32.035279 [debug] [MainThread]: Connection 'model.customer.stg_orders' was properly closed.
[0m06:19:32.035636 [info ] [MainThread]: 
[0m06:19:32.036062 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m06:19:32.036823 [debug] [MainThread]: Command end result
[0m06:19:32.044895 [info ] [MainThread]: 
[0m06:19:32.045397 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:19:32.045796 [info ] [MainThread]: 
[0m06:19:32.046209 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:19:32.047022 [debug] [MainThread]: Command `dbt run` succeeded at 06:19:32.046885 after 2.32 seconds
[0m06:19:32.047475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb734c18130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72ee849a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb72dcc7b20>]}
[0m06:19:32.047897 [debug] [MainThread]: Flushing usage events
[0m06:19:37.432811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc626b40d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc60f829a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc60f821f0>]}


============================== 06:19:37.435902 | 8893a751-4f0e-49fc-b34a-f4d4a9098a1a ==============================
[0m06:19:37.435902 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:19:37.436503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:19:37.706138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8893a751-4f0e-49fc-b34a-f4d4a9098a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc5c909fa0>]}
[0m06:19:37.723139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8893a751-4f0e-49fc-b34a-f4d4a9098a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc5c8d9af0>]}
[0m06:19:37.736340 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:19:37.757381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:19:37.757882 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:19:37.764757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8893a751-4f0e-49fc-b34a-f4d4a9098a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc5b766340>]}
[0m06:19:37.772014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8893a751-4f0e-49fc-b34a-f4d4a9098a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc5b7c5070>]}
[0m06:19:37.772506 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m06:19:37.772937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8893a751-4f0e-49fc-b34a-f4d4a9098a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc5b747f70>]}
[0m06:19:37.773580 [warn ] [MainThread]: The selection criterion 'stg_payment' does not match any nodes
[0m06:19:37.774552 [info ] [MainThread]: 
[0m06:19:37.774976 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:19:37.775521 [debug] [MainThread]: Command end result
[0m06:19:37.781229 [debug] [MainThread]: Command `dbt run` succeeded at 06:19:37.781083 after 0.37 seconds
[0m06:19:37.781633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc626b40d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc5b7c5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc5b7c5280>]}
[0m06:19:37.782031 [debug] [MainThread]: Flushing usage events
[0m06:19:42.955245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c68d551f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c676699a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c67669670>]}


============================== 06:19:42.958427 | d78a7165-4aa4-4120-9495-7951ba9489a8 ==============================
[0m06:19:42.958427 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:19:42.959036 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:19:43.228658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd78a7165-4aa4-4120-9495-7951ba9489a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c62f9eaf0>]}
[0m06:19:43.245606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd78a7165-4aa4-4120-9495-7951ba9489a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c62fc1a60>]}
[0m06:19:43.258935 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:19:43.279757 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:19:43.280233 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:19:43.286877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd78a7165-4aa4-4120-9495-7951ba9489a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c62e3c460>]}
[0m06:19:43.294176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd78a7165-4aa4-4120-9495-7951ba9489a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c62e24190>]}
[0m06:19:43.294744 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m06:19:43.295188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd78a7165-4aa4-4120-9495-7951ba9489a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c62e24460>]}
[0m06:19:43.296474 [info ] [MainThread]: 
[0m06:19:43.297299 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:19:43.298544 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m06:19:43.313590 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m06:19:43.314046 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m06:19:43.314452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:19:43.980560 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m06:19:43.983286 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m06:19:44.105211 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m06:19:44.115400 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m06:19:44.116614 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m06:19:44.117077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:19:44.577068 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:19:44.579390 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m06:19:44.690812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd78a7165-4aa4-4120-9495-7951ba9489a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c62e24220>]}
[0m06:19:44.691957 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:19:44.692562 [info ] [MainThread]: 
[0m06:19:44.697137 [debug] [Thread-1  ]: Began running node model.customer.stg_customers
[0m06:19:44.697770 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_customers ............................ [RUN]
[0m06:19:44.698574 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_customers)
[0m06:19:44.699008 [debug] [Thread-1  ]: Began compiling node model.customer.stg_customers
[0m06:19:44.701278 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_customers"
[0m06:19:44.702032 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (compile): 06:19:44.699290 => 06:19:44.701756
[0m06:19:44.702460 [debug] [Thread-1  ]: Began executing node model.customer.stg_customers
[0m06:19:44.734777 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_customers"
[0m06:19:44.735955 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_customers"
[0m06:19:44.736431 [debug] [Thread-1  ]: On model.customer.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_customers"} */
create or replace   view learn_dbt.learn_dbt.stg_customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from learn_dbt.jaffle_shop.customers

)

select * from customers
  );
[0m06:19:44.736824 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:19:45.073944 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:19:45.100524 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (execute): 06:19:44.702735 => 06:19:45.100256
[0m06:19:45.101082 [debug] [Thread-1  ]: On model.customer.stg_customers: Close
[0m06:19:45.192794 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd78a7165-4aa4-4120-9495-7951ba9489a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c611a8f70>]}
[0m06:19:45.193790 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_customers ....................... [[32mSUCCESS 1[0m in 0.49s]
[0m06:19:45.194626 [debug] [Thread-1  ]: Finished running node model.customer.stg_customers
[0m06:19:45.196394 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:19:45.196743 [debug] [MainThread]: Connection 'model.customer.stg_customers' was properly closed.
[0m06:19:45.197118 [info ] [MainThread]: 
[0m06:19:45.197547 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m06:19:45.198338 [debug] [MainThread]: Command end result
[0m06:19:45.204995 [info ] [MainThread]: 
[0m06:19:45.205493 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:19:45.205910 [info ] [MainThread]: 
[0m06:19:45.206362 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:19:45.207181 [debug] [MainThread]: Command `dbt run` succeeded at 06:19:45.207036 after 2.27 seconds
[0m06:19:45.207629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c68d551f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c62fc1a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c62e1ebe0>]}
[0m06:19:45.208053 [debug] [MainThread]: Flushing usage events
[0m06:19:50.739711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2c4d11c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2addd970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2addd4c0>]}


============================== 06:19:50.742930 | fced39e6-1d5c-42cb-9b27-31c83fbd168e ==============================
[0m06:19:50.742930 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:19:50.743548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:19:51.011490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fced39e6-1d5c-42cb-9b27-31c83fbd168e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a26713ac0>]}
[0m06:19:51.028290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fced39e6-1d5c-42cb-9b27-31c83fbd168e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a26713a90>]}
[0m06:19:51.041176 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:19:51.061926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:19:51.062444 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:19:51.069147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fced39e6-1d5c-42cb-9b27-31c83fbd168e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a255a6430>]}
[0m06:19:51.076430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fced39e6-1d5c-42cb-9b27-31c83fbd168e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2660f160>]}
[0m06:19:51.076937 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m06:19:51.077450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fced39e6-1d5c-42cb-9b27-31c83fbd168e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a26713fa0>]}
[0m06:19:51.078808 [info ] [MainThread]: 
[0m06:19:51.079625 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:19:51.080837 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m06:19:51.097694 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m06:19:51.098226 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m06:19:51.098668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:19:51.629474 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m06:19:51.632350 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m06:19:51.756320 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m06:19:51.765151 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m06:19:51.765644 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m06:19:51.765988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:19:52.050525 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:19:52.052677 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m06:19:52.147854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fced39e6-1d5c-42cb-9b27-31c83fbd168e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a266f5550>]}
[0m06:19:52.149082 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:19:52.149797 [info ] [MainThread]: 
[0m06:19:52.165735 [debug] [Thread-1  ]: Began running node model.customer.fact_orders
[0m06:19:52.166431 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.fact_orders ............................. [RUN]
[0m06:19:52.167269 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.fact_orders)
[0m06:19:52.167703 [debug] [Thread-1  ]: Began compiling node model.customer.fact_orders
[0m06:19:52.171657 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.fact_orders"
[0m06:19:52.172443 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (compile): 06:19:52.167981 => 06:19:52.172162
[0m06:19:52.172847 [debug] [Thread-1  ]: Began executing node model.customer.fact_orders
[0m06:19:52.205768 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.fact_orders"
[0m06:19:52.207354 [debug] [Thread-1  ]: Using snowflake connection "model.customer.fact_orders"
[0m06:19:52.207839 [debug] [Thread-1  ]: On model.customer.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.fact_orders"} */
create or replace transient table learn_dbt.learn_dbt.fact_orders
         as
        (with orders as  (
    select * from learn_dbt.learn_dbt.stg_orders
),

payments as (
    select * from learn_dbt.learn_dbt.stg_payments
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
        );
[0m06:19:52.208249 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:19:53.899751 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m06:19:53.925019 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (execute): 06:19:52.173105 => 06:19:53.924757
[0m06:19:53.925542 [debug] [Thread-1  ]: On model.customer.fact_orders: Close
[0m06:19:54.063775 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fced39e6-1d5c-42cb-9b27-31c83fbd168e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a24923970>]}
[0m06:19:54.064857 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.fact_orders ........................ [[32mSUCCESS 1[0m in 1.90s]
[0m06:19:54.065765 [debug] [Thread-1  ]: Finished running node model.customer.fact_orders
[0m06:19:54.067795 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:19:54.068187 [debug] [MainThread]: Connection 'model.customer.fact_orders' was properly closed.
[0m06:19:54.068586 [info ] [MainThread]: 
[0m06:19:54.069084 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m06:19:54.069979 [debug] [MainThread]: Command end result
[0m06:19:54.078292 [info ] [MainThread]: 
[0m06:19:54.078789 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:19:54.079189 [info ] [MainThread]: 
[0m06:19:54.079611 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:19:54.080392 [debug] [MainThread]: Command `dbt run` succeeded at 06:19:54.080255 after 3.36 seconds
[0m06:19:54.080832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a2c4d11c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a267136d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a26713e80>]}
[0m06:19:54.081250 [debug] [MainThread]: Flushing usage events
[0m06:19:59.447993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf9ec6130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf87d2a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf87d2190>]}


============================== 06:19:59.451030 | 81bca07e-77f7-4758-a952-cc1ed1ad6549 ==============================
[0m06:19:59.451030 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:19:59.451620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:19:59.723258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81bca07e-77f7-4758-a952-cc1ed1ad6549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf4135eb0>]}
[0m06:19:59.740250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81bca07e-77f7-4758-a952-cc1ed1ad6549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf41066a0>]}
[0m06:19:59.753459 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:19:59.774328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:19:59.774798 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:19:59.781377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81bca07e-77f7-4758-a952-cc1ed1ad6549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf2f663a0>]}
[0m06:19:59.788602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81bca07e-77f7-4758-a952-cc1ed1ad6549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf2fc40d0>]}
[0m06:19:59.789157 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m06:19:59.789591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81bca07e-77f7-4758-a952-cc1ed1ad6549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf2f47fa0>]}
[0m06:19:59.790896 [info ] [MainThread]: 
[0m06:19:59.791690 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:19:59.792919 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m06:19:59.808274 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m06:19:59.808787 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m06:19:59.809189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:20:00.437934 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m06:20:00.440721 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m06:20:00.569328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m06:20:00.578220 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m06:20:00.578751 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m06:20:00.579100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:20:00.850064 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:20:00.852245 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m06:20:00.950893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81bca07e-77f7-4758-a952-cc1ed1ad6549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf2f47b80>]}
[0m06:20:00.952008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:20:00.952535 [info ] [MainThread]: 
[0m06:20:00.956577 [debug] [Thread-1  ]: Began running node model.customer.dim_customers
[0m06:20:00.957196 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.dim_customers ........................... [RUN]
[0m06:20:00.958279 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.dim_customers)
[0m06:20:00.958778 [debug] [Thread-1  ]: Began compiling node model.customer.dim_customers
[0m06:20:00.962897 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.dim_customers"
[0m06:20:00.963963 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (compile): 06:20:00.959062 => 06:20:00.963643
[0m06:20:00.964430 [debug] [Thread-1  ]: Began executing node model.customer.dim_customers
[0m06:20:00.999069 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.dim_customers"
[0m06:20:01.000975 [debug] [Thread-1  ]: Using snowflake connection "model.customer.dim_customers"
[0m06:20:01.001475 [debug] [Thread-1  ]: On model.customer.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.dim_customers"} */
create or replace transient table learn_dbt.learn_dbt.dim_customers
         as
        (with customers as (
    select * from learn_dbt.learn_dbt.stg_customers
),

orders as (
    select * from learn_dbt.learn_dbt.fact_orders
),
customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
        );
[0m06:20:01.001993 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:20:02.058331 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:20:02.083544 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (execute): 06:20:00.964788 => 06:20:02.083286
[0m06:20:02.084068 [debug] [Thread-1  ]: On model.customer.dim_customers: Close
[0m06:20:02.218979 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '81bca07e-77f7-4758-a952-cc1ed1ad6549', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf0a07070>]}
[0m06:20:02.219966 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.dim_customers ...................... [[32mSUCCESS 1[0m in 1.26s]
[0m06:20:02.220781 [debug] [Thread-1  ]: Finished running node model.customer.dim_customers
[0m06:20:02.222644 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:20:02.223004 [debug] [MainThread]: Connection 'model.customer.dim_customers' was properly closed.
[0m06:20:02.223358 [info ] [MainThread]: 
[0m06:20:02.223794 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m06:20:02.224565 [debug] [MainThread]: Command end result
[0m06:20:02.233187 [info ] [MainThread]: 
[0m06:20:02.233799 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:20:02.234209 [info ] [MainThread]: 
[0m06:20:02.234664 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:20:02.235605 [debug] [MainThread]: Command `dbt run` succeeded at 06:20:02.235457 after 2.80 seconds
[0m06:20:02.240630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf9ec6130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf41066a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf09eaca0>]}
[0m06:20:02.241098 [debug] [MainThread]: Flushing usage events
[0m06:46:57.966619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f800c578130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f800ae8da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f800ae8d190>]}


============================== 06:46:57.970119 | 52f97686-b268-4bba-aca5-e37f5f6ba11d ==============================
[0m06:46:57.970119 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:46:57.970789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:46:58.252199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52f97686-b268-4bba-aca5-e37f5f6ba11d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80067f4f10>]}
[0m06:46:58.269097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52f97686-b268-4bba-aca5-e37f5f6ba11d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80067d96a0>]}
[0m06:46:58.282689 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:46:58.304522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:46:58.305067 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:46:58.312289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52f97686-b268-4bba-aca5-e37f5f6ba11d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80066603a0>]}
[0m06:46:58.320252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52f97686-b268-4bba-aca5-e37f5f6ba11d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80066c60d0>]}
[0m06:46:58.320914 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m06:46:58.321377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52f97686-b268-4bba-aca5-e37f5f6ba11d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80066c63a0>]}
[0m06:46:58.322734 [info ] [MainThread]: 
[0m06:46:58.323631 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:46:58.325732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m06:46:58.345250 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m06:46:58.346191 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m06:46:58.347033 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:46:58.991552 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m06:46:58.994132 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m06:46:59.101309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m06:46:59.110434 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m06:46:59.111103 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m06:46:59.111499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:46:59.621006 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m06:46:59.623115 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m06:46:59.756109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52f97686-b268-4bba-aca5-e37f5f6ba11d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80066c62e0>]}
[0m06:46:59.757386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:46:59.758008 [info ] [MainThread]: 
[0m06:46:59.762756 [debug] [Thread-1  ]: Began running node model.customer.stg_orders
[0m06:46:59.763427 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_orders ............................... [RUN]
[0m06:46:59.764312 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_orders)
[0m06:46:59.764770 [debug] [Thread-1  ]: Began compiling node model.customer.stg_orders
[0m06:46:59.768272 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_orders"
[0m06:46:59.769143 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (compile): 06:46:59.765054 => 06:46:59.768834
[0m06:46:59.769569 [debug] [Thread-1  ]: Began executing node model.customer.stg_orders
[0m06:46:59.803186 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_orders"
[0m06:46:59.804466 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_orders"
[0m06:46:59.804951 [debug] [Thread-1  ]: On model.customer.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_orders"} */
create or replace   view learn_dbt.learn_dbt.stg_orders
  
   as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from learn_dbt.jaffle_shop.orders

)

select * from orders
  );
[0m06:46:59.805333 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:47:00.183578 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:47:00.210135 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (execute): 06:46:59.769871 => 06:47:00.209868
[0m06:47:00.210717 [debug] [Thread-1  ]: On model.customer.stg_orders: Close
[0m06:47:00.306333 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52f97686-b268-4bba-aca5-e37f5f6ba11d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80040c9d00>]}
[0m06:47:00.307354 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_orders .......................... [[32mSUCCESS 1[0m in 0.54s]
[0m06:47:00.308183 [debug] [Thread-1  ]: Finished running node model.customer.stg_orders
[0m06:47:00.310770 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:47:00.311136 [debug] [MainThread]: Connection 'model.customer.stg_orders' was properly closed.
[0m06:47:00.311498 [info ] [MainThread]: 
[0m06:47:00.311976 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m06:47:00.312959 [debug] [MainThread]: Command end result
[0m06:47:00.324567 [info ] [MainThread]: 
[0m06:47:00.325130 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:47:00.325538 [info ] [MainThread]: 
[0m06:47:00.325959 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:47:00.326794 [debug] [MainThread]: Command `dbt run` succeeded at 06:47:00.326654 after 2.38 seconds
[0m06:47:00.327236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f800c578130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8006641f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80067d96a0>]}
[0m06:47:00.327660 [debug] [MainThread]: Flushing usage events
[0m06:47:06.321987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ef2c1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0edbcc940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0edbcc460>]}


============================== 06:47:06.325520 | d4e99025-d276-4583-9879-71392dfaf182 ==============================
[0m06:47:06.325520 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:47:06.326360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:47:06.630963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4e99025-d276-4583-9879-71392dfaf182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e952efa0>]}
[0m06:47:06.648277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4e99025-d276-4583-9879-71392dfaf182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e951ac10>]}
[0m06:47:06.662374 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:47:06.684134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:47:06.684691 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:47:06.691754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4e99025-d276-4583-9879-71392dfaf182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e8365400>]}
[0m06:47:06.699655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4e99025-d276-4583-9879-71392dfaf182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e83c4130>]}
[0m06:47:06.700356 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m06:47:06.700824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4e99025-d276-4583-9879-71392dfaf182', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e951a580>]}
[0m06:47:06.701496 [warn ] [MainThread]: The selection criterion 'stg_payment' does not match any nodes
[0m06:47:06.702524 [info ] [MainThread]: 
[0m06:47:06.702948 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m06:47:06.703499 [debug] [MainThread]: Command end result
[0m06:47:06.709674 [debug] [MainThread]: Command `dbt run` succeeded at 06:47:06.709457 after 0.41 seconds
[0m06:47:06.710143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ef2c1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e951aeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0e951ae20>]}
[0m06:47:06.710590 [debug] [MainThread]: Flushing usage events
[0m06:47:12.244511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c44410d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c2d3d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c2d3d190>]}


============================== 06:47:12.248096 | 270925ca-23bc-43e1-93ef-0d90aa6aa5af ==============================
[0m06:47:12.248096 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:47:12.248758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:47:12.536831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '270925ca-23bc-43e1-93ef-0d90aa6aa5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96be6a2fa0>]}
[0m06:47:12.553960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '270925ca-23bc-43e1-93ef-0d90aa6aa5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96be674940>]}
[0m06:47:12.567877 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:47:12.589647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:47:12.590199 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:47:12.597349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '270925ca-23bc-43e1-93ef-0d90aa6aa5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bd4e5340>]}
[0m06:47:12.605500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '270925ca-23bc-43e1-93ef-0d90aa6aa5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bd544070>]}
[0m06:47:12.606175 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m06:47:12.606685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '270925ca-23bc-43e1-93ef-0d90aa6aa5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bd4c6f70>]}
[0m06:47:12.608053 [info ] [MainThread]: 
[0m06:47:12.608945 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:47:12.610235 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m06:47:12.627784 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m06:47:12.628444 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m06:47:12.628878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:47:13.318811 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m06:47:13.321512 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m06:47:13.477076 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt_learn_dbt'
[0m06:47:13.487131 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m06:47:13.487821 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m06:47:13.488489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:47:14.080063 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m06:47:14.082315 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m06:47:14.235829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '270925ca-23bc-43e1-93ef-0d90aa6aa5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bd4c6f10>]}
[0m06:47:14.237056 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:47:14.237577 [info ] [MainThread]: 
[0m06:47:14.241766 [debug] [Thread-1  ]: Began running node model.customer.stg_customers
[0m06:47:14.242464 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_customers ............................ [RUN]
[0m06:47:14.243330 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_customers)
[0m06:47:14.243749 [debug] [Thread-1  ]: Began compiling node model.customer.stg_customers
[0m06:47:14.250291 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_customers"
[0m06:47:14.251149 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (compile): 06:47:14.244014 => 06:47:14.250858
[0m06:47:14.251567 [debug] [Thread-1  ]: Began executing node model.customer.stg_customers
[0m06:47:14.286697 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_customers"
[0m06:47:14.287939 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_customers"
[0m06:47:14.288557 [debug] [Thread-1  ]: On model.customer.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_customers"} */
create or replace   view learn_dbt.learn_dbt.stg_customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from learn_dbt.jaffle_shop.customers

)

select * from customers
  );
[0m06:47:14.288957 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:47:14.691410 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:47:14.720330 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (execute): 06:47:14.251830 => 06:47:14.720058
[0m06:47:14.720889 [debug] [Thread-1  ]: On model.customer.stg_customers: Close
[0m06:47:14.822944 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '270925ca-23bc-43e1-93ef-0d90aa6aa5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bc7936a0>]}
[0m06:47:14.823963 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_customers ....................... [[32mSUCCESS 1[0m in 0.58s]
[0m06:47:14.824941 [debug] [Thread-1  ]: Finished running node model.customer.stg_customers
[0m06:47:14.826884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:47:14.827251 [debug] [MainThread]: Connection 'list_learn_dbt' was properly closed.
[0m06:47:14.827543 [debug] [MainThread]: Connection 'model.customer.stg_customers' was properly closed.
[0m06:47:14.827890 [info ] [MainThread]: 
[0m06:47:14.828328 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m06:47:14.829181 [debug] [MainThread]: Command end result
[0m06:47:14.836282 [info ] [MainThread]: 
[0m06:47:14.836947 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:47:14.837364 [info ] [MainThread]: 
[0m06:47:14.837799 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:47:14.838694 [debug] [MainThread]: Command `dbt run` succeeded at 06:47:14.838526 after 2.61 seconds
[0m06:47:14.839169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c44410d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bd4c6f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96bd4c6a60>]}
[0m06:47:14.839612 [debug] [MainThread]: Flushing usage events
[0m06:47:20.685366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71de3161c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71dcbec970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71dcbec4c0>]}


============================== 06:47:20.688877 | 701bcfc1-d6e1-477b-b6a8-1999f6d9dcaf ==============================
[0m06:47:20.688877 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:47:20.689522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:47:20.993295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '701bcfc1-d6e1-477b-b6a8-1999f6d9dcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d8548ac0>]}
[0m06:47:21.010701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '701bcfc1-d6e1-477b-b6a8-1999f6d9dcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d8548a90>]}
[0m06:47:21.024678 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:47:21.046397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:47:21.046962 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:47:21.054101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '701bcfc1-d6e1-477b-b6a8-1999f6d9dcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d73a7430>]}
[0m06:47:21.062143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '701bcfc1-d6e1-477b-b6a8-1999f6d9dcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d843f220>]}
[0m06:47:21.062833 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m06:47:21.063695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '701bcfc1-d6e1-477b-b6a8-1999f6d9dcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d85486d0>]}
[0m06:47:21.065100 [info ] [MainThread]: 
[0m06:47:21.066030 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:47:21.067374 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m06:47:21.083255 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m06:47:21.083814 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m06:47:21.084235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:47:21.494990 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:47:21.497503 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m06:47:21.602546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m06:47:21.614978 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m06:47:21.615564 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m06:47:21.616052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:47:21.938685 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:47:21.940748 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m06:47:22.059212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '701bcfc1-d6e1-477b-b6a8-1999f6d9dcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d843f220>]}
[0m06:47:22.060322 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:47:22.060844 [info ] [MainThread]: 
[0m06:47:22.065099 [debug] [Thread-1  ]: Began running node model.customer.fact_orders
[0m06:47:22.065781 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.fact_orders ............................. [RUN]
[0m06:47:22.066622 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.fact_orders)
[0m06:47:22.067047 [debug] [Thread-1  ]: Began compiling node model.customer.fact_orders
[0m06:47:22.071170 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.fact_orders"
[0m06:47:22.072020 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (compile): 06:47:22.067322 => 06:47:22.071708
[0m06:47:22.072446 [debug] [Thread-1  ]: Began executing node model.customer.fact_orders
[0m06:47:22.106982 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.fact_orders"
[0m06:47:22.108700 [debug] [Thread-1  ]: Using snowflake connection "model.customer.fact_orders"
[0m06:47:22.109251 [debug] [Thread-1  ]: On model.customer.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.fact_orders"} */
create or replace transient table learn_dbt.learn_dbt.fact_orders
         as
        (with orders as  (
    select * from learn_dbt.learn_dbt.stg_orders
),

payments as (
    select * from learn_dbt.learn_dbt.stg_payments
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
        );
[0m06:47:22.109669 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:47:23.318529 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:47:23.343905 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (execute): 06:47:22.072708 => 06:47:23.343643
[0m06:47:23.344459 [debug] [Thread-1  ]: On model.customer.fact_orders: Close
[0m06:47:23.461581 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '701bcfc1-d6e1-477b-b6a8-1999f6d9dcaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d4e58190>]}
[0m06:47:23.462648 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.fact_orders ........................ [[32mSUCCESS 1[0m in 1.40s]
[0m06:47:23.463487 [debug] [Thread-1  ]: Finished running node model.customer.fact_orders
[0m06:47:23.465389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:47:23.465764 [debug] [MainThread]: Connection 'model.customer.fact_orders' was properly closed.
[0m06:47:23.466191 [info ] [MainThread]: 
[0m06:47:23.467099 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.40 seconds (2.40s).
[0m06:47:23.468259 [debug] [MainThread]: Command end result
[0m06:47:23.476563 [info ] [MainThread]: 
[0m06:47:23.477111 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:47:23.477511 [info ] [MainThread]: 
[0m06:47:23.478060 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:47:23.479069 [debug] [MainThread]: Command `dbt run` succeeded at 06:47:23.478918 after 2.81 seconds
[0m06:47:23.479685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71de3161c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d8548f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71d8548fa0>]}
[0m06:47:23.480296 [debug] [MainThread]: Flushing usage events
[0m06:47:29.323402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8540400160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f853ed159a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f853ed15970>]}


============================== 06:47:29.326845 | 8a775e7d-03f7-4efd-abcb-4b1a8842636b ==============================
[0m06:47:29.326845 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:47:29.327467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:47:29.612801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a775e7d-03f7-4efd-abcb-4b1a8842636b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f853a675fd0>]}
[0m06:47:29.629851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a775e7d-03f7-4efd-abcb-4b1a8842636b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f853a64cc10>]}
[0m06:47:29.643605 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:47:29.664767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:47:29.665279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:47:29.672244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a775e7d-03f7-4efd-abcb-4b1a8842636b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85394e53d0>]}
[0m06:47:29.679771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a775e7d-03f7-4efd-abcb-4b1a8842636b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8539546100>]}
[0m06:47:29.680338 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m06:47:29.680790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a775e7d-03f7-4efd-abcb-4b1a8842636b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85395463d0>]}
[0m06:47:29.682063 [info ] [MainThread]: 
[0m06:47:29.682938 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:47:29.684191 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m06:47:29.699650 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m06:47:29.700289 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m06:47:29.700717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:47:30.446406 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m06:47:30.449072 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m06:47:30.590836 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m06:47:30.599759 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m06:47:30.600306 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m06:47:30.600695 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:47:31.029574 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:47:31.032153 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m06:47:31.136130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a775e7d-03f7-4efd-abcb-4b1a8842636b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85395463d0>]}
[0m06:47:31.137291 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:47:31.137857 [info ] [MainThread]: 
[0m06:47:31.142707 [debug] [Thread-1  ]: Began running node model.customer.dim_customers
[0m06:47:31.143469 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.dim_customers ........................... [RUN]
[0m06:47:31.144394 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.dim_customers)
[0m06:47:31.144851 [debug] [Thread-1  ]: Began compiling node model.customer.dim_customers
[0m06:47:31.149365 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.dim_customers"
[0m06:47:31.151523 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (compile): 06:47:31.145136 => 06:47:31.149960
[0m06:47:31.152075 [debug] [Thread-1  ]: Began executing node model.customer.dim_customers
[0m06:47:31.201503 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.dim_customers"
[0m06:47:31.203535 [debug] [Thread-1  ]: Using snowflake connection "model.customer.dim_customers"
[0m06:47:31.204113 [debug] [Thread-1  ]: On model.customer.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.dim_customers"} */
create or replace transient table learn_dbt.learn_dbt.dim_customers
         as
        (with customers as (
    select * from learn_dbt.learn_dbt.stg_customers
),

orders as (
    select * from learn_dbt.learn_dbt.fact_orders
),
customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
        );
[0m06:47:31.204564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:47:32.277678 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:47:32.308388 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (execute): 06:47:31.152409 => 06:47:32.308102
[0m06:47:32.309025 [debug] [Thread-1  ]: On model.customer.dim_customers: Close
[0m06:47:32.437124 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a775e7d-03f7-4efd-abcb-4b1a8842636b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f853885d8e0>]}
[0m06:47:32.438143 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.dim_customers ...................... [[32mSUCCESS 1[0m in 1.29s]
[0m06:47:32.439014 [debug] [Thread-1  ]: Finished running node model.customer.dim_customers
[0m06:47:32.441215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:47:32.441584 [debug] [MainThread]: Connection 'model.customer.dim_customers' was properly closed.
[0m06:47:32.441959 [info ] [MainThread]: 
[0m06:47:32.442433 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m06:47:32.443221 [debug] [MainThread]: Command end result
[0m06:47:32.451735 [info ] [MainThread]: 
[0m06:47:32.452383 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:47:32.452801 [info ] [MainThread]: 
[0m06:47:32.453224 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:47:32.454066 [debug] [MainThread]: Command `dbt run` succeeded at 06:47:32.453917 after 3.15 seconds
[0m06:47:32.454548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8540400160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f853a64cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85387367c0>]}
[0m06:47:32.454999 [debug] [MainThread]: Flushing usage events
[0m09:27:38.965657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5647043100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56459508b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56459503d0>]}


============================== 09:27:38.969116 | 7092e6b4-c5c7-4241-9fc0-3c68c87dd24c ==============================
[0m09:27:38.969116 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:27:38.969764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:27:39.270644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7092e6b4-c5c7-4241-9fc0-3c68c87dd24c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56412b8f10>]}
[0m09:27:39.288310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7092e6b4-c5c7-4241-9fc0-3c68c87dd24c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5641292bb0>]}
[0m09:27:39.302149 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:27:39.323642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:27:39.324168 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:27:39.331257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7092e6b4-c5c7-4241-9fc0-3c68c87dd24c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56400e6370>]}
[0m09:27:39.338880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7092e6b4-c5c7-4241-9fc0-3c68c87dd24c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56401470a0>]}
[0m09:27:39.339475 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m09:27:39.339934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7092e6b4-c5c7-4241-9fc0-3c68c87dd24c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56400c7af0>]}
[0m09:27:39.341232 [info ] [MainThread]: 
[0m09:27:39.342101 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:27:39.343865 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m09:27:39.361011 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m09:27:39.361646 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m09:27:39.362088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:40.205192 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m09:27:40.207792 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m09:27:40.318406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m09:27:40.328569 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m09:27:40.329073 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m09:27:40.329426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:27:40.881589 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m09:27:40.884010 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m09:27:40.988580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7092e6b4-c5c7-4241-9fc0-3c68c87dd24c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f56400c7af0>]}
[0m09:27:40.989654 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:27:40.990174 [info ] [MainThread]: 
[0m09:27:40.994152 [debug] [Thread-1  ]: Began running node model.customer.stg_orders
[0m09:27:40.994876 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_orders ............................... [RUN]
[0m09:27:40.995723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_orders)
[0m09:27:40.996147 [debug] [Thread-1  ]: Began compiling node model.customer.stg_orders
[0m09:27:40.998445 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_orders"
[0m09:27:40.999185 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (compile): 09:27:40.996414 => 09:27:40.998916
[0m09:27:40.999573 [debug] [Thread-1  ]: Began executing node model.customer.stg_orders
[0m09:27:41.031738 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_orders"
[0m09:27:41.032915 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_orders"
[0m09:27:41.033393 [debug] [Thread-1  ]: On model.customer.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_orders"} */
create or replace   view learn_dbt.learn_dbt.stg_orders
  
   as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from learn_dbt.jaffle_shop.orders

)

select * from orders
  );
[0m09:27:41.033789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:27:41.444308 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:27:41.476817 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (execute): 09:27:40.999828 => 09:27:41.476551
[0m09:27:41.477349 [debug] [Thread-1  ]: On model.customer.stg_orders: Close
[0m09:27:41.579934 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7092e6b4-c5c7-4241-9fc0-3c68c87dd24c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5639b776a0>]}
[0m09:27:41.581165 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_orders .......................... [[32mSUCCESS 1[0m in 0.58s]
[0m09:27:41.582104 [debug] [Thread-1  ]: Finished running node model.customer.stg_orders
[0m09:27:41.583920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:27:41.584282 [debug] [MainThread]: Connection 'model.customer.stg_orders' was properly closed.
[0m09:27:41.584642 [info ] [MainThread]: 
[0m09:27:41.585145 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m09:27:41.585936 [debug] [MainThread]: Command end result
[0m09:27:41.593339 [info ] [MainThread]: 
[0m09:27:41.594200 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:27:41.594665 [info ] [MainThread]: 
[0m09:27:41.595177 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:27:41.596030 [debug] [MainThread]: Command `dbt run` succeeded at 09:27:41.595886 after 2.65 seconds
[0m09:27:41.596479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5647043100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5641292bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5640147250>]}
[0m09:27:41.596917 [debug] [MainThread]: Flushing usage events
[0m09:27:47.384907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c4dd690d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c4c68f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c4c68f3d0>]}


============================== 09:27:47.388384 | 73fdaa7b-da86-4527-a3b2-04b188ee3bab ==============================
[0m09:27:47.388384 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:27:47.389006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:27:47.666735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73fdaa7b-da86-4527-a3b2-04b188ee3bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c47ff4fa0>]}
[0m09:27:47.683718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73fdaa7b-da86-4527-a3b2-04b188ee3bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c47fdb8b0>]}
[0m09:27:47.697249 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:27:47.718375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:27:47.718901 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:27:47.725947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73fdaa7b-da86-4527-a3b2-04b188ee3bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c47e61340>]}
[0m09:27:47.733612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73fdaa7b-da86-4527-a3b2-04b188ee3bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c47ebf070>]}
[0m09:27:47.734203 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m09:27:47.734692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73fdaa7b-da86-4527-a3b2-04b188ee3bab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c47e42f70>]}
[0m09:27:47.735366 [warn ] [MainThread]: The selection criterion 'stg_payment' does not match any nodes
[0m09:27:47.736332 [info ] [MainThread]: 
[0m09:27:47.736746 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:27:47.737475 [debug] [MainThread]: Command end result
[0m09:27:47.743408 [debug] [MainThread]: Command `dbt run` succeeded at 09:27:47.743242 after 0.38 seconds
[0m09:27:47.743849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c4dd690d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c47ebf040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c47ebf280>]}
[0m09:27:47.744245 [debug] [MainThread]: Flushing usage events
[0m09:27:53.237040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d50559160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4ee6da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4ee6d1c0>]}


============================== 09:27:53.240537 | 0c6cbad6-7cab-408d-a4cc-cb2a464035b9 ==============================
[0m09:27:53.240537 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:27:53.241189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:27:53.525382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c6cbad6-7cab-408d-a4cc-cb2a464035b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4a7ccfd0>]}
[0m09:27:53.542381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c6cbad6-7cab-408d-a4cc-cb2a464035b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4a7a6bb0>]}
[0m09:27:53.556363 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:27:53.577783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:27:53.578359 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:27:53.585357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c6cbad6-7cab-408d-a4cc-cb2a464035b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4a63e3d0>]}
[0m09:27:53.593061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c6cbad6-7cab-408d-a4cc-cb2a464035b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4a69c100>]}
[0m09:27:53.593666 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m09:27:53.594136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c6cbad6-7cab-408d-a4cc-cb2a464035b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4a69c3d0>]}
[0m09:27:53.595473 [info ] [MainThread]: 
[0m09:27:53.596329 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:27:53.597604 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m09:27:53.613267 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m09:27:53.613930 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m09:27:53.614374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:27:54.206909 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m09:27:54.209438 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m09:27:54.306082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m09:27:54.315620 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m09:27:54.316167 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m09:27:54.316544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:27:54.746008 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m09:27:54.748376 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m09:27:54.853575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c6cbad6-7cab-408d-a4cc-cb2a464035b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4a69c3d0>]}
[0m09:27:54.854687 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:27:54.855242 [info ] [MainThread]: 
[0m09:27:54.859914 [debug] [Thread-1  ]: Began running node model.customer.stg_customers
[0m09:27:54.860578 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_customers ............................ [RUN]
[0m09:27:54.861363 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_customers)
[0m09:27:54.861800 [debug] [Thread-1  ]: Began compiling node model.customer.stg_customers
[0m09:27:54.865082 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_customers"
[0m09:27:54.865939 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (compile): 09:27:54.862076 => 09:27:54.865656
[0m09:27:54.866373 [debug] [Thread-1  ]: Began executing node model.customer.stg_customers
[0m09:27:54.902730 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_customers"
[0m09:27:54.904005 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_customers"
[0m09:27:54.904513 [debug] [Thread-1  ]: On model.customer.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_customers"} */
create or replace   view learn_dbt.learn_dbt.stg_customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from learn_dbt.jaffle_shop.customers

)

select * from customers
  );
[0m09:27:54.904913 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:27:55.398719 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m09:27:55.425913 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (execute): 09:27:54.866636 => 09:27:55.425657
[0m09:27:55.426490 [debug] [Thread-1  ]: On model.customer.stg_customers: Close
[0m09:27:55.535659 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c6cbad6-7cab-408d-a4cc-cb2a464035b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d489afa60>]}
[0m09:27:55.536746 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_customers ....................... [[32mSUCCESS 1[0m in 0.67s]
[0m09:27:55.537777 [debug] [Thread-1  ]: Finished running node model.customer.stg_customers
[0m09:27:55.539760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:27:55.540122 [debug] [MainThread]: Connection 'model.customer.stg_customers' was properly closed.
[0m09:27:55.540699 [info ] [MainThread]: 
[0m09:27:55.541160 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m09:27:55.542029 [debug] [MainThread]: Command end result
[0m09:27:55.553641 [info ] [MainThread]: 
[0m09:27:55.554357 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:27:55.555285 [info ] [MainThread]: 
[0m09:27:55.555739 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:27:55.557170 [debug] [MainThread]: Command `dbt run` succeeded at 09:27:55.557019 after 2.34 seconds
[0m09:27:55.557639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d50559160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d4a7a6bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d489bbeb0>]}
[0m09:27:55.558073 [debug] [MainThread]: Flushing usage events
[0m09:28:01.411911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c356b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c1e4a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c1e4a940>]}


============================== 09:28:01.415246 | 7b295db4-c0b7-4bbc-91db-a0b995c638f4 ==============================
[0m09:28:01.415246 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:28:01.415873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:28:01.695993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b295db4-c0b7-4bbc-91db-a0b995c638f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09bd7d0eb0>]}
[0m09:28:01.713012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b295db4-c0b7-4bbc-91db-a0b995c638f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09bd7a16a0>]}
[0m09:28:01.727098 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:28:01.748532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:28:01.749023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:28:01.755824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b295db4-c0b7-4bbc-91db-a0b995c638f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09bd63c3a0>]}
[0m09:28:01.763345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b295db4-c0b7-4bbc-91db-a0b995c638f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09bd69b0d0>]}
[0m09:28:01.763889 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m09:28:01.764340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b295db4-c0b7-4bbc-91db-a0b995c638f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09bd69b3a0>]}
[0m09:28:01.765600 [info ] [MainThread]: 
[0m09:28:01.766442 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:28:01.768190 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m09:28:01.784763 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m09:28:01.785354 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m09:28:01.785778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:02.208300 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m09:28:02.211282 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m09:28:02.313595 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m09:28:02.325497 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m09:28:02.326036 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m09:28:02.326423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:02.615220 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m09:28:02.617511 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m09:28:02.721534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b295db4-c0b7-4bbc-91db-a0b995c638f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09bd69b2e0>]}
[0m09:28:02.722733 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:28:02.723324 [info ] [MainThread]: 
[0m09:28:02.727621 [debug] [Thread-1  ]: Began running node model.customer.fact_orders
[0m09:28:02.728308 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.fact_orders ............................. [RUN]
[0m09:28:02.729206 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.fact_orders)
[0m09:28:02.729638 [debug] [Thread-1  ]: Began compiling node model.customer.fact_orders
[0m09:28:02.733874 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.fact_orders"
[0m09:28:02.734665 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (compile): 09:28:02.730113 => 09:28:02.734389
[0m09:28:02.735072 [debug] [Thread-1  ]: Began executing node model.customer.fact_orders
[0m09:28:02.770234 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.fact_orders"
[0m09:28:02.771883 [debug] [Thread-1  ]: Using snowflake connection "model.customer.fact_orders"
[0m09:28:02.772382 [debug] [Thread-1  ]: On model.customer.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.fact_orders"} */
create or replace transient table learn_dbt.learn_dbt.fact_orders
         as
        (with orders as  (
    select * from learn_dbt.learn_dbt.stg_orders
),

payments as (
    select * from learn_dbt.learn_dbt.stg_payments
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
        );
[0m09:28:02.772806 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:28:04.406414 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m09:28:04.432151 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (execute): 09:28:02.735328 => 09:28:04.431887
[0m09:28:04.432699 [debug] [Thread-1  ]: On model.customer.fact_orders: Close
[0m09:28:04.520635 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b295db4-c0b7-4bbc-91db-a0b995c638f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09bc0adca0>]}
[0m09:28:04.521698 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.fact_orders ........................ [[32mSUCCESS 1[0m in 1.79s]
[0m09:28:04.522663 [debug] [Thread-1  ]: Finished running node model.customer.fact_orders
[0m09:28:04.524611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:28:04.524972 [debug] [MainThread]: Connection 'model.customer.fact_orders' was properly closed.
[0m09:28:04.525331 [info ] [MainThread]: 
[0m09:28:04.525768 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m09:28:04.526551 [debug] [MainThread]: Command end result
[0m09:28:04.533500 [info ] [MainThread]: 
[0m09:28:04.534026 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:28:04.534458 [info ] [MainThread]: 
[0m09:28:04.534890 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:28:04.535674 [debug] [MainThread]: Command `dbt run` succeeded at 09:28:04.535536 after 3.14 seconds
[0m09:28:04.536111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09c356b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09bd61ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09bd7a16a0>]}
[0m09:28:04.536541 [debug] [MainThread]: Flushing usage events
[0m09:28:10.331096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc7b86130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc6465970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc6465940>]}


============================== 09:28:10.334407 | b3901a76-6caa-49bd-8dc0-c65de4bbdc0a ==============================
[0m09:28:10.334407 [info ] [MainThread]: Running with dbt=1.5.1
[0m09:28:10.335017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m09:28:10.612899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3901a76-6caa-49bd-8dc0-c65de4bbdc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc1debee0>]}
[0m09:28:10.630040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3901a76-6caa-49bd-8dc0-c65de4bbdc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc1db8c10>]}
[0m09:28:10.643706 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m09:28:10.665043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:28:10.665583 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:28:10.672649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3901a76-6caa-49bd-8dc0-c65de4bbdc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc1c583a0>]}
[0m09:28:10.680433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3901a76-6caa-49bd-8dc0-c65de4bbdc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc1cb60d0>]}
[0m09:28:10.681095 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m09:28:10.681546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3901a76-6caa-49bd-8dc0-c65de4bbdc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc1c39fa0>]}
[0m09:28:10.682915 [info ] [MainThread]: 
[0m09:28:10.683787 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:28:10.685702 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m09:28:10.708443 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m09:28:10.709019 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m09:28:10.709452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:28:11.508524 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m09:28:11.511345 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m09:28:11.658812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m09:28:11.670984 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m09:28:11.671546 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m09:28:11.671902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:28:11.978805 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m09:28:11.980962 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m09:28:12.086221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3901a76-6caa-49bd-8dc0-c65de4bbdc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc0063130>]}
[0m09:28:12.087401 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:28:12.087929 [info ] [MainThread]: 
[0m09:28:12.091861 [debug] [Thread-1  ]: Began running node model.customer.dim_customers
[0m09:28:12.092498 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.dim_customers ........................... [RUN]
[0m09:28:12.093325 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.dim_customers)
[0m09:28:12.093758 [debug] [Thread-1  ]: Began compiling node model.customer.dim_customers
[0m09:28:12.097764 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.dim_customers"
[0m09:28:12.098581 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (compile): 09:28:12.094036 => 09:28:12.098283
[0m09:28:12.098993 [debug] [Thread-1  ]: Began executing node model.customer.dim_customers
[0m09:28:12.133104 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.dim_customers"
[0m09:28:12.135068 [debug] [Thread-1  ]: Using snowflake connection "model.customer.dim_customers"
[0m09:28:12.135582 [debug] [Thread-1  ]: On model.customer.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.dim_customers"} */
create or replace transient table learn_dbt.learn_dbt.dim_customers
         as
        (with customers as (
    select * from learn_dbt.learn_dbt.stg_customers
),

orders as (
    select * from learn_dbt.learn_dbt.fact_orders
),
customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
        );
[0m09:28:12.136001 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m09:28:14.040577 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m09:28:14.066176 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (execute): 09:28:12.099258 => 09:28:14.065909
[0m09:28:14.066747 [debug] [Thread-1  ]: On model.customer.dim_customers: Close
[0m09:28:14.163263 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3901a76-6caa-49bd-8dc0-c65de4bbdc0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cba6ae9a0>]}
[0m09:28:14.164328 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.dim_customers ...................... [[32mSUCCESS 1[0m in 2.07s]
[0m09:28:14.165256 [debug] [Thread-1  ]: Finished running node model.customer.dim_customers
[0m09:28:14.167243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:28:14.167633 [debug] [MainThread]: Connection 'model.customer.dim_customers' was properly closed.
[0m09:28:14.168033 [info ] [MainThread]: 
[0m09:28:14.168519 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m09:28:14.169408 [debug] [MainThread]: Command end result
[0m09:28:14.177561 [info ] [MainThread]: 
[0m09:28:14.178354 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:28:14.178945 [info ] [MainThread]: 
[0m09:28:14.179524 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:28:14.180468 [debug] [MainThread]: Command `dbt run` succeeded at 09:28:14.180324 after 3.87 seconds
[0m09:28:14.180904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc7b86130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cc1db8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cba682bb0>]}
[0m09:28:14.181321 [debug] [MainThread]: Flushing usage events
[0m18:12:26.734061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c9c83550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c8545700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c8545130>]}


============================== 18:12:26.738288 | 7d4ab897-9ccb-4ce0-ae12-3619ab5c647a ==============================
[0m18:12:26.738288 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:12:26.739199 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:12:27.793617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d4ab897-9ccb-4ce0-ae12-3619ab5c647a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c3e62d00>]}
[0m18:12:27.816458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d4ab897-9ccb-4ce0-ae12-3619ab5c647a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c3e57880>]}
[0m18:12:27.832803 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:12:27.913813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:27.914355 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:27.923135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d4ab897-9ccb-4ce0-ae12-3619ab5c647a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c2ca4460>]}
[0m18:12:27.930648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d4ab897-9ccb-4ce0-ae12-3619ab5c647a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c2d07250>]}
[0m18:12:27.931420 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:12:27.932084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d4ab897-9ccb-4ce0-ae12-3619ab5c647a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c2d073d0>]}
[0m18:12:27.933571 [info ] [MainThread]: 
[0m18:12:27.934521 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:12:27.935775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m18:12:27.955030 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m18:12:27.955513 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m18:12:27.955876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:29.632983 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.0 seconds
[0m18:12:29.636116 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m18:12:29.770586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m18:12:29.781400 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m18:12:29.781846 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m18:12:29.782251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:30.236283 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m18:12:30.239075 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m18:12:30.360229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d4ab897-9ccb-4ce0-ae12-3619ab5c647a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c2d07310>]}
[0m18:12:30.361692 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:30.362428 [info ] [MainThread]: 
[0m18:12:30.372347 [debug] [Thread-1  ]: Began running node model.customer.stg_orders
[0m18:12:30.373021 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_orders ............................... [RUN]
[0m18:12:30.374021 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_orders)
[0m18:12:30.374489 [debug] [Thread-1  ]: Began compiling node model.customer.stg_orders
[0m18:12:30.376848 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_orders"
[0m18:12:30.377949 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (compile): 18:12:30.374815 => 18:12:30.377465
[0m18:12:30.378527 [debug] [Thread-1  ]: Began executing node model.customer.stg_orders
[0m18:12:30.420278 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_orders"
[0m18:12:30.421528 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_orders"
[0m18:12:30.422005 [debug] [Thread-1  ]: On model.customer.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_orders"} */
create or replace   view learn_dbt.learn_dbt.stg_orders
  
   as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from learn_dbt.jaffle_shop.orders

)

select * from orders
  );
[0m18:12:30.422466 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:12:30.844458 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:12:30.875088 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (execute): 18:12:30.379024 => 18:12:30.874800
[0m18:12:30.875609 [debug] [Thread-1  ]: On model.customer.stg_orders: Close
[0m18:12:30.981923 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d4ab897-9ccb-4ce0-ae12-3619ab5c647a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c2ca4760>]}
[0m18:12:30.983027 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_orders .......................... [[32mSUCCESS 1[0m in 0.61s]
[0m18:12:30.984148 [debug] [Thread-1  ]: Finished running node model.customer.stg_orders
[0m18:12:30.988235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:30.988640 [debug] [MainThread]: Connection 'model.customer.stg_orders' was properly closed.
[0m18:12:30.989101 [info ] [MainThread]: 
[0m18:12:30.989632 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.05 seconds (3.05s).
[0m18:12:30.990894 [debug] [MainThread]: Command end result
[0m18:12:30.999384 [info ] [MainThread]: 
[0m18:12:30.999935 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:12:31.000665 [info ] [MainThread]: 
[0m18:12:31.001339 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:12:31.002281 [debug] [MainThread]: Command `dbt run` succeeded at 18:12:31.002123 after 4.29 seconds
[0m18:12:31.002866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c9c83550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c3e62d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48c2c88c10>]}
[0m18:12:31.003596 [debug] [MainThread]: Flushing usage events
[0m18:12:38.069306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4abbca4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4aa4a8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4aa4a82e0>]}


============================== 18:12:38.072842 | 7ba1d752-ddcd-4e49-9927-f7783ea78288 ==============================
[0m18:12:38.072842 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:12:38.073925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:12:38.396317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ba1d752-ddcd-4e49-9927-f7783ea78288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a5dc5d00>]}
[0m18:12:38.417919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ba1d752-ddcd-4e49-9927-f7783ea78288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a5da4d00>]}
[0m18:12:38.434363 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:12:38.464927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:38.465651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:38.474813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ba1d752-ddcd-4e49-9927-f7783ea78288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a5c313d0>]}
[0m18:12:38.482715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ba1d752-ddcd-4e49-9927-f7783ea78288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a5c9d100>]}
[0m18:12:38.483326 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:12:38.483901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ba1d752-ddcd-4e49-9927-f7783ea78288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a5c9d3d0>]}
[0m18:12:38.484911 [warn ] [MainThread]: The selection criterion 'stg_payment' does not match any nodes
[0m18:12:38.486173 [info ] [MainThread]: 
[0m18:12:38.486755 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:12:38.487546 [debug] [MainThread]: Command end result
[0m18:12:38.494218 [debug] [MainThread]: Command `dbt run` succeeded at 18:12:38.494043 after 0.44 seconds
[0m18:12:38.494723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4abbca4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a5da4d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a5c15bb0>]}
[0m18:12:38.495205 [debug] [MainThread]: Flushing usage events
[0m18:12:45.168945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3578634f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc356141610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3561415e0>]}


============================== 18:12:45.172617 | aff2426f-9dab-4d8f-98a8-d9347b0483b3 ==============================
[0m18:12:45.172617 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:12:45.173337 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:12:45.499933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aff2426f-9dab-4d8f-98a8-d9347b0483b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc351a64d30>]}
[0m18:12:45.524856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aff2426f-9dab-4d8f-98a8-d9347b0483b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc351a64340>]}
[0m18:12:45.542474 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:12:45.568541 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:45.569141 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:45.577514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aff2426f-9dab-4d8f-98a8-d9347b0483b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3508a4400>]}
[0m18:12:45.586238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aff2426f-9dab-4d8f-98a8-d9347b0483b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3509141f0>]}
[0m18:12:45.586991 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:12:45.588231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aff2426f-9dab-4d8f-98a8-d9347b0483b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc350914370>]}
[0m18:12:45.590035 [info ] [MainThread]: 
[0m18:12:45.591464 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:12:45.593180 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m18:12:45.614268 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m18:12:45.614791 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m18:12:45.617120 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:46.448699 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m18:12:46.451527 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m18:12:46.565906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m18:12:46.577291 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m18:12:46.577768 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m18:12:46.578195 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:46.882432 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m18:12:46.885060 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m18:12:46.995269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aff2426f-9dab-4d8f-98a8-d9347b0483b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3509eebb0>]}
[0m18:12:46.996652 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:46.997368 [info ] [MainThread]: 
[0m18:12:47.002438 [debug] [Thread-1  ]: Began running node model.customer.stg_customers
[0m18:12:47.003263 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_customers ............................ [RUN]
[0m18:12:47.004280 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_customers)
[0m18:12:47.004837 [debug] [Thread-1  ]: Began compiling node model.customer.stg_customers
[0m18:12:47.007701 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_customers"
[0m18:12:47.008776 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (compile): 18:12:47.005218 => 18:12:47.008413
[0m18:12:47.009283 [debug] [Thread-1  ]: Began executing node model.customer.stg_customers
[0m18:12:47.050101 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_customers"
[0m18:12:47.051706 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_customers"
[0m18:12:47.052220 [debug] [Thread-1  ]: On model.customer.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_customers"} */
create or replace   view learn_dbt.learn_dbt.stg_customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from learn_dbt.jaffle_shop.customers

)

select * from customers
  );
[0m18:12:47.052696 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:12:47.595490 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:12:47.628984 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (execute): 18:12:47.009635 => 18:12:47.628646
[0m18:12:47.629647 [debug] [Thread-1  ]: On model.customer.stg_customers: Close
[0m18:12:47.737850 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aff2426f-9dab-4d8f-98a8-d9347b0483b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34bc1f8e0>]}
[0m18:12:47.739164 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_customers ....................... [[32mSUCCESS 1[0m in 0.73s]
[0m18:12:47.740199 [debug] [Thread-1  ]: Finished running node model.customer.stg_customers
[0m18:12:47.742375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:47.742829 [debug] [MainThread]: Connection 'model.customer.stg_customers' was properly closed.
[0m18:12:47.743333 [info ] [MainThread]: 
[0m18:12:47.743962 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.15 seconds (2.15s).
[0m18:12:47.745021 [debug] [MainThread]: Command end result
[0m18:12:47.755818 [info ] [MainThread]: 
[0m18:12:47.756518 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:12:47.757075 [info ] [MainThread]: 
[0m18:12:47.757767 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:12:47.758821 [debug] [MainThread]: Command `dbt run` succeeded at 18:12:47.758620 after 2.61 seconds
[0m18:12:47.759552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3578634f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc351a64340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc34bc16f70>]}
[0m18:12:47.760118 [debug] [MainThread]: Flushing usage events
[0m18:12:55.103590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1b89c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1a15d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1a15d130>]}


============================== 18:12:55.106735 | 45d088db-c923-4adf-bf2d-109b449aebd4 ==============================
[0m18:12:55.106735 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:12:55.107513 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:12:55.437534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45d088db-c923-4adf-bf2d-109b449aebd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c15a7ed30>]}
[0m18:12:55.459633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45d088db-c923-4adf-bf2d-109b449aebd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c15a7e580>]}
[0m18:12:55.476848 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:12:55.507503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:55.508039 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:55.516930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45d088db-c923-4adf-bf2d-109b449aebd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c148e2490>]}
[0m18:12:55.524841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45d088db-c923-4adf-bf2d-109b449aebd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c149561c0>]}
[0m18:12:55.525452 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:12:55.526537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45d088db-c923-4adf-bf2d-109b449aebd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c148c6c10>]}
[0m18:12:55.528044 [info ] [MainThread]: 
[0m18:12:55.529318 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:12:55.531830 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m18:12:55.551423 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m18:12:55.551955 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m18:12:55.552419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:56.027354 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m18:12:56.030307 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m18:12:56.139704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m18:12:56.152719 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m18:12:56.153371 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m18:12:56.153864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:12:56.610353 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m18:12:56.613125 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m18:12:56.728114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45d088db-c923-4adf-bf2d-109b449aebd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c14956100>]}
[0m18:12:56.729288 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:12:56.729990 [info ] [MainThread]: 
[0m18:12:56.734467 [debug] [Thread-1  ]: Began running node model.customer.fact_orders
[0m18:12:56.735196 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.fact_orders ............................. [RUN]
[0m18:12:56.736382 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.fact_orders)
[0m18:12:56.737085 [debug] [Thread-1  ]: Began compiling node model.customer.fact_orders
[0m18:12:56.741883 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.fact_orders"
[0m18:12:56.742878 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (compile): 18:12:56.737453 => 18:12:56.742543
[0m18:12:56.743497 [debug] [Thread-1  ]: Began executing node model.customer.fact_orders
[0m18:12:56.785410 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.fact_orders"
[0m18:12:56.787665 [debug] [Thread-1  ]: Using snowflake connection "model.customer.fact_orders"
[0m18:12:56.788224 [debug] [Thread-1  ]: On model.customer.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.fact_orders"} */
create or replace transient table learn_dbt.learn_dbt.fact_orders
         as
        (with orders as  (
    select * from learn_dbt.learn_dbt.stg_orders
),

payments as (
    select * from learn_dbt.learn_dbt.stg_payments
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
        );
[0m18:12:56.788736 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:12:59.295277 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.0 seconds
[0m18:12:59.326547 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (execute): 18:12:56.743833 => 18:12:59.326264
[0m18:12:59.327089 [debug] [Thread-1  ]: On model.customer.fact_orders: Close
[0m18:12:59.437404 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45d088db-c923-4adf-bf2d-109b449aebd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c0fc559a0>]}
[0m18:12:59.438621 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.fact_orders ........................ [[32mSUCCESS 1[0m in 2.70s]
[0m18:12:59.439873 [debug] [Thread-1  ]: Finished running node model.customer.fact_orders
[0m18:12:59.442370 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:59.442941 [debug] [MainThread]: Connection 'model.customer.fact_orders' was properly closed.
[0m18:12:59.443493 [info ] [MainThread]: 
[0m18:12:59.444167 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.91 seconds (3.91s).
[0m18:12:59.445389 [debug] [MainThread]: Command end result
[0m18:12:59.455102 [info ] [MainThread]: 
[0m18:12:59.457978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:12:59.458573 [info ] [MainThread]: 
[0m18:12:59.459200 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:12:59.460299 [debug] [MainThread]: Command `dbt run` succeeded at 18:12:59.460095 after 4.38 seconds
[0m18:12:59.460883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c1b89c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c15a7e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c15a730a0>]}
[0m18:12:59.461504 [debug] [MainThread]: Flushing usage events
[0m18:13:06.852580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25446c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb252d566a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb252d564c0>]}


============================== 18:13:06.856596 | 52ce76f7-7b60-4ddf-8250-ad6ef64c6c2d ==============================
[0m18:13:06.856596 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:13:06.857588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:13:07.185981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52ce76f7-7b60-4ddf-8250-ad6ef64c6c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24e673d30>]}
[0m18:13:07.208963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52ce76f7-7b60-4ddf-8250-ad6ef64c6c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24e6479d0>]}
[0m18:13:07.225717 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m18:13:07.251886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:13:07.252303 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:13:07.261015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52ce76f7-7b60-4ddf-8250-ad6ef64c6c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24d4a2400>]}
[0m18:13:07.269087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52ce76f7-7b60-4ddf-8250-ad6ef64c6c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24d509130>]}
[0m18:13:07.269666 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:13:07.270230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52ce76f7-7b60-4ddf-8250-ad6ef64c6c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24d509400>]}
[0m18:13:07.271664 [info ] [MainThread]: 
[0m18:13:07.272550 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:13:07.274057 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m18:13:07.295557 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m18:13:07.296361 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m18:13:07.296848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:08.040940 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m18:13:08.043834 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m18:13:08.150772 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m18:13:08.162505 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m18:13:08.163346 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m18:13:08.163913 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:13:08.471286 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m18:13:08.473687 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m18:13:08.593179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52ce76f7-7b60-4ddf-8250-ad6ef64c6c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24d5092b0>]}
[0m18:13:08.594606 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:08.595519 [info ] [MainThread]: 
[0m18:13:08.601015 [debug] [Thread-1  ]: Began running node model.customer.dim_customers
[0m18:13:08.601722 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.dim_customers ........................... [RUN]
[0m18:13:08.602661 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.dim_customers)
[0m18:13:08.603286 [debug] [Thread-1  ]: Began compiling node model.customer.dim_customers
[0m18:13:08.607862 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.dim_customers"
[0m18:13:08.608801 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (compile): 18:13:08.603719 => 18:13:08.608450
[0m18:13:08.609317 [debug] [Thread-1  ]: Began executing node model.customer.dim_customers
[0m18:13:08.654108 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.dim_customers"
[0m18:13:08.656032 [debug] [Thread-1  ]: Using snowflake connection "model.customer.dim_customers"
[0m18:13:08.656619 [debug] [Thread-1  ]: On model.customer.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.dim_customers"} */
create or replace transient table learn_dbt.learn_dbt.dim_customers
         as
        (with customers as (
    select * from learn_dbt.learn_dbt.stg_customers
),

orders as (
    select * from learn_dbt.learn_dbt.fact_orders
),
customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
        );
[0m18:13:08.657151 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:13:11.113448 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:13:11.146459 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (execute): 18:13:08.609661 => 18:13:11.146136
[0m18:13:11.147118 [debug] [Thread-1  ]: On model.customer.dim_customers: Close
[0m18:13:11.251830 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52ce76f7-7b60-4ddf-8250-ad6ef64c6c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24c74bc40>]}
[0m18:13:11.253191 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.dim_customers ...................... [[32mSUCCESS 1[0m in 2.65s]
[0m18:13:11.254292 [debug] [Thread-1  ]: Finished running node model.customer.dim_customers
[0m18:13:11.256786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:11.257384 [debug] [MainThread]: Connection 'model.customer.dim_customers' was properly closed.
[0m18:13:11.257913 [info ] [MainThread]: 
[0m18:13:11.258599 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m18:13:11.259713 [debug] [MainThread]: Command end result
[0m18:13:11.269386 [info ] [MainThread]: 
[0m18:13:11.269988 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:11.270505 [info ] [MainThread]: 
[0m18:13:11.271349 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:13:11.272436 [debug] [MainThread]: Command `dbt run` succeeded at 18:13:11.272250 after 4.45 seconds
[0m18:13:11.273067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb25446c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24e6479d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb24d487b20>]}
[0m18:13:11.273605 [debug] [MainThread]: Flushing usage events
[0m18:39:55.457906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92bc100430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ba9dcdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ba9e93d0>]}


============================== 18:39:55.461775 | 4246af81-fb12-4633-848f-a43e4dceae75 ==============================
[0m18:39:55.461775 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:39:55.462547 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': 'profiles.yml', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:39:55.466440 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m18:39:55.467356 [debug] [MainThread]: Command `dbt run` failed at 18:39:55.467183 after 0.02 seconds
[0m18:39:55.467888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92bc100430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ba9e9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92ba9846a0>]}
[0m18:39:55.468514 [debug] [MainThread]: Flushing usage events
[0m18:40:53.164190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c310d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c19eb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c19eb1f0>]}


============================== 18:40:53.168248 | a8c3f10b-6f23-4055-b835-c24350d43bc9 ==============================
[0m18:40:53.168248 [info ] [MainThread]: Running with dbt=1.5.1
[0m18:40:53.169084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:40:53.169692 [warn ] [MainThread]: [OpenCommand]: Unable to parse dict {'open_cmd': 'xdg-open', 'profiles_dir': PosixPath('/home/satyam/airflow/dags/dbt')}
[0m18:40:53.170229 [info ] [MainThread]: To view your profiles.yml file, run:

 
[0m18:40:53.171054 [debug] [MainThread]: Command `dbt debug` succeeded at 18:40:53.170888 after 0.03 seconds
[0m18:40:53.171724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c310d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c19eb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c19eb040>]}
[0m18:40:53.172259 [debug] [MainThread]: Flushing usage events
[0m08:44:31.013505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe145a075b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe14432e0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe14432e220>]}


============================== 08:44:31.026615 | 726371ee-52bf-41f2-8d14-81ea9f017844 ==============================
[0m08:44:31.026615 [info ] [MainThread]: Running with dbt=1.5.1
[0m08:44:31.027566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt/', 'version_check': 'True', 'debug': 'False', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:44:31.028182 [info ] [MainThread]: dbt version: 1.5.1
[0m08:44:31.028715 [info ] [MainThread]: python version: 3.8.10
[0m08:44:31.029222 [info ] [MainThread]: python path: /usr/bin/python3
[0m08:44:31.029744 [info ] [MainThread]: os info: Linux-5.15.0-1039-azure-x86_64-with-glibc2.29
[0m08:44:31.030236 [info ] [MainThread]: Using profiles.yml file at dags/dbt/profiles.yml
[0m08:44:31.030731 [info ] [MainThread]: Using dbt_project.yml file at dags/dbt/dbt_project.yml
[0m08:44:31.031247 [info ] [MainThread]: Configuration:
[0m08:44:31.354039 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:44:31.391271 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:44:31.392088 [info ] [MainThread]: Required dependencies:
[0m08:44:31.392718 [debug] [MainThread]: Executing "git --help"
[0m08:44:31.399187 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:44:31.400318 [debug] [MainThread]: STDERR: "b''"
[0m08:44:31.400898 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:44:31.401474 [info ] [MainThread]: Connection:
[0m08:44:31.402089 [info ] [MainThread]:   account: emuqifz-vy24542
[0m08:44:31.402757 [info ] [MainThread]:   user: satyamkumar
[0m08:44:31.403305 [info ] [MainThread]:   database: learn_dbt
[0m08:44:31.403862 [info ] [MainThread]:   schema: learn_dbt
[0m08:44:31.404381 [info ] [MainThread]:   warehouse: learn_dbt_dw
[0m08:44:31.404920 [info ] [MainThread]:   role: accountadmin
[0m08:44:31.405459 [info ] [MainThread]:   client_session_keep_alive: False
[0m08:44:31.406001 [info ] [MainThread]:   query_tag: None
[0m08:44:31.407207 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m08:44:31.408593 [debug] [MainThread]: Using snowflake connection "debug"
[0m08:44:31.409029 [debug] [MainThread]: On debug: select 1 as id
[0m08:44:31.409498 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:44:32.243097 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m08:44:32.245469 [debug] [MainThread]: On debug: Close
[0m08:44:32.348765 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:44:32.349655 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:44:32.350814 [debug] [MainThread]: Command `dbt debug` succeeded at 08:44:32.350573 after 1.36 seconds
[0m08:44:32.351452 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:44:32.352001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe145a075b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13ebf82e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13ebf8880>]}
[0m08:44:32.352984 [debug] [MainThread]: Flushing usage events
[0m08:50:30.128853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde31d8d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde306aa610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde306aa130>]}


============================== 08:50:30.133063 | 626c574f-89da-46de-b7ed-63742b5b1e3c ==============================
[0m08:50:30.133063 [info ] [MainThread]: Running with dbt=1.5.1
[0m08:50:30.133783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dbt/', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m08:50:30.473885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '626c574f-89da-46de-b7ed-63742b5b1e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2bf9dd30>]}
[0m08:50:30.497276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '626c574f-89da-46de-b7ed-63742b5b1e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2bf7b9d0>]}
[0m08:50:30.521130 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m08:50:30.626327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:50:30.626928 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:50:30.637082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '626c574f-89da-46de-b7ed-63742b5b1e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2ade2400>]}
[0m08:50:30.646716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '626c574f-89da-46de-b7ed-63742b5b1e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2be75130>]}
[0m08:50:30.648220 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m08:50:30.648810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '626c574f-89da-46de-b7ed-63742b5b1e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2be75220>]}
[0m08:50:30.650836 [info ] [MainThread]: 
[0m08:50:30.652009 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:50:30.654234 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m08:50:30.675227 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m08:50:30.676125 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m08:50:30.676673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:31.581858 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m08:50:31.585572 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m08:50:31.689852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m08:50:31.701323 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m08:50:31.701998 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m08:50:31.702434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:50:32.182382 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m08:50:32.186875 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m08:50:32.296160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '626c574f-89da-46de-b7ed-63742b5b1e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2be75340>]}
[0m08:50:32.297516 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:50:32.298171 [info ] [MainThread]: 
[0m08:50:32.308806 [debug] [Thread-1  ]: Began running node model.customer.stg_customers
[0m08:50:32.309699 [info ] [Thread-1  ]: 1 of 5 START sql view model learn_dbt.stg_customers ............................ [RUN]
[0m08:50:32.310840 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_customers)
[0m08:50:32.311401 [debug] [Thread-1  ]: Began compiling node model.customer.stg_customers
[0m08:50:32.314721 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_customers"
[0m08:50:32.316190 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (compile): 08:50:32.311813 => 08:50:32.315825
[0m08:50:32.316948 [debug] [Thread-1  ]: Began executing node model.customer.stg_customers
[0m08:50:32.363737 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_customers"
[0m08:50:32.365624 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_customers"
[0m08:50:32.366157 [debug] [Thread-1  ]: On model.customer.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_customers"} */
create or replace   view learn_dbt.learn_dbt.stg_customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from learn_dbt.jaffle_shop.customers

)

select * from customers
  );
[0m08:50:32.366936 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:50:32.797361 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m08:50:32.830874 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (execute): 08:50:32.317349 => 08:50:32.830532
[0m08:50:32.831940 [debug] [Thread-1  ]: On model.customer.stg_customers: Close
[0m08:50:32.933129 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '626c574f-89da-46de-b7ed-63742b5b1e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde28883850>]}
[0m08:50:32.934444 [info ] [Thread-1  ]: 1 of 5 OK created sql view model learn_dbt.stg_customers ....................... [[32mSUCCESS 1[0m in 0.62s]
[0m08:50:32.935917 [debug] [Thread-1  ]: Finished running node model.customer.stg_customers
[0m08:50:32.936593 [debug] [Thread-1  ]: Began running node model.customer.stg_orders
[0m08:50:32.937488 [info ] [Thread-1  ]: 2 of 5 START sql view model learn_dbt.stg_orders ............................... [RUN]
[0m08:50:32.938537 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.customer.stg_customers, now model.customer.stg_orders)
[0m08:50:32.939097 [debug] [Thread-1  ]: Began compiling node model.customer.stg_orders
[0m08:50:32.943590 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_orders"
[0m08:50:32.944826 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (compile): 08:50:32.939457 => 08:50:32.944440
[0m08:50:32.945439 [debug] [Thread-1  ]: Began executing node model.customer.stg_orders
[0m08:50:32.949928 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_orders"
[0m08:50:32.951085 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_orders"
[0m08:50:32.951724 [debug] [Thread-1  ]: On model.customer.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_orders"} */
create or replace   view learn_dbt.learn_dbt.stg_orders
  
   as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from learn_dbt.jaffle_shop.orders

)

select * from orders
  );
[0m08:50:32.952328 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:50:33.380018 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m08:50:33.384691 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (execute): 08:50:32.945809 => 08:50:33.384373
[0m08:50:33.385242 [debug] [Thread-1  ]: On model.customer.stg_orders: Close
[0m08:50:33.488086 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '626c574f-89da-46de-b7ed-63742b5b1e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2883bcd0>]}
[0m08:50:33.489179 [info ] [Thread-1  ]: 2 of 5 OK created sql view model learn_dbt.stg_orders .......................... [[32mSUCCESS 1[0m in 0.55s]
[0m08:50:33.490585 [debug] [Thread-1  ]: Finished running node model.customer.stg_orders
[0m08:50:33.491236 [debug] [Thread-1  ]: Began running node model.customer.stg_payments
[0m08:50:33.491909 [info ] [Thread-1  ]: 3 of 5 START sql view model learn_dbt.stg_payments ............................. [RUN]
[0m08:50:33.493149 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.customer.stg_orders, now model.customer.stg_payments)
[0m08:50:33.493716 [debug] [Thread-1  ]: Began compiling node model.customer.stg_payments
[0m08:50:33.496612 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_payments"
[0m08:50:33.497705 [debug] [Thread-1  ]: Timing info for model.customer.stg_payments (compile): 08:50:33.494082 => 08:50:33.497376
[0m08:50:33.498275 [debug] [Thread-1  ]: Began executing node model.customer.stg_payments
[0m08:50:33.502509 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_payments"
[0m08:50:33.503892 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_payments"
[0m08:50:33.504412 [debug] [Thread-1  ]: On model.customer.stg_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_payments"} */
create or replace   view learn_dbt.learn_dbt.stg_payments
  
   as (
    with payment as 
(
    select 
        id as customer_id ,
        orderid as order_id,
        paymentmethod,
        status,
        amount ,
        created
        from learn_dbt.stripe.payment
)
select * from payment
  );
[0m08:50:33.504917 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:50:33.932326 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m08:50:33.937230 [debug] [Thread-1  ]: Timing info for model.customer.stg_payments (execute): 08:50:33.498611 => 08:50:33.936896
[0m08:50:33.937830 [debug] [Thread-1  ]: On model.customer.stg_payments: Close
[0m08:50:34.047398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '626c574f-89da-46de-b7ed-63742b5b1e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2a1843a0>]}
[0m08:50:34.048680 [info ] [Thread-1  ]: 3 of 5 OK created sql view model learn_dbt.stg_payments ........................ [[32mSUCCESS 1[0m in 0.55s]
[0m08:50:34.050453 [debug] [Thread-1  ]: Finished running node model.customer.stg_payments
[0m08:50:34.052488 [debug] [Thread-1  ]: Began running node model.customer.fact_orders
[0m08:50:34.053137 [info ] [Thread-1  ]: 4 of 5 START sql table model learn_dbt.fact_orders ............................. [RUN]
[0m08:50:34.054519 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.customer.stg_payments, now model.customer.fact_orders)
[0m08:50:34.055304 [debug] [Thread-1  ]: Began compiling node model.customer.fact_orders
[0m08:50:34.060172 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.fact_orders"
[0m08:50:34.061192 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (compile): 08:50:34.055699 => 08:50:34.060838
[0m08:50:34.061772 [debug] [Thread-1  ]: Began executing node model.customer.fact_orders
[0m08:50:34.094525 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.fact_orders"
[0m08:50:34.096700 [debug] [Thread-1  ]: Using snowflake connection "model.customer.fact_orders"
[0m08:50:34.097243 [debug] [Thread-1  ]: On model.customer.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.fact_orders"} */
create or replace transient table learn_dbt.learn_dbt.fact_orders
         as
        (with orders as  (
    select * from learn_dbt.learn_dbt.stg_orders
),

payments as (
    select * from learn_dbt.learn_dbt.stg_payments
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
        );
[0m08:50:34.097762 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:50:35.703499 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m08:50:35.708036 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (execute): 08:50:34.062116 => 08:50:35.707632
[0m08:50:35.708584 [debug] [Thread-1  ]: On model.customer.fact_orders: Close
[0m08:50:35.813147 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '626c574f-89da-46de-b7ed-63742b5b1e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2a184400>]}
[0m08:50:35.814265 [info ] [Thread-1  ]: 4 of 5 OK created sql table model learn_dbt.fact_orders ........................ [[32mSUCCESS 1[0m in 1.76s]
[0m08:50:35.815255 [debug] [Thread-1  ]: Finished running node model.customer.fact_orders
[0m08:50:35.817339 [debug] [Thread-1  ]: Began running node model.customer.dim_customers
[0m08:50:35.818055 [info ] [Thread-1  ]: 5 of 5 START sql table model learn_dbt.dim_customers ........................... [RUN]
[0m08:50:35.819140 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.customer.fact_orders, now model.customer.dim_customers)
[0m08:50:35.819714 [debug] [Thread-1  ]: Began compiling node model.customer.dim_customers
[0m08:50:35.825138 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.dim_customers"
[0m08:50:35.826276 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (compile): 08:50:35.820106 => 08:50:35.825944
[0m08:50:35.826785 [debug] [Thread-1  ]: Began executing node model.customer.dim_customers
[0m08:50:35.832858 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.dim_customers"
[0m08:50:35.834940 [debug] [Thread-1  ]: Using snowflake connection "model.customer.dim_customers"
[0m08:50:35.835605 [debug] [Thread-1  ]: On model.customer.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.dim_customers"} */
create or replace transient table learn_dbt.learn_dbt.dim_customers
         as
        (with customers as (
    select * from learn_dbt.learn_dbt.stg_customers
),

orders as (
    select * from learn_dbt.learn_dbt.fact_orders
),
customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
        );
[0m08:50:35.836161 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:50:37.432638 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m08:50:37.437046 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (execute): 08:50:35.827122 => 08:50:37.436664
[0m08:50:37.437840 [debug] [Thread-1  ]: On model.customer.dim_customers: Close
[0m08:50:37.540046 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '626c574f-89da-46de-b7ed-63742b5b1e3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde287e0460>]}
[0m08:50:37.541625 [info ] [Thread-1  ]: 5 of 5 OK created sql table model learn_dbt.dim_customers ...................... [[32mSUCCESS 1[0m in 1.72s]
[0m08:50:37.542678 [debug] [Thread-1  ]: Finished running node model.customer.dim_customers
[0m08:50:37.545396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:50:37.545879 [debug] [MainThread]: Connection 'model.customer.dim_customers' was properly closed.
[0m08:50:37.546425 [info ] [MainThread]: 
[0m08:50:37.547058 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 6.89 seconds (6.89s).
[0m08:50:37.549155 [debug] [MainThread]: Command end result
[0m08:50:37.558331 [info ] [MainThread]: 
[0m08:50:37.559012 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:50:37.559615 [info ] [MainThread]: 
[0m08:50:37.560342 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m08:50:37.561827 [debug] [MainThread]: Command `dbt run` succeeded at 08:50:37.561394 after 7.46 seconds
[0m08:50:37.562417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde31d8d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2bf7b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde2be75370>]}
[0m08:50:37.562951 [debug] [MainThread]: Flushing usage events
[0m11:09:59.752488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f373e9ba520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f373d27c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f373d27c130>]}


============================== 11:09:59.756560 | e0721170-1167-4269-a537-563e419a348a ==============================
[0m11:09:59.756560 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:09:59.757419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:10:00.868030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0721170-1167-4269-a537-563e419a348a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3738b9ad60>]}
[0m11:10:00.890885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0721170-1167-4269-a537-563e419a348a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3738b9a1c0>]}
[0m11:10:00.908348 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:10:00.986718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:10:00.987555 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:10:00.997915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0721170-1167-4269-a537-563e419a348a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37379e1430>]}
[0m11:10:01.007964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0721170-1167-4269-a537-563e419a348a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3738a6b160>]}
[0m11:10:01.008694 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:10:01.010016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0721170-1167-4269-a537-563e419a348a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37379c6b50>]}
[0m11:10:01.011803 [info ] [MainThread]: 
[0m11:10:01.013412 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:10:01.014942 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:10:01.035365 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:10:01.036089 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:10:01.036524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:02.319574 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:10:02.322449 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:10:02.433092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:10:02.445936 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:10:02.446608 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:10:02.447384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:02.801319 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:10:02.803837 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:10:02.912891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0721170-1167-4269-a537-563e419a348a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3738b4a160>]}
[0m11:10:02.914169 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:10:02.914770 [info ] [MainThread]: 
[0m11:10:02.923501 [debug] [Thread-1  ]: Began running node model.customer.stg_orders
[0m11:10:02.924217 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_orders ............................... [RUN]
[0m11:10:02.925136 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_orders)
[0m11:10:02.925646 [debug] [Thread-1  ]: Began compiling node model.customer.stg_orders
[0m11:10:02.928153 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_orders"
[0m11:10:02.929028 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (compile): 11:10:02.926010 => 11:10:02.928681
[0m11:10:02.929935 [debug] [Thread-1  ]: Began executing node model.customer.stg_orders
[0m11:10:02.981987 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_orders"
[0m11:10:02.983362 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_orders"
[0m11:10:02.983971 [debug] [Thread-1  ]: On model.customer.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_orders"} */
create or replace   view learn_dbt.learn_dbt.stg_orders
  
   as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from learn_dbt.jaffle_shop.orders

)

select * from orders
  );
[0m11:10:02.984535 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:10:03.388773 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:10:03.434960 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (execute): 11:10:02.930313 => 11:10:03.434609
[0m11:10:03.435582 [debug] [Thread-1  ]: On model.customer.stg_orders: Close
[0m11:10:03.538901 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0721170-1167-4269-a537-563e419a348a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37379b1c70>]}
[0m11:10:03.539935 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_orders .......................... [[32mSUCCESS 1[0m in 0.61s]
[0m11:10:03.540946 [debug] [Thread-1  ]: Finished running node model.customer.stg_orders
[0m11:10:03.543131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:03.543623 [debug] [MainThread]: Connection 'model.customer.stg_orders' was properly closed.
[0m11:10:03.544061 [info ] [MainThread]: 
[0m11:10:03.544618 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.53 seconds (2.53s).
[0m11:10:03.545810 [debug] [MainThread]: Command end result
[0m11:10:03.553828 [info ] [MainThread]: 
[0m11:10:03.554421 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:03.554908 [info ] [MainThread]: 
[0m11:10:03.555426 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:10:03.556628 [debug] [MainThread]: Command `dbt run` succeeded at 11:10:03.556428 after 3.83 seconds
[0m11:10:03.557209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f373e9ba520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3738b9a1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3738b960a0>]}
[0m11:10:03.557677 [debug] [MainThread]: Flushing usage events
[0m11:10:10.839522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa443f005b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4427c2760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4427c20a0>]}


============================== 11:10:10.842843 | 08c2fa83-96c3-49b0-85ac-6a76beee9bc8 ==============================
[0m11:10:10.842843 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:10:10.843591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:10:11.158453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08c2fa83-96c3-49b0-85ac-6a76beee9bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43e0e1d60>]}
[0m11:10:11.183132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08c2fa83-96c3-49b0-85ac-6a76beee9bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43e0b6eb0>]}
[0m11:10:11.201660 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:10:11.229478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:10:11.229995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:10:11.240961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08c2fa83-96c3-49b0-85ac-6a76beee9bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43cf1f4c0>]}
[0m11:10:11.249574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08c2fa83-96c3-49b0-85ac-6a76beee9bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43cf9d2b0>]}
[0m11:10:11.250145 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:10:11.250667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08c2fa83-96c3-49b0-85ac-6a76beee9bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43cf9d430>]}
[0m11:10:11.251424 [warn ] [MainThread]: The selection criterion 'stg_payment' does not match any nodes
[0m11:10:11.252603 [info ] [MainThread]: 
[0m11:10:11.253282 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:10:11.254334 [debug] [MainThread]: Command end result
[0m11:10:11.261225 [debug] [MainThread]: Command `dbt run` succeeded at 11:10:11.261039 after 0.44 seconds
[0m11:10:11.261785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa443f005b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43e0b6eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa43cf9d490>]}
[0m11:10:11.262262 [debug] [MainThread]: Flushing usage events
[0m11:10:18.172683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5cdb28430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5cc4115e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5cc411130>]}


============================== 11:10:18.176547 | 02808019-2dcd-427a-b847-b752713cf5bf ==============================
[0m11:10:18.176547 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:10:18.177321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:10:18.506743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02808019-2dcd-427a-b847-b752713cf5bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c7d2dc70>]}
[0m11:10:18.528526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02808019-2dcd-427a-b847-b752713cf5bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c7d1df40>]}
[0m11:10:18.548640 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:10:18.586137 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:10:18.586653 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:10:18.595391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02808019-2dcd-427a-b847-b752713cf5bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c6b61340>]}
[0m11:10:18.604353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02808019-2dcd-427a-b847-b752713cf5bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c6bca070>]}
[0m11:10:18.605011 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:10:18.606038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02808019-2dcd-427a-b847-b752713cf5bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c6b47f70>]}
[0m11:10:18.607498 [info ] [MainThread]: 
[0m11:10:18.608660 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:10:18.609920 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:10:18.628877 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:10:18.629351 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:10:18.629827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:19.517231 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:10:19.520458 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:10:19.615267 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:10:19.625281 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:10:19.625874 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:10:19.626279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:20.090100 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:10:20.092464 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:10:20.200429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02808019-2dcd-427a-b847-b752713cf5bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c6bca070>]}
[0m11:10:20.201766 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:10:20.202398 [info ] [MainThread]: 
[0m11:10:20.207889 [debug] [Thread-1  ]: Began running node model.customer.stg_customers
[0m11:10:20.208611 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_customers ............................ [RUN]
[0m11:10:20.209685 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_customers)
[0m11:10:20.210407 [debug] [Thread-1  ]: Began compiling node model.customer.stg_customers
[0m11:10:20.213257 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_customers"
[0m11:10:20.214232 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (compile): 11:10:20.210895 => 11:10:20.213869
[0m11:10:20.214768 [debug] [Thread-1  ]: Began executing node model.customer.stg_customers
[0m11:10:20.254449 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_customers"
[0m11:10:20.255761 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_customers"
[0m11:10:20.256472 [debug] [Thread-1  ]: On model.customer.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_customers"} */
create or replace   view learn_dbt.learn_dbt.stg_customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from learn_dbt.jaffle_shop.customers

)

select * from customers
  );
[0m11:10:20.257052 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:10:20.668595 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:10:20.698805 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (execute): 11:10:20.215103 => 11:10:20.698457
[0m11:10:20.699328 [debug] [Thread-1  ]: On model.customer.stg_customers: Close
[0m11:10:20.818649 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02808019-2dcd-427a-b847-b752713cf5bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c460a8b0>]}
[0m11:10:20.819806 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_customers ....................... [[32mSUCCESS 1[0m in 0.61s]
[0m11:10:20.825861 [debug] [Thread-1  ]: Finished running node model.customer.stg_customers
[0m11:10:20.827859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:20.828257 [debug] [MainThread]: Connection 'model.customer.stg_customers' was properly closed.
[0m11:10:20.828734 [info ] [MainThread]: 
[0m11:10:20.830193 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m11:10:20.831875 [debug] [MainThread]: Command end result
[0m11:10:20.847137 [info ] [MainThread]: 
[0m11:10:20.848503 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:20.849127 [info ] [MainThread]: 
[0m11:10:20.850313 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:10:20.851912 [debug] [MainThread]: Command `dbt run` succeeded at 11:10:20.851681 after 2.70 seconds
[0m11:10:20.852620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5cdb28430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c7d1df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c6bca280>]}
[0m11:10:20.853152 [debug] [MainThread]: Flushing usage events
[0m11:10:31.752397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f4da7f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f4c35c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f4c35c0a0>]}


============================== 11:10:31.755871 | da9ba1fb-f606-480b-b593-5c4870f3d442 ==============================
[0m11:10:31.755871 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:10:31.756605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:10:32.061890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da9ba1fb-f606-480b-b593-5c4870f3d442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f47c7ad60>]}
[0m11:10:32.084466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da9ba1fb-f606-480b-b593-5c4870f3d442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f47c55f70>]}
[0m11:10:32.101022 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:10:32.127761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:10:32.128185 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:10:32.136738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da9ba1fb-f606-480b-b593-5c4870f3d442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f46ae14c0>]}
[0m11:10:32.144604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da9ba1fb-f606-480b-b593-5c4870f3d442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f46b4f2b0>]}
[0m11:10:32.145252 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:10:32.145842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da9ba1fb-f606-480b-b593-5c4870f3d442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f46b4f430>]}
[0m11:10:32.147486 [info ] [MainThread]: 
[0m11:10:32.148395 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:10:32.149779 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:10:32.167456 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:10:32.167949 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:10:32.168412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:32.798482 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:10:32.802494 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:10:32.908771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:10:32.919687 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:10:32.920337 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:10:32.921073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:33.349465 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:10:33.351761 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:10:33.458213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da9ba1fb-f606-480b-b593-5c4870f3d442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f46b4f220>]}
[0m11:10:33.459386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:10:33.459935 [info ] [MainThread]: 
[0m11:10:33.464708 [debug] [Thread-1  ]: Began running node model.customer.fact_orders
[0m11:10:33.465550 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.fact_orders ............................. [RUN]
[0m11:10:33.466661 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.fact_orders)
[0m11:10:33.467247 [debug] [Thread-1  ]: Began compiling node model.customer.fact_orders
[0m11:10:33.472011 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.fact_orders"
[0m11:10:33.473039 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (compile): 11:10:33.467613 => 11:10:33.472701
[0m11:10:33.473600 [debug] [Thread-1  ]: Began executing node model.customer.fact_orders
[0m11:10:33.516066 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.fact_orders"
[0m11:10:33.517918 [debug] [Thread-1  ]: Using snowflake connection "model.customer.fact_orders"
[0m11:10:33.518420 [debug] [Thread-1  ]: On model.customer.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.fact_orders"} */
create or replace transient table learn_dbt.learn_dbt.fact_orders
         as
        (with orders as  (
    select * from learn_dbt.learn_dbt.stg_orders
),

payments as (
    select * from learn_dbt.learn_dbt.stg_payments
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
        );
[0m11:10:33.518909 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:10:35.260831 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:10:35.292960 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (execute): 11:10:33.473896 => 11:10:35.292507
[0m11:10:35.293673 [debug] [Thread-1  ]: On model.customer.fact_orders: Close
[0m11:10:35.398559 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da9ba1fb-f606-480b-b593-5c4870f3d442', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f45e5a9a0>]}
[0m11:10:35.399445 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.fact_orders ........................ [[32mSUCCESS 1[0m in 1.93s]
[0m11:10:35.400525 [debug] [Thread-1  ]: Finished running node model.customer.fact_orders
[0m11:10:35.402809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:35.405064 [debug] [MainThread]: Connection 'model.customer.fact_orders' was properly closed.
[0m11:10:35.405530 [info ] [MainThread]: 
[0m11:10:35.406255 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m11:10:35.407751 [debug] [MainThread]: Command end result
[0m11:10:35.416462 [info ] [MainThread]: 
[0m11:10:35.417298 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:35.417962 [info ] [MainThread]: 
[0m11:10:35.418508 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:10:35.419712 [debug] [MainThread]: Command `dbt run` succeeded at 11:10:35.419458 after 3.69 seconds
[0m11:10:35.420245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f4da7f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f47c55f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f46b4f490>]}
[0m11:10:35.420716 [debug] [MainThread]: Flushing usage events
[0m11:10:45.588519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc373aa9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37236b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37236b130>]}


============================== 11:10:45.592378 | 2441f8ba-e2bb-4078-a0f2-2cd0cf6e8a63 ==============================
[0m11:10:45.592378 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:10:45.593143 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:10:45.922793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2441f8ba-e2bb-4078-a0f2-2cd0cf6e8a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36dc89d30>]}
[0m11:10:45.946996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2441f8ba-e2bb-4078-a0f2-2cd0cf6e8a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36dc5e910>]}
[0m11:10:45.965959 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:10:45.993383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:10:45.994060 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:10:46.003126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2441f8ba-e2bb-4078-a0f2-2cd0cf6e8a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36cadf490>]}
[0m11:10:46.011281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2441f8ba-e2bb-4078-a0f2-2cd0cf6e8a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36cb49280>]}
[0m11:10:46.011914 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:10:46.012462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2441f8ba-e2bb-4078-a0f2-2cd0cf6e8a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36cb49400>]}
[0m11:10:46.014219 [info ] [MainThread]: 
[0m11:10:46.015331 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:10:46.016758 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:10:46.037075 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:10:46.037529 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:10:46.037919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:10:46.872207 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:10:46.875284 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:10:46.977919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:10:46.988671 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:10:46.989226 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:10:46.989793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:10:47.293040 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:10:47.295849 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:10:47.399593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2441f8ba-e2bb-4078-a0f2-2cd0cf6e8a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36dc3be50>]}
[0m11:10:47.401439 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:10:47.402718 [info ] [MainThread]: 
[0m11:10:47.409011 [debug] [Thread-1  ]: Began running node model.customer.stg_orders
[0m11:10:47.409963 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_orders ............................... [RUN]
[0m11:10:47.410985 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_orders)
[0m11:10:47.411668 [debug] [Thread-1  ]: Began compiling node model.customer.stg_orders
[0m11:10:47.415697 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_orders"
[0m11:10:47.417495 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (compile): 11:10:47.412886 => 11:10:47.417063
[0m11:10:47.418081 [debug] [Thread-1  ]: Began executing node model.customer.stg_orders
[0m11:10:47.463846 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_orders"
[0m11:10:47.465391 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_orders"
[0m11:10:47.465926 [debug] [Thread-1  ]: On model.customer.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_orders"} */
create or replace   view learn_dbt.learn_dbt.stg_orders
  
   as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from learn_dbt.jaffle_shop.orders

)

select * from orders
  );
[0m11:10:47.466480 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:10:47.851805 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:10:47.884583 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (execute): 11:10:47.418528 => 11:10:47.884279
[0m11:10:47.885175 [debug] [Thread-1  ]: On model.customer.stg_orders: Close
[0m11:10:47.990362 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2441f8ba-e2bb-4078-a0f2-2cd0cf6e8a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc366549910>]}
[0m11:10:47.991679 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_orders .......................... [[32mSUCCESS 1[0m in 0.58s]
[0m11:10:47.993032 [debug] [Thread-1  ]: Finished running node model.customer.stg_orders
[0m11:10:47.995850 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:10:47.996288 [debug] [MainThread]: Connection 'model.customer.stg_orders' was properly closed.
[0m11:10:47.996739 [info ] [MainThread]: 
[0m11:10:47.997369 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.98 seconds (1.98s).
[0m11:10:47.998363 [debug] [MainThread]: Command end result
[0m11:10:48.012766 [info ] [MainThread]: 
[0m11:10:48.013908 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:10:48.014749 [info ] [MainThread]: 
[0m11:10:48.016142 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:10:48.017588 [debug] [MainThread]: Command `dbt run` succeeded at 11:10:48.017392 after 2.45 seconds
[0m11:10:48.018417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc373aa9580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc367e51fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc36cac6c40>]}
[0m11:10:48.018951 [debug] [MainThread]: Flushing usage events
[0m11:10:55.136632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f439e98b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f439d269700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f439d269130>]}


============================== 11:10:55.140729 | 15360964-b9f9-48cf-bfc0-6ace82e3c4af ==============================
[0m11:10:55.140729 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:10:55.141949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:10:55.464592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15360964-b9f9-48cf-bfc0-6ace82e3c4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4398b88d00>]}
[0m11:10:55.486190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15360964-b9f9-48cf-bfc0-6ace82e3c4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4398b5aaf0>]}
[0m11:10:55.502126 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:10:55.529646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:10:55.530140 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:10:55.539276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15360964-b9f9-48cf-bfc0-6ace82e3c4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43979e1460>]}
[0m11:10:55.547516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15360964-b9f9-48cf-bfc0-6ace82e3c4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4398a58190>]}
[0m11:10:55.548069 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:10:55.548777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15360964-b9f9-48cf-bfc0-6ace82e3c4af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4398a58460>]}
[0m11:10:55.549627 [warn ] [MainThread]: The selection criterion 'stg_payment' does not match any nodes
[0m11:10:55.550735 [info ] [MainThread]: 
[0m11:10:55.551293 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:10:55.552017 [debug] [MainThread]: Command end result
[0m11:10:55.558584 [debug] [MainThread]: Command `dbt run` succeeded at 11:10:55.558421 after 0.44 seconds
[0m11:10:55.559184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f439e98b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4398b5aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4398a583d0>]}
[0m11:10:55.559711 [debug] [MainThread]: Flushing usage events
[0m11:11:02.834155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f119c09a5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f119a95c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f119a95c0a0>]}


============================== 11:11:02.837403 | 4b354104-737b-4981-aba3-1925abf388d3 ==============================
[0m11:11:02.837403 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:11:02.838556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:11:03.181755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b354104-737b-4981-aba3-1925abf388d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f119627bd60>]}
[0m11:11:03.204555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b354104-737b-4981-aba3-1925abf388d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11962526d0>]}
[0m11:11:03.222708 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:11:03.250374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:11:03.250862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:11:03.259568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b354104-737b-4981-aba3-1925abf388d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11950e14c0>]}
[0m11:11:03.268798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b354104-737b-4981-aba3-1925abf388d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f119515a2b0>]}
[0m11:11:03.269496 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:11:03.270129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b354104-737b-4981-aba3-1925abf388d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f119515a430>]}
[0m11:11:03.272001 [info ] [MainThread]: 
[0m11:11:03.273373 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:11:03.274819 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:11:03.295156 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:11:03.295864 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:11:03.296401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:03.983486 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:11:03.986607 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:11:04.098265 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt_learn_dbt'
[0m11:11:04.109552 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:11:04.110076 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:11:04.110700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:04.564803 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:11:04.567180 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:11:04.672745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b354104-737b-4981-aba3-1925abf388d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f119515a220>]}
[0m11:11:04.673907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:11:04.674656 [info ] [MainThread]: 
[0m11:11:04.679563 [debug] [Thread-1  ]: Began running node model.customer.stg_customers
[0m11:11:04.680438 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_customers ............................ [RUN]
[0m11:11:04.681373 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_customers)
[0m11:11:04.682048 [debug] [Thread-1  ]: Began compiling node model.customer.stg_customers
[0m11:11:04.684629 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_customers"
[0m11:11:04.685604 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (compile): 11:11:04.682390 => 11:11:04.685283
[0m11:11:04.686161 [debug] [Thread-1  ]: Began executing node model.customer.stg_customers
[0m11:11:04.727476 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_customers"
[0m11:11:04.728691 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_customers"
[0m11:11:04.729328 [debug] [Thread-1  ]: On model.customer.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_customers"} */
create or replace   view learn_dbt.learn_dbt.stg_customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from learn_dbt.jaffle_shop.customers

)

select * from customers
  );
[0m11:11:04.729836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:11:05.162107 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:11:05.197855 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (execute): 11:11:04.686548 => 11:11:05.197508
[0m11:11:05.198663 [debug] [Thread-1  ]: On model.customer.stg_customers: Close
[0m11:11:05.311917 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b354104-737b-4981-aba3-1925abf388d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1194353e80>]}
[0m11:11:05.312901 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_customers ....................... [[32mSUCCESS 1[0m in 0.63s]
[0m11:11:05.313904 [debug] [Thread-1  ]: Finished running node model.customer.stg_customers
[0m11:11:05.316156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:05.316605 [debug] [MainThread]: Connection 'list_learn_dbt' was properly closed.
[0m11:11:05.317022 [debug] [MainThread]: Connection 'model.customer.stg_customers' was properly closed.
[0m11:11:05.317464 [info ] [MainThread]: 
[0m11:11:05.318072 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.04 seconds (2.04s).
[0m11:11:05.319170 [debug] [MainThread]: Command end result
[0m11:11:05.329458 [info ] [MainThread]: 
[0m11:11:05.330135 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:11:05.330677 [info ] [MainThread]: 
[0m11:11:05.331202 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:11:05.332372 [debug] [MainThread]: Command `dbt run` succeeded at 11:11:05.332205 after 2.52 seconds
[0m11:11:05.332885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f119c09a5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11962526d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f119515a490>]}
[0m11:11:05.333427 [debug] [MainThread]: Flushing usage events
[0m11:11:12.511940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b3f25580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b2803730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b2803130>]}


============================== 11:11:12.515510 | 573197ad-f203-4be0-8a4e-5e01ff4aea6c ==============================
[0m11:11:12.515510 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:11:12.516223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:11:12.860969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '573197ad-f203-4be0-8a4e-5e01ff4aea6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08ae124d30>]}
[0m11:11:12.882210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '573197ad-f203-4be0-8a4e-5e01ff4aea6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08ae124040>]}
[0m11:11:12.898412 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:11:12.926486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:11:12.926960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:11:12.935500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '573197ad-f203-4be0-8a4e-5e01ff4aea6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08acf60490>]}
[0m11:11:12.943686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '573197ad-f203-4be0-8a4e-5e01ff4aea6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08acfc6280>]}
[0m11:11:12.944292 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:11:12.944888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '573197ad-f203-4be0-8a4e-5e01ff4aea6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08acfc6400>]}
[0m11:11:12.946434 [info ] [MainThread]: 
[0m11:11:12.947407 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:11:12.948851 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:11:12.970625 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:11:12.971162 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:11:12.971650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:13.471109 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:11:13.474016 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:11:13.593338 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:11:13.603563 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:11:13.604068 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:11:13.604528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:13.892641 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:11:13.895220 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:11:13.998954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '573197ad-f203-4be0-8a4e-5e01ff4aea6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08acfc6160>]}
[0m11:11:14.000140 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:11:14.000847 [info ] [MainThread]: 
[0m11:11:14.006187 [debug] [Thread-1  ]: Began running node model.customer.dim_customers
[0m11:11:14.006951 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.dim_customers ........................... [RUN]
[0m11:11:14.007990 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.dim_customers)
[0m11:11:14.008534 [debug] [Thread-1  ]: Began compiling node model.customer.dim_customers
[0m11:11:14.013324 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.dim_customers"
[0m11:11:14.014336 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (compile): 11:11:14.008984 => 11:11:14.014004
[0m11:11:14.015042 [debug] [Thread-1  ]: Began executing node model.customer.dim_customers
[0m11:11:14.057016 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.dim_customers"
[0m11:11:14.059278 [debug] [Thread-1  ]: Using snowflake connection "model.customer.dim_customers"
[0m11:11:14.059825 [debug] [Thread-1  ]: On model.customer.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.dim_customers"} */
create or replace transient table learn_dbt.learn_dbt.dim_customers
         as
        (with customers as (
    select * from learn_dbt.learn_dbt.stg_customers
),

orders as (
    select * from learn_dbt.learn_dbt.fact_orders
),
customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
        );
[0m11:11:14.060353 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:11:15.309777 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:11:15.339927 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (execute): 11:11:14.015416 => 11:11:15.339642
[0m11:11:15.340568 [debug] [Thread-1  ]: On model.customer.dim_customers: Close
[0m11:11:15.452968 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '573197ad-f203-4be0-8a4e-5e01ff4aea6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08ac20bca0>]}
[0m11:11:15.454019 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.dim_customers ...................... [[32mSUCCESS 1[0m in 1.45s]
[0m11:11:15.455198 [debug] [Thread-1  ]: Finished running node model.customer.dim_customers
[0m11:11:15.457991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:15.458412 [debug] [MainThread]: Connection 'model.customer.dim_customers' was properly closed.
[0m11:11:15.458879 [info ] [MainThread]: 
[0m11:11:15.459401 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.51 seconds (2.51s).
[0m11:11:15.460438 [debug] [MainThread]: Command end result
[0m11:11:15.469808 [info ] [MainThread]: 
[0m11:11:15.470610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:11:15.471164 [info ] [MainThread]: 
[0m11:11:15.471706 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:11:15.472731 [debug] [MainThread]: Command `dbt run` succeeded at 11:11:15.472500 after 2.98 seconds
[0m11:11:15.473317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b3f25580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08ae124040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08acf45c10>]}
[0m11:11:15.473860 [debug] [MainThread]: Flushing usage events
[0m11:11:22.758050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f956dbbf550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f956c4a9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f956c4a91c0>]}


============================== 11:11:22.761657 | 16661354-a1ea-4ddd-83dd-1c54fe86bfdf ==============================
[0m11:11:22.761657 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:11:22.762571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:11:23.076330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16661354-a1ea-4ddd-83dd-1c54fe86bfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9567dc7d00>]}
[0m11:11:23.098949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16661354-a1ea-4ddd-83dd-1c54fe86bfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9567d98df0>]}
[0m11:11:23.117367 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:11:23.146336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:11:23.147300 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:11:23.155914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16661354-a1ea-4ddd-83dd-1c54fe86bfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9567c30460>]}
[0m11:11:23.167492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16661354-a1ea-4ddd-83dd-1c54fe86bfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9567c99190>]}
[0m11:11:23.168179 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:11:23.168760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16661354-a1ea-4ddd-83dd-1c54fe86bfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9567c99460>]}
[0m11:11:23.170465 [info ] [MainThread]: 
[0m11:11:23.171434 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:11:23.172895 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:11:23.193852 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:11:23.194648 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:11:23.195276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:23.893746 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:11:23.897155 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:11:23.996122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:11:24.006744 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:11:24.007214 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:11:24.007657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:24.289976 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:11:24.292173 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:11:24.406075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16661354-a1ea-4ddd-83dd-1c54fe86bfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9567c99220>]}
[0m11:11:24.407628 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:11:24.408447 [info ] [MainThread]: 
[0m11:11:24.413483 [debug] [Thread-1  ]: Began running node model.customer.fact_orders
[0m11:11:24.414163 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.fact_orders ............................. [RUN]
[0m11:11:24.415097 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.fact_orders)
[0m11:11:24.415603 [debug] [Thread-1  ]: Began compiling node model.customer.fact_orders
[0m11:11:24.420633 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.fact_orders"
[0m11:11:24.422173 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (compile): 11:11:24.415937 => 11:11:24.421785
[0m11:11:24.422731 [debug] [Thread-1  ]: Began executing node model.customer.fact_orders
[0m11:11:24.464014 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.fact_orders"
[0m11:11:24.465884 [debug] [Thread-1  ]: Using snowflake connection "model.customer.fact_orders"
[0m11:11:24.466442 [debug] [Thread-1  ]: On model.customer.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.fact_orders"} */
create or replace transient table learn_dbt.learn_dbt.fact_orders
         as
        (with orders as  (
    select * from learn_dbt.learn_dbt.stg_orders
),

payments as (
    select * from learn_dbt.learn_dbt.stg_payments
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
        );
[0m11:11:24.466938 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:11:25.941540 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:11:25.981507 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (execute): 11:11:24.423220 => 11:11:25.981148
[0m11:11:25.982162 [debug] [Thread-1  ]: On model.customer.fact_orders: Close
[0m11:11:26.086654 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16661354-a1ea-4ddd-83dd-1c54fe86bfdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9565f9f970>]}
[0m11:11:26.087670 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.fact_orders ........................ [[32mSUCCESS 1[0m in 1.67s]
[0m11:11:26.088682 [debug] [Thread-1  ]: Finished running node model.customer.fact_orders
[0m11:11:26.091222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:26.091609 [debug] [MainThread]: Connection 'model.customer.fact_orders' was properly closed.
[0m11:11:26.092028 [info ] [MainThread]: 
[0m11:11:26.092795 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m11:11:26.094173 [debug] [MainThread]: Command end result
[0m11:11:26.103447 [info ] [MainThread]: 
[0m11:11:26.104043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:11:26.104840 [info ] [MainThread]: 
[0m11:11:26.105511 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:11:26.106933 [debug] [MainThread]: Command `dbt run` succeeded at 11:11:26.106733 after 3.37 seconds
[0m11:11:26.107451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f956dbbf550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9567d98df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9567c16be0>]}
[0m11:11:26.107947 [debug] [MainThread]: Flushing usage events
[0m11:11:33.608267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbadbc114c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbada4ef670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbada4ef130>]}


============================== 11:11:33.611753 | 810b0049-17d7-43ff-8f10-e28a4a4ab67d ==============================
[0m11:11:33.611753 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:11:33.612630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:11:33.943665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '810b0049-17d7-43ff-8f10-e28a4a4ab67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad4dfad00>]}
[0m11:11:33.966288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '810b0049-17d7-43ff-8f10-e28a4a4ab67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad4dcca90>]}
[0m11:11:33.983447 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:11:34.010984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:11:34.011462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:11:34.020361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '810b0049-17d7-43ff-8f10-e28a4a4ab67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad4c623d0>]}
[0m11:11:34.028385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '810b0049-17d7-43ff-8f10-e28a4a4ab67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad4cca100>]}
[0m11:11:34.029041 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:11:34.029639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '810b0049-17d7-43ff-8f10-e28a4a4ab67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad4cca3d0>]}
[0m11:11:34.031346 [info ] [MainThread]: 
[0m11:11:34.032420 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:11:34.034023 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:11:34.053840 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:11:34.054528 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:11:34.055077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:34.720638 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:11:34.723703 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:11:34.834010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:11:34.843675 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:11:34.844132 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:11:34.844570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:35.302737 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:11:35.305641 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:11:35.412518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '810b0049-17d7-43ff-8f10-e28a4a4ab67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad4c46fa0>]}
[0m11:11:35.414471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:11:35.415117 [info ] [MainThread]: 
[0m11:11:35.420025 [debug] [Thread-1  ]: Began running node model.customer.dim_customers
[0m11:11:35.420875 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.dim_customers ........................... [RUN]
[0m11:11:35.421896 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.dim_customers)
[0m11:11:35.422404 [debug] [Thread-1  ]: Began compiling node model.customer.dim_customers
[0m11:11:35.426978 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.dim_customers"
[0m11:11:35.427975 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (compile): 11:11:35.422763 => 11:11:35.427581
[0m11:11:35.428453 [debug] [Thread-1  ]: Began executing node model.customer.dim_customers
[0m11:11:35.468965 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.dim_customers"
[0m11:11:35.471021 [debug] [Thread-1  ]: Using snowflake connection "model.customer.dim_customers"
[0m11:11:35.471686 [debug] [Thread-1  ]: On model.customer.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.dim_customers"} */
create or replace transient table learn_dbt.learn_dbt.dim_customers
         as
        (with customers as (
    select * from learn_dbt.learn_dbt.stg_customers
),

orders as (
    select * from learn_dbt.learn_dbt.fact_orders
),
customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
        );
[0m11:11:35.472301 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:11:36.393155 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:11:36.427107 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (execute): 11:11:35.428771 => 11:11:36.426795
[0m11:11:36.427692 [debug] [Thread-1  ]: On model.customer.dim_customers: Close
[0m11:11:36.519966 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '810b0049-17d7-43ff-8f10-e28a4a4ab67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbace6dd070>]}
[0m11:11:36.521080 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.dim_customers ...................... [[32mSUCCESS 1[0m in 1.10s]
[0m11:11:36.522079 [debug] [Thread-1  ]: Finished running node model.customer.dim_customers
[0m11:11:36.524337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:36.524859 [debug] [MainThread]: Connection 'model.customer.dim_customers' was properly closed.
[0m11:11:36.525351 [info ] [MainThread]: 
[0m11:11:36.525911 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.49 seconds (2.49s).
[0m11:11:36.526950 [debug] [MainThread]: Command end result
[0m11:11:36.536588 [info ] [MainThread]: 
[0m11:11:36.537203 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:11:36.537721 [info ] [MainThread]: 
[0m11:11:36.538278 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:11:36.539270 [debug] [MainThread]: Command `dbt run` succeeded at 11:11:36.539111 after 2.95 seconds
[0m11:11:36.539865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbadbc114c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad4dcca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbad4c46fa0>]}
[0m11:11:36.540370 [debug] [MainThread]: Flushing usage events
[0m11:13:09.913814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5e51b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5ce056a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5ce050a0>]}


============================== 11:13:09.917481 | 39426d18-5ec0-41b3-a7f2-c447c9d26bc7 ==============================
[0m11:13:09.917481 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:13:09.919528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:13:10.231280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39426d18-5ec0-41b3-a7f2-c447c9d26bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5871fd30>]}
[0m11:13:10.252447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39426d18-5ec0-41b3-a7f2-c447c9d26bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5871f2e0>]}
[0m11:13:10.269106 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:13:10.298218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:13:10.298821 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:13:10.308930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39426d18-5ec0-41b3-a7f2-c447c9d26bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad57562400>]}
[0m11:13:10.317756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39426d18-5ec0-41b3-a7f2-c447c9d26bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad575ca1f0>]}
[0m11:13:10.318619 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:13:10.319215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39426d18-5ec0-41b3-a7f2-c447c9d26bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad575ca370>]}
[0m11:13:10.320862 [info ] [MainThread]: 
[0m11:13:10.321897 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:13:10.323292 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:13:10.344981 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:13:10.345921 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:13:10.346351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:11.034746 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:13:11.038529 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:13:11.156340 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt_learn_dbt'
[0m11:13:11.167561 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:13:11.168060 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:13:11.168491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:11.523553 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:13:11.526530 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:13:11.633031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39426d18-5ec0-41b3-a7f2-c447c9d26bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad575ca280>]}
[0m11:13:11.634282 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:13:11.634873 [info ] [MainThread]: 
[0m11:13:11.640045 [debug] [Thread-1  ]: Began running node model.customer.stg_orders
[0m11:13:11.640745 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_orders ............................... [RUN]
[0m11:13:11.641725 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_orders)
[0m11:13:11.642235 [debug] [Thread-1  ]: Began compiling node model.customer.stg_orders
[0m11:13:11.644774 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_orders"
[0m11:13:11.645846 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (compile): 11:13:11.642613 => 11:13:11.645365
[0m11:13:11.646356 [debug] [Thread-1  ]: Began executing node model.customer.stg_orders
[0m11:13:11.687408 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_orders"
[0m11:13:11.688758 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_orders"
[0m11:13:11.689355 [debug] [Thread-1  ]: On model.customer.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_orders"} */
create or replace   view learn_dbt.learn_dbt.stg_orders
  
   as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from learn_dbt.jaffle_shop.orders

)

select * from orders
  );
[0m11:13:11.689867 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:13:12.123088 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:13:12.156236 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (execute): 11:13:11.646692 => 11:13:12.155901
[0m11:13:12.156825 [debug] [Thread-1  ]: On model.customer.stg_orders: Close
[0m11:13:12.252134 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39426d18-5ec0-41b3-a7f2-c447c9d26bc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad54fe48b0>]}
[0m11:13:12.253260 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_orders .......................... [[32mSUCCESS 1[0m in 0.61s]
[0m11:13:12.254206 [debug] [Thread-1  ]: Finished running node model.customer.stg_orders
[0m11:13:12.256575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:12.257142 [debug] [MainThread]: Connection 'list_learn_dbt' was properly closed.
[0m11:13:12.257576 [debug] [MainThread]: Connection 'model.customer.stg_orders' was properly closed.
[0m11:13:12.258081 [info ] [MainThread]: 
[0m11:13:12.258792 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m11:13:12.259874 [debug] [MainThread]: Command end result
[0m11:13:12.269450 [info ] [MainThread]: 
[0m11:13:12.270032 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:13:12.270645 [info ] [MainThread]: 
[0m11:13:12.271403 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:13:12.272385 [debug] [MainThread]: Command `dbt run` succeeded at 11:13:12.272222 after 2.38 seconds
[0m11:13:12.273062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5e51b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad5871fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad57547b50>]}
[0m11:13:12.273572 [debug] [MainThread]: Flushing usage events
[0m11:13:19.510233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa820652550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81ef14730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81ef140a0>]}


============================== 11:13:19.514028 | c5bd98c4-7722-473c-9135-482e460e1984 ==============================
[0m11:13:19.514028 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:13:19.514859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:13:19.828482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5bd98c4-7722-473c-9135-482e460e1984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8197f8d30>]}
[0m11:13:19.852598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5bd98c4-7722-473c-9135-482e460e1984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8197f8280>]}
[0m11:13:19.870205 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:13:19.897463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:13:19.897895 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:13:19.906320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5bd98c4-7722-473c-9135-482e460e1984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa81965f490>]}
[0m11:13:19.914866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5bd98c4-7722-473c-9135-482e460e1984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8196c91c0>]}
[0m11:13:19.915433 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:13:19.916009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5bd98c4-7722-473c-9135-482e460e1984', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa819646c10>]}
[0m11:13:19.916806 [warn ] [MainThread]: The selection criterion 'stg_payment' does not match any nodes
[0m11:13:19.918003 [info ] [MainThread]: 
[0m11:13:19.918543 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:13:19.919327 [debug] [MainThread]: Command end result
[0m11:13:19.926017 [debug] [MainThread]: Command `dbt run` succeeded at 11:13:19.925835 after 0.44 seconds
[0m11:13:19.926522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa820652550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8197f8280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8197f0040>]}
[0m11:13:19.927008 [debug] [MainThread]: Flushing usage events
[0m11:13:27.230976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d602a5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5eb675e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5eb67310>]}


============================== 11:13:27.236457 | 268571c8-c306-4340-901a-2952b567606a ==============================
[0m11:13:27.236457 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:13:27.237956 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:13:27.589421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '268571c8-c306-4340-901a-2952b567606a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5a480d00>]}
[0m11:13:27.617022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '268571c8-c306-4340-901a-2952b567606a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5a45fb50>]}
[0m11:13:27.635353 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:13:27.671888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:13:27.672424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:13:27.680537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '268571c8-c306-4340-901a-2952b567606a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d592e0460>]}
[0m11:13:27.688787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '268571c8-c306-4340-901a-2952b567606a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5934a190>]}
[0m11:13:27.689405 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:13:27.690253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '268571c8-c306-4340-901a-2952b567606a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5934a460>]}
[0m11:13:27.691806 [info ] [MainThread]: 
[0m11:13:27.692792 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:13:27.694216 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:13:27.713667 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:13:27.714155 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:13:27.714547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:28.374706 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:13:28.378348 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:13:28.480731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:13:28.493503 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:13:28.493998 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:13:28.494451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:28.942198 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:13:28.944595 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:13:29.047082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '268571c8-c306-4340-901a-2952b567606a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5934a220>]}
[0m11:13:29.048420 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:13:29.049070 [info ] [MainThread]: 
[0m11:13:29.055005 [debug] [Thread-1  ]: Began running node model.customer.stg_customers
[0m11:13:29.055891 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_customers ............................ [RUN]
[0m11:13:29.057578 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_customers)
[0m11:13:29.058108 [debug] [Thread-1  ]: Began compiling node model.customer.stg_customers
[0m11:13:29.061189 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_customers"
[0m11:13:29.062204 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (compile): 11:13:29.058479 => 11:13:29.061851
[0m11:13:29.062753 [debug] [Thread-1  ]: Began executing node model.customer.stg_customers
[0m11:13:29.107159 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_customers"
[0m11:13:29.108618 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_customers"
[0m11:13:29.109230 [debug] [Thread-1  ]: On model.customer.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_customers"} */
create or replace   view learn_dbt.learn_dbt.stg_customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from learn_dbt.jaffle_shop.customers

)

select * from customers
  );
[0m11:13:29.109802 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:13:29.492683 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:13:29.529147 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (execute): 11:13:29.063118 => 11:13:29.528782
[0m11:13:29.529842 [debug] [Thread-1  ]: On model.customer.stg_customers: Close
[0m11:13:29.633977 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '268571c8-c306-4340-901a-2952b567606a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5854b910>]}
[0m11:13:29.635323 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_customers ....................... [[32mSUCCESS 1[0m in 0.58s]
[0m11:13:29.636707 [debug] [Thread-1  ]: Finished running node model.customer.stg_customers
[0m11:13:29.640163 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:29.640620 [debug] [MainThread]: Connection 'model.customer.stg_customers' was properly closed.
[0m11:13:29.641267 [info ] [MainThread]: 
[0m11:13:29.642185 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m11:13:29.644008 [debug] [MainThread]: Command end result
[0m11:13:29.653689 [info ] [MainThread]: 
[0m11:13:29.654358 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:13:29.654916 [info ] [MainThread]: 
[0m11:13:29.655522 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:13:29.656794 [debug] [MainThread]: Command `dbt run` succeeded at 11:13:29.656621 after 2.45 seconds
[0m11:13:29.657357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d602a5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5864ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d592c7be0>]}
[0m11:13:29.657978 [debug] [MainThread]: Flushing usage events
[0m11:13:47.777444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26879b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26705d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26705d0a0>]}


============================== 11:13:47.781438 | 8704c2d4-2d76-4eb8-9609-575991dd34d7 ==============================
[0m11:13:47.781438 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:13:47.782313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:13:48.113983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8704c2d4-2d76-4eb8-9609-575991dd34d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26297dd00>]}
[0m11:13:48.137272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8704c2d4-2d76-4eb8-9609-575991dd34d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26297d400>]}
[0m11:13:48.155046 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:13:48.187493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:13:48.188160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:13:48.197779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8704c2d4-2d76-4eb8-9609-575991dd34d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2617df460>]}
[0m11:13:48.206301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8704c2d4-2d76-4eb8-9609-575991dd34d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26284c250>]}
[0m11:13:48.206930 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:13:48.207479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8704c2d4-2d76-4eb8-9609-575991dd34d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26284c3d0>]}
[0m11:13:48.208890 [info ] [MainThread]: 
[0m11:13:48.209992 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:13:48.211613 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:13:48.233357 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:13:48.233958 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:13:48.234463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:48.942661 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:13:48.945992 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:13:49.066070 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:13:49.077062 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:13:49.077656 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:13:49.078066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:49.381974 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:13:49.384990 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:13:49.494247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8704c2d4-2d76-4eb8-9609-575991dd34d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26284c310>]}
[0m11:13:49.495630 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:13:49.496270 [info ] [MainThread]: 
[0m11:13:49.501890 [debug] [Thread-1  ]: Began running node model.customer.fact_orders
[0m11:13:49.502581 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.fact_orders ............................. [RUN]
[0m11:13:49.503567 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.fact_orders)
[0m11:13:49.504097 [debug] [Thread-1  ]: Began compiling node model.customer.fact_orders
[0m11:13:49.508693 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.fact_orders"
[0m11:13:49.509749 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (compile): 11:13:49.504440 => 11:13:49.509403
[0m11:13:49.510274 [debug] [Thread-1  ]: Began executing node model.customer.fact_orders
[0m11:13:49.553193 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.fact_orders"
[0m11:13:49.555208 [debug] [Thread-1  ]: Using snowflake connection "model.customer.fact_orders"
[0m11:13:49.555747 [debug] [Thread-1  ]: On model.customer.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.fact_orders"} */
create or replace transient table learn_dbt.learn_dbt.fact_orders
         as
        (with orders as  (
    select * from learn_dbt.learn_dbt.stg_orders
),

payments as (
    select * from learn_dbt.learn_dbt.stg_payments
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
        );
[0m11:13:49.556303 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:13:50.590265 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:13:50.626973 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (execute): 11:13:49.510623 => 11:13:50.626661
[0m11:13:50.627752 [debug] [Thread-1  ]: On model.customer.fact_orders: Close
[0m11:13:50.728240 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8704c2d4-2d76-4eb8-9609-575991dd34d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff260b57940>]}
[0m11:13:50.729339 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.fact_orders ........................ [[32mSUCCESS 1[0m in 1.22s]
[0m11:13:50.730485 [debug] [Thread-1  ]: Finished running node model.customer.fact_orders
[0m11:13:50.732895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:50.733397 [debug] [MainThread]: Connection 'model.customer.fact_orders' was properly closed.
[0m11:13:50.733881 [info ] [MainThread]: 
[0m11:13:50.737862 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m11:13:50.739202 [debug] [MainThread]: Command end result
[0m11:13:50.749431 [info ] [MainThread]: 
[0m11:13:50.750042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:13:50.750534 [info ] [MainThread]: 
[0m11:13:50.751172 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:13:50.752164 [debug] [MainThread]: Command `dbt run` succeeded at 11:13:50.752006 after 3.00 seconds
[0m11:13:50.752664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26879b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff26297dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2617c6c10>]}
[0m11:13:50.753368 [debug] [MainThread]: Flushing usage events
[0m11:13:58.352347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f02495b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74eeb0b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74eeb0b310>]}


============================== 11:13:58.356213 | 4b04d7cd-25de-43fe-b864-36c215ba5ecf ==============================
[0m11:13:58.356213 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:13:58.357357 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:13:58.686446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b04d7cd-25de-43fe-b864-36c215ba5ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e93f3e80>]}
[0m11:13:58.708055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b04d7cd-25de-43fe-b864-36c215ba5ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e93cceb0>]}
[0m11:13:58.725188 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:13:58.751011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:13:58.751405 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:13:58.759199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b04d7cd-25de-43fe-b864-36c215ba5ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e92614c0>]}
[0m11:13:58.767223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b04d7cd-25de-43fe-b864-36c215ba5ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e92ce2b0>]}
[0m11:13:58.767831 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:13:58.768478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b04d7cd-25de-43fe-b864-36c215ba5ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e92ce430>]}
[0m11:13:58.770080 [info ] [MainThread]: 
[0m11:13:58.771042 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:13:58.772257 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:13:58.791021 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:13:58.791503 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:13:58.791950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:59.400273 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:13:59.403926 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:13:59.506802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:13:59.517544 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:13:59.518035 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:13:59.518461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:13:59.821008 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:13:59.823468 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:13:59.936111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b04d7cd-25de-43fe-b864-36c215ba5ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e92ce220>]}
[0m11:13:59.937572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:13:59.938272 [info ] [MainThread]: 
[0m11:13:59.944267 [debug] [Thread-1  ]: Began running node model.customer.stg_orders
[0m11:13:59.945055 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_orders ............................... [RUN]
[0m11:13:59.946059 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_orders)
[0m11:13:59.946586 [debug] [Thread-1  ]: Began compiling node model.customer.stg_orders
[0m11:13:59.949370 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_orders"
[0m11:13:59.950573 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (compile): 11:13:59.946965 => 11:13:59.950224
[0m11:13:59.951100 [debug] [Thread-1  ]: Began executing node model.customer.stg_orders
[0m11:13:59.993784 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_orders"
[0m11:13:59.995282 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_orders"
[0m11:13:59.995815 [debug] [Thread-1  ]: On model.customer.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_orders"} */
create or replace   view learn_dbt.learn_dbt.stg_orders
  
   as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from learn_dbt.jaffle_shop.orders

)

select * from orders
  );
[0m11:13:59.996325 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:14:00.362743 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:14:00.394970 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (execute): 11:13:59.951633 => 11:14:00.394650
[0m11:14:00.395560 [debug] [Thread-1  ]: On model.customer.stg_orders: Close
[0m11:14:00.486559 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b04d7cd-25de-43fe-b864-36c215ba5ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e84f60d0>]}
[0m11:14:00.487795 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_orders .......................... [[32mSUCCESS 1[0m in 0.54s]
[0m11:14:00.488885 [debug] [Thread-1  ]: Finished running node model.customer.stg_orders
[0m11:14:00.491397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:00.491825 [debug] [MainThread]: Connection 'model.customer.stg_orders' was properly closed.
[0m11:14:00.492387 [info ] [MainThread]: 
[0m11:14:00.493006 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m11:14:00.494076 [debug] [MainThread]: Command end result
[0m11:14:00.504696 [info ] [MainThread]: 
[0m11:14:00.505745 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:14:00.506371 [info ] [MainThread]: 
[0m11:14:00.506972 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:14:00.508480 [debug] [MainThread]: Command `dbt run` succeeded at 11:14:00.508202 after 2.18 seconds
[0m11:14:00.509329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74f02495b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e85fa310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f74e9246c70>]}
[0m11:14:00.510003 [debug] [MainThread]: Flushing usage events
[0m11:14:07.372754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2882c3b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28814fd6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28814fd130>]}


============================== 11:14:07.376401 | e6d19836-9ea0-4d05-8024-960e3d7cc596 ==============================
[0m11:14:07.376401 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:14:07.377120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:14:07.696833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6d19836-9ea0-4d05-8024-960e3d7cc596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f287bdfad30>]}
[0m11:14:07.719485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6d19836-9ea0-4d05-8024-960e3d7cc596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f287bdfa3d0>]}
[0m11:14:07.735565 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:14:07.761244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:14:07.761707 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:14:07.770103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6d19836-9ea0-4d05-8024-960e3d7cc596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f287bc60490>]}
[0m11:14:07.781409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6d19836-9ea0-4d05-8024-960e3d7cc596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f287bcc61c0>]}
[0m11:14:07.782031 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:14:07.782582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6d19836-9ea0-4d05-8024-960e3d7cc596', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f287bc45c10>]}
[0m11:14:07.783334 [warn ] [MainThread]: The selection criterion 'stg_payment' does not match any nodes
[0m11:14:07.784489 [info ] [MainThread]: 
[0m11:14:07.785026 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:14:07.785810 [debug] [MainThread]: Command end result
[0m11:14:07.793001 [debug] [MainThread]: Command `dbt run` succeeded at 11:14:07.792699 after 0.44 seconds
[0m11:14:07.793560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2882c3b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f287bdfa3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f287bdf3040>]}
[0m11:14:07.794064 [debug] [MainThread]: Flushing usage events
[0m11:14:14.701577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0ac654c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0954f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0954f130>]}


============================== 11:14:14.705411 | 0091344c-c56b-42ec-b914-6137fa4ed68c ==============================
[0m11:14:14.705411 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:14:14.706196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:14:15.022056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0091344c-c56b-42ec-b914-6137fa4ed68c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b04e6fd00>]}
[0m11:14:15.045156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0091344c-c56b-42ec-b914-6137fa4ed68c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b04e43f10>]}
[0m11:14:15.062989 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:14:15.091040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:14:15.091705 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:14:15.100996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0091344c-c56b-42ec-b914-6137fa4ed68c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b03ca43d0>]}
[0m11:14:15.109148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0091344c-c56b-42ec-b914-6137fa4ed68c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b03d0b100>]}
[0m11:14:15.109776 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:14:15.110829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0091344c-c56b-42ec-b914-6137fa4ed68c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b03d0b3d0>]}
[0m11:14:15.112365 [info ] [MainThread]: 
[0m11:14:15.113610 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:14:15.115014 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:14:15.134684 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:14:15.135403 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:14:15.135955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:15.841079 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:14:15.844484 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:14:15.964243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:14:15.975396 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:14:15.975870 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:14:15.976289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:16.460359 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:14:16.462780 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:14:16.590063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0091344c-c56b-42ec-b914-6137fa4ed68c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b03c87fa0>]}
[0m11:14:16.591567 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:14:16.592613 [info ] [MainThread]: 
[0m11:14:16.599060 [debug] [Thread-1  ]: Began running node model.customer.stg_orders
[0m11:14:16.600191 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_orders ............................... [RUN]
[0m11:14:16.601937 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_orders)
[0m11:14:16.602570 [debug] [Thread-1  ]: Began compiling node model.customer.stg_orders
[0m11:14:16.605669 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_orders"
[0m11:14:16.606592 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (compile): 11:14:16.603005 => 11:14:16.606244
[0m11:14:16.607100 [debug] [Thread-1  ]: Began executing node model.customer.stg_orders
[0m11:14:16.656037 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_orders"
[0m11:14:16.658099 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_orders"
[0m11:14:16.658897 [debug] [Thread-1  ]: On model.customer.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_orders"} */
create or replace   view learn_dbt.learn_dbt.stg_orders
  
   as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from learn_dbt.jaffle_shop.orders

)

select * from orders
  );
[0m11:14:16.659520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:14:17.062719 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:14:17.098461 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (execute): 11:14:16.607646 => 11:14:17.098129
[0m11:14:17.099137 [debug] [Thread-1  ]: On model.customer.stg_orders: Close
[0m11:14:17.199179 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0091344c-c56b-42ec-b914-6137fa4ed68c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b016f8af0>]}
[0m11:14:17.200222 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_orders .......................... [[32mSUCCESS 1[0m in 0.60s]
[0m11:14:17.201869 [debug] [Thread-1  ]: Finished running node model.customer.stg_orders
[0m11:14:17.204402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:17.204875 [debug] [MainThread]: Connection 'model.customer.stg_orders' was properly closed.
[0m11:14:17.205346 [info ] [MainThread]: 
[0m11:14:17.205912 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m11:14:17.206922 [debug] [MainThread]: Command end result
[0m11:14:17.218175 [info ] [MainThread]: 
[0m11:14:17.219720 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:14:17.220313 [info ] [MainThread]: 
[0m11:14:17.220982 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:14:17.222100 [debug] [MainThread]: Command `dbt run` succeeded at 11:14:17.221915 after 2.54 seconds
[0m11:14:17.222769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0ac654c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b04e43f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b03d0b340>]}
[0m11:14:17.223345 [debug] [MainThread]: Flushing usage events
[0m11:14:24.435765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f664141d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f663fcdf610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f663fcdf3a0>]}


============================== 11:14:24.439664 | 356cd834-37ee-44dc-a343-56d6c67c68cd ==============================
[0m11:14:24.439664 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:14:24.440368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:14:24.799146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '356cd834-37ee-44dc-a343-56d6c67c68cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f663a5f6d30>]}
[0m11:14:24.821782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '356cd834-37ee-44dc-a343-56d6c67c68cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f663a5d36a0>]}
[0m11:14:24.838850 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:14:24.866830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:14:24.867356 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:14:24.876339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '356cd834-37ee-44dc-a343-56d6c67c68cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f663a461490>]}
[0m11:14:24.885288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '356cd834-37ee-44dc-a343-56d6c67c68cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f663a4c6280>]}
[0m11:14:24.885913 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:14:24.886659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '356cd834-37ee-44dc-a343-56d6c67c68cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f663a4c6400>]}
[0m11:14:24.887746 [warn ] [MainThread]: The selection criterion 'stg_payment' does not match any nodes
[0m11:14:24.889066 [info ] [MainThread]: 
[0m11:14:24.889598 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:14:24.890349 [debug] [MainThread]: Command end result
[0m11:14:24.897373 [debug] [MainThread]: Command `dbt run` succeeded at 11:14:24.897114 after 0.48 seconds
[0m11:14:24.897977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f664141d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f663a5d36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f663a4c6460>]}
[0m11:14:24.898629 [debug] [MainThread]: Flushing usage events
[0m11:14:32.046373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51786ed580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5176faf610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5176faf2e0>]}


============================== 11:14:32.050327 | e320e3f1-0d9c-4930-9a97-7bfb9f7f63b1 ==============================
[0m11:14:32.050327 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:14:32.051136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:14:32.371750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e320e3f1-0d9c-4930-9a97-7bfb9f7f63b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51728cbd30>]}
[0m11:14:32.394099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e320e3f1-0d9c-4930-9a97-7bfb9f7f63b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51728a9fd0>]}
[0m11:14:32.413132 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:14:32.452177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:14:32.452832 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:14:32.462302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e320e3f1-0d9c-4930-9a97-7bfb9f7f63b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5171720490>]}
[0m11:14:32.471811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e320e3f1-0d9c-4930-9a97-7bfb9f7f63b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f517178e280>]}
[0m11:14:32.472539 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:14:32.473143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e320e3f1-0d9c-4930-9a97-7bfb9f7f63b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f517178e400>]}
[0m11:14:32.474766 [info ] [MainThread]: 
[0m11:14:32.475997 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:14:32.479196 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:14:32.512994 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:14:32.514653 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:14:32.515213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:33.218272 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:14:33.221613 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:14:33.330513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:14:33.341812 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:14:33.342431 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:14:33.343759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:33.636476 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:14:33.638877 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:14:33.740814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e320e3f1-0d9c-4930-9a97-7bfb9f7f63b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f517287fdf0>]}
[0m11:14:33.742146 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:14:33.742711 [info ] [MainThread]: 
[0m11:14:33.747972 [debug] [Thread-1  ]: Began running node model.customer.stg_orders
[0m11:14:33.748645 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_orders ............................... [RUN]
[0m11:14:33.749586 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_orders)
[0m11:14:33.750088 [debug] [Thread-1  ]: Began compiling node model.customer.stg_orders
[0m11:14:33.753173 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_orders"
[0m11:14:33.754103 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (compile): 11:14:33.750621 => 11:14:33.753730
[0m11:14:33.754632 [debug] [Thread-1  ]: Began executing node model.customer.stg_orders
[0m11:14:33.793233 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_orders"
[0m11:14:33.794449 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_orders"
[0m11:14:33.794919 [debug] [Thread-1  ]: On model.customer.stg_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_orders"} */
create or replace   view learn_dbt.learn_dbt.stg_orders
  
   as (
    with orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from learn_dbt.jaffle_shop.orders

)

select * from orders
  );
[0m11:14:33.795475 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:14:34.180807 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:14:34.211773 [debug] [Thread-1  ]: Timing info for model.customer.stg_orders (execute): 11:14:33.755003 => 11:14:34.211369
[0m11:14:34.212303 [debug] [Thread-1  ]: On model.customer.stg_orders: Close
[0m11:14:34.306691 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e320e3f1-0d9c-4930-9a97-7bfb9f7f63b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f517019a0a0>]}
[0m11:14:34.307919 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_orders .......................... [[32mSUCCESS 1[0m in 0.56s]
[0m11:14:34.309020 [debug] [Thread-1  ]: Finished running node model.customer.stg_orders
[0m11:14:34.311215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:34.311730 [debug] [MainThread]: Connection 'model.customer.stg_orders' was properly closed.
[0m11:14:34.312184 [info ] [MainThread]: 
[0m11:14:34.312853 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m11:14:34.314017 [debug] [MainThread]: Command end result
[0m11:14:34.323694 [info ] [MainThread]: 
[0m11:14:34.324420 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:14:34.325008 [info ] [MainThread]: 
[0m11:14:34.325621 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:14:34.326812 [debug] [MainThread]: Command `dbt run` succeeded at 11:14:34.326562 after 2.31 seconds
[0m11:14:34.327304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51786ed580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5170a9efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5171706c40>]}
[0m11:14:34.327849 [debug] [MainThread]: Flushing usage events
[0m11:14:41.825933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e91f5b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e90839730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e90839130>]}


============================== 11:14:41.829136 | 74fa84ce-7d51-40f2-a355-bcc0edac761c ==============================
[0m11:14:41.829136 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:14:41.829861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:14:42.144359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74fa84ce-7d51-40f2-a355-bcc0edac761c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e8c157d30>]}
[0m11:14:42.168350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74fa84ce-7d51-40f2-a355-bcc0edac761c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e8c157040>]}
[0m11:14:42.186438 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:14:42.214196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:14:42.214736 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:14:42.223891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74fa84ce-7d51-40f2-a355-bcc0edac761c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e8af9f490>]}
[0m11:14:42.231903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74fa84ce-7d51-40f2-a355-bcc0edac761c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e8c02d1c0>]}
[0m11:14:42.232560 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:14:42.233135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74fa84ce-7d51-40f2-a355-bcc0edac761c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e8af86c10>]}
[0m11:14:42.233930 [warn ] [MainThread]: The selection criterion 'stg_payment' does not match any nodes
[0m11:14:42.235212 [info ] [MainThread]: 
[0m11:14:42.235762 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:14:42.236474 [debug] [MainThread]: Command end result
[0m11:14:42.243568 [debug] [MainThread]: Command `dbt run` succeeded at 11:14:42.243400 after 0.44 seconds
[0m11:14:42.244110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e91f5b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e8c157040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e8c15b130>]}
[0m11:14:42.244581 [debug] [MainThread]: Flushing usage events
[0m11:14:49.116821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f0e0db550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f0c9c5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f0c9c50a0>]}


============================== 11:14:49.120626 | 4f3388a4-b74a-4181-8d1d-0710aa956107 ==============================
[0m11:14:49.120626 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:14:49.121887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:14:49.450483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f3388a4-b74a-4181-8d1d-0710aa956107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f082e5d00>]}
[0m11:14:49.473639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f3388a4-b74a-4181-8d1d-0710aa956107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f082b5b20>]}
[0m11:14:49.491815 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:14:49.518666 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:14:49.519363 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:14:49.529626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f3388a4-b74a-4181-8d1d-0710aa956107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f0711f460>]}
[0m11:14:49.539169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f3388a4-b74a-4181-8d1d-0710aa956107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f07187190>]}
[0m11:14:49.539989 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:14:49.540557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f3388a4-b74a-4181-8d1d-0710aa956107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f07187460>]}
[0m11:14:49.542922 [info ] [MainThread]: 
[0m11:14:49.544299 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:14:49.546016 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:14:49.575353 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:14:49.576228 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:14:49.576767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:50.259114 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:14:50.262213 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:14:50.384485 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:14:50.394604 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:14:50.395156 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:14:50.395547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:50.866336 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:14:50.869016 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:14:50.974525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f3388a4-b74a-4181-8d1d-0710aa956107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f07187220>]}
[0m11:14:50.975763 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:14:50.976427 [info ] [MainThread]: 
[0m11:14:50.981200 [debug] [Thread-1  ]: Began running node model.customer.stg_customers
[0m11:14:50.982027 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_customers ............................ [RUN]
[0m11:14:50.983100 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_customers)
[0m11:14:50.983648 [debug] [Thread-1  ]: Began compiling node model.customer.stg_customers
[0m11:14:50.986163 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_customers"
[0m11:14:50.987295 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (compile): 11:14:50.984001 => 11:14:50.986744
[0m11:14:50.987915 [debug] [Thread-1  ]: Began executing node model.customer.stg_customers
[0m11:14:51.025425 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_customers"
[0m11:14:51.026569 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_customers"
[0m11:14:51.027181 [debug] [Thread-1  ]: On model.customer.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_customers"} */
create or replace   view learn_dbt.learn_dbt.stg_customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from learn_dbt.jaffle_shop.customers

)

select * from customers
  );
[0m11:14:51.027961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:14:51.429918 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:14:51.463636 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (execute): 11:14:50.988251 => 11:14:51.463307
[0m11:14:51.464245 [debug] [Thread-1  ]: On model.customer.stg_customers: Close
[0m11:14:51.571473 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f3388a4-b74a-4181-8d1d-0710aa956107', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f064ba970>]}
[0m11:14:51.572655 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_customers ....................... [[32mSUCCESS 1[0m in 0.59s]
[0m11:14:51.573836 [debug] [Thread-1  ]: Finished running node model.customer.stg_customers
[0m11:14:51.576050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:14:51.576472 [debug] [MainThread]: Connection 'model.customer.stg_customers' was properly closed.
[0m11:14:51.576956 [info ] [MainThread]: 
[0m11:14:51.577540 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.03 seconds (2.03s).
[0m11:14:51.578542 [debug] [MainThread]: Command end result
[0m11:14:51.588312 [info ] [MainThread]: 
[0m11:14:51.589155 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:14:51.589913 [info ] [MainThread]: 
[0m11:14:51.590659 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:14:51.591979 [debug] [MainThread]: Command `dbt run` succeeded at 11:14:51.591693 after 2.50 seconds
[0m11:14:51.592521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f0e0db550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f082b5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f064c69d0>]}
[0m11:14:51.593046 [debug] [MainThread]: Flushing usage events
[0m11:14:58.539634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff421757580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff420019610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4200193a0>]}


============================== 11:14:58.545917 | c1451475-c5f4-4c62-89e1-24c08ee2d546 ==============================
[0m11:14:58.545917 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:14:58.547068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:14:58.882599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1451475-c5f4-4c62-89e1-24c08ee2d546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41b937d30>]}
[0m11:14:58.905121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1451475-c5f4-4c62-89e1-24c08ee2d546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41b90de20>]}
[0m11:14:58.923422 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:14:58.949902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:14:58.950319 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:14:58.958418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1451475-c5f4-4c62-89e1-24c08ee2d546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41a762490>]}
[0m11:14:58.966012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1451475-c5f4-4c62-89e1-24c08ee2d546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41a7ca280>]}
[0m11:14:58.966716 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:14:58.967325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1451475-c5f4-4c62-89e1-24c08ee2d546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41a7ca400>]}
[0m11:14:58.969150 [info ] [MainThread]: 
[0m11:14:58.970228 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:14:58.971719 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:14:58.990815 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:14:58.991333 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:14:58.991810 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:14:59.484029 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:14:59.486924 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:14:59.587258 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:14:59.598025 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:14:59.598613 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:14:59.599112 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:14:59.892736 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:14:59.895194 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:15:00.003841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1451475-c5f4-4c62-89e1-24c08ee2d546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41b8efd00>]}
[0m11:15:00.005160 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:15:00.007045 [info ] [MainThread]: 
[0m11:15:00.011856 [debug] [Thread-1  ]: Began running node model.customer.stg_customers
[0m11:15:00.012619 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_customers ............................ [RUN]
[0m11:15:00.013680 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_customers)
[0m11:15:00.014227 [debug] [Thread-1  ]: Began compiling node model.customer.stg_customers
[0m11:15:00.017016 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_customers"
[0m11:15:00.018031 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (compile): 11:15:00.014602 => 11:15:00.017680
[0m11:15:00.018560 [debug] [Thread-1  ]: Began executing node model.customer.stg_customers
[0m11:15:00.063766 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_customers"
[0m11:15:00.065272 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_customers"
[0m11:15:00.065785 [debug] [Thread-1  ]: On model.customer.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_customers"} */
create or replace   view learn_dbt.learn_dbt.stg_customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from learn_dbt.jaffle_shop.customers

)

select * from customers
  );
[0m11:15:00.066383 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:15:00.614570 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:15:00.652407 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (execute): 11:15:00.018905 => 11:15:00.652047
[0m11:15:00.653087 [debug] [Thread-1  ]: On model.customer.stg_customers: Close
[0m11:15:00.755070 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1451475-c5f4-4c62-89e1-24c08ee2d546', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4181f7910>]}
[0m11:15:00.756261 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_customers ....................... [[32mSUCCESS 1[0m in 0.74s]
[0m11:15:00.757360 [debug] [Thread-1  ]: Finished running node model.customer.stg_customers
[0m11:15:00.759542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:00.759965 [debug] [MainThread]: Connection 'model.customer.stg_customers' was properly closed.
[0m11:15:00.760488 [info ] [MainThread]: 
[0m11:15:00.761196 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.79 seconds (1.79s).
[0m11:15:00.762254 [debug] [MainThread]: Command end result
[0m11:15:00.772286 [info ] [MainThread]: 
[0m11:15:00.773118 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:00.773751 [info ] [MainThread]: 
[0m11:15:00.774379 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:15:00.775433 [debug] [MainThread]: Command `dbt run` succeeded at 11:15:00.775256 after 2.26 seconds
[0m11:15:00.775982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff421757580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff419b008e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff41a747c40>]}
[0m11:15:00.776580 [debug] [MainThread]: Flushing usage events
[0m11:15:07.994893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb02fd44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb018b25e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb018b20a0>]}


============================== 11:15:07.998811 | adba951f-56b7-4c0e-93a7-611de870ae5e ==============================
[0m11:15:07.998811 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:15:07.999555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:15:08.326428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'adba951f-56b7-4c0e-93a7-611de870ae5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feafd1d3d00>]}
[0m11:15:08.349582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'adba951f-56b7-4c0e-93a7-611de870ae5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feafd1d3100>]}
[0m11:15:08.367319 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:15:08.398117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:08.398658 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:08.408650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'adba951f-56b7-4c0e-93a7-611de870ae5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feafd03a3d0>]}
[0m11:15:08.416779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'adba951f-56b7-4c0e-93a7-611de870ae5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feafd0a21c0>]}
[0m11:15:08.417500 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:15:08.418060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adba951f-56b7-4c0e-93a7-611de870ae5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feafd0a2340>]}
[0m11:15:08.419575 [info ] [MainThread]: 
[0m11:15:08.420681 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:15:08.422198 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:15:08.441904 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:15:08.445249 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:15:08.445788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:09.124154 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:15:09.127300 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:15:09.226504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:15:09.237485 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:15:09.238088 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:15:09.238808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:09.539621 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:15:09.542438 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:15:09.744057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'adba951f-56b7-4c0e-93a7-611de870ae5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feafd01ef10>]}
[0m11:15:09.745600 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:15:09.746320 [info ] [MainThread]: 
[0m11:15:09.754337 [debug] [Thread-1  ]: Began running node model.customer.stg_customers
[0m11:15:09.755210 [info ] [Thread-1  ]: 1 of 1 START sql view model learn_dbt.stg_customers ............................ [RUN]
[0m11:15:09.756269 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.stg_customers)
[0m11:15:09.756921 [debug] [Thread-1  ]: Began compiling node model.customer.stg_customers
[0m11:15:09.759656 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.stg_customers"
[0m11:15:09.760753 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (compile): 11:15:09.757297 => 11:15:09.760378
[0m11:15:09.761302 [debug] [Thread-1  ]: Began executing node model.customer.stg_customers
[0m11:15:09.802320 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.stg_customers"
[0m11:15:09.804198 [debug] [Thread-1  ]: Using snowflake connection "model.customer.stg_customers"
[0m11:15:09.805022 [debug] [Thread-1  ]: On model.customer.stg_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.stg_customers"} */
create or replace   view learn_dbt.learn_dbt.stg_customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from learn_dbt.jaffle_shop.customers

)

select * from customers
  );
[0m11:15:09.805589 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:15:10.203965 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:15:10.237828 [debug] [Thread-1  ]: Timing info for model.customer.stg_customers (execute): 11:15:09.761763 => 11:15:10.237503
[0m11:15:10.238432 [debug] [Thread-1  ]: On model.customer.stg_customers: Close
[0m11:15:10.335830 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'adba951f-56b7-4c0e-93a7-611de870ae5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaf9a9fd00>]}
[0m11:15:10.336856 [info ] [Thread-1  ]: 1 of 1 OK created sql view model learn_dbt.stg_customers ....................... [[32mSUCCESS 1[0m in 0.58s]
[0m11:15:10.338144 [debug] [Thread-1  ]: Finished running node model.customer.stg_customers
[0m11:15:10.340702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:10.341192 [debug] [MainThread]: Connection 'model.customer.stg_customers' was properly closed.
[0m11:15:10.341809 [info ] [MainThread]: 
[0m11:15:10.342431 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m11:15:10.343703 [debug] [MainThread]: Command end result
[0m11:15:10.352599 [info ] [MainThread]: 
[0m11:15:10.353279 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:10.353813 [info ] [MainThread]: 
[0m11:15:10.354590 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:15:10.355624 [debug] [MainThread]: Command `dbt run` succeeded at 11:15:10.355411 after 2.38 seconds
[0m11:15:10.356276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb02fd44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feafd1d3100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feafd01efa0>]}
[0m11:15:10.356759 [debug] [MainThread]: Flushing usage events
[0m11:15:17.516168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37e1252580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37dfb14730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37dfb140a0>]}


============================== 11:15:17.520576 | c79aba8c-20aa-42b2-9617-070fc0156daa ==============================
[0m11:15:17.520576 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:15:17.521325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:15:17.879796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c79aba8c-20aa-42b2-9617-070fc0156daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37da3f8d30>]}
[0m11:15:17.904279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c79aba8c-20aa-42b2-9617-070fc0156daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37da3d39a0>]}
[0m11:15:17.931215 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:15:17.961480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:17.962096 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:17.972146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c79aba8c-20aa-42b2-9617-070fc0156daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37da261490>]}
[0m11:15:17.980657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c79aba8c-20aa-42b2-9617-070fc0156daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37da2cf280>]}
[0m11:15:17.981428 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:15:17.982175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c79aba8c-20aa-42b2-9617-070fc0156daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37da2cf400>]}
[0m11:15:17.984206 [info ] [MainThread]: 
[0m11:15:17.985300 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:15:17.986885 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:15:18.010907 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:15:18.011626 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:15:18.013146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:18.496108 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:15:18.499245 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:15:18.591531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:15:18.603052 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:15:18.603719 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:15:18.604158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:19.074120 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:15:19.076763 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:15:19.180290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c79aba8c-20aa-42b2-9617-070fc0156daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37da3abe20>]}
[0m11:15:19.181611 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:15:19.182323 [info ] [MainThread]: 
[0m11:15:19.187759 [debug] [Thread-1  ]: Began running node model.customer.dim_customers
[0m11:15:19.188524 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.dim_customers ........................... [RUN]
[0m11:15:19.189445 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.dim_customers)
[0m11:15:19.190003 [debug] [Thread-1  ]: Began compiling node model.customer.dim_customers
[0m11:15:19.197364 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.dim_customers"
[0m11:15:19.198421 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (compile): 11:15:19.190403 => 11:15:19.198024
[0m11:15:19.198929 [debug] [Thread-1  ]: Began executing node model.customer.dim_customers
[0m11:15:19.241857 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.dim_customers"
[0m11:15:19.244149 [debug] [Thread-1  ]: Using snowflake connection "model.customer.dim_customers"
[0m11:15:19.244833 [debug] [Thread-1  ]: On model.customer.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.dim_customers"} */
create or replace transient table learn_dbt.learn_dbt.dim_customers
         as
        (with customers as (
    select * from learn_dbt.learn_dbt.stg_customers
),

orders as (
    select * from learn_dbt.learn_dbt.fact_orders
),
customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
        );
[0m11:15:19.245483 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:15:20.427376 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:15:20.459114 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (execute): 11:15:19.199248 => 11:15:20.458800
[0m11:15:20.459737 [debug] [Thread-1  ]: On model.customer.dim_customers: Close
[0m11:15:20.566811 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c79aba8c-20aa-42b2-9617-070fc0156daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37d8507610>]}
[0m11:15:20.567811 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.dim_customers ...................... [[32mSUCCESS 1[0m in 1.38s]
[0m11:15:20.569123 [debug] [Thread-1  ]: Finished running node model.customer.dim_customers
[0m11:15:20.571412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:20.571949 [debug] [MainThread]: Connection 'model.customer.dim_customers' was properly closed.
[0m11:15:20.572405 [info ] [MainThread]: 
[0m11:15:20.572999 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m11:15:20.574133 [debug] [MainThread]: Command end result
[0m11:15:20.583609 [info ] [MainThread]: 
[0m11:15:20.584244 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:20.584796 [info ] [MainThread]: 
[0m11:15:20.585432 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:15:20.586987 [debug] [MainThread]: Command `dbt run` succeeded at 11:15:20.586819 after 3.09 seconds
[0m11:15:20.587503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37e1252580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37d95fdd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37da246c40>]}
[0m11:15:20.588204 [debug] [MainThread]: Flushing usage events
[0m11:15:28.454194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9271e6f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92707596a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92707590a0>]}


============================== 11:15:28.458680 | 21184226-ec54-4588-b710-ee43f6dba341 ==============================
[0m11:15:28.458680 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:15:28.459467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:15:28.809806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21184226-ec54-4588-b710-ee43f6dba341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926c077d30>]}
[0m11:15:28.831022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21184226-ec54-4588-b710-ee43f6dba341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926c06d370>]}
[0m11:15:28.848093 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:15:28.875422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:28.875830 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:28.884338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21184226-ec54-4588-b710-ee43f6dba341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926aea1400>]}
[0m11:15:28.902645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21184226-ec54-4588-b710-ee43f6dba341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926af071f0>]}
[0m11:15:28.903338 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:15:28.903912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21184226-ec54-4588-b710-ee43f6dba341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926af07370>]}
[0m11:15:28.905393 [info ] [MainThread]: 
[0m11:15:28.906358 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:15:28.907904 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:15:28.927198 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:15:28.927767 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:15:28.928239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:29.589399 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:15:29.592362 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:15:29.697276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:15:29.708304 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:15:29.708956 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:15:29.709378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:30.021587 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:15:30.024290 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:15:30.134370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21184226-ec54-4588-b710-ee43f6dba341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926af07280>]}
[0m11:15:30.135587 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:15:30.136217 [info ] [MainThread]: 
[0m11:15:30.141377 [debug] [Thread-1  ]: Began running node model.customer.fact_orders
[0m11:15:30.142069 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.fact_orders ............................. [RUN]
[0m11:15:30.143019 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.fact_orders)
[0m11:15:30.143513 [debug] [Thread-1  ]: Began compiling node model.customer.fact_orders
[0m11:15:30.148116 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.fact_orders"
[0m11:15:30.149130 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (compile): 11:15:30.143862 => 11:15:30.148677
[0m11:15:30.149700 [debug] [Thread-1  ]: Began executing node model.customer.fact_orders
[0m11:15:30.191765 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.fact_orders"
[0m11:15:30.193610 [debug] [Thread-1  ]: Using snowflake connection "model.customer.fact_orders"
[0m11:15:30.194226 [debug] [Thread-1  ]: On model.customer.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.fact_orders"} */
create or replace transient table learn_dbt.learn_dbt.fact_orders
         as
        (with orders as  (
    select * from learn_dbt.learn_dbt.stg_orders
),

payments as (
    select * from learn_dbt.learn_dbt.stg_payments
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
        );
[0m11:15:30.194799 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:15:31.288146 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:15:31.319878 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (execute): 11:15:30.150066 => 11:15:31.319514
[0m11:15:31.320462 [debug] [Thread-1  ]: On model.customer.fact_orders: Close
[0m11:15:31.447455 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21184226-ec54-4588-b710-ee43f6dba341', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9268939fd0>]}
[0m11:15:31.448538 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.fact_orders ........................ [[32mSUCCESS 1[0m in 1.30s]
[0m11:15:31.449703 [debug] [Thread-1  ]: Finished running node model.customer.fact_orders
[0m11:15:31.451960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:31.452454 [debug] [MainThread]: Connection 'model.customer.fact_orders' was properly closed.
[0m11:15:31.453152 [info ] [MainThread]: 
[0m11:15:31.454117 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.55 seconds (2.55s).
[0m11:15:31.455198 [debug] [MainThread]: Command end result
[0m11:15:31.465951 [info ] [MainThread]: 
[0m11:15:31.466605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:31.467301 [info ] [MainThread]: 
[0m11:15:31.467922 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:15:31.469018 [debug] [MainThread]: Command `dbt run` succeeded at 11:15:31.468817 after 3.04 seconds
[0m11:15:31.470241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9271e6f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926c077d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f926ae85b50>]}
[0m11:15:31.470987 [debug] [MainThread]: Flushing usage events
[0m11:15:38.608679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8658fe55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86578a7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86578a72e0>]}


============================== 11:15:38.612668 | 06863672-007b-4ea9-a12b-36095ff8d1fd ==============================
[0m11:15:38.612668 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:15:38.613575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:15:38.970160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06863672-007b-4ea9-a12b-36095ff8d1fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86531c0f10>]}
[0m11:15:38.992830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06863672-007b-4ea9-a12b-36095ff8d1fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86531a16d0>]}
[0m11:15:39.010790 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:15:39.039084 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:39.039689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:39.049288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '06863672-007b-4ea9-a12b-36095ff8d1fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865302e4c0>]}
[0m11:15:39.057971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '06863672-007b-4ea9-a12b-36095ff8d1fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865309b2b0>]}
[0m11:15:39.058658 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:15:39.059215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06863672-007b-4ea9-a12b-36095ff8d1fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865309b430>]}
[0m11:15:39.060852 [info ] [MainThread]: 
[0m11:15:39.062012 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:15:39.063678 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:15:39.083964 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:15:39.084725 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:15:39.085261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:39.611427 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:15:39.614587 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:15:39.731401 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:15:39.742057 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:15:39.742680 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:15:39.743240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:40.045202 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:15:40.047849 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:15:40.153342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '06863672-007b-4ea9-a12b-36095ff8d1fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865309b220>]}
[0m11:15:40.154907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:15:40.156184 [info ] [MainThread]: 
[0m11:15:40.161903 [debug] [Thread-1  ]: Began running node model.customer.fact_orders
[0m11:15:40.162668 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.fact_orders ............................. [RUN]
[0m11:15:40.163632 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.fact_orders)
[0m11:15:40.164164 [debug] [Thread-1  ]: Began compiling node model.customer.fact_orders
[0m11:15:40.171227 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.fact_orders"
[0m11:15:40.172278 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (compile): 11:15:40.164511 => 11:15:40.171910
[0m11:15:40.172830 [debug] [Thread-1  ]: Began executing node model.customer.fact_orders
[0m11:15:40.216651 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.fact_orders"
[0m11:15:40.218598 [debug] [Thread-1  ]: Using snowflake connection "model.customer.fact_orders"
[0m11:15:40.219220 [debug] [Thread-1  ]: On model.customer.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.fact_orders"} */
create or replace transient table learn_dbt.learn_dbt.fact_orders
         as
        (with orders as  (
    select * from learn_dbt.learn_dbt.stg_orders
),

payments as (
    select * from learn_dbt.learn_dbt.stg_payments
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
        );
[0m11:15:40.219753 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:15:41.277206 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:15:41.310114 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (execute): 11:15:40.173240 => 11:15:41.309809
[0m11:15:41.310811 [debug] [Thread-1  ]: On model.customer.fact_orders: Close
[0m11:15:41.415148 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '06863672-007b-4ea9-a12b-36095ff8d1fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8650295160>]}
[0m11:15:41.416289 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.fact_orders ........................ [[32mSUCCESS 1[0m in 1.25s]
[0m11:15:41.417649 [debug] [Thread-1  ]: Finished running node model.customer.fact_orders
[0m11:15:41.420083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:41.420546 [debug] [MainThread]: Connection 'model.customer.fact_orders' was properly closed.
[0m11:15:41.421086 [info ] [MainThread]: 
[0m11:15:41.421758 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m11:15:41.423054 [debug] [MainThread]: Command end result
[0m11:15:41.432712 [info ] [MainThread]: 
[0m11:15:41.433407 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:41.433955 [info ] [MainThread]: 
[0m11:15:41.434798 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:15:41.435928 [debug] [MainThread]: Command `dbt run` succeeded at 11:15:41.435760 after 2.85 seconds
[0m11:15:41.436481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8658fe55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8653013c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865138efd0>]}
[0m11:15:41.437034 [debug] [MainThread]: Flushing usage events
[0m11:15:48.472150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2800b56550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27ff418700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27ff418130>]}


============================== 11:15:48.476016 | ebfcff8e-0c59-44e4-b01b-6587aa05f07d ==============================
[0m11:15:48.476016 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:15:48.476788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:15:48.809218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebfcff8e-0c59-44e4-b01b-6587aa05f07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fad34d00>]}
[0m11:15:48.832179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebfcff8e-0c59-44e4-b01b-6587aa05f07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fad340a0>]}
[0m11:15:48.850512 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:15:48.879094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:48.879829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:48.888767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ebfcff8e-0c59-44e4-b01b-6587aa05f07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f9b61460>]}
[0m11:15:48.897793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ebfcff8e-0c59-44e4-b01b-6587aa05f07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f9bc6190>]}
[0m11:15:48.898491 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:15:48.899589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebfcff8e-0c59-44e4-b01b-6587aa05f07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f9b46fd0>]}
[0m11:15:48.901195 [info ] [MainThread]: 
[0m11:15:48.902215 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:15:48.903719 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:15:48.927848 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:15:48.928548 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:15:48.929208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:49.578296 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:15:49.581503 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:15:49.687740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:15:49.698584 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:15:49.699074 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:15:49.699688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:50.027029 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:15:50.030305 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:15:50.153667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ebfcff8e-0c59-44e4-b01b-6587aa05f07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27face9c40>]}
[0m11:15:50.155047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:15:50.155685 [info ] [MainThread]: 
[0m11:15:50.161913 [debug] [Thread-1  ]: Began running node model.customer.fact_orders
[0m11:15:50.162632 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.fact_orders ............................. [RUN]
[0m11:15:50.163655 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.fact_orders)
[0m11:15:50.164212 [debug] [Thread-1  ]: Began compiling node model.customer.fact_orders
[0m11:15:50.169119 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.fact_orders"
[0m11:15:50.170160 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (compile): 11:15:50.164697 => 11:15:50.169766
[0m11:15:50.170726 [debug] [Thread-1  ]: Began executing node model.customer.fact_orders
[0m11:15:50.224111 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.fact_orders"
[0m11:15:50.226212 [debug] [Thread-1  ]: Using snowflake connection "model.customer.fact_orders"
[0m11:15:50.228488 [debug] [Thread-1  ]: On model.customer.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.fact_orders"} */
create or replace transient table learn_dbt.learn_dbt.fact_orders
         as
        (with orders as  (
    select * from learn_dbt.learn_dbt.stg_orders
),

payments as (
    select * from learn_dbt.learn_dbt.stg_payments
),

order_payments as (
    select
        order_id,
        sum(case when status = 'success' then amount end) as amount

    from payments
    group by 1
),

final as (

    select
        orders.order_id,
        orders.customer_id,
        orders.order_date,
        coalesce(order_payments.amount, 0) as amount

    from orders
    left join order_payments using (order_id)
)

select * from final
        );
[0m11:15:50.229209 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:15:51.120865 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:15:51.152090 [debug] [Thread-1  ]: Timing info for model.customer.fact_orders (execute): 11:15:50.171085 => 11:15:51.151790
[0m11:15:51.152638 [debug] [Thread-1  ]: On model.customer.fact_orders: Close
[0m11:15:51.261938 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ebfcff8e-0c59-44e4-b01b-6587aa05f07d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27f8f11940>]}
[0m11:15:51.263131 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.fact_orders ........................ [[32mSUCCESS 1[0m in 1.10s]
[0m11:15:51.264138 [debug] [Thread-1  ]: Finished running node model.customer.fact_orders
[0m11:15:51.266291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:51.266799 [debug] [MainThread]: Connection 'model.customer.fact_orders' was properly closed.
[0m11:15:51.267239 [info ] [MainThread]: 
[0m11:15:51.267793 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m11:15:51.268759 [debug] [MainThread]: Command end result
[0m11:15:51.277973 [info ] [MainThread]: 
[0m11:15:51.279187 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:15:51.279859 [info ] [MainThread]: 
[0m11:15:51.280517 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:15:51.281693 [debug] [MainThread]: Command `dbt run` succeeded at 11:15:51.281482 after 2.83 seconds
[0m11:15:51.282476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2800b56550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fad340a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27fad2df10>]}
[0m11:15:51.283054 [debug] [MainThread]: Flushing usage events
[0m11:15:58.920333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c5b3f1580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c59cdb730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c59cdb0a0>]}


============================== 11:15:58.924215 | f9ff0385-bf34-4092-a93e-f4c230ef0d8d ==============================
[0m11:15:58.924215 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:15:58.925090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:15:59.251028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9ff0385-bf34-4092-a93e-f4c230ef0d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c545f3d30>]}
[0m11:15:59.274289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9ff0385-bf34-4092-a93e-f4c230ef0d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c545d0dc0>]}
[0m11:15:59.292216 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:15:59.319567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:15:59.320165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:15:59.329373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9ff0385-bf34-4092-a93e-f4c230ef0d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c54461490>]}
[0m11:15:59.339676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9ff0385-bf34-4092-a93e-f4c230ef0d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c544cf280>]}
[0m11:15:59.340386 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:15:59.341332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9ff0385-bf34-4092-a93e-f4c230ef0d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c544cf400>]}
[0m11:15:59.342909 [info ] [MainThread]: 
[0m11:15:59.344078 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:15:59.346295 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:15:59.371518 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:15:59.372271 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:15:59.372734 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:00.026830 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:16:00.030122 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:16:00.149785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:16:00.161566 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:16:00.162141 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:16:00.162601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:16:00.605016 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:16:00.607524 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:16:00.710457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9ff0385-bf34-4092-a93e-f4c230ef0d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c545acd00>]}
[0m11:16:00.711760 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:16:00.712439 [info ] [MainThread]: 
[0m11:16:00.717557 [debug] [Thread-1  ]: Began running node model.customer.dim_customers
[0m11:16:00.718315 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.dim_customers ........................... [RUN]
[0m11:16:00.719430 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.dim_customers)
[0m11:16:00.720004 [debug] [Thread-1  ]: Began compiling node model.customer.dim_customers
[0m11:16:00.724981 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.dim_customers"
[0m11:16:00.725980 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (compile): 11:16:00.720366 => 11:16:00.725619
[0m11:16:00.726548 [debug] [Thread-1  ]: Began executing node model.customer.dim_customers
[0m11:16:00.770521 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.dim_customers"
[0m11:16:00.773050 [debug] [Thread-1  ]: Using snowflake connection "model.customer.dim_customers"
[0m11:16:00.773695 [debug] [Thread-1  ]: On model.customer.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.dim_customers"} */
create or replace transient table learn_dbt.learn_dbt.dim_customers
         as
        (with customers as (
    select * from learn_dbt.learn_dbt.stg_customers
),

orders as (
    select * from learn_dbt.learn_dbt.fact_orders
),
customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
        );
[0m11:16:00.774242 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:16:01.712085 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:16:01.745877 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (execute): 11:16:00.726887 => 11:16:01.745547
[0m11:16:01.746709 [debug] [Thread-1  ]: On model.customer.dim_customers: Close
[0m11:16:01.852016 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9ff0385-bf34-4092-a93e-f4c230ef0d8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c4de9c610>]}
[0m11:16:01.853170 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.dim_customers ...................... [[32mSUCCESS 1[0m in 1.13s]
[0m11:16:01.854167 [debug] [Thread-1  ]: Finished running node model.customer.dim_customers
[0m11:16:01.856289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:16:01.856723 [debug] [MainThread]: Connection 'model.customer.dim_customers' was properly closed.
[0m11:16:01.857251 [info ] [MainThread]: 
[0m11:16:01.858612 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.51 seconds (2.51s).
[0m11:16:01.859808 [debug] [MainThread]: Command end result
[0m11:16:01.869176 [info ] [MainThread]: 
[0m11:16:01.869918 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:16:01.870432 [info ] [MainThread]: 
[0m11:16:01.871084 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:16:01.872151 [debug] [MainThread]: Command `dbt run` succeeded at 11:16:01.871961 after 2.97 seconds
[0m11:16:01.872722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c5b3f1580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c4f793fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c54447c40>]}
[0m11:16:01.873252 [debug] [MainThread]: Flushing usage events
[0m11:16:08.994292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece4a12550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece32d45e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece32d4190>]}


============================== 11:16:08.999927 | ec9547ca-32ca-4279-8314-28ed721490e8 ==============================
[0m11:16:08.999927 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:16:09.000694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:16:09.327012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec9547ca-32ca-4279-8314-28ed721490e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdebf2d00>]}
[0m11:16:09.349667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec9547ca-32ca-4279-8314-28ed721490e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdebc3e50>]}
[0m11:16:09.367603 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:16:09.395421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:16:09.395994 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:16:09.405409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec9547ca-32ca-4279-8314-28ed721490e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdea5b460>]}
[0m11:16:09.415983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec9547ca-32ca-4279-8314-28ed721490e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdeac4190>]}
[0m11:16:09.416545 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:16:09.417203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec9547ca-32ca-4279-8314-28ed721490e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdeac4460>]}
[0m11:16:09.418814 [info ] [MainThread]: 
[0m11:16:09.419830 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:16:09.421536 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:16:09.442576 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:16:09.443338 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:16:09.443890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:09.982832 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m11:16:09.986133 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:16:10.098010 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_learn_dbt, now list_learn_dbt_learn_dbt)
[0m11:16:10.109272 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:16:10.110011 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:16:10.110485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:16:10.420494 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:16:10.423083 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:16:10.538648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec9547ca-32ca-4279-8314-28ed721490e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdeac4220>]}
[0m11:16:10.540001 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:16:10.540769 [info ] [MainThread]: 
[0m11:16:10.546495 [debug] [Thread-1  ]: Began running node model.customer.dim_customers
[0m11:16:10.547277 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.dim_customers ........................... [RUN]
[0m11:16:10.548205 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.dim_customers)
[0m11:16:10.548724 [debug] [Thread-1  ]: Began compiling node model.customer.dim_customers
[0m11:16:10.553774 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.dim_customers"
[0m11:16:10.555419 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (compile): 11:16:10.549107 => 11:16:10.555062
[0m11:16:10.555928 [debug] [Thread-1  ]: Began executing node model.customer.dim_customers
[0m11:16:10.601693 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.dim_customers"
[0m11:16:10.603880 [debug] [Thread-1  ]: Using snowflake connection "model.customer.dim_customers"
[0m11:16:10.604404 [debug] [Thread-1  ]: On model.customer.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.dim_customers"} */
create or replace transient table learn_dbt.learn_dbt.dim_customers
         as
        (with customers as (
    select * from learn_dbt.learn_dbt.stg_customers
),

orders as (
    select * from learn_dbt.learn_dbt.fact_orders
),
customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
        );
[0m11:16:10.605096 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:16:11.635296 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:16:11.668837 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (execute): 11:16:10.556261 => 11:16:11.668445
[0m11:16:11.669772 [debug] [Thread-1  ]: On model.customer.dim_customers: Close
[0m11:16:11.793172 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec9547ca-32ca-4279-8314-28ed721490e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdc4c73d0>]}
[0m11:16:11.794494 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.dim_customers ...................... [[32mSUCCESS 1[0m in 1.25s]
[0m11:16:11.795813 [debug] [Thread-1  ]: Finished running node model.customer.dim_customers
[0m11:16:11.798824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:16:11.799305 [debug] [MainThread]: Connection 'model.customer.dim_customers' was properly closed.
[0m11:16:11.799821 [info ] [MainThread]: 
[0m11:16:11.800601 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m11:16:11.801845 [debug] [MainThread]: Command end result
[0m11:16:11.812356 [info ] [MainThread]: 
[0m11:16:11.813297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:16:11.814068 [info ] [MainThread]: 
[0m11:16:11.814862 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:16:11.815957 [debug] [MainThread]: Command `dbt run` succeeded at 11:16:11.815719 after 2.85 seconds
[0m11:16:11.816527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fece4a12550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdebc3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecdea40be0>]}
[0m11:16:11.817078 [debug] [MainThread]: Flushing usage events
[0m11:16:18.782688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcb6ded580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcb56e1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcb56e1130>]}


============================== 11:16:18.786366 | 5d400bb2-6937-4682-bb5a-e8145e31a908 ==============================
[0m11:16:18.786366 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:16:18.787086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:16:19.100447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d400bb2-6937-4682-bb5a-e8145e31a908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcafff6e50>]}
[0m11:16:19.125556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d400bb2-6937-4682-bb5a-e8145e31a908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcafff6730>]}
[0m11:16:19.143010 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:16:19.178132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:16:19.178676 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:16:19.187749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d400bb2-6937-4682-bb5a-e8145e31a908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcafe604c0>]}
[0m11:16:19.205366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d400bb2-6937-4682-bb5a-e8145e31a908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcafecf1f0>]}
[0m11:16:19.206059 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m11:16:19.206667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d400bb2-6937-4682-bb5a-e8145e31a908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcafecf4c0>]}
[0m11:16:19.208274 [info ] [MainThread]: 
[0m11:16:19.209285 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:16:19.210729 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt'
[0m11:16:19.230151 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt"
[0m11:16:19.230727 [debug] [ThreadPool]: On list_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt"} */
show terse schemas in database learn_dbt
    limit 10000
[0m11:16:19.231185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:19.694883 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:16:19.698117 [debug] [ThreadPool]: On list_learn_dbt: Close
[0m11:16:19.798016 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_learn_dbt_learn_dbt'
[0m11:16:19.812171 [debug] [ThreadPool]: Using snowflake connection "list_learn_dbt_learn_dbt"
[0m11:16:19.812939 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_learn_dbt_learn_dbt"} */
show terse objects in learn_dbt.learn_dbt
[0m11:16:19.813675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:16:20.257826 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:16:20.260309 [debug] [ThreadPool]: On list_learn_dbt_learn_dbt: Close
[0m11:16:20.367170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d400bb2-6937-4682-bb5a-e8145e31a908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcaffabb50>]}
[0m11:16:20.368343 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:16:20.368977 [info ] [MainThread]: 
[0m11:16:20.374473 [debug] [Thread-1  ]: Began running node model.customer.dim_customers
[0m11:16:20.375740 [info ] [Thread-1  ]: 1 of 1 START sql table model learn_dbt.dim_customers ........................... [RUN]
[0m11:16:20.377087 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_learn_dbt_learn_dbt, now model.customer.dim_customers)
[0m11:16:20.377596 [debug] [Thread-1  ]: Began compiling node model.customer.dim_customers
[0m11:16:20.382322 [debug] [Thread-1  ]: Writing injected SQL for node "model.customer.dim_customers"
[0m11:16:20.383286 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (compile): 11:16:20.377934 => 11:16:20.382906
[0m11:16:20.383811 [debug] [Thread-1  ]: Began executing node model.customer.dim_customers
[0m11:16:20.425260 [debug] [Thread-1  ]: Writing runtime sql for node "model.customer.dim_customers"
[0m11:16:20.427573 [debug] [Thread-1  ]: Using snowflake connection "model.customer.dim_customers"
[0m11:16:20.428155 [debug] [Thread-1  ]: On model.customer.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.customer.dim_customers"} */
create or replace transient table learn_dbt.learn_dbt.dim_customers
         as
        (with customers as (
    select * from learn_dbt.learn_dbt.stg_customers
),

orders as (
    select * from learn_dbt.learn_dbt.fact_orders
),
customer_orders as (

    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
        lifetime_value

    from customers
    left join customer_orders using (customer_id)

)

select * from final
        );
[0m11:16:20.428764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:16:21.255441 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:16:21.288297 [debug] [Thread-1  ]: Timing info for model.customer.dim_customers (execute): 11:16:20.384192 => 11:16:21.287957
[0m11:16:21.288926 [debug] [Thread-1  ]: On model.customer.dim_customers: Close
[0m11:16:21.394823 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d400bb2-6937-4682-bb5a-e8145e31a908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcad8e2580>]}
[0m11:16:21.396230 [info ] [Thread-1  ]: 1 of 1 OK created sql table model learn_dbt.dim_customers ...................... [[32mSUCCESS 1[0m in 1.02s]
[0m11:16:21.397260 [debug] [Thread-1  ]: Finished running node model.customer.dim_customers
[0m11:16:21.399480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:16:21.399890 [debug] [MainThread]: Connection 'list_learn_dbt' was properly closed.
[0m11:16:21.400288 [debug] [MainThread]: Connection 'model.customer.dim_customers' was properly closed.
[0m11:16:21.400709 [info ] [MainThread]: 
[0m11:16:21.401350 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m11:16:21.402495 [debug] [MainThread]: Command end result
[0m11:16:21.413152 [info ] [MainThread]: 
[0m11:16:21.413848 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:16:21.414458 [info ] [MainThread]: 
[0m11:16:21.415342 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:16:21.416404 [debug] [MainThread]: Command `dbt run` succeeded at 11:16:21.416192 after 2.65 seconds
[0m11:16:21.417184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcb6ded580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcafff6730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efcafecf430>]}
[0m11:16:21.417720 [debug] [MainThread]: Flushing usage events
[0m12:10:12.042992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35f4a8c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35f338e130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35f338e280>]}


============================== 12:10:12.046808 | 6e6e56ac-60ff-4dbf-8b13-698b4b77f819 ==============================
[0m12:10:12.046808 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:10:12.047690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dags/dbt/logs', 'profiles_dir': 'dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:10:12.048214 [info ] [MainThread]: dbt version: 1.5.1
[0m12:10:12.048807 [info ] [MainThread]: python version: 3.8.10
[0m12:10:12.049296 [info ] [MainThread]: python path: /usr/bin/python3
[0m12:10:12.049773 [info ] [MainThread]: os info: Linux-5.15.0-1040-azure-x86_64-with-glibc2.29
[0m12:10:12.050247 [info ] [MainThread]: Using profiles.yml file at dags/dbt/profiles.yml
[0m12:10:12.050788 [info ] [MainThread]: Using dbt_project.yml file at dags/dbt/dbt_project.yml
[0m12:10:12.051272 [info ] [MainThread]: Configuration:
[0m12:10:12.360645 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:10:12.394947 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:10:12.395552 [info ] [MainThread]: Required dependencies:
[0m12:10:12.396052 [debug] [MainThread]: Executing "git --help"
[0m12:10:12.403415 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:10:12.404366 [debug] [MainThread]: STDERR: "b''"
[0m12:10:12.404893 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:10:12.405535 [info ] [MainThread]: Connection:
[0m12:10:12.406217 [info ] [MainThread]:   account: emuqifz-vy24542
[0m12:10:12.406803 [info ] [MainThread]:   user: satyamkumar
[0m12:10:12.407397 [info ] [MainThread]:   database: external_db
[0m12:10:12.407920 [info ] [MainThread]:   schema: sales
[0m12:10:12.408547 [info ] [MainThread]:   warehouse: learn_dbt_dw
[0m12:10:12.409107 [info ] [MainThread]:   role: accountadmin
[0m12:10:12.409669 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:10:12.410202 [info ] [MainThread]:   query_tag: None
[0m12:10:12.411543 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:10:12.412736 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:10:12.413315 [debug] [MainThread]: On debug: select 1 as id
[0m12:10:12.413999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:10:13.098422 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:10:13.100851 [debug] [MainThread]: On debug: Close
[0m12:10:13.206726 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:10:13.207715 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:10:13.209192 [debug] [MainThread]: Command `dbt debug` succeeded at 12:10:13.208875 after 1.19 seconds
[0m12:10:13.209930 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:10:13.211645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35f4a8c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35eec6df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35eec6d940>]}
[0m12:10:13.212748 [debug] [MainThread]: Flushing usage events
[0m12:16:34.334047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81585dc520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8156ede640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8156ede220>]}


============================== 12:16:34.338353 | c12885be-90c2-4f3b-974f-0504c6367350 ==============================
[0m12:16:34.338353 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:16:34.339237 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'dags/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:16:34.687532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c12885be-90c2-4f3b-974f-0504c6367350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81527c8130>]}
[0m12:16:34.713236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c12885be-90c2-4f3b-974f-0504c6367350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81527d0040>]}
[0m12:16:34.731271 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:16:34.739886 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m12:16:34.740450 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m12:16:34.741042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c12885be-90c2-4f3b-974f-0504c6367350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815261efa0>]}
[0m12:16:35.677954 [debug] [MainThread]: 1699: static parser successfully parsed sales/intermediate/fct_order_detail.sql
[0m12:16:35.697263 [debug] [MainThread]: 1699: static parser successfully parsed sales/intermediate/fct_payment_details.sql
[0m12:16:35.702871 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_orders.sql
[0m12:16:35.707715 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_payments.sql
[0m12:16:35.713111 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_customers.sql
[0m12:16:35.718824 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_products.sql
[0m12:16:35.724343 [debug] [MainThread]: 1699: static parser successfully parsed sales/core/product_sales.sql
[0m12:16:35.806886 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales.intermediate
- models.sales.staging
- models.sales.bronze
[0m12:16:35.814800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c12885be-90c2-4f3b-974f-0504c6367350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815271c340>]}
[0m12:16:35.823286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c12885be-90c2-4f3b-974f-0504c6367350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81511afa60>]}
[0m12:16:35.823867 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:16:35.824423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12885be-90c2-4f3b-974f-0504c6367350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8152784fd0>]}
[0m12:16:35.826627 [info ] [MainThread]: 
[0m12:16:35.827600 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:16:35.829547 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:16:35.900149 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:16:35.901004 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:16:35.901650 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:36.834229 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:16:36.837382 [debug] [ThreadPool]: On list_external_db: Close
[0m12:16:36.950921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now create_external_db_sales)
[0m12:16:36.952378 [debug] [ThreadPool]: Creating schema "database: "external_db"
schema: "sales"
"
[0m12:16:36.960889 [debug] [ThreadPool]: Using snowflake connection "create_external_db_sales"
[0m12:16:36.961572 [debug] [ThreadPool]: On create_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "create_external_db_sales"} */
create schema if not exists external_db.sales
[0m12:16:36.962125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:37.296087 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:16:37.299517 [debug] [ThreadPool]: On create_external_db_sales: Close
[0m12:16:37.402950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_external_db_sales, now list_external_db_sales)
[0m12:16:37.412392 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m12:16:37.413073 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m12:16:37.413645 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:37.777793 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m12:16:37.780261 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m12:16:37.900458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12885be-90c2-4f3b-974f-0504c6367350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8152735370>]}
[0m12:16:37.901864 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:16:37.903366 [info ] [MainThread]: 
[0m12:16:37.911401 [debug] [Thread-1  ]: Began running node model.sales.bronze_customers
[0m12:16:37.912210 [info ] [Thread-1  ]: 1 of 7 START sql view model sales.bronze_customers ............................. [RUN]
[0m12:16:37.914583 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.sales.bronze_customers)
[0m12:16:37.915181 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_customers
[0m12:16:37.920164 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_customers"
[0m12:16:37.922715 [debug] [Thread-1  ]: Timing info for model.sales.bronze_customers (compile): 12:16:37.915539 => 12:16:37.922227
[0m12:16:37.923384 [debug] [Thread-1  ]: Began executing node model.sales.bronze_customers
[0m12:16:37.973936 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.bronze_customers"
[0m12:16:37.975479 [debug] [Thread-1  ]: Using snowflake connection "model.sales.bronze_customers"
[0m12:16:37.976069 [debug] [Thread-1  ]: On model.sales.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.bronze_customers"} */
create or replace   view external_db.sales.bronze_customers
  
   as (
    with customers as (
     select * from external_db.stage.customers
)

select * from customers
  );
[0m12:16:37.976580 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:16:38.371929 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:16:38.400571 [debug] [Thread-1  ]: Timing info for model.sales.bronze_customers (execute): 12:16:37.923993 => 12:16:38.400214
[0m12:16:38.401269 [debug] [Thread-1  ]: On model.sales.bronze_customers: Close
[0m12:16:38.500666 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12885be-90c2-4f3b-974f-0504c6367350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815046c370>]}
[0m12:16:38.501990 [info ] [Thread-1  ]: 1 of 7 OK created sql view model sales.bronze_customers ........................ [[32mSUCCESS 1[0m in 0.59s]
[0m12:16:38.503963 [debug] [Thread-1  ]: Finished running node model.sales.bronze_customers
[0m12:16:38.504708 [debug] [Thread-1  ]: Began running node model.sales.bronze_orders
[0m12:16:38.505944 [info ] [Thread-1  ]: 2 of 7 START sql view model sales.bronze_orders ................................ [RUN]
[0m12:16:38.506934 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_customers, now model.sales.bronze_orders)
[0m12:16:38.507477 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_orders
[0m12:16:38.512743 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_orders"
[0m12:16:38.514242 [debug] [Thread-1  ]: Timing info for model.sales.bronze_orders (compile): 12:16:38.508384 => 12:16:38.513890
[0m12:16:38.514861 [debug] [Thread-1  ]: Began executing node model.sales.bronze_orders
[0m12:16:38.521748 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.bronze_orders"
[0m12:16:38.522903 [debug] [Thread-1  ]: Using snowflake connection "model.sales.bronze_orders"
[0m12:16:38.523588 [debug] [Thread-1  ]: On model.sales.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.bronze_orders"} */
create or replace   view external_db.sales.bronze_orders
  
   as (
    with orders as (
     select * from external_db.stage.orders
)

select * from orders
  );
[0m12:16:38.524247 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:16:38.922872 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:16:38.927267 [debug] [Thread-1  ]: Timing info for model.sales.bronze_orders (execute): 12:16:38.515288 => 12:16:38.926902
[0m12:16:38.927853 [debug] [Thread-1  ]: On model.sales.bronze_orders: Close
[0m12:16:39.040665 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12885be-90c2-4f3b-974f-0504c6367350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815041a130>]}
[0m12:16:39.041873 [info ] [Thread-1  ]: 2 of 7 OK created sql view model sales.bronze_orders ........................... [[32mSUCCESS 1[0m in 0.53s]
[0m12:16:39.043327 [debug] [Thread-1  ]: Finished running node model.sales.bronze_orders
[0m12:16:39.044122 [debug] [Thread-1  ]: Began running node model.sales.bronze_payments
[0m12:16:39.045000 [info ] [Thread-1  ]: 3 of 7 START sql view model sales.bronze_payments .............................. [RUN]
[0m12:16:39.046144 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_orders, now model.sales.bronze_payments)
[0m12:16:39.046729 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_payments
[0m12:16:39.051363 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_payments"
[0m12:16:39.052436 [debug] [Thread-1  ]: Timing info for model.sales.bronze_payments (compile): 12:16:39.047069 => 12:16:39.052053
[0m12:16:39.053121 [debug] [Thread-1  ]: Began executing node model.sales.bronze_payments
[0m12:16:39.058529 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.bronze_payments"
[0m12:16:39.059534 [debug] [Thread-1  ]: Using snowflake connection "model.sales.bronze_payments"
[0m12:16:39.060086 [debug] [Thread-1  ]: On model.sales.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.bronze_payments"} */
create or replace   view external_db.sales.bronze_payments
  
   as (
    with payments as (
     select * from external_db.stage.payments
)

select * from payments
  );
[0m12:16:39.060851 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:16:39.439610 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:16:39.443928 [debug] [Thread-1  ]: Timing info for model.sales.bronze_payments (execute): 12:16:39.053658 => 12:16:39.443574
[0m12:16:39.444624 [debug] [Thread-1  ]: On model.sales.bronze_payments: Close
[0m12:16:39.550870 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12885be-90c2-4f3b-974f-0504c6367350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8150458d30>]}
[0m12:16:39.552144 [info ] [Thread-1  ]: 3 of 7 OK created sql view model sales.bronze_payments ......................... [[32mSUCCESS 1[0m in 0.51s]
[0m12:16:39.553498 [debug] [Thread-1  ]: Finished running node model.sales.bronze_payments
[0m12:16:39.554339 [debug] [Thread-1  ]: Began running node model.sales.bronze_products
[0m12:16:39.555368 [info ] [Thread-1  ]: 4 of 7 START sql view model sales.bronze_products .............................. [RUN]
[0m12:16:39.556979 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_payments, now model.sales.bronze_products)
[0m12:16:39.557764 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_products
[0m12:16:39.562568 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_products"
[0m12:16:39.564177 [debug] [Thread-1  ]: Timing info for model.sales.bronze_products (compile): 12:16:39.558228 => 12:16:39.563849
[0m12:16:39.564829 [debug] [Thread-1  ]: Began executing node model.sales.bronze_products
[0m12:16:39.569045 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.bronze_products"
[0m12:16:39.570308 [debug] [Thread-1  ]: Using snowflake connection "model.sales.bronze_products"
[0m12:16:39.570967 [debug] [Thread-1  ]: On model.sales.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.bronze_products"} */
create or replace   view external_db.sales.bronze_products
  
   as (
    with products as (
     select * from external_db.stage.products
)

select * from products
  );
[0m12:16:39.571768 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:16:39.943479 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:16:39.947997 [debug] [Thread-1  ]: Timing info for model.sales.bronze_products (execute): 12:16:39.565189 => 12:16:39.947658
[0m12:16:39.948666 [debug] [Thread-1  ]: On model.sales.bronze_products: Close
[0m12:16:40.051152 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12885be-90c2-4f3b-974f-0504c6367350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8150458dc0>]}
[0m12:16:40.052542 [info ] [Thread-1  ]: 4 of 7 OK created sql view model sales.bronze_products ......................... [[32mSUCCESS 1[0m in 0.49s]
[0m12:16:40.053743 [debug] [Thread-1  ]: Finished running node model.sales.bronze_products
[0m12:16:40.054470 [debug] [Thread-1  ]: Began running node model.sales.fct_payment_details
[0m12:16:40.055899 [info ] [Thread-1  ]: 5 of 7 START sql view model sales.fct_payment_details .......................... [RUN]
[0m12:16:40.057167 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_products, now model.sales.fct_payment_details)
[0m12:16:40.057955 [debug] [Thread-1  ]: Began compiling node model.sales.fct_payment_details
[0m12:16:40.063256 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.fct_payment_details"
[0m12:16:40.064972 [debug] [Thread-1  ]: Timing info for model.sales.fct_payment_details (compile): 12:16:40.058665 => 12:16:40.064515
[0m12:16:40.065632 [debug] [Thread-1  ]: Began executing node model.sales.fct_payment_details
[0m12:16:40.070303 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.fct_payment_details"
[0m12:16:40.073061 [debug] [Thread-1  ]: Using snowflake connection "model.sales.fct_payment_details"
[0m12:16:40.073731 [debug] [Thread-1  ]: On model.sales.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.fct_payment_details"} */
create or replace   view external_db.sales.fct_payment_details
  
   as (
    with payments as (
    select * from external_db.sales.bronze_payments
),

final as(
    select 
    payment_id,
    payment_method,
    order_id

    from payments where status = 'success'
)

select * from final
  );
[0m12:16:40.074325 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:16:40.694937 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:16:40.698935 [debug] [Thread-1  ]: Timing info for model.sales.fct_payment_details (execute): 12:16:40.066082 => 12:16:40.698596
[0m12:16:40.699617 [debug] [Thread-1  ]: On model.sales.fct_payment_details: Close
[0m12:16:40.825935 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12885be-90c2-4f3b-974f-0504c6367350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8150458c40>]}
[0m12:16:40.827068 [info ] [Thread-1  ]: 5 of 7 OK created sql view model sales.fct_payment_details ..................... [[32mSUCCESS 1[0m in 0.77s]
[0m12:16:40.828136 [debug] [Thread-1  ]: Finished running node model.sales.fct_payment_details
[0m12:16:40.829105 [debug] [Thread-1  ]: Began running node model.sales.fct_order_detail
[0m12:16:40.830238 [info ] [Thread-1  ]: 6 of 7 START sql view model sales.fct_order_detail ............................. [RUN]
[0m12:16:40.831267 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.fct_payment_details, now model.sales.fct_order_detail)
[0m12:16:40.831928 [debug] [Thread-1  ]: Began compiling node model.sales.fct_order_detail
[0m12:16:40.837241 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.fct_order_detail"
[0m12:16:40.838446 [debug] [Thread-1  ]: Timing info for model.sales.fct_order_detail (compile): 12:16:40.832571 => 12:16:40.838128
[0m12:16:40.839011 [debug] [Thread-1  ]: Began executing node model.sales.fct_order_detail
[0m12:16:40.845315 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.fct_order_detail"
[0m12:16:40.846693 [debug] [Thread-1  ]: Using snowflake connection "model.sales.fct_order_detail"
[0m12:16:40.847281 [debug] [Thread-1  ]: On model.sales.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.fct_order_detail"} */
create or replace   view external_db.sales.fct_order_detail
  
   as (
    with orders as (
    select * from external_db.sales.bronze_orders
),
products as (
    select * from external_db.sales.bronze_products
), 

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m12:16:40.847927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:16:41.273914 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:16:41.278149 [debug] [Thread-1  ]: Timing info for model.sales.fct_order_detail (execute): 12:16:40.839414 => 12:16:41.277713
[0m12:16:41.278724 [debug] [Thread-1  ]: On model.sales.fct_order_detail: Close
[0m12:16:41.379347 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12885be-90c2-4f3b-974f-0504c6367350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81503a5460>]}
[0m12:16:41.380552 [info ] [Thread-1  ]: 6 of 7 OK created sql view model sales.fct_order_detail ........................ [[32mSUCCESS 1[0m in 0.55s]
[0m12:16:41.381994 [debug] [Thread-1  ]: Finished running node model.sales.fct_order_detail
[0m12:16:41.383495 [debug] [Thread-1  ]: Began running node model.sales.product_sales
[0m12:16:41.384279 [info ] [Thread-1  ]: 7 of 7 START sql view model sales.product_sales ................................ [RUN]
[0m12:16:41.385315 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.fct_order_detail, now model.sales.product_sales)
[0m12:16:41.386017 [debug] [Thread-1  ]: Began compiling node model.sales.product_sales
[0m12:16:41.391534 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.product_sales"
[0m12:16:41.392967 [debug] [Thread-1  ]: Timing info for model.sales.product_sales (compile): 12:16:41.386596 => 12:16:41.392580
[0m12:16:41.395894 [debug] [Thread-1  ]: Began executing node model.sales.product_sales
[0m12:16:41.402089 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.product_sales"
[0m12:16:41.403805 [debug] [Thread-1  ]: Using snowflake connection "model.sales.product_sales"
[0m12:16:41.404573 [debug] [Thread-1  ]: On model.sales.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.product_sales"} */
create or replace   view external_db.sales.product_sales
  
   as (
    with order_details as (
    select * from external_db.sales.fct_order_detail
), 
customer as (
    select * from external_db.sales.bronze_customers
),
payments as (
    select * from external_db.sales.fct_payment_details
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m12:16:41.405220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:16:41.927954 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:16:41.932772 [debug] [Thread-1  ]: Timing info for model.sales.product_sales (execute): 12:16:41.397530 => 12:16:41.931780
[0m12:16:41.933474 [debug] [Thread-1  ]: On model.sales.product_sales: Close
[0m12:16:42.048405 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12885be-90c2-4f3b-974f-0504c6367350', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f815048d5e0>]}
[0m12:16:42.049746 [info ] [Thread-1  ]: 7 of 7 OK created sql view model sales.product_sales ........................... [[32mSUCCESS 1[0m in 0.66s]
[0m12:16:42.050802 [debug] [Thread-1  ]: Finished running node model.sales.product_sales
[0m12:16:42.053941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:42.054552 [debug] [MainThread]: Connection 'model.sales.product_sales' was properly closed.
[0m12:16:42.055073 [info ] [MainThread]: 
[0m12:16:42.058002 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 6.23 seconds (6.23s).
[0m12:16:42.062060 [debug] [MainThread]: Command end result
[0m12:16:42.074202 [info ] [MainThread]: 
[0m12:16:42.075248 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:42.076161 [info ] [MainThread]: 
[0m12:16:42.077134 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:16:42.078433 [debug] [MainThread]: Command `dbt run` succeeded at 12:16:42.078227 after 7.77 seconds
[0m12:16:42.079191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81585dc520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81527d0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81503faca0>]}
[0m12:16:42.079888 [debug] [MainThread]: Flushing usage events
[0m13:55:51.133217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3321bd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff330adb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff330adb400>]}


============================== 13:55:51.137624 | 2f059760-621c-4d60-97b3-cd49b06b248b ==============================
[0m13:55:51.137624 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:55:51.138525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'dags/dbt', 'log_path': 'dags/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:55:51.537953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f059760-621c-4d60-97b3-cd49b06b248b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff32c3d0130>]}
[0m13:55:51.561462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f059760-621c-4d60-97b3-cd49b06b248b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff32c3cd040>]}
[0m13:55:51.580304 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:55:51.611793 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:51.612392 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:51.613469 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales.intermediate
- models.sales.bronze
- models.sales.staging
[0m13:55:51.623733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f059760-621c-4d60-97b3-cd49b06b248b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff32c24eaf0>]}
[0m13:55:51.633191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f059760-621c-4d60-97b3-cd49b06b248b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff32c2a59d0>]}
[0m13:55:51.633816 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:55:51.636145 [info ] [MainThread]: 
[0m13:55:51.637166 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:55:51.639070 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m13:55:51.659537 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m13:55:51.660280 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m13:55:51.660804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:52.410089 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:55:52.413313 [debug] [ThreadPool]: On list_external_db: Close
[0m13:55:52.511160 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_sales'
[0m13:55:52.523842 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m13:55:52.524416 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m13:55:52.524838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:52.863762 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m13:55:52.866307 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m13:55:52.990225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f059760-621c-4d60-97b3-cd49b06b248b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff32c2a53d0>]}
[0m13:55:52.991487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:55:52.992710 [info ] [MainThread]: 
[0m13:55:53.003706 [debug] [Thread-1  ]: Began running node model.sales.bronze_customers
[0m13:55:53.004421 [info ] [Thread-1  ]: 1 of 7 START sql view model sales.bronze_customers ............................. [RUN]
[0m13:55:53.006162 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.sales.bronze_customers)
[0m13:55:53.006712 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_customers
[0m13:55:53.011751 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_customers"
[0m13:55:53.013501 [debug] [Thread-1  ]: Timing info for model.sales.bronze_customers (compile): 13:55:53.007033 => 13:55:53.013042
[0m13:55:53.014186 [debug] [Thread-1  ]: Began executing node model.sales.bronze_customers
[0m13:55:53.057574 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.bronze_customers"
[0m13:55:53.059049 [debug] [Thread-1  ]: Using snowflake connection "model.sales.bronze_customers"
[0m13:55:53.059582 [debug] [Thread-1  ]: On model.sales.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.bronze_customers"} */
create or replace   view external_db.sales.bronze_customers
  
   as (
    with customers as (
     select * from external_db.stage.customers
)

select * from customers
  );
[0m13:55:53.060547 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:53.455208 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:55:53.487140 [debug] [Thread-1  ]: Timing info for model.sales.bronze_customers (execute): 13:55:53.014567 => 13:55:53.486745
[0m13:55:53.487765 [debug] [Thread-1  ]: On model.sales.bronze_customers: Close
[0m13:55:53.598346 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f059760-621c-4d60-97b3-cd49b06b248b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff329cc87c0>]}
[0m13:55:53.599521 [info ] [Thread-1  ]: 1 of 7 OK created sql view model sales.bronze_customers ........................ [[32mSUCCESS 1[0m in 0.59s]
[0m13:55:53.601022 [debug] [Thread-1  ]: Finished running node model.sales.bronze_customers
[0m13:55:53.601764 [debug] [Thread-1  ]: Began running node model.sales.bronze_orders
[0m13:55:53.602623 [info ] [Thread-1  ]: 2 of 7 START sql view model sales.bronze_orders ................................ [RUN]
[0m13:55:53.603698 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_customers, now model.sales.bronze_orders)
[0m13:55:53.604274 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_orders
[0m13:55:53.608745 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_orders"
[0m13:55:53.609847 [debug] [Thread-1  ]: Timing info for model.sales.bronze_orders (compile): 13:55:53.604682 => 13:55:53.609479
[0m13:55:53.610386 [debug] [Thread-1  ]: Began executing node model.sales.bronze_orders
[0m13:55:53.614550 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.bronze_orders"
[0m13:55:53.615567 [debug] [Thread-1  ]: Using snowflake connection "model.sales.bronze_orders"
[0m13:55:53.616331 [debug] [Thread-1  ]: On model.sales.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.bronze_orders"} */
create or replace   view external_db.sales.bronze_orders
  
   as (
    with orders as (
     select * from external_db.stage.orders
)

select * from orders
  );
[0m13:55:53.616846 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:54.165479 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:55:54.170319 [debug] [Thread-1  ]: Timing info for model.sales.bronze_orders (execute): 13:55:53.610710 => 13:55:54.170004
[0m13:55:54.170963 [debug] [Thread-1  ]: On model.sales.bronze_orders: Close
[0m13:55:54.278768 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f059760-621c-4d60-97b3-cd49b06b248b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff328c86550>]}
[0m13:55:54.279994 [info ] [Thread-1  ]: 2 of 7 OK created sql view model sales.bronze_orders ........................... [[32mSUCCESS 1[0m in 0.68s]
[0m13:55:54.282415 [debug] [Thread-1  ]: Finished running node model.sales.bronze_orders
[0m13:55:54.283050 [debug] [Thread-1  ]: Began running node model.sales.bronze_payments
[0m13:55:54.283618 [info ] [Thread-1  ]: 3 of 7 START sql view model sales.bronze_payments .............................. [RUN]
[0m13:55:54.285045 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_orders, now model.sales.bronze_payments)
[0m13:55:54.285753 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_payments
[0m13:55:54.290570 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_payments"
[0m13:55:54.291586 [debug] [Thread-1  ]: Timing info for model.sales.bronze_payments (compile): 13:55:54.286107 => 13:55:54.291242
[0m13:55:54.292084 [debug] [Thread-1  ]: Began executing node model.sales.bronze_payments
[0m13:55:54.296795 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.bronze_payments"
[0m13:55:54.297878 [debug] [Thread-1  ]: Using snowflake connection "model.sales.bronze_payments"
[0m13:55:54.298444 [debug] [Thread-1  ]: On model.sales.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.bronze_payments"} */
create or replace   view external_db.sales.bronze_payments
  
   as (
    with payments as (
     select * from external_db.stage.payments
)

select * from payments
  );
[0m13:55:54.298918 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:54.734616 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:55:54.738849 [debug] [Thread-1  ]: Timing info for model.sales.bronze_payments (execute): 13:55:54.292427 => 13:55:54.738570
[0m13:55:54.739465 [debug] [Thread-1  ]: On model.sales.bronze_payments: Close
[0m13:55:54.839936 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f059760-621c-4d60-97b3-cd49b06b248b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff32a5d3e50>]}
[0m13:55:54.841485 [info ] [Thread-1  ]: 3 of 7 OK created sql view model sales.bronze_payments ......................... [[32mSUCCESS 1[0m in 0.56s]
[0m13:55:54.842504 [debug] [Thread-1  ]: Finished running node model.sales.bronze_payments
[0m13:55:54.843126 [debug] [Thread-1  ]: Began running node model.sales.bronze_products
[0m13:55:54.843899 [info ] [Thread-1  ]: 4 of 7 START sql view model sales.bronze_products .............................. [RUN]
[0m13:55:54.845040 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_payments, now model.sales.bronze_products)
[0m13:55:54.845512 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_products
[0m13:55:54.850468 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_products"
[0m13:55:54.851809 [debug] [Thread-1  ]: Timing info for model.sales.bronze_products (compile): 13:55:54.845820 => 13:55:54.851421
[0m13:55:54.852646 [debug] [Thread-1  ]: Began executing node model.sales.bronze_products
[0m13:55:54.857509 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.bronze_products"
[0m13:55:54.858814 [debug] [Thread-1  ]: Using snowflake connection "model.sales.bronze_products"
[0m13:55:54.859315 [debug] [Thread-1  ]: On model.sales.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.bronze_products"} */
create or replace   view external_db.sales.bronze_products
  
   as (
    with products as (
     select * from external_db.stage.products
)

select * from products
  );
[0m13:55:54.859803 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:55.274285 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:55:55.278776 [debug] [Thread-1  ]: Timing info for model.sales.bronze_products (execute): 13:55:54.852995 => 13:55:55.278483
[0m13:55:55.279287 [debug] [Thread-1  ]: On model.sales.bronze_products: Close
[0m13:55:55.387133 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f059760-621c-4d60-97b3-cd49b06b248b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff32a5d3880>]}
[0m13:55:55.388266 [info ] [Thread-1  ]: 4 of 7 OK created sql view model sales.bronze_products ......................... [[32mSUCCESS 1[0m in 0.54s]
[0m13:55:55.389260 [debug] [Thread-1  ]: Finished running node model.sales.bronze_products
[0m13:55:55.389893 [debug] [Thread-1  ]: Began running node model.sales.fct_payment_details
[0m13:55:55.391093 [info ] [Thread-1  ]: 5 of 7 START sql view model sales.fct_payment_details .......................... [RUN]
[0m13:55:55.392255 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_products, now model.sales.fct_payment_details)
[0m13:55:55.393254 [debug] [Thread-1  ]: Began compiling node model.sales.fct_payment_details
[0m13:55:55.398141 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.fct_payment_details"
[0m13:55:55.399547 [debug] [Thread-1  ]: Timing info for model.sales.fct_payment_details (compile): 13:55:55.393807 => 13:55:55.399145
[0m13:55:55.400221 [debug] [Thread-1  ]: Began executing node model.sales.fct_payment_details
[0m13:55:55.406848 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.fct_payment_details"
[0m13:55:55.408552 [debug] [Thread-1  ]: Using snowflake connection "model.sales.fct_payment_details"
[0m13:55:55.409234 [debug] [Thread-1  ]: On model.sales.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.fct_payment_details"} */
create or replace   view external_db.sales.fct_payment_details
  
   as (
    with payments as (
    select * from external_db.sales.bronze_payments
),

final as(
    select 
    payment_id,
    payment_method,
    order_id

    from payments where status = 'success'
)

select * from final
  );
[0m13:55:55.409851 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:55.854936 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:55:55.859275 [debug] [Thread-1  ]: Timing info for model.sales.fct_payment_details (execute): 13:55:55.400601 => 13:55:55.858950
[0m13:55:55.859922 [debug] [Thread-1  ]: On model.sales.fct_payment_details: Close
[0m13:55:55.975227 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f059760-621c-4d60-97b3-cd49b06b248b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff32a5fb790>]}
[0m13:55:55.976295 [info ] [Thread-1  ]: 5 of 7 OK created sql view model sales.fct_payment_details ..................... [[32mSUCCESS 1[0m in 0.58s]
[0m13:55:55.977777 [debug] [Thread-1  ]: Finished running node model.sales.fct_payment_details
[0m13:55:55.978580 [debug] [Thread-1  ]: Began running node model.sales.fct_order_detail
[0m13:55:55.979399 [info ] [Thread-1  ]: 6 of 7 START sql view model sales.fct_order_detail ............................. [RUN]
[0m13:55:55.980794 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.fct_payment_details, now model.sales.fct_order_detail)
[0m13:55:55.981728 [debug] [Thread-1  ]: Began compiling node model.sales.fct_order_detail
[0m13:55:55.990364 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.fct_order_detail"
[0m13:55:55.991364 [debug] [Thread-1  ]: Timing info for model.sales.fct_order_detail (compile): 13:55:55.982209 => 13:55:55.991041
[0m13:55:55.991927 [debug] [Thread-1  ]: Began executing node model.sales.fct_order_detail
[0m13:55:55.997199 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.fct_order_detail"
[0m13:55:55.999034 [debug] [Thread-1  ]: Using snowflake connection "model.sales.fct_order_detail"
[0m13:55:55.999591 [debug] [Thread-1  ]: On model.sales.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.fct_order_detail"} */
create or replace   view external_db.sales.fct_order_detail
  
   as (
    with orders as (
    select * from external_db.sales.bronze_orders
),
products as (
    select * from external_db.sales.bronze_products
), 

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m13:55:56.000209 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:56.456023 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:55:56.460310 [debug] [Thread-1  ]: Timing info for model.sales.fct_order_detail (execute): 13:55:55.992274 => 13:55:56.460043
[0m13:55:56.460777 [debug] [Thread-1  ]: On model.sales.fct_order_detail: Close
[0m13:55:56.569323 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f059760-621c-4d60-97b3-cd49b06b248b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff328c92c70>]}
[0m13:55:56.571109 [info ] [Thread-1  ]: 6 of 7 OK created sql view model sales.fct_order_detail ........................ [[32mSUCCESS 1[0m in 0.59s]
[0m13:55:56.572508 [debug] [Thread-1  ]: Finished running node model.sales.fct_order_detail
[0m13:55:56.573818 [debug] [Thread-1  ]: Began running node model.sales.product_sales
[0m13:55:56.574412 [info ] [Thread-1  ]: 7 of 7 START sql view model sales.product_sales ................................ [RUN]
[0m13:55:56.575365 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.fct_order_detail, now model.sales.product_sales)
[0m13:55:56.575849 [debug] [Thread-1  ]: Began compiling node model.sales.product_sales
[0m13:55:56.580273 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.product_sales"
[0m13:55:56.581748 [debug] [Thread-1  ]: Timing info for model.sales.product_sales (compile): 13:55:56.576163 => 13:55:56.581267
[0m13:55:56.582229 [debug] [Thread-1  ]: Began executing node model.sales.product_sales
[0m13:55:56.586272 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.product_sales"
[0m13:55:56.587727 [debug] [Thread-1  ]: Using snowflake connection "model.sales.product_sales"
[0m13:55:56.588260 [debug] [Thread-1  ]: On model.sales.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.product_sales"} */
create or replace   view external_db.sales.product_sales
  
   as (
    with order_details as (
    select * from external_db.sales.fct_order_detail
), 
customer as (
    select * from external_db.sales.bronze_customers
),
payments as (
    select * from external_db.sales.fct_payment_details
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m13:55:56.588888 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:55:57.059049 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:55:57.063215 [debug] [Thread-1  ]: Timing info for model.sales.product_sales (execute): 13:55:56.582547 => 13:55:57.062874
[0m13:55:57.063790 [debug] [Thread-1  ]: On model.sales.product_sales: Close
[0m13:55:57.177186 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f059760-621c-4d60-97b3-cd49b06b248b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff328c92610>]}
[0m13:55:57.178372 [info ] [Thread-1  ]: 7 of 7 OK created sql view model sales.product_sales ........................... [[32mSUCCESS 1[0m in 0.60s]
[0m13:55:57.179763 [debug] [Thread-1  ]: Finished running node model.sales.product_sales
[0m13:55:57.182058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:57.182539 [debug] [MainThread]: Connection 'list_external_db' was properly closed.
[0m13:55:57.183032 [debug] [MainThread]: Connection 'model.sales.product_sales' was properly closed.
[0m13:55:57.183584 [info ] [MainThread]: 
[0m13:55:57.184229 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 5.55 seconds (5.55s).
[0m13:55:57.187341 [debug] [MainThread]: Command end result
[0m13:55:57.196994 [info ] [MainThread]: 
[0m13:55:57.197772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:57.198338 [info ] [MainThread]: 
[0m13:55:57.199116 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:55:57.200236 [debug] [MainThread]: Command `dbt build` succeeded at 13:55:57.200024 after 6.09 seconds
[0m13:55:57.200798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3321bd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff32c3cd040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff32a999dc0>]}
[0m13:55:57.201472 [debug] [MainThread]: Flushing usage events
[0m13:59:27.263012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f847b4014c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8479cc45e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8479cc4190>]}


============================== 13:59:27.266625 | 3bca4cdb-b193-4a06-a980-c28612d4da27 ==============================
[0m13:59:27.266625 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:59:27.267345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dags/dbt/logs', 'debug': 'False', 'profiles_dir': 'dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:59:27.601902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bca4cdb-b193-4a06-a980-c28612d4da27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84755dc0a0>]}
[0m13:59:27.625359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bca4cdb-b193-4a06-a980-c28612d4da27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84755e10d0>]}
[0m13:59:27.642591 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m13:59:27.670806 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:59:27.671274 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:59:27.672214 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales.bronze
- models.sales.staging
- models.sales.intermediate
[0m13:59:27.680932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bca4cdb-b193-4a06-a980-c28612d4da27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8475460a00>]}
[0m13:59:27.688822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bca4cdb-b193-4a06-a980-c28612d4da27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84754bc8b0>]}
[0m13:59:27.689427 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:59:27.689955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bca4cdb-b193-4a06-a980-c28612d4da27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84754bc970>]}
[0m13:59:27.691842 [info ] [MainThread]: 
[0m13:59:27.692756 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:59:27.697461 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_sales'
[0m13:59:27.715639 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m13:59:27.716216 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m13:59:27.716681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:28.478223 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m13:59:28.482207 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m13:59:28.612074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bca4cdb-b193-4a06-a980-c28612d4da27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8475447850>]}
[0m13:59:28.613317 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:59:28.613972 [info ] [MainThread]: 
[0m13:59:28.619096 [debug] [Thread-1  ]: Began running node model.sales.bronze_customers
[0m13:59:28.620019 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.sales.bronze_customers)
[0m13:59:28.620722 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_customers
[0m13:59:28.626641 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_customers"
[0m13:59:28.627639 [debug] [Thread-1  ]: Timing info for model.sales.bronze_customers (compile): 13:59:28.621121 => 13:59:28.627221
[0m13:59:28.628145 [debug] [Thread-1  ]: Began executing node model.sales.bronze_customers
[0m13:59:28.628766 [debug] [Thread-1  ]: Timing info for model.sales.bronze_customers (execute): 13:59:28.628451 => 13:59:28.628484
[0m13:59:28.629924 [debug] [Thread-1  ]: Finished running node model.sales.bronze_customers
[0m13:59:28.630453 [debug] [Thread-1  ]: Began running node model.sales.bronze_orders
[0m13:59:28.631321 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_customers, now model.sales.bronze_orders)
[0m13:59:28.632242 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_orders
[0m13:59:28.635620 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_orders"
[0m13:59:28.636578 [debug] [Thread-1  ]: Timing info for model.sales.bronze_orders (compile): 13:59:28.632573 => 13:59:28.636277
[0m13:59:28.637208 [debug] [Thread-1  ]: Began executing node model.sales.bronze_orders
[0m13:59:28.637860 [debug] [Thread-1  ]: Timing info for model.sales.bronze_orders (execute): 13:59:28.637549 => 13:59:28.637561
[0m13:59:28.638910 [debug] [Thread-1  ]: Finished running node model.sales.bronze_orders
[0m13:59:28.639429 [debug] [Thread-1  ]: Began running node model.sales.bronze_payments
[0m13:59:28.640340 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_orders, now model.sales.bronze_payments)
[0m13:59:28.640880 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_payments
[0m13:59:28.644071 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_payments"
[0m13:59:28.644872 [debug] [Thread-1  ]: Timing info for model.sales.bronze_payments (compile): 13:59:28.641200 => 13:59:28.644524
[0m13:59:28.645498 [debug] [Thread-1  ]: Began executing node model.sales.bronze_payments
[0m13:59:28.646272 [debug] [Thread-1  ]: Timing info for model.sales.bronze_payments (execute): 13:59:28.645851 => 13:59:28.645890
[0m13:59:28.647365 [debug] [Thread-1  ]: Finished running node model.sales.bronze_payments
[0m13:59:28.648194 [debug] [Thread-1  ]: Began running node model.sales.bronze_products
[0m13:59:28.649155 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_payments, now model.sales.bronze_products)
[0m13:59:28.649776 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_products
[0m13:59:28.653276 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_products"
[0m13:59:28.654480 [debug] [Thread-1  ]: Timing info for model.sales.bronze_products (compile): 13:59:28.650138 => 13:59:28.654183
[0m13:59:28.654967 [debug] [Thread-1  ]: Began executing node model.sales.bronze_products
[0m13:59:28.655612 [debug] [Thread-1  ]: Timing info for model.sales.bronze_products (execute): 13:59:28.655263 => 13:59:28.655275
[0m13:59:28.656980 [debug] [Thread-1  ]: Finished running node model.sales.bronze_products
[0m13:59:28.657525 [debug] [Thread-1  ]: Began running node model.sales.fct_payment_details
[0m13:59:28.658223 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_products, now model.sales.fct_payment_details)
[0m13:59:28.658724 [debug] [Thread-1  ]: Began compiling node model.sales.fct_payment_details
[0m13:59:28.662107 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.fct_payment_details"
[0m13:59:28.662911 [debug] [Thread-1  ]: Timing info for model.sales.fct_payment_details (compile): 13:59:28.659062 => 13:59:28.662589
[0m13:59:28.663355 [debug] [Thread-1  ]: Began executing node model.sales.fct_payment_details
[0m13:59:28.664479 [debug] [Thread-1  ]: Timing info for model.sales.fct_payment_details (execute): 13:59:28.664090 => 13:59:28.664104
[0m13:59:28.666087 [debug] [Thread-1  ]: Finished running node model.sales.fct_payment_details
[0m13:59:28.666912 [debug] [Thread-1  ]: Began running node model.sales.fct_order_detail
[0m13:59:28.667780 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.fct_payment_details, now model.sales.fct_order_detail)
[0m13:59:28.668258 [debug] [Thread-1  ]: Began compiling node model.sales.fct_order_detail
[0m13:59:28.674629 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.fct_order_detail"
[0m13:59:28.675480 [debug] [Thread-1  ]: Timing info for model.sales.fct_order_detail (compile): 13:59:28.668648 => 13:59:28.675161
[0m13:59:28.675983 [debug] [Thread-1  ]: Began executing node model.sales.fct_order_detail
[0m13:59:28.676709 [debug] [Thread-1  ]: Timing info for model.sales.fct_order_detail (execute): 13:59:28.676397 => 13:59:28.676412
[0m13:59:28.677927 [debug] [Thread-1  ]: Finished running node model.sales.fct_order_detail
[0m13:59:28.679228 [debug] [Thread-1  ]: Began running node model.sales.product_sales
[0m13:59:28.680614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.fct_order_detail, now model.sales.product_sales)
[0m13:59:28.681134 [debug] [Thread-1  ]: Began compiling node model.sales.product_sales
[0m13:59:28.684830 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.product_sales"
[0m13:59:28.685669 [debug] [Thread-1  ]: Timing info for model.sales.product_sales (compile): 13:59:28.681457 => 13:59:28.685326
[0m13:59:28.686193 [debug] [Thread-1  ]: Began executing node model.sales.product_sales
[0m13:59:28.686988 [debug] [Thread-1  ]: Timing info for model.sales.product_sales (execute): 13:59:28.686642 => 13:59:28.686655
[0m13:59:28.688122 [debug] [Thread-1  ]: Finished running node model.sales.product_sales
[0m13:59:28.689282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:28.690161 [debug] [MainThread]: Connection 'model.sales.product_sales' was properly closed.
[0m13:59:28.692081 [debug] [MainThread]: Command end result
[0m13:59:28.701325 [debug] [MainThread]: Command `dbt compile` succeeded at 13:59:28.701026 after 1.46 seconds
[0m13:59:28.701898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f847b4014c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84755e10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8475447f10>]}
[0m13:59:28.702412 [debug] [MainThread]: Flushing usage events
[0m14:09:45.207072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9189123580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9187a24640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9187a24310>]}


============================== 14:09:45.211165 | 287098b6-ded9-49c4-b6b0-c73e31a8fc60 ==============================
[0m14:09:45.211165 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:09:45.211907 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dags/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:09:45.542119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '287098b6-ded9-49c4-b6b0-c73e31a8fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91832f0d00>]}
[0m14:09:45.563257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '287098b6-ded9-49c4-b6b0-c73e31a8fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9183315610>]}
[0m14:09:45.580117 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:09:45.607106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:09:45.607691 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:09:45.608515 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales.staging
- models.sales.intermediate
- models.sales.bronze
[0m14:09:45.616277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '287098b6-ded9-49c4-b6b0-c73e31a8fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9182177af0>]}
[0m14:09:45.625166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '287098b6-ded9-49c4-b6b0-c73e31a8fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91821d29d0>]}
[0m14:09:45.625703 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:09:45.627567 [info ] [MainThread]: 
[0m14:09:45.628448 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:09:45.630378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m14:09:45.648933 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m14:09:45.649364 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m14:09:45.649993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:46.603288 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:09:46.606893 [debug] [ThreadPool]: On list_external_db: Close
[0m14:09:46.722678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_sales)
[0m14:09:46.733273 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m14:09:46.733770 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m14:09:46.734224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:47.205963 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:09:47.208490 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m14:09:47.306419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '287098b6-ded9-49c4-b6b0-c73e31a8fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f91821d23d0>]}
[0m14:09:47.307702 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:09:47.308344 [info ] [MainThread]: 
[0m14:09:47.315380 [debug] [Thread-1  ]: Began running node model.sales.bronze_customers
[0m14:09:47.316141 [info ] [Thread-1  ]: 1 of 7 START sql view model sales.bronze_customers ............................. [RUN]
[0m14:09:47.317151 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.sales.bronze_customers)
[0m14:09:47.317730 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_customers
[0m14:09:47.322655 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_customers"
[0m14:09:47.323789 [debug] [Thread-1  ]: Timing info for model.sales.bronze_customers (compile): 14:09:47.318179 => 14:09:47.323359
[0m14:09:47.324399 [debug] [Thread-1  ]: Began executing node model.sales.bronze_customers
[0m14:09:47.370057 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.bronze_customers"
[0m14:09:47.371372 [debug] [Thread-1  ]: Using snowflake connection "model.sales.bronze_customers"
[0m14:09:47.371945 [debug] [Thread-1  ]: On model.sales.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.bronze_customers"} */
create or replace   view external_db.sales.bronze_customers
  
   as (
    with customers as (
     select * from external_db.stage.customers
)

select * from customers
  );
[0m14:09:47.372443 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:09:47.776086 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:09:47.807600 [debug] [Thread-1  ]: Timing info for model.sales.bronze_customers (execute): 14:09:47.324742 => 14:09:47.807271
[0m14:09:47.808195 [debug] [Thread-1  ]: On model.sales.bronze_customers: Close
[0m14:09:47.914180 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '287098b6-ded9-49c4-b6b0-c73e31a8fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f918140f130>]}
[0m14:09:47.915192 [info ] [Thread-1  ]: 1 of 7 OK created sql view model sales.bronze_customers ........................ [[32mSUCCESS 1[0m in 0.60s]
[0m14:09:47.916355 [debug] [Thread-1  ]: Finished running node model.sales.bronze_customers
[0m14:09:47.917022 [debug] [Thread-1  ]: Began running node model.sales.bronze_orders
[0m14:09:47.917678 [info ] [Thread-1  ]: 2 of 7 START sql view model sales.bronze_orders ................................ [RUN]
[0m14:09:47.919108 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_customers, now model.sales.bronze_orders)
[0m14:09:47.919747 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_orders
[0m14:09:47.923965 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_orders"
[0m14:09:47.924949 [debug] [Thread-1  ]: Timing info for model.sales.bronze_orders (compile): 14:09:47.920090 => 14:09:47.924511
[0m14:09:47.925602 [debug] [Thread-1  ]: Began executing node model.sales.bronze_orders
[0m14:09:47.929943 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.bronze_orders"
[0m14:09:47.930922 [debug] [Thread-1  ]: Using snowflake connection "model.sales.bronze_orders"
[0m14:09:47.931388 [debug] [Thread-1  ]: On model.sales.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.bronze_orders"} */
create or replace   view external_db.sales.bronze_orders
  
   as (
    with orders as (
     select * from external_db.stage.orders
)

select * from orders
  );
[0m14:09:47.931906 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:09:48.320797 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:09:48.325423 [debug] [Thread-1  ]: Timing info for model.sales.bronze_orders (execute): 14:09:47.926133 => 14:09:48.325125
[0m14:09:48.326037 [debug] [Thread-1  ]: On model.sales.bronze_orders: Close
[0m14:09:48.448648 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '287098b6-ded9-49c4-b6b0-c73e31a8fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9181418250>]}
[0m14:09:48.449933 [info ] [Thread-1  ]: 2 of 7 OK created sql view model sales.bronze_orders ........................... [[32mSUCCESS 1[0m in 0.53s]
[0m14:09:48.451018 [debug] [Thread-1  ]: Finished running node model.sales.bronze_orders
[0m14:09:48.451669 [debug] [Thread-1  ]: Began running node model.sales.bronze_payments
[0m14:09:48.452441 [info ] [Thread-1  ]: 3 of 7 START sql view model sales.bronze_payments .............................. [RUN]
[0m14:09:48.453681 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_orders, now model.sales.bronze_payments)
[0m14:09:48.454347 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_payments
[0m14:09:48.458612 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_payments"
[0m14:09:48.459608 [debug] [Thread-1  ]: Timing info for model.sales.bronze_payments (compile): 14:09:48.454800 => 14:09:48.459212
[0m14:09:48.460230 [debug] [Thread-1  ]: Began executing node model.sales.bronze_payments
[0m14:09:48.464848 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.bronze_payments"
[0m14:09:48.466226 [debug] [Thread-1  ]: Using snowflake connection "model.sales.bronze_payments"
[0m14:09:48.466903 [debug] [Thread-1  ]: On model.sales.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.bronze_payments"} */
create or replace   view external_db.sales.bronze_payments
  
   as (
    with payments as (
     select * from external_db.stage.payments
)

select * from payments
  );
[0m14:09:48.467481 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:09:48.848603 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:09:48.853187 [debug] [Thread-1  ]: Timing info for model.sales.bronze_payments (execute): 14:09:48.460605 => 14:09:48.852888
[0m14:09:48.853770 [debug] [Thread-1  ]: On model.sales.bronze_payments: Close
[0m14:09:48.959423 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '287098b6-ded9-49c4-b6b0-c73e31a8fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f918151d8e0>]}
[0m14:09:48.960705 [info ] [Thread-1  ]: 3 of 7 OK created sql view model sales.bronze_payments ......................... [[32mSUCCESS 1[0m in 0.51s]
[0m14:09:48.962099 [debug] [Thread-1  ]: Finished running node model.sales.bronze_payments
[0m14:09:48.963127 [debug] [Thread-1  ]: Began running node model.sales.bronze_products
[0m14:09:48.963946 [info ] [Thread-1  ]: 4 of 7 START sql view model sales.bronze_products .............................. [RUN]
[0m14:09:48.965508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_payments, now model.sales.bronze_products)
[0m14:09:48.966060 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_products
[0m14:09:48.972722 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_products"
[0m14:09:48.974282 [debug] [Thread-1  ]: Timing info for model.sales.bronze_products (compile): 14:09:48.966483 => 14:09:48.973858
[0m14:09:48.974921 [debug] [Thread-1  ]: Began executing node model.sales.bronze_products
[0m14:09:48.980429 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.bronze_products"
[0m14:09:48.982155 [debug] [Thread-1  ]: Using snowflake connection "model.sales.bronze_products"
[0m14:09:48.982881 [debug] [Thread-1  ]: On model.sales.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.bronze_products"} */
create or replace   view external_db.sales.bronze_products
  
   as (
    with products as (
     select * from external_db.stage.products
)

select * from products
  );
[0m14:09:48.983493 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:09:49.368682 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:09:49.373517 [debug] [Thread-1  ]: Timing info for model.sales.bronze_products (execute): 14:09:48.975348 => 14:09:49.373213
[0m14:09:49.374052 [debug] [Thread-1  ]: On model.sales.bronze_products: Close
[0m14:09:49.480535 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '287098b6-ded9-49c4-b6b0-c73e31a8fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9180375ee0>]}
[0m14:09:49.481827 [info ] [Thread-1  ]: 4 of 7 OK created sql view model sales.bronze_products ......................... [[32mSUCCESS 1[0m in 0.52s]
[0m14:09:49.483398 [debug] [Thread-1  ]: Finished running node model.sales.bronze_products
[0m14:09:49.484406 [debug] [Thread-1  ]: Began running node model.sales.fct_payment_details
[0m14:09:49.485086 [info ] [Thread-1  ]: 5 of 7 START sql view model sales.fct_payment_details .......................... [RUN]
[0m14:09:49.486072 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_products, now model.sales.fct_payment_details)
[0m14:09:49.486577 [debug] [Thread-1  ]: Began compiling node model.sales.fct_payment_details
[0m14:09:49.492979 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.fct_payment_details"
[0m14:09:49.494571 [debug] [Thread-1  ]: Timing info for model.sales.fct_payment_details (compile): 14:09:49.486913 => 14:09:49.494215
[0m14:09:49.495190 [debug] [Thread-1  ]: Began executing node model.sales.fct_payment_details
[0m14:09:49.499845 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.fct_payment_details"
[0m14:09:49.501207 [debug] [Thread-1  ]: Using snowflake connection "model.sales.fct_payment_details"
[0m14:09:49.501728 [debug] [Thread-1  ]: On model.sales.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.fct_payment_details"} */
create or replace   view external_db.sales.fct_payment_details
  
   as (
    with payments as (
    select * from external_db.sales.bronze_payments
),

final as(
    select 
    payment_id,
    payment_method,
    order_id

    from payments where status = 'success'
)

select * from final
  );
[0m14:09:49.502223 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:09:49.933483 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:09:49.937497 [debug] [Thread-1  ]: Timing info for model.sales.fct_payment_details (execute): 14:09:49.495664 => 14:09:49.937207
[0m14:09:49.937995 [debug] [Thread-1  ]: On model.sales.fct_payment_details: Close
[0m14:09:50.038955 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '287098b6-ded9-49c4-b6b0-c73e31a8fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9181418610>]}
[0m14:09:50.040116 [info ] [Thread-1  ]: 5 of 7 OK created sql view model sales.fct_payment_details ..................... [[32mSUCCESS 1[0m in 0.55s]
[0m14:09:50.041451 [debug] [Thread-1  ]: Finished running node model.sales.fct_payment_details
[0m14:09:50.042282 [debug] [Thread-1  ]: Began running node model.sales.fct_order_detail
[0m14:09:50.043094 [info ] [Thread-1  ]: 6 of 7 START sql view model sales.fct_order_detail ............................. [RUN]
[0m14:09:50.044039 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.fct_payment_details, now model.sales.fct_order_detail)
[0m14:09:50.044542 [debug] [Thread-1  ]: Began compiling node model.sales.fct_order_detail
[0m14:09:50.049018 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.fct_order_detail"
[0m14:09:50.050081 [debug] [Thread-1  ]: Timing info for model.sales.fct_order_detail (compile): 14:09:50.044918 => 14:09:50.049573
[0m14:09:50.050662 [debug] [Thread-1  ]: Began executing node model.sales.fct_order_detail
[0m14:09:50.056949 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.fct_order_detail"
[0m14:09:50.058444 [debug] [Thread-1  ]: Using snowflake connection "model.sales.fct_order_detail"
[0m14:09:50.058969 [debug] [Thread-1  ]: On model.sales.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.fct_order_detail"} */
create or replace   view external_db.sales.fct_order_detail
  
   as (
    with orders as (
    select * from external_db.sales.bronze_orders
),
products as (
    select * from external_db.sales.bronze_products
), 

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m14:09:50.059490 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:09:50.514038 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:09:50.519044 [debug] [Thread-1  ]: Timing info for model.sales.fct_order_detail (execute): 14:09:50.051078 => 14:09:50.518637
[0m14:09:50.519665 [debug] [Thread-1  ]: On model.sales.fct_order_detail: Close
[0m14:09:50.631839 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '287098b6-ded9-49c4-b6b0-c73e31a8fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9182177be0>]}
[0m14:09:50.632964 [info ] [Thread-1  ]: 6 of 7 OK created sql view model sales.fct_order_detail ........................ [[32mSUCCESS 1[0m in 0.59s]
[0m14:09:50.634044 [debug] [Thread-1  ]: Finished running node model.sales.fct_order_detail
[0m14:09:50.635491 [debug] [Thread-1  ]: Began running node model.sales.product_sales
[0m14:09:50.636233 [info ] [Thread-1  ]: 7 of 7 START sql view model sales.product_sales ................................ [RUN]
[0m14:09:50.637463 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.fct_order_detail, now model.sales.product_sales)
[0m14:09:50.638065 [debug] [Thread-1  ]: Began compiling node model.sales.product_sales
[0m14:09:50.643467 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.product_sales"
[0m14:09:50.644524 [debug] [Thread-1  ]: Timing info for model.sales.product_sales (compile): 14:09:50.638739 => 14:09:50.644114
[0m14:09:50.645045 [debug] [Thread-1  ]: Began executing node model.sales.product_sales
[0m14:09:50.649678 [debug] [Thread-1  ]: Writing runtime sql for node "model.sales.product_sales"
[0m14:09:50.651385 [debug] [Thread-1  ]: Using snowflake connection "model.sales.product_sales"
[0m14:09:50.651883 [debug] [Thread-1  ]: On model.sales.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.sales.product_sales"} */
create or replace   view external_db.sales.product_sales
  
   as (
    with order_details as (
    select * from external_db.sales.fct_order_detail
), 
customer as (
    select * from external_db.sales.bronze_customers
),
payments as (
    select * from external_db.sales.fct_payment_details
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m14:09:50.652569 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:09:51.143516 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:09:51.147963 [debug] [Thread-1  ]: Timing info for model.sales.product_sales (execute): 14:09:50.645377 => 14:09:51.147659
[0m14:09:51.148486 [debug] [Thread-1  ]: On model.sales.product_sales: Close
[0m14:09:51.245628 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '287098b6-ded9-49c4-b6b0-c73e31a8fc60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f918154ae80>]}
[0m14:09:51.246742 [info ] [Thread-1  ]: 7 of 7 OK created sql view model sales.product_sales ........................... [[32mSUCCESS 1[0m in 0.61s]
[0m14:09:51.247738 [debug] [Thread-1  ]: Finished running node model.sales.product_sales
[0m14:09:51.250126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:51.250610 [debug] [MainThread]: Connection 'model.sales.product_sales' was properly closed.
[0m14:09:51.251161 [info ] [MainThread]: 
[0m14:09:51.251808 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m14:09:51.254390 [debug] [MainThread]: Command end result
[0m14:09:51.265643 [info ] [MainThread]: 
[0m14:09:51.266687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:09:51.267245 [info ] [MainThread]: 
[0m14:09:51.267809 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m14:09:51.269062 [debug] [MainThread]: Command `dbt build` succeeded at 14:09:51.268793 after 6.08 seconds
[0m14:09:51.269627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9189123580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9183315610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f918036b5b0>]}
[0m14:09:51.270159 [debug] [MainThread]: Flushing usage events
[0m14:11:05.157022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69af914c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6998947c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6998940a0>]}


============================== 14:11:05.160643 | 1bf5b51b-c4da-4d86-a1e5-c6be3eb1e4aa ==============================
[0m14:11:05.160643 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:11:05.161410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dags/dbt/logs', 'profiles_dir': 'dags/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:11:05.488377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bf5b51b-c4da-4d86-a1e5-c6be3eb1e4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe695182d90>]}
[0m14:11:05.509530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bf5b51b-c4da-4d86-a1e5-c6be3eb1e4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6951821f0>]}
[0m14:11:05.526364 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:11:05.556015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:05.556500 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:05.557585 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.sales.bronze
- models.sales.staging
- models.sales.intermediate
[0m14:11:05.566260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bf5b51b-c4da-4d86-a1e5-c6be3eb1e4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe693ff8a90>]}
[0m14:11:05.568299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bf5b51b-c4da-4d86-a1e5-c6be3eb1e4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe695060940>]}
[0m14:11:05.569090 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:11:05.569683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bf5b51b-c4da-4d86-a1e5-c6be3eb1e4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6950609a0>]}
[0m14:11:05.571664 [info ] [MainThread]: 
[0m14:11:05.572737 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:11:05.575420 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_sales'
[0m14:11:05.594467 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m14:11:05.595072 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m14:11:05.595768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:06.309735 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:11:06.313334 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m14:11:06.422288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bf5b51b-c4da-4d86-a1e5-c6be3eb1e4aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe693fdb8e0>]}
[0m14:11:06.423945 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:11:06.425302 [info ] [MainThread]: 
[0m14:11:06.433141 [debug] [Thread-1  ]: Began running node model.sales.bronze_customers
[0m14:11:06.434062 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.sales.bronze_customers)
[0m14:11:06.434716 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_customers
[0m14:11:06.440365 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_customers"
[0m14:11:06.441306 [debug] [Thread-1  ]: Timing info for model.sales.bronze_customers (compile): 14:11:06.435116 => 14:11:06.440946
[0m14:11:06.442145 [debug] [Thread-1  ]: Began executing node model.sales.bronze_customers
[0m14:11:06.442838 [debug] [Thread-1  ]: Timing info for model.sales.bronze_customers (execute): 14:11:06.442479 => 14:11:06.442514
[0m14:11:06.444264 [debug] [Thread-1  ]: Finished running node model.sales.bronze_customers
[0m14:11:06.444871 [debug] [Thread-1  ]: Began running node model.sales.bronze_orders
[0m14:11:06.445690 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_customers, now model.sales.bronze_orders)
[0m14:11:06.446239 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_orders
[0m14:11:06.450168 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_orders"
[0m14:11:06.451053 [debug] [Thread-1  ]: Timing info for model.sales.bronze_orders (compile): 14:11:06.446657 => 14:11:06.450708
[0m14:11:06.451867 [debug] [Thread-1  ]: Began executing node model.sales.bronze_orders
[0m14:11:06.452664 [debug] [Thread-1  ]: Timing info for model.sales.bronze_orders (execute): 14:11:06.452282 => 14:11:06.452294
[0m14:11:06.454078 [debug] [Thread-1  ]: Finished running node model.sales.bronze_orders
[0m14:11:06.454761 [debug] [Thread-1  ]: Began running node model.sales.bronze_payments
[0m14:11:06.455682 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_orders, now model.sales.bronze_payments)
[0m14:11:06.456291 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_payments
[0m14:11:06.459884 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_payments"
[0m14:11:06.461043 [debug] [Thread-1  ]: Timing info for model.sales.bronze_payments (compile): 14:11:06.456692 => 14:11:06.460692
[0m14:11:06.461600 [debug] [Thread-1  ]: Began executing node model.sales.bronze_payments
[0m14:11:06.462305 [debug] [Thread-1  ]: Timing info for model.sales.bronze_payments (execute): 14:11:06.461995 => 14:11:06.462007
[0m14:11:06.463487 [debug] [Thread-1  ]: Finished running node model.sales.bronze_payments
[0m14:11:06.464529 [debug] [Thread-1  ]: Began running node model.sales.bronze_products
[0m14:11:06.465601 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_payments, now model.sales.bronze_products)
[0m14:11:06.466232 [debug] [Thread-1  ]: Began compiling node model.sales.bronze_products
[0m14:11:06.469980 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.bronze_products"
[0m14:11:06.470793 [debug] [Thread-1  ]: Timing info for model.sales.bronze_products (compile): 14:11:06.466652 => 14:11:06.470487
[0m14:11:06.471288 [debug] [Thread-1  ]: Began executing node model.sales.bronze_products
[0m14:11:06.471901 [debug] [Thread-1  ]: Timing info for model.sales.bronze_products (execute): 14:11:06.471609 => 14:11:06.471621
[0m14:11:06.473012 [debug] [Thread-1  ]: Finished running node model.sales.bronze_products
[0m14:11:06.473569 [debug] [Thread-1  ]: Began running node model.sales.fct_payment_details
[0m14:11:06.474493 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.bronze_products, now model.sales.fct_payment_details)
[0m14:11:06.475118 [debug] [Thread-1  ]: Began compiling node model.sales.fct_payment_details
[0m14:11:06.479115 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.fct_payment_details"
[0m14:11:06.479996 [debug] [Thread-1  ]: Timing info for model.sales.fct_payment_details (compile): 14:11:06.475593 => 14:11:06.479675
[0m14:11:06.480549 [debug] [Thread-1  ]: Began executing node model.sales.fct_payment_details
[0m14:11:06.481258 [debug] [Thread-1  ]: Timing info for model.sales.fct_payment_details (execute): 14:11:06.480861 => 14:11:06.480872
[0m14:11:06.482452 [debug] [Thread-1  ]: Finished running node model.sales.fct_payment_details
[0m14:11:06.483013 [debug] [Thread-1  ]: Began running node model.sales.fct_order_detail
[0m14:11:06.483826 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.fct_payment_details, now model.sales.fct_order_detail)
[0m14:11:06.484328 [debug] [Thread-1  ]: Began compiling node model.sales.fct_order_detail
[0m14:11:06.488298 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.fct_order_detail"
[0m14:11:06.489109 [debug] [Thread-1  ]: Timing info for model.sales.fct_order_detail (compile): 14:11:06.484639 => 14:11:06.488785
[0m14:11:06.489626 [debug] [Thread-1  ]: Began executing node model.sales.fct_order_detail
[0m14:11:06.490273 [debug] [Thread-1  ]: Timing info for model.sales.fct_order_detail (execute): 14:11:06.489937 => 14:11:06.489949
[0m14:11:06.491469 [debug] [Thread-1  ]: Finished running node model.sales.fct_order_detail
[0m14:11:06.492632 [debug] [Thread-1  ]: Began running node model.sales.product_sales
[0m14:11:06.493389 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.sales.fct_order_detail, now model.sales.product_sales)
[0m14:11:06.493892 [debug] [Thread-1  ]: Began compiling node model.sales.product_sales
[0m14:11:06.498264 [debug] [Thread-1  ]: Writing injected SQL for node "model.sales.product_sales"
[0m14:11:06.499076 [debug] [Thread-1  ]: Timing info for model.sales.product_sales (compile): 14:11:06.494299 => 14:11:06.498773
[0m14:11:06.499583 [debug] [Thread-1  ]: Began executing node model.sales.product_sales
[0m14:11:06.500248 [debug] [Thread-1  ]: Timing info for model.sales.product_sales (execute): 14:11:06.499902 => 14:11:06.499913
[0m14:11:06.501776 [debug] [Thread-1  ]: Finished running node model.sales.product_sales
[0m14:11:06.503036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:06.503475 [debug] [MainThread]: Connection 'model.sales.product_sales' was properly closed.
[0m14:11:06.505638 [debug] [MainThread]: Command end result
[0m14:11:06.552699 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m14:11:06.553367 [info ] [MainThread]: Building catalog
[0m14:11:06.557549 [debug] [ThreadPool]: Acquiring new snowflake connection 'external_db.information_schema'
[0m14:11:06.569021 [debug] [ThreadPool]: Using snowflake connection "external_db.information_schema"
[0m14:11:06.569628 [debug] [ThreadPool]: On external_db.information_schema: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "external_db.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from external_db.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from external_db.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('stage') or upper("table_schema") = upper('sales'))
      order by "column_index"
[0m14:11:06.570174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:09.394887 [debug] [ThreadPool]: SQL status: SUCCESS 36 in 3.0 seconds
[0m14:11:09.469748 [debug] [ThreadPool]: On external_db.information_schema: Close
[0m14:11:09.586992 [info ] [MainThread]: Catalog written to /home/satyam/airflow/target/catalog.json
[0m14:11:09.588714 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:11:09.588510 after 4.45 seconds
[0m14:11:09.589286 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:11:09.589700 [debug] [MainThread]: Connection 'external_db.information_schema' was properly closed.
[0m14:11:09.590181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe69af914c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6951821f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe693fdbe80>]}
[0m14:11:09.590734 [debug] [MainThread]: Flushing usage events
[0m14:11:51.364832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92bca94520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92bb3725e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92bb3721c0>]}


============================== 14:11:51.368485 | da470379-0fb9-4826-84a5-8c1fb4a2415b ==============================
[0m14:11:51.368485 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:11:51.369193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:11:51.684690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da470379-0fb9-4826-84a5-8c1fb4a2415b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92b5bb6130>]}
[0m14:11:51.707633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da470379-0fb9-4826-84a5-8c1fb4a2415b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92b5bb73a0>]}
[0m14:11:52.036271 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m14:11:52.047813 [error] [MainThread]: Traceback (most recent call last):
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 299, in docs_serve
    results = task.run()
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
  File "/usr/lib/python3.8/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/lib/python3.8/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m14:11:52.049612 [debug] [MainThread]: Command `dbt docs serve` failed at 14:11:52.049329 after 0.71 seconds
[0m14:11:52.050439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92bca94520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92b5bb24f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92b5bb2d90>]}
[0m14:11:52.051261 [debug] [MainThread]: Flushing usage events
[0m14:12:02.069265 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m14:12:53.770798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd636a2f460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6353195b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6353190d0>]}


============================== 14:12:53.774425 | 27a1c493-9bf1-4aa4-a8e0-82d5ebe686f5 ==============================
[0m14:12:53.774425 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:12:53.775247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dags/dbt/logs', 'debug': 'False', 'profiles_dir': 'dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:12:54.082582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27a1c493-9bf1-4aa4-a8e0-82d5ebe686f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62fb35d90>]}
[0m14:12:54.105136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27a1c493-9bf1-4aa4-a8e0-82d5ebe686f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd62fb355e0>]}
[0m14:19:28.561173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ff542490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fde45640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3fde45280>]}


============================== 14:19:28.564823 | 4408181a-2155-4c31-8b7d-dc225819d3e1 ==============================
[0m14:19:28.564823 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:19:28.565698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dags/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:19:28.882313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4408181a-2155-4c31-8b7d-dc225819d3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f972c0a0>]}
[0m14:19:28.906015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4408181a-2155-4c31-8b7d-dc225819d3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f9735070>]}
[0m14:19:28.924597 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:19:28.934718 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m14:19:28.935338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4408181a-2155-4c31-8b7d-dc225819d3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f96eadc0>]}
[0m14:19:29.862402 [debug] [MainThread]: 1699: static parser successfully parsed sales/intermediate/fct_order_detail.sql
[0m14:19:29.880853 [debug] [MainThread]: 1699: static parser successfully parsed sales/intermediate/fct_payment_details.sql
[0m14:19:29.886102 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_orders.sql
[0m14:19:29.891172 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_payments.sql
[0m14:19:29.897170 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_customers.sql
[0m14:19:29.902297 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_products.sql
[0m14:19:29.908613 [debug] [MainThread]: 1699: static parser successfully parsed sales/core/product_sales.sql
[0m14:19:29.986590 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m14:19:29.993168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4408181a-2155-4c31-8b7d-dc225819d3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f9689b80>]}
[0m14:19:30.001826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4408181a-2155-4c31-8b7d-dc225819d3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f808ad30>]}
[0m14:19:30.002576 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:19:30.004672 [info ] [MainThread]: 
[0m14:19:30.005833 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:19:30.008427 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m14:19:30.075145 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m14:19:30.075915 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m14:19:30.076489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:30.858966 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:19:30.862775 [debug] [ThreadPool]: On list_external_db: Close
[0m14:19:30.963269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_sales)
[0m14:19:30.975712 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m14:19:30.976378 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m14:19:30.976971 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:31.461768 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:19:31.464639 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m14:19:31.580776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4408181a-2155-4c31-8b7d-dc225819d3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f80fea00>]}
[0m14:19:31.582258 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:19:31.582860 [info ] [MainThread]: 
[0m14:19:31.588804 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m14:19:31.589772 [info ] [Thread-1  ]: 1 of 7 START sql view model sales.bronze_customers ............................. [RUN]
[0m14:19:31.591708 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_customers)
[0m14:19:31.592378 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m14:19:31.597075 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m14:19:31.598833 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 14:19:31.592846 => 14:19:31.598434
[0m14:19:31.599486 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m14:19:31.641717 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m14:19:31.643357 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m14:19:31.643976 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace   view external_db.sales.bronze_customers
  
   as (
    with customers as (
     select * from external_db.stage.customers
)

select * from customers
  );
[0m14:19:31.644548 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:19:32.152657 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:19:32.186457 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 14:19:31.599894 => 14:19:32.186022
[0m14:19:32.187150 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m14:19:32.303537 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4408181a-2155-4c31-8b7d-dc225819d3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3eb3aa550>]}
[0m14:19:32.304720 [info ] [Thread-1  ]: 1 of 7 OK created sql view model sales.bronze_customers ........................ [[32mSUCCESS 1[0m in 0.71s]
[0m14:19:32.306074 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m14:19:32.306787 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m14:19:32.307884 [info ] [Thread-1  ]: 2 of 7 START sql view model sales.bronze_orders ................................ [RUN]
[0m14:19:32.308821 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m14:19:32.309389 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m14:19:32.313401 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m14:19:32.314355 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 14:19:32.309713 => 14:19:32.313942
[0m14:19:32.314971 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m14:19:32.321118 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m14:19:32.322312 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m14:19:32.322940 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace   view external_db.sales.bronze_orders
  
   as (
    with orders as (
     select * from external_db.stage.orders
)

select * from orders
  );
[0m14:19:32.323649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:19:32.761298 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:19:32.766450 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 14:19:32.315334 => 14:19:32.766121
[0m14:19:32.767086 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m14:19:32.888096 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4408181a-2155-4c31-8b7d-dc225819d3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3eb3a54c0>]}
[0m14:19:32.889282 [info ] [Thread-1  ]: 2 of 7 OK created sql view model sales.bronze_orders ........................... [[32mSUCCESS 1[0m in 0.58s]
[0m14:19:32.890238 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m14:19:32.890899 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m14:19:32.891565 [info ] [Thread-1  ]: 3 of 7 START sql view model sales.bronze_payments .............................. [RUN]
[0m14:19:32.892527 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m14:19:32.893529 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m14:19:32.898351 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m14:19:32.899224 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 14:19:32.894316 => 14:19:32.898898
[0m14:19:32.899734 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m14:19:32.903912 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m14:19:32.904978 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m14:19:32.905496 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace   view external_db.sales.bronze_payments
  
   as (
    with payments as (
     select * from external_db.stage.payments
)

select * from payments
  );
[0m14:19:32.906038 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:19:33.331741 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:19:33.336354 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 14:19:32.900210 => 14:19:33.336030
[0m14:19:33.337140 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m14:19:33.455158 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4408181a-2155-4c31-8b7d-dc225819d3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f9669e20>]}
[0m14:19:33.456214 [info ] [Thread-1  ]: 3 of 7 OK created sql view model sales.bronze_payments ......................... [[32mSUCCESS 1[0m in 0.56s]
[0m14:19:33.457284 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m14:19:33.458024 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m14:19:33.458711 [info ] [Thread-1  ]: 4 of 7 START sql view model sales.bronze_products .............................. [RUN]
[0m14:19:33.459622 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m14:19:33.460106 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m14:19:33.464948 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m14:19:33.466012 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 14:19:33.460495 => 14:19:33.465654
[0m14:19:33.466572 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m14:19:33.470671 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m14:19:33.473439 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m14:19:33.473992 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace   view external_db.sales.bronze_products
  
   as (
    with products as (
     select * from external_db.stage.products
)

select * from products
  );
[0m14:19:33.474513 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:19:33.893034 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:19:33.897569 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 14:19:33.466930 => 14:19:33.897258
[0m14:19:33.898159 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m14:19:34.011488 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4408181a-2155-4c31-8b7d-dc225819d3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3eb3aa550>]}
[0m14:19:34.012670 [info ] [Thread-1  ]: 4 of 7 OK created sql view model sales.bronze_products ......................... [[32mSUCCESS 1[0m in 0.55s]
[0m14:19:34.014024 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m14:19:34.014633 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m14:19:34.015284 [info ] [Thread-1  ]: 5 of 7 START sql view model sales.fct_payment_details .......................... [RUN]
[0m14:19:34.016137 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m14:19:34.016622 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m14:19:34.021604 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m14:19:34.022904 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 14:19:34.017050 => 14:19:34.022480
[0m14:19:34.023397 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m14:19:34.027811 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m14:19:34.029116 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m14:19:34.029636 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace   view external_db.sales.fct_payment_details
  
   as (
    with payments as (
    select * from external_db.sales.bronze_payments
),

final as(
    select 
    payment_id,
    payment_method,
    order_id

    from payments where status = 'success'
)

select * from final
  );
[0m14:19:34.030370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:19:34.477179 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:19:34.482006 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 14:19:34.023724 => 14:19:34.481673
[0m14:19:34.482558 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m14:19:34.590650 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4408181a-2155-4c31-8b7d-dc225819d3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3e9b039a0>]}
[0m14:19:34.591856 [info ] [Thread-1  ]: 5 of 7 OK created sql view model sales.fct_payment_details ..................... [[32mSUCCESS 1[0m in 0.57s]
[0m14:19:34.593239 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m14:19:34.593900 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m14:19:34.594673 [info ] [Thread-1  ]: 6 of 7 START sql view model sales.fct_order_detail ............................. [RUN]
[0m14:19:34.595685 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m14:19:34.596190 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m14:19:34.602520 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m14:19:34.603454 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 14:19:34.596520 => 14:19:34.603149
[0m14:19:34.603973 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m14:19:34.608446 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m14:19:34.609757 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m14:19:34.610357 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace   view external_db.sales.fct_order_detail
  
   as (
    with orders as (
    select * from external_db.sales.bronze_orders
),
products as (
    select * from external_db.sales.bronze_products
), 

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m14:19:34.610858 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:19:35.106180 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:19:35.110135 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 14:19:34.604352 => 14:19:35.109869
[0m14:19:35.110786 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m14:19:35.223828 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4408181a-2155-4c31-8b7d-dc225819d3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3eb4e3790>]}
[0m14:19:35.224825 [info ] [Thread-1  ]: 6 of 7 OK created sql view model sales.fct_order_detail ........................ [[32mSUCCESS 1[0m in 0.63s]
[0m14:19:35.226284 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m14:19:35.227719 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m14:19:35.228338 [info ] [Thread-1  ]: 7 of 7 START sql view model sales.product_sales ................................ [RUN]
[0m14:19:35.229585 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m14:19:35.230246 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m14:19:35.234911 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m14:19:35.236033 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 14:19:35.230624 => 14:19:35.235646
[0m14:19:35.236605 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m14:19:35.240958 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m14:19:35.242484 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m14:19:35.243022 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace   view external_db.sales.product_sales
  
   as (
    with order_details as (
    select * from external_db.sales.fct_order_detail
), 
customer as (
    select * from external_db.sales.bronze_customers
),
payments as (
    select * from external_db.sales.fct_payment_details
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m14:19:35.243647 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:19:35.782901 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:19:35.787666 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 14:19:35.236944 => 14:19:35.787339
[0m14:19:35.788258 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m14:19:35.902051 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4408181a-2155-4c31-8b7d-dc225819d3e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3eb38bcd0>]}
[0m14:19:35.903220 [info ] [Thread-1  ]: 7 of 7 OK created sql view model sales.product_sales ........................... [[32mSUCCESS 1[0m in 0.67s]
[0m14:19:35.905000 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m14:19:35.907480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:35.907979 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m14:19:35.908475 [info ] [MainThread]: 
[0m14:19:35.909405 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 5.90 seconds (5.90s).
[0m14:19:35.912192 [debug] [MainThread]: Command end result
[0m14:19:35.921622 [info ] [MainThread]: 
[0m14:19:35.922205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:19:35.922752 [info ] [MainThread]: 
[0m14:19:35.923387 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m14:19:35.924606 [debug] [MainThread]: Command `dbt build` succeeded at 14:19:35.924407 after 7.38 seconds
[0m14:19:35.925382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3ff542490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f812ef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3f85bef10>]}
[0m14:19:35.925991 [debug] [MainThread]: Flushing usage events
[0m14:23:49.941168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a3b18490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a23f65b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a23f6190>]}


============================== 14:23:49.944704 | be03e33d-fb2d-441b-b320-e79e9af127f0 ==============================
[0m14:23:49.944704 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:23:49.945565 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'dags/dbt', 'log_path': 'dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:23:50.264800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be03e33d-fb2d-441b-b320-e79e9af127f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb39dd08100>]}
[0m14:23:50.288670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be03e33d-fb2d-441b-b320-e79e9af127f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb39dd120a0>]}
[0m14:23:50.306826 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:23:50.336410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:50.336960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:50.337932 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.bronze
- models.development.staging
[0m14:23:50.347799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be03e33d-fb2d-441b-b320-e79e9af127f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb39cb76940>]}
[0m14:23:50.356390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be03e33d-fb2d-441b-b320-e79e9af127f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb39cbcb7f0>]}
[0m14:23:50.357058 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:23:50.357571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be03e33d-fb2d-441b-b320-e79e9af127f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb39cbcb8b0>]}
[0m14:23:50.359781 [info ] [MainThread]: 
[0m14:23:50.360681 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:23:50.362641 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_sales'
[0m14:23:50.381273 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m14:23:50.381874 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m14:23:50.382356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:51.131830 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:23:51.134958 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m14:23:51.257120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be03e33d-fb2d-441b-b320-e79e9af127f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb39cb5bd90>]}
[0m14:23:51.258263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:51.259364 [info ] [MainThread]: 
[0m14:23:51.265787 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m14:23:51.266799 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_customers)
[0m14:23:51.267480 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m14:23:51.272973 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m14:23:51.274039 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 14:23:51.267842 => 14:23:51.273693
[0m14:23:51.274613 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m14:23:51.275270 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 14:23:51.274948 => 14:23:51.274980
[0m14:23:51.276417 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m14:23:51.277048 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m14:23:51.277914 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m14:23:51.278420 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m14:23:51.282670 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m14:23:51.283989 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 14:23:51.278749 => 14:23:51.283644
[0m14:23:51.284543 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m14:23:51.285328 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 14:23:51.285009 => 14:23:51.285038
[0m14:23:51.286485 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m14:23:51.287040 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m14:23:51.287741 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m14:23:51.288258 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m14:23:51.291998 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m14:23:51.293248 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 14:23:51.288624 => 14:23:51.292870
[0m14:23:51.293922 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m14:23:51.294605 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 14:23:51.294320 => 14:23:51.294329
[0m14:23:51.295673 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m14:23:51.296220 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m14:23:51.297104 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m14:23:51.297589 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m14:23:51.301142 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m14:23:51.302628 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 14:23:51.297897 => 14:23:51.302156
[0m14:23:51.303257 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m14:23:51.303936 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 14:23:51.303658 => 14:23:51.303667
[0m14:23:51.304987 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m14:23:51.306143 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m14:23:51.307018 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_order_detail)
[0m14:23:51.307578 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m14:23:51.311744 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m14:23:51.312597 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 14:23:51.307875 => 14:23:51.312249
[0m14:23:51.313120 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m14:23:51.313729 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 14:23:51.313440 => 14:23:51.313450
[0m14:23:51.315074 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m14:23:51.315651 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m14:23:51.316486 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.fct_payment_details)
[0m14:23:51.317026 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m14:23:51.321696 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m14:23:51.322751 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 14:23:51.317379 => 14:23:51.322360
[0m14:23:51.323290 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m14:23:51.324106 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 14:23:51.323703 => 14:23:51.323713
[0m14:23:51.325268 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m14:23:51.326269 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m14:23:51.327015 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.product_sales)
[0m14:23:51.327565 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m14:23:51.331904 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m14:23:51.332676 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 14:23:51.327908 => 14:23:51.332382
[0m14:23:51.333160 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m14:23:51.333745 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 14:23:51.333465 => 14:23:51.333476
[0m14:23:51.334893 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m14:23:51.336318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:51.336747 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m14:23:51.338815 [debug] [MainThread]: Command end result
[0m14:23:51.348345 [debug] [MainThread]: Command `dbt compile` succeeded at 14:23:51.348069 after 1.43 seconds
[0m14:23:51.349000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3a3b18490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb39dd120a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb39657e310>]}
[0m14:23:51.349512 [debug] [MainThread]: Flushing usage events
[0m14:27:15.707821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac4207430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac2af1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac2af11c0>]}


============================== 14:27:15.711340 | 08188771-c20b-4a11-a02b-1269c32780ca ==============================
[0m14:27:15.711340 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:27:15.712033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:27:16.035019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08188771-c20b-4a11-a02b-1269c32780ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abd3f7f70>]}
[0m14:27:16.057625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08188771-c20b-4a11-a02b-1269c32780ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abd3f7610>]}
[0m14:27:16.075495 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:27:16.115328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:16.115997 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:16.117115 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m14:27:16.125776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08188771-c20b-4a11-a02b-1269c32780ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abd2758e0>]}
[0m14:27:16.135275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08188771-c20b-4a11-a02b-1269c32780ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abd2ce850>]}
[0m14:27:16.136014 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:27:16.136682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08188771-c20b-4a11-a02b-1269c32780ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abd2ce6a0>]}
[0m14:27:16.138806 [info ] [MainThread]: 
[0m14:27:16.139831 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:27:16.141706 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_sales'
[0m14:27:16.161228 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m14:27:16.161910 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m14:27:16.162440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:16.948317 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:27:16.951832 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m14:27:17.077275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08188771-c20b-4a11-a02b-1269c32780ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abd25ccd0>]}
[0m14:27:17.078541 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:27:17.079543 [info ] [MainThread]: 
[0m14:27:17.085386 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m14:27:17.086248 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_customers)
[0m14:27:17.086866 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m14:27:17.092046 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m14:27:17.093276 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 14:27:17.087239 => 14:27:17.092833
[0m14:27:17.093880 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m14:27:17.094594 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 14:27:17.094261 => 14:27:17.094296
[0m14:27:17.096511 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m14:27:17.097305 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m14:27:17.098085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m14:27:17.098601 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m14:27:17.102218 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m14:27:17.103069 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 14:27:17.098945 => 14:27:17.102710
[0m14:27:17.103605 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m14:27:17.104257 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 14:27:17.103923 => 14:27:17.103933
[0m14:27:17.105488 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m14:27:17.106046 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m14:27:17.106883 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m14:27:17.107441 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m14:27:17.111041 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m14:27:17.112473 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 14:27:17.107801 => 14:27:17.112107
[0m14:27:17.113033 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m14:27:17.113658 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 14:27:17.113372 => 14:27:17.113382
[0m14:27:17.114733 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m14:27:17.115294 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m14:27:17.116092 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m14:27:17.116628 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m14:27:17.120514 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m14:27:17.121550 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 14:27:17.117266 => 14:27:17.121211
[0m14:27:17.122179 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m14:27:17.122812 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 14:27:17.122522 => 14:27:17.122533
[0m14:27:17.123982 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m14:27:17.124610 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m14:27:17.125415 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m14:27:17.125924 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m14:27:17.131878 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m14:27:17.133034 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 14:27:17.126365 => 14:27:17.132641
[0m14:27:17.133552 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m14:27:17.134205 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 14:27:17.133879 => 14:27:17.133891
[0m14:27:17.135383 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m14:27:17.135959 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m14:27:17.136762 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m14:27:17.137607 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m14:27:17.141384 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m14:27:17.142242 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 14:27:17.137946 => 14:27:17.141882
[0m14:27:17.142836 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m14:27:17.143495 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 14:27:17.143178 => 14:27:17.143190
[0m14:27:17.144633 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m14:27:17.145863 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m14:27:17.146641 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m14:27:17.147222 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m14:27:17.151235 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m14:27:17.152116 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 14:27:17.147575 => 14:27:17.151736
[0m14:27:17.152631 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m14:27:17.153297 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 14:27:17.152972 => 14:27:17.152983
[0m14:27:17.154462 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m14:27:17.155772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:17.156282 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m14:27:17.158868 [debug] [MainThread]: Command end result
[0m14:27:17.168389 [debug] [MainThread]: Command `dbt compile` succeeded at 14:27:17.168189 after 1.48 seconds
[0m14:27:17.169015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ac4207430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abd3f7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5abd25cdc0>]}
[0m14:27:17.169638 [debug] [MainThread]: Flushing usage events
[0m14:43:43.036185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe517060550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe515922040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5159220a0>]}


============================== 14:43:43.040332 | 386520be-4e0d-4326-a389-fdf4b5ebc7f5 ==============================
[0m14:43:43.040332 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:43:43.041060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dags/dbt/logs', 'version_check': 'True', 'profiles_dir': 'dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:43:43.571307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '386520be-4e0d-4326-a389-fdf4b5ebc7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5112400a0>]}
[0m14:43:43.595294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '386520be-4e0d-4326-a389-fdf4b5ebc7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51123d100>]}
[0m14:43:43.612805 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m14:43:43.674702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:43:43.675470 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:43:43.676552 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.intermediate
- models.development.bronze
[0m14:43:43.686121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '386520be-4e0d-4326-a389-fdf4b5ebc7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5100b7a00>]}
[0m14:43:43.695442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '386520be-4e0d-4326-a389-fdf4b5ebc7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51010b8b0>]}
[0m14:43:43.696106 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:43:43.696692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '386520be-4e0d-4326-a389-fdf4b5ebc7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51010b970>]}
[0m14:43:43.699299 [info ] [MainThread]: 
[0m14:43:43.700369 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:43:43.702840 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_sales'
[0m14:43:43.721891 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m14:43:43.722590 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m14:43:43.723106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:44.447078 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:43:44.450875 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m14:43:44.578448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '386520be-4e0d-4326-a389-fdf4b5ebc7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51009b850>]}
[0m14:43:44.579863 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:44.580578 [info ] [MainThread]: 
[0m14:43:44.585989 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m14:43:44.586928 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_customers)
[0m14:43:44.587463 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m14:43:44.594033 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m14:43:44.595063 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 14:43:44.587827 => 14:43:44.594709
[0m14:43:44.595859 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m14:43:44.596556 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 14:43:44.596185 => 14:43:44.596222
[0m14:43:44.597768 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m14:43:44.598360 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m14:43:44.599346 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m14:43:44.599863 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m14:43:44.604432 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m14:43:44.605269 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 14:43:44.600168 => 14:43:44.604973
[0m14:43:44.605747 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m14:43:44.606357 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 14:43:44.606053 => 14:43:44.606065
[0m14:43:44.607472 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m14:43:44.608008 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m14:43:44.609048 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m14:43:44.609587 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m14:43:44.613403 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m14:43:44.614296 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 14:43:44.609885 => 14:43:44.613999
[0m14:43:44.614769 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m14:43:44.615425 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 14:43:44.615071 => 14:43:44.615082
[0m14:43:44.616720 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m14:43:44.617306 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m14:43:44.618061 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m14:43:44.618580 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m14:43:44.622369 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m14:43:44.623501 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 14:43:44.618929 => 14:43:44.623058
[0m14:43:44.624360 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m14:43:44.625065 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 14:43:44.624746 => 14:43:44.624758
[0m14:43:44.626181 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m14:43:44.627061 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m14:43:44.628087 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m14:43:44.628656 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m14:43:44.632618 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m14:43:44.633974 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 14:43:44.629000 => 14:43:44.633515
[0m14:43:44.634472 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m14:43:44.635082 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 14:43:44.634799 => 14:43:44.634810
[0m14:43:44.636530 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m14:43:44.637158 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m14:43:44.637867 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m14:43:44.638358 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m14:43:44.643468 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m14:43:44.644642 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 14:43:44.638665 => 14:43:44.644318
[0m14:43:44.645213 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m14:43:44.645868 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 14:43:44.645525 => 14:43:44.645535
[0m14:43:44.647341 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m14:43:44.648841 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m14:43:44.649716 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m14:43:44.650230 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m14:43:44.654473 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m14:43:44.655559 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 14:43:44.650537 => 14:43:44.655192
[0m14:43:44.656043 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m14:43:44.656700 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 14:43:44.656375 => 14:43:44.656387
[0m14:43:44.657908 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m14:43:44.662431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:44.662996 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m14:43:44.665239 [debug] [MainThread]: Command end result
[0m14:43:44.675446 [debug] [MainThread]: Command `dbt compile` succeeded at 14:43:44.675216 after 1.66 seconds
[0m14:43:44.676125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe517060550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51123d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51010b9d0>]}
[0m14:43:44.676694 [debug] [MainThread]: Flushing usage events
[0m15:45:30.640213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1630e1a4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162f6dd070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f162f6dd370>]}


============================== 15:45:30.644339 | d999d17d-f4ad-43e8-bab8-127dc2736cc6 ==============================
[0m15:45:30.644339 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:45:30.645690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'dags/dbt', 'log_path': 'dags/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:45:30.981727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd999d17d-f4ad-43e8-bab8-127dc2736cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1629ffc100>]}
[0m15:45:31.003557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd999d17d-f4ad-43e8-bab8-127dc2736cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1629ff8610>]}
[0m15:45:31.020724 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:45:31.049841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:45:31.051132 [debug] [MainThread]: Partial parsing: updated file: development://models/staging_source.yml
[0m15:45:31.051634 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_orders.sql
[0m15:45:31.085031 [debug] [MainThread]: 1699: static parser successfully parsed sales/core/product_sales.sql
[0m15:45:31.104229 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_customers.sql
[0m15:45:31.109700 [debug] [MainThread]: 1699: static parser successfully parsed sales/intermediate/fct_order_detail.sql
[0m15:45:31.115534 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_orders.sql
[0m15:45:31.121003 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_products.sql
[0m15:45:31.126292 [debug] [MainThread]: 1699: static parser successfully parsed sales/intermediate/fct_payment_details.sql
[0m15:45:31.131502 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_payments.sql
[0m15:45:31.160559 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.development.bronze_orders' (models/sales/bronze/bronze_orders.sql) depends on a source named 'sales_stage.orders' which was not found
[0m15:45:31.161750 [debug] [MainThread]: Command `dbt compile` failed at 15:45:31.161562 after 0.54 seconds
[0m15:45:31.162261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1630e1a4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16299f58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16299f5580>]}
[0m15:45:31.164171 [debug] [MainThread]: Flushing usage events
[0m15:46:29.230863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809bf59460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809a81c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809a81c190>]}


============================== 15:46:29.234669 | b456451a-11bd-49f4-91c7-23151af78c40 ==============================
[0m15:46:29.234669 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:46:29.235556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:46:29.572405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b456451a-11bd-49f4-91c7-23151af78c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8096131040>]}
[0m15:46:29.595171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b456451a-11bd-49f4-91c7-23151af78c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8096137070>]}
[0m15:46:29.613252 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:46:29.643783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:46:29.645339 [debug] [MainThread]: Partial parsing: updated file: development://models/staging_source.yml
[0m15:46:29.645962 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_orders.sql
[0m15:46:29.679890 [debug] [MainThread]: 1699: static parser successfully parsed sales/core/product_sales.sql
[0m15:46:29.699881 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_customers.sql
[0m15:46:29.705282 [debug] [MainThread]: 1699: static parser successfully parsed sales/intermediate/fct_order_detail.sql
[0m15:46:29.710414 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_orders.sql
[0m15:46:29.716238 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_products.sql
[0m15:46:29.721086 [debug] [MainThread]: 1699: static parser successfully parsed sales/intermediate/fct_payment_details.sql
[0m15:46:29.726257 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_payments.sql
[0m15:46:29.764253 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m15:46:29.771540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b456451a-11bd-49f4-91c7-23151af78c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8094ad1b20>]}
[0m15:46:29.780799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b456451a-11bd-49f4-91c7-23151af78c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8096010910>]}
[0m15:46:29.781447 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:46:29.782013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b456451a-11bd-49f4-91c7-23151af78c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8096010820>]}
[0m15:46:29.783963 [info ] [MainThread]: 
[0m15:46:29.784978 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:46:29.786837 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_sales'
[0m15:46:29.809599 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m15:46:29.810336 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m15:46:29.810854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:30.552712 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m15:46:30.556188 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m15:46:30.666792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b456451a-11bd-49f4-91c7-23151af78c40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80960ebf70>]}
[0m15:46:30.668752 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:46:30.670612 [info ] [MainThread]: 
[0m15:46:30.676691 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m15:46:30.677612 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_customers)
[0m15:46:30.678206 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m15:46:30.683232 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m15:46:30.684126 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 15:46:30.678573 => 15:46:30.683790
[0m15:46:30.684593 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m15:46:30.685243 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 15:46:30.684927 => 15:46:30.684959
[0m15:46:30.686738 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m15:46:30.687353 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m15:46:30.688150 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m15:46:30.689046 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m15:46:30.691171 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m15:46:30.692133 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 15:46:30.689376 => 15:46:30.691691
[0m15:46:30.692594 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m15:46:30.693378 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 15:46:30.693078 => 15:46:30.693090
[0m15:46:30.694641 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m15:46:30.695221 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m15:46:30.696047 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m15:46:30.696650 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m15:46:30.700330 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m15:46:30.701172 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 15:46:30.697199 => 15:46:30.700825
[0m15:46:30.702023 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m15:46:30.702867 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 15:46:30.702493 => 15:46:30.702505
[0m15:46:30.704135 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m15:46:30.704800 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m15:46:30.705856 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m15:46:30.706615 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m15:46:30.710509 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m15:46:30.711485 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 15:46:30.706978 => 15:46:30.711160
[0m15:46:30.712079 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m15:46:30.712796 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 15:46:30.712410 => 15:46:30.712422
[0m15:46:30.714052 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m15:46:30.714744 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m15:46:30.715546 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m15:46:30.716348 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m15:46:30.721759 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m15:46:30.722889 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 15:46:30.716759 => 15:46:30.722519
[0m15:46:30.723458 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m15:46:30.724167 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 15:46:30.723861 => 15:46:30.723872
[0m15:46:30.725436 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m15:46:30.726039 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m15:46:30.726981 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m15:46:30.727484 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m15:46:30.731318 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m15:46:30.732349 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 15:46:30.727848 => 15:46:30.732065
[0m15:46:30.732967 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m15:46:30.733553 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 15:46:30.733293 => 15:46:30.733302
[0m15:46:30.735444 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m15:46:30.736792 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m15:46:30.737528 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m15:46:30.738038 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m15:46:30.741788 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m15:46:30.742870 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 15:46:30.738329 => 15:46:30.742362
[0m15:46:30.743426 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m15:46:30.744080 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 15:46:30.743784 => 15:46:30.743795
[0m15:46:30.745292 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m15:46:30.747012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:30.747434 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m15:46:30.750027 [debug] [MainThread]: Command end result
[0m15:46:30.759713 [debug] [MainThread]: Command `dbt compile` succeeded at 15:46:30.759535 after 1.55 seconds
[0m15:46:30.760291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f809bf59460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8096137070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8094f9ceb0>]}
[0m15:46:30.760855 [debug] [MainThread]: Flushing usage events
[0m15:49:07.456569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe338920550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3371e2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3371e21c0>]}


============================== 15:49:07.460485 | e8eccdb3-96f3-4e42-a15e-2690fb113425 ==============================
[0m15:49:07.460485 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:49:07.461466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:49:07.799757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8eccdb3-96f3-4e42-a15e-2690fb113425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe332af40a0>]}
[0m15:49:07.822316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8eccdb3-96f3-4e42-a15e-2690fb113425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe332afe070>]}
[0m15:49:07.839558 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:49:07.867747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:49:07.868511 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_payments.sql
[0m15:49:07.869085 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_products.sql
[0m15:49:07.869731 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_customers.sql
[0m15:49:07.903108 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_payments.sql
[0m15:49:07.922221 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_products.sql
[0m15:49:07.927180 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_customers.sql
[0m15:49:07.937039 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m15:49:07.943899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8eccdb3-96f3-4e42-a15e-2690fb113425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3314f4fa0>]}
[0m15:49:07.952636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8eccdb3-96f3-4e42-a15e-2690fb113425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3314c0040>]}
[0m15:49:07.953429 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics, 0 groups
[0m15:49:07.954160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8eccdb3-96f3-4e42-a15e-2690fb113425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3314c00a0>]}
[0m15:49:07.956368 [info ] [MainThread]: 
[0m15:49:07.957403 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:49:07.959256 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_sales'
[0m15:49:07.977694 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m15:49:07.978279 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m15:49:07.978767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:08.674753 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m15:49:08.678405 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m15:49:08.776511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8eccdb3-96f3-4e42-a15e-2690fb113425', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe33193afa0>]}
[0m15:49:08.777818 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:49:08.778440 [info ] [MainThread]: 
[0m15:49:08.784089 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m15:49:08.784971 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_customers)
[0m15:49:08.785596 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m15:49:08.788600 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m15:49:08.789532 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 15:49:08.785960 => 15:49:08.789201
[0m15:49:08.790054 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m15:49:08.790700 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 15:49:08.790364 => 15:49:08.790416
[0m15:49:08.791985 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m15:49:08.792744 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m15:49:08.795008 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m15:49:08.795624 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m15:49:08.797628 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m15:49:08.798439 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 15:49:08.795981 => 15:49:08.798126
[0m15:49:08.798946 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m15:49:08.799523 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 15:49:08.799247 => 15:49:08.799258
[0m15:49:08.800627 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m15:49:08.801245 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m15:49:08.802009 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m15:49:08.802806 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m15:49:08.804806 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m15:49:08.805634 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 15:49:08.803120 => 15:49:08.805328
[0m15:49:08.806089 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m15:49:08.806819 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 15:49:08.806490 => 15:49:08.806500
[0m15:49:08.807833 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m15:49:08.808398 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m15:49:08.809168 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m15:49:08.809692 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m15:49:08.812217 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m15:49:08.813573 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 15:49:08.809983 => 15:49:08.813185
[0m15:49:08.814052 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m15:49:08.814629 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 15:49:08.814351 => 15:49:08.814362
[0m15:49:08.815875 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m15:49:08.816521 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m15:49:08.817301 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m15:49:08.818012 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m15:49:08.822254 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m15:49:08.823632 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 15:49:08.818413 => 15:49:08.823265
[0m15:49:08.824113 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m15:49:08.824720 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 15:49:08.824430 => 15:49:08.824440
[0m15:49:08.829836 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m15:49:08.830516 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m15:49:08.831442 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m15:49:08.832078 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m15:49:08.836366 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m15:49:08.837740 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 15:49:08.832486 => 15:49:08.837351
[0m15:49:08.838344 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m15:49:08.841003 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 15:49:08.840632 => 15:49:08.840647
[0m15:49:08.842305 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m15:49:08.843948 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m15:49:08.845180 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m15:49:08.845788 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m15:49:08.850165 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m15:49:08.851023 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 15:49:08.846187 => 15:49:08.850709
[0m15:49:08.851578 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m15:49:08.852241 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 15:49:08.851926 => 15:49:08.851937
[0m15:49:08.853507 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m15:49:08.854715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:08.855131 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m15:49:08.857975 [debug] [MainThread]: Command end result
[0m15:49:08.868959 [debug] [MainThread]: Command `dbt compile` succeeded at 15:49:08.868726 after 1.43 seconds
[0m15:49:08.869773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe338920550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3314c0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe331914b80>]}
[0m15:49:08.870405 [debug] [MainThread]: Flushing usage events
[0m15:53:54.601227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b052604c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b03b3e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b03b3e190>]}


============================== 15:53:54.605781 | 13427ae7-ccf9-48aa-bd84-19e2e1bc069d ==============================
[0m15:53:54.605781 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:53:54.606517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:53:54.944648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13427ae7-ccf9-48aa-bd84-19e2e1bc069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aff45f0a0>]}
[0m15:53:54.969114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13427ae7-ccf9-48aa-bd84-19e2e1bc069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aff45e0d0>]}
[0m15:53:54.987182 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:53:55.016011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:53:55.017084 [debug] [MainThread]: Partial parsing: updated file: development://models/staging_source.yml
[0m15:53:55.017747 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_orders.sql
[0m15:53:55.052193 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_orders.sql
[0m15:53:55.108968 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m15:53:55.116592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13427ae7-ccf9-48aa-bd84-19e2e1bc069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0afddc8e20>]}
[0m15:53:55.125225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13427ae7-ccf9-48aa-bd84-19e2e1bc069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0afe31a6d0>]}
[0m15:53:55.125772 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m15:53:55.126297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13427ae7-ccf9-48aa-bd84-19e2e1bc069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0afe31a730>]}
[0m15:53:55.128763 [info ] [MainThread]: 
[0m15:53:55.129872 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:53:55.131748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_sales'
[0m15:53:55.150634 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m15:53:55.151273 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m15:53:55.151776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:55.931407 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m15:53:55.934917 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m15:53:56.048205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13427ae7-ccf9-48aa-bd84-19e2e1bc069d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0afddc8e50>]}
[0m15:53:56.049463 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:53:56.050049 [info ] [MainThread]: 
[0m15:53:56.058277 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m15:53:56.059372 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_customers)
[0m15:53:56.060007 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m15:53:56.064225 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m15:53:56.065700 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 15:53:56.060551 => 15:53:56.065285
[0m15:53:56.066181 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m15:53:56.066926 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 15:53:56.066577 => 15:53:56.066612
[0m15:53:56.068953 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m15:53:56.069597 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m15:53:56.070472 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m15:53:56.071957 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m15:53:56.077858 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m15:53:56.078757 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 15:53:56.072461 => 15:53:56.078440
[0m15:53:56.079254 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m15:53:56.080190 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 15:53:56.079834 => 15:53:56.079846
[0m15:53:56.081787 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m15:53:56.082378 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m15:53:56.083164 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m15:53:56.083681 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m15:53:56.086200 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m15:53:56.087427 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 15:53:56.084002 => 15:53:56.087077
[0m15:53:56.088003 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m15:53:56.088737 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 15:53:56.088433 => 15:53:56.088445
[0m15:53:56.089912 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m15:53:56.090521 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m15:53:56.091259 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m15:53:56.092013 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m15:53:56.094429 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m15:53:56.095452 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 15:53:56.092372 => 15:53:56.095122
[0m15:53:56.095982 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m15:53:56.096771 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 15:53:56.096452 => 15:53:56.096464
[0m15:53:56.098133 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m15:53:56.098765 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m15:53:56.099525 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m15:53:56.100073 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m15:53:56.103923 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m15:53:56.104809 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 15:53:56.100422 => 15:53:56.104489
[0m15:53:56.105420 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m15:53:56.106062 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 15:53:56.105768 => 15:53:56.105780
[0m15:53:56.107236 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m15:53:56.108565 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m15:53:56.109410 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m15:53:56.109940 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m15:53:56.115821 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m15:53:56.116769 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 15:53:56.110280 => 15:53:56.116440
[0m15:53:56.117303 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m15:53:56.118020 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 15:53:56.117658 => 15:53:56.117669
[0m15:53:56.119174 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m15:53:56.120329 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m15:53:56.121182 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m15:53:56.121720 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m15:53:56.125875 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m15:53:56.126704 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 15:53:56.122043 => 15:53:56.126394
[0m15:53:56.127191 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m15:53:56.127872 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 15:53:56.127533 => 15:53:56.127544
[0m15:53:56.129571 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m15:53:56.131202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:53:56.131648 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m15:53:56.133936 [debug] [MainThread]: Command end result
[0m15:53:56.143533 [debug] [MainThread]: Command `dbt compile` succeeded at 15:53:56.143328 after 1.56 seconds
[0m15:53:56.144259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b052604c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aff45e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0afe29cbb0>]}
[0m15:53:56.144788 [debug] [MainThread]: Flushing usage events
[0m15:56:02.131456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe526a2d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5252f05b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5252f0400>]}


============================== 15:56:02.135337 | c5fdd3ac-55e3-4b87-b603-205de8949bc3 ==============================
[0m15:56:02.135337 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:56:02.136075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'dags/dbt/logs', 'profiles_dir': 'dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:56:02.464415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5fdd3ac-55e3-4b87-b603-205de8949bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51fbef100>]}
[0m15:56:02.486081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5fdd3ac-55e3-4b87-b603-205de8949bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51fbf70a0>]}
[0m15:56:02.503115 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:56:02.533098 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m15:56:02.533910 [debug] [MainThread]: Partial parsing: added file: development://models/sources.yml
[0m15:56:02.569392 [debug] [MainThread]: 1699: static parser successfully parsed sales/core/product_sales.sql
[0m15:56:02.589223 [debug] [MainThread]: 1699: static parser successfully parsed sales/intermediate/fct_order_detail.sql
[0m15:56:02.594720 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_orders.sql
[0m15:56:02.638489 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.intermediate
- models.development.bronze
[0m15:56:02.648351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5fdd3ac-55e3-4b87-b603-205de8949bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51fa78fa0>]}
[0m15:56:02.658000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5fdd3ac-55e3-4b87-b603-205de8949bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51face940>]}
[0m15:56:02.658616 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m15:56:02.659255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5fdd3ac-55e3-4b87-b603-205de8949bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51face9a0>]}
[0m15:56:02.661643 [info ] [MainThread]: 
[0m15:56:02.662654 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:56:02.664886 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_sales'
[0m15:56:02.684553 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m15:56:02.685193 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m15:56:02.685711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:03.423688 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m15:56:03.427483 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m15:56:03.525395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5fdd3ac-55e3-4b87-b603-205de8949bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51fbabc10>]}
[0m15:56:03.526699 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:56:03.527318 [info ] [MainThread]: 
[0m15:56:03.532534 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m15:56:03.533586 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_customers)
[0m15:56:03.534102 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m15:56:03.537648 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m15:56:03.538599 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 15:56:03.534488 => 15:56:03.538243
[0m15:56:03.539114 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m15:56:03.539899 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 15:56:03.539431 => 15:56:03.539464
[0m15:56:03.541343 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m15:56:03.541914 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m15:56:03.542634 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m15:56:03.543103 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m15:56:03.547496 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m15:56:03.548608 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 15:56:03.543408 => 15:56:03.548194
[0m15:56:03.549201 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m15:56:03.550236 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 15:56:03.549901 => 15:56:03.549916
[0m15:56:03.551557 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m15:56:03.552216 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m15:56:03.553180 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m15:56:03.553715 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m15:56:03.556247 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m15:56:03.557131 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 15:56:03.554230 => 15:56:03.556764
[0m15:56:03.557624 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m15:56:03.558244 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 15:56:03.557949 => 15:56:03.557959
[0m15:56:03.559470 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m15:56:03.560222 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m15:56:03.561071 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m15:56:03.561605 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m15:56:03.563995 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m15:56:03.565007 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 15:56:03.561944 => 15:56:03.564546
[0m15:56:03.565535 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m15:56:03.566179 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 15:56:03.565875 => 15:56:03.565885
[0m15:56:03.567795 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m15:56:03.568578 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m15:56:03.569385 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m15:56:03.570005 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m15:56:03.573797 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m15:56:03.574801 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 15:56:03.570384 => 15:56:03.574356
[0m15:56:03.575333 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m15:56:03.575977 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 15:56:03.575679 => 15:56:03.575692
[0m15:56:03.577230 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m15:56:03.578589 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m15:56:03.579336 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m15:56:03.579942 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m15:56:03.585549 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m15:56:03.586438 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 15:56:03.580441 => 15:56:03.586082
[0m15:56:03.586952 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m15:56:03.587618 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 15:56:03.587270 => 15:56:03.587299
[0m15:56:03.588949 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m15:56:03.590320 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m15:56:03.591194 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m15:56:03.591751 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m15:56:03.596125 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m15:56:03.597339 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 15:56:03.592106 => 15:56:03.596929
[0m15:56:03.597846 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m15:56:03.598632 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 15:56:03.598170 => 15:56:03.598182
[0m15:56:03.599790 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m15:56:03.601304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:03.601759 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m15:56:03.603788 [debug] [MainThread]: Command end result
[0m15:56:03.612842 [debug] [MainThread]: Command `dbt compile` succeeded at 15:56:03.612648 after 1.50 seconds
[0m15:56:03.613495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe526a2d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51fbf70a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe51face250>]}
[0m15:56:03.614160 [debug] [MainThread]: Flushing usage events
[0m16:03:37.937777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff43f4464f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff43dd09070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff43dd09370>]}


============================== 16:03:37.942283 | 881a00a5-1c54-4d0f-a696-5cbe61bb47c4 ==============================
[0m16:03:37.942283 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:03:37.943172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dags/dbt/logs', 'debug': 'False', 'profiles_dir': 'dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:03:38.306608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '881a00a5-1c54-4d0f-a696-5cbe61bb47c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4385f8100>]}
[0m16:03:38.332357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '881a00a5-1c54-4d0f-a696-5cbe61bb47c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4385f5610>]}
[0m16:03:38.353439 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m16:03:38.388009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:03:38.389304 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_orders.sql
[0m16:03:38.431019 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_orders.sql
[0m16:03:38.458264 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.bronze
- models.development.staging
[0m16:03:38.466033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '881a00a5-1c54-4d0f-a696-5cbe61bb47c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4381878e0>]}
[0m16:03:38.476311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '881a00a5-1c54-4d0f-a696-5cbe61bb47c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff438416d60>]}
[0m16:03:38.477198 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m16:03:38.477887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '881a00a5-1c54-4d0f-a696-5cbe61bb47c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff438416910>]}
[0m16:03:38.480679 [info ] [MainThread]: 
[0m16:03:38.482032 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:03:38.484237 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_sales'
[0m16:03:38.504069 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m16:03:38.504737 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m16:03:38.505219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:39.444167 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:03:39.447903 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m16:03:39.560683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '881a00a5-1c54-4d0f-a696-5cbe61bb47c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff43847c520>]}
[0m16:03:39.562048 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:03:39.562736 [info ] [MainThread]: 
[0m16:03:39.571526 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m16:03:39.572394 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_customers)
[0m16:03:39.572998 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m16:03:39.576481 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m16:03:39.578126 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 16:03:39.573366 => 16:03:39.577536
[0m16:03:39.578661 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m16:03:39.579464 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 16:03:39.579119 => 16:03:39.579155
[0m16:03:39.580813 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m16:03:39.581500 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m16:03:39.582431 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m16:03:39.582933 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m16:03:39.585652 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m16:03:39.586510 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 16:03:39.583690 => 16:03:39.586183
[0m16:03:39.587075 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m16:03:39.587719 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 16:03:39.587422 => 16:03:39.587433
[0m16:03:39.588953 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m16:03:39.589673 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m16:03:39.590666 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m16:03:39.591184 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m16:03:39.593417 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m16:03:39.594238 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 16:03:39.591542 => 16:03:39.593910
[0m16:03:39.594775 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m16:03:39.595601 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 16:03:39.595285 => 16:03:39.595299
[0m16:03:39.596761 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m16:03:39.597405 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m16:03:39.598164 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m16:03:39.600386 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m16:03:39.602829 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m16:03:39.603714 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 16:03:39.600729 => 16:03:39.603415
[0m16:03:39.604229 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m16:03:39.604993 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 16:03:39.604610 => 16:03:39.604622
[0m16:03:39.606188 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m16:03:39.606824 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m16:03:39.607566 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m16:03:39.608068 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m16:03:39.613174 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m16:03:39.614484 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 16:03:39.608460 => 16:03:39.614108
[0m16:03:39.615099 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m16:03:39.615745 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 16:03:39.615439 => 16:03:39.615453
[0m16:03:39.616960 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m16:03:39.617605 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m16:03:39.618389 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m16:03:39.621625 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m16:03:39.626605 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m16:03:39.627696 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 16:03:39.621994 => 16:03:39.627367
[0m16:03:39.628328 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m16:03:39.629096 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 16:03:39.628728 => 16:03:39.628742
[0m16:03:39.630403 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m16:03:39.631445 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m16:03:39.632282 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m16:03:39.632813 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m16:03:39.637437 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m16:03:39.638621 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 16:03:39.633236 => 16:03:39.638247
[0m16:03:39.639139 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m16:03:39.639897 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 16:03:39.639487 => 16:03:39.639499
[0m16:03:39.641279 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m16:03:39.642635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:39.643125 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m16:03:39.645420 [debug] [MainThread]: Command end result
[0m16:03:39.656172 [debug] [MainThread]: Command `dbt compile` succeeded at 16:03:39.655941 after 1.74 seconds
[0m16:03:39.656758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff43f4464f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4385f5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff438416b80>]}
[0m16:03:39.657399 [debug] [MainThread]: Flushing usage events
[0m16:17:00.051115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23f4b1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23dd8e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23dd8e190>]}


============================== 16:17:00.055261 | baee3274-c8a9-4d42-ba81-211364170c7a ==============================
[0m16:17:00.055261 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:17:00.056065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dags/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:17:00.386974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'baee3274-c8a9-4d42-ba81-211364170c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2396a4130>]}
[0m16:17:00.409561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'baee3274-c8a9-4d42-ba81-211364170c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2396ab040>]}
[0m16:17:00.426919 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m16:17:00.457191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:17:00.458067 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_orders.sql
[0m16:17:00.491542 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_orders.sql
[0m16:17:00.514532 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.bronze
- models.development.staging
[0m16:17:00.521390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'baee3274-c8a9-4d42-ba81-211364170c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd22bfc68e0>]}
[0m16:17:00.530445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'baee3274-c8a9-4d42-ba81-211364170c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd238497d90>]}
[0m16:17:00.531231 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m16:17:00.531803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baee3274-c8a9-4d42-ba81-211364170c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2384978b0>]}
[0m16:17:00.533757 [info ] [MainThread]: 
[0m16:17:00.534646 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:17:00.536598 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_sales'
[0m16:17:00.555655 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m16:17:00.556340 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m16:17:00.556843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:01.475237 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:17:01.479143 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m16:17:01.585858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'baee3274-c8a9-4d42-ba81-211364170c7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2384fd3a0>]}
[0m16:17:01.587183 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:17:01.587798 [info ] [MainThread]: 
[0m16:17:01.593172 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m16:17:01.594392 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_customers)
[0m16:17:01.594934 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m16:17:01.598161 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m16:17:01.599304 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 16:17:01.595290 => 16:17:01.598864
[0m16:17:01.599903 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m16:17:01.600599 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 16:17:01.600207 => 16:17:01.600240
[0m16:17:01.601745 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m16:17:01.602304 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m16:17:01.603132 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m16:17:01.605656 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m16:17:01.609975 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m16:17:01.610886 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 16:17:01.605995 => 16:17:01.610572
[0m16:17:01.611409 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m16:17:01.612182 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 16:17:01.611897 => 16:17:01.611909
[0m16:17:01.613484 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m16:17:01.614065 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m16:17:01.614838 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m16:17:01.615418 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m16:17:01.617651 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m16:17:01.618458 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 16:17:01.615829 => 16:17:01.618150
[0m16:17:01.618951 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m16:17:01.619637 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 16:17:01.619301 => 16:17:01.619312
[0m16:17:01.620805 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m16:17:01.621424 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m16:17:01.622160 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m16:17:01.622784 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m16:17:01.625140 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m16:17:01.626018 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 16:17:01.623104 => 16:17:01.625664
[0m16:17:01.626825 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m16:17:01.627507 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 16:17:01.627173 => 16:17:01.627184
[0m16:17:01.628648 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m16:17:01.629482 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m16:17:01.630263 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m16:17:01.630862 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m16:17:01.634622 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m16:17:01.635443 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 16:17:01.631179 => 16:17:01.635132
[0m16:17:01.635985 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m16:17:01.636598 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 16:17:01.636308 => 16:17:01.636319
[0m16:17:01.637776 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m16:17:01.639187 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m16:17:01.640121 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m16:17:01.640721 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m16:17:01.645510 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m16:17:01.646549 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 16:17:01.641138 => 16:17:01.646172
[0m16:17:01.647070 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m16:17:01.647798 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 16:17:01.647422 => 16:17:01.647435
[0m16:17:01.649062 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m16:17:01.650006 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m16:17:01.650785 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m16:17:01.651277 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m16:17:01.655788 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m16:17:01.656879 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 16:17:01.651652 => 16:17:01.656526
[0m16:17:01.657413 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m16:17:01.658130 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 16:17:01.657783 => 16:17:01.657810
[0m16:17:01.659258 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m16:17:01.660879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:01.661457 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m16:17:01.663510 [debug] [MainThread]: Command end result
[0m16:17:01.672785 [debug] [MainThread]: Command `dbt compile` succeeded at 16:17:01.672578 after 1.64 seconds
[0m16:17:01.673363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23f4b1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2396ab040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd238497b20>]}
[0m16:17:01.673977 [debug] [MainThread]: Flushing usage events
[0m16:37:49.055094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fe04d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fc92b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fc92b1c0>]}


============================== 16:37:49.059000 | 5e8233fb-8635-4d72-822a-398230b96985 ==============================
[0m16:37:49.059000 [info ] [MainThread]: Running with dbt=1.5.1
[0m16:37:49.059712 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dags/dbt/logs', 'debug': 'False', 'profiles_dir': 'dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m16:37:49.426018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e8233fb-8635-4d72-822a-398230b96985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f824c100>]}
[0m16:37:49.453732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e8233fb-8635-4d72-822a-398230b96985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f824a0a0>]}
[0m16:37:49.478093 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m16:37:49.510746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:37:49.511765 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:37:49.512811 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.bronze
- models.development.staging
[0m16:37:49.527219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e8233fb-8635-4d72-822a-398230b96985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f70b4940>]}
[0m16:37:49.536609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e8233fb-8635-4d72-822a-398230b96985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f710d7f0>]}
[0m16:37:49.538468 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m16:37:49.539047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e8233fb-8635-4d72-822a-398230b96985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f710d8b0>]}
[0m16:37:49.541344 [info ] [MainThread]: 
[0m16:37:49.542540 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:37:49.546054 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_sales'
[0m16:37:49.564010 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m16:37:49.564528 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m16:37:49.565064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:50.459984 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m16:37:50.463748 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m16:37:50.572332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e8233fb-8635-4d72-822a-398230b96985', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f709cd90>]}
[0m16:37:50.573700 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:37:50.574643 [info ] [MainThread]: 
[0m16:37:50.581038 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m16:37:50.582122 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_customers)
[0m16:37:50.582678 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m16:37:50.585976 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m16:37:50.586980 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 16:37:50.583060 => 16:37:50.586595
[0m16:37:50.587475 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m16:37:50.588126 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 16:37:50.587801 => 16:37:50.587836
[0m16:37:50.589685 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m16:37:50.590269 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m16:37:50.591002 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m16:37:50.591485 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m16:37:50.595701 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m16:37:50.597664 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 16:37:50.591863 => 16:37:50.597274
[0m16:37:50.598232 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m16:37:50.598987 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 16:37:50.598642 => 16:37:50.598654
[0m16:37:50.600203 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m16:37:50.600795 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m16:37:50.601736 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m16:37:50.602236 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m16:37:50.604290 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m16:37:50.605246 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 16:37:50.602572 => 16:37:50.604867
[0m16:37:50.605727 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m16:37:50.606333 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 16:37:50.606043 => 16:37:50.606054
[0m16:37:50.607405 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m16:37:50.607996 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m16:37:50.609164 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m16:37:50.609763 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m16:37:50.611776 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m16:37:50.612996 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 16:37:50.610130 => 16:37:50.612519
[0m16:37:50.613513 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m16:37:50.614176 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 16:37:50.613834 => 16:37:50.613844
[0m16:37:50.615220 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m16:37:50.615767 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m16:37:50.616479 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m16:37:50.617017 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m16:37:50.620698 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m16:37:50.621495 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 16:37:50.617370 => 16:37:50.621199
[0m16:37:50.622097 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m16:37:50.622961 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 16:37:50.622477 => 16:37:50.622488
[0m16:37:50.624194 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m16:37:50.625117 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m16:37:50.627731 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m16:37:50.628294 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m16:37:50.631792 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m16:37:50.632874 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 16:37:50.628600 => 16:37:50.632385
[0m16:37:50.635594 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m16:37:50.636305 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 16:37:50.635997 => 16:37:50.636009
[0m16:37:50.637630 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m16:37:50.638513 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m16:37:50.639627 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m16:37:50.640123 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m16:37:50.644005 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m16:37:50.644950 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 16:37:50.640481 => 16:37:50.644498
[0m16:37:50.645487 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m16:37:50.646097 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 16:37:50.645813 => 16:37:50.645824
[0m16:37:50.647292 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m16:37:50.648540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:50.649139 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m16:37:50.651300 [debug] [MainThread]: Command end result
[0m16:37:50.660856 [debug] [MainThread]: Command `dbt compile` succeeded at 16:37:50.660673 after 1.63 seconds
[0m16:37:50.661483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77fe04d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f824a0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77f710d910>]}
[0m16:37:50.662006 [debug] [MainThread]: Flushing usage events
[0m20:17:50.491094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e5e5c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e473a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e473a190>]}


============================== 20:17:50.495576 | a8a38290-88bf-46ca-b7f2-a44e320e0d5d ==============================
[0m20:17:50.495576 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:17:50.496403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dags/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:17:51.621208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8a38290-88bf-46ca-b7f2-a44e320e0d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e004d100>]}
[0m20:17:51.643901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8a38290-88bf-46ca-b7f2-a44e320e0d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e00570d0>]}
[0m20:17:51.661337 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:17:51.740117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m20:17:51.741078 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_customers.sql
[0m20:17:51.741696 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_payments.sql
[0m20:17:51.742323 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_products.sql
[0m20:17:51.776138 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_customers.sql
[0m20:17:51.797542 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_payments.sql
[0m20:17:51.803088 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_products.sql
[0m20:17:51.813155 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m20:17:51.820590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8a38290-88bf-46ca-b7f2-a44e320e0d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02dea31190>]}
[0m20:17:51.830760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8a38290-88bf-46ca-b7f2-a44e320e0d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02dea03040>]}
[0m20:17:51.831568 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:17:51.832380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8a38290-88bf-46ca-b7f2-a44e320e0d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02dea030d0>]}
[0m20:17:51.834698 [info ] [MainThread]: 
[0m20:17:51.835807 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:17:51.837709 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_sales'
[0m20:17:51.855626 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m20:17:51.856268 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m20:17:51.856716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:52.993048 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m20:17:52.996622 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m20:17:53.109180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8a38290-88bf-46ca-b7f2-a44e320e0d5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02de9fd8e0>]}
[0m20:17:53.110591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:17:53.111161 [info ] [MainThread]: 
[0m20:17:53.121170 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m20:17:53.122041 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_customers)
[0m20:17:53.122552 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m20:17:53.127733 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m20:17:53.128727 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 20:17:53.122897 => 20:17:53.128375
[0m20:17:53.129334 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m20:17:53.131346 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 20:17:53.130985 => 20:17:53.131022
[0m20:17:53.132640 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m20:17:53.133275 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m20:17:53.134051 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m20:17:53.134836 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m20:17:53.138132 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m20:17:53.139009 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 20:17:53.135238 => 20:17:53.138661
[0m20:17:53.139579 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m20:17:53.140246 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 20:17:53.139911 => 20:17:53.139923
[0m20:17:53.141473 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m20:17:53.142064 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m20:17:53.142847 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m20:17:53.143373 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m20:17:53.146895 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m20:17:53.147842 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 20:17:53.143708 => 20:17:53.147423
[0m20:17:53.148390 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m20:17:53.149037 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 20:17:53.148697 => 20:17:53.148708
[0m20:17:53.150174 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m20:17:53.150829 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m20:17:53.151609 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m20:17:53.152128 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m20:17:53.155473 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m20:17:53.156323 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 20:17:53.152474 => 20:17:53.155959
[0m20:17:53.156770 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m20:17:53.157520 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 20:17:53.157191 => 20:17:53.157202
[0m20:17:53.158698 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m20:17:53.160042 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m20:17:53.160940 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_order_detail)
[0m20:17:53.161485 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m20:17:53.165406 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m20:17:53.166214 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 20:17:53.161826 => 20:17:53.165902
[0m20:17:53.166743 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m20:17:53.167438 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 20:17:53.167112 => 20:17:53.167123
[0m20:17:53.168535 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m20:17:53.169134 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m20:17:53.169940 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.fct_payment_details)
[0m20:17:53.170458 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m20:17:53.173969 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m20:17:53.174769 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 20:17:53.170758 => 20:17:53.174457
[0m20:17:53.175385 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m20:17:53.175990 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 20:17:53.175706 => 20:17:53.175717
[0m20:17:53.177073 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m20:17:53.178033 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m20:17:53.178752 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.product_sales)
[0m20:17:53.179272 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m20:17:53.183458 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m20:17:53.184254 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 20:17:53.179702 => 20:17:53.183947
[0m20:17:53.184745 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m20:17:53.185378 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 20:17:53.185103 => 20:17:53.185114
[0m20:17:53.186541 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m20:17:53.187729 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:53.188289 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m20:17:53.190706 [debug] [MainThread]: Command end result
[0m20:17:53.200530 [debug] [MainThread]: Command `dbt compile` succeeded at 20:17:53.200332 after 2.73 seconds
[0m20:17:53.201146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e5e5c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02e00570d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02deebdfa0>]}
[0m20:17:53.201786 [debug] [MainThread]: Flushing usage events
[0m20:22:56.014899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f982ea515b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f982d3136a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f982d313550>]}


============================== 20:22:56.018176 | 02f22d20-a921-4707-882e-c3e6d7bfeec3 ==============================
[0m20:22:56.018176 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:22:56.018901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:22:56.022413 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'default' does not have a target named 'prod'. The valid target names for this profile are:
   - dev
[0m20:22:56.023280 [debug] [MainThread]: Command `dbt run` failed at 20:22:56.023081 after 0.03 seconds
[0m20:22:56.023881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f982ea515b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f982d313970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f982d3138e0>]}
[0m20:22:56.024351 [debug] [MainThread]: Flushing usage events
[0m20:23:02.624197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4d8af5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4c171730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4c171580>]}


============================== 20:23:02.627773 | 36811ba5-039b-4454-aeec-8a399c75a855 ==============================
[0m20:23:02.627773 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:23:02.628510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:23:02.631991 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'default' does not have a target named 'prod'. The valid target names for this profile are:
   - dev
[0m20:23:02.632947 [debug] [MainThread]: Command `dbt run` failed at 20:23:02.632702 after 0.03 seconds
[0m20:23:02.633404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4d8af5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4c171970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe4c1718e0>]}
[0m20:23:02.633925 [debug] [MainThread]: Flushing usage events
[0m20:23:09.145225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f176d6eb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f176bfd5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f176bfd53d0>]}


============================== 20:23:09.148920 | df4c6e39-c5d0-4223-bbb5-0018fd35df7e ==============================
[0m20:23:09.148920 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:23:09.149621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:23:09.154303 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'default' does not have a target named 'prod'. The valid target names for this profile are:
   - dev
[0m20:23:09.155193 [debug] [MainThread]: Command `dbt run` failed at 20:23:09.155015 after 0.03 seconds
[0m20:23:09.155828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f176d6eb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f176bfd5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f176bfa4a30>]}
[0m20:23:09.156333 [debug] [MainThread]: Flushing usage events
[0m20:23:15.621001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f910815e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f8f973790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f8f973640>]}


============================== 20:23:15.624790 | fc209b92-657a-4dcf-8265-ddbb4d7bf274 ==============================
[0m20:23:15.624790 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:23:15.626128 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:23:15.629862 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'default' does not have a target named 'prod'. The valid target names for this profile are:
   - dev
[0m20:23:15.631668 [debug] [MainThread]: Command `dbt run` failed at 20:23:15.631499 after 0.03 seconds
[0m20:23:15.632128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f910815e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f8f973700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8f8f973220>]}
[0m20:23:15.632696 [debug] [MainThread]: Flushing usage events
[0m20:24:23.286503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c0dcc520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bf68e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bf68e160>]}


============================== 20:24:23.290465 | fd313e9c-437a-45d0-b8b4-ca130841d98c ==============================
[0m20:24:23.290465 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:24:23.291579 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:24:23.295809 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'default' does not have a target named 'prod'. The valid target names for this profile are:
   - dev
[0m20:24:23.296660 [debug] [MainThread]: Command `dbt run` failed at 20:24:23.296490 after 0.03 seconds
[0m20:24:23.297126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99c0dcc520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bf68e820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99bf654ac0>]}
[0m20:24:23.297754 [debug] [MainThread]: Flushing usage events
[0m20:24:30.138516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddeec365b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdded4f8730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdded4f8160>]}


============================== 20:24:30.142042 | 2a15eb5e-b204-4e5d-90bf-0bbc7198d5b4 ==============================
[0m20:24:30.142042 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:24:30.142790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:24:30.146540 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'default' does not have a target named 'prod'. The valid target names for this profile are:
   - dev
[0m20:24:30.147558 [debug] [MainThread]: Command `dbt run` failed at 20:24:30.147376 after 0.03 seconds
[0m20:24:30.148010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fddeec365b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdded4f8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdded4f88e0>]}
[0m20:24:30.148521 [debug] [MainThread]: Flushing usage events
[0m20:24:36.640689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1caee75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c97a8730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c97a8160>]}


============================== 20:24:36.644953 | 80b37e3c-256c-4410-9db0-d9a9b3550cf3 ==============================
[0m20:24:36.644953 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:24:36.645671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:24:36.649384 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'default' does not have a target named 'prod'. The valid target names for this profile are:
   - dev
[0m20:24:36.650216 [debug] [MainThread]: Command `dbt run` failed at 20:24:36.650059 after 0.03 seconds
[0m20:24:36.650652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1caee75b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c97a8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1c97a88e0>]}
[0m20:24:36.651117 [debug] [MainThread]: Flushing usage events
[0m20:24:43.120979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21ec06c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21ea92e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21ea92e100>]}


============================== 20:24:43.124171 | 0000b0aa-e053-44cf-b8d3-c1a8c36c9fbd ==============================
[0m20:24:43.124171 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:24:43.124859 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:24:43.128967 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'default' does not have a target named 'prod'. The valid target names for this profile are:
   - dev
[0m20:24:43.129819 [debug] [MainThread]: Command `dbt run` failed at 20:24:43.129674 after 0.03 seconds
[0m20:24:43.130345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21ec06c5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21ea92e970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21ea92e8e0>]}
[0m20:24:43.130812 [debug] [MainThread]: Flushing usage events
[0m20:27:44.244300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe300e3e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ff728550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ff728310>]}


============================== 20:27:44.247893 | 71f4e867-b2d7-448a-a681-974a35d635f0 ==============================
[0m20:27:44.247893 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:27:44.248653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:27:44.548616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71f4e867-b2d7-448a-a681-974a35d635f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fb0480a0>]}
[0m20:27:44.569825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71f4e867-b2d7-448a-a681-974a35d635f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fb047400>]}
[0m20:27:44.585792 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:27:44.612528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:27:44.612912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:27:44.613698 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m20:27:44.621682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71f4e867-b2d7-448a-a681-974a35d635f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f9eb7970>]}
[0m20:27:44.629608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71f4e867-b2d7-448a-a681-974a35d635f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f9f0c8e0>]}
[0m20:27:44.630144 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:27:44.630699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71f4e867-b2d7-448a-a681-974a35d635f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f9f0c730>]}
[0m20:27:44.632125 [info ] [MainThread]: 
[0m20:27:44.633032 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:27:44.634412 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:27:44.653097 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:27:44.653606 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:27:44.654104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:45.492869 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m20:27:45.496140 [debug] [ThreadPool]: On list_external_db: Close
[0m20:27:45.600891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now create_external_db_sales)
[0m20:27:45.601844 [debug] [ThreadPool]: Creating schema "database: "external_db"
schema: "sales"
"
[0m20:27:45.609138 [debug] [ThreadPool]: Using snowflake connection "create_external_db_sales"
[0m20:27:45.609639 [debug] [ThreadPool]: On create_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "create_external_db_sales"} */
create schema if not exists external_db.sales
[0m20:27:45.610196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:45.925058 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:27:45.926598 [debug] [ThreadPool]: On create_external_db_sales: Close
[0m20:27:46.024254 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_sales'
[0m20:27:46.033618 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m20:27:46.034097 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m20:27:46.034489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:46.372493 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m20:27:46.374794 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m20:27:46.478369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71f4e867-b2d7-448a-a681-974a35d635f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f9f0c640>]}
[0m20:27:46.479768 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:27:46.480603 [info ] [MainThread]: 
[0m20:27:46.485858 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m20:27:46.486590 [info ] [Thread-1  ]: 1 of 1 START sql view model sales.bronze_orders ................................ [RUN]
[0m20:27:46.487884 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_orders)
[0m20:27:46.488829 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m20:27:46.493137 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m20:27:46.494322 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 20:27:46.489204 => 20:27:46.493936
[0m20:27:46.494883 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m20:27:46.537879 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m20:27:46.539193 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m20:27:46.539766 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace   view external_db.sales.bronze_orders
  
   as (
    with orders as (
     select * from external_db.stage.orders
)

select * from orders
  );
[0m20:27:46.540304 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:27:47.093408 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:27:47.122811 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 20:27:46.495323 => 20:27:47.122467
[0m20:27:47.123515 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m20:27:47.223758 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71f4e867-b2d7-448a-a681-974a35d635f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f8935df0>]}
[0m20:27:47.224693 [info ] [Thread-1  ]: 1 of 1 OK created sql view model sales.bronze_orders ........................... [[32mSUCCESS 1[0m in 0.74s]
[0m20:27:47.225659 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m20:27:47.228074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:47.228542 [debug] [MainThread]: Connection 'create_external_db_sales' was properly closed.
[0m20:27:47.228928 [debug] [MainThread]: Connection 'model.development.bronze_orders' was properly closed.
[0m20:27:47.229401 [info ] [MainThread]: 
[0m20:27:47.229969 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.60 seconds (2.60s).
[0m20:27:47.231128 [debug] [MainThread]: Command end result
[0m20:27:47.239391 [info ] [MainThread]: 
[0m20:27:47.239990 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:27:47.240737 [info ] [MainThread]: 
[0m20:27:47.241327 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:27:47.242348 [debug] [MainThread]: Command `dbt run` succeeded at 20:27:47.242151 after 3.02 seconds
[0m20:27:47.242842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe300e3e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2fb047400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2f9e78730>]}
[0m20:27:47.243523 [debug] [MainThread]: Flushing usage events
[0m20:27:54.042973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c757264c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7401b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c7401b5b0>]}


============================== 20:27:54.046444 | f27572a2-d058-4192-bccd-e1e585c4c3b9 ==============================
[0m20:27:54.046444 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:27:54.047126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:27:54.358555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f27572a2-d058-4192-bccd-e1e585c4c3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c6f93b0a0>]}
[0m20:27:54.383741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f27572a2-d058-4192-bccd-e1e585c4c3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c6f93a400>]}
[0m20:27:54.400310 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:27:54.430611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:27:54.431196 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:27:54.432375 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.intermediate
- models.development.bronze
[0m20:27:54.441096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f27572a2-d058-4192-bccd-e1e585c4c3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c6e7b7970>]}
[0m20:27:54.449906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f27572a2-d058-4192-bccd-e1e585c4c3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c6f80d820>]}
[0m20:27:54.450504 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:27:54.451277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f27572a2-d058-4192-bccd-e1e585c4c3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c6f80d8e0>]}
[0m20:27:54.453016 [info ] [MainThread]: 
[0m20:27:54.454017 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:27:54.455481 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:27:54.474725 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:27:54.475242 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:27:54.475746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:54.936173 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:27:54.940004 [debug] [ThreadPool]: On list_external_db: Close
[0m20:27:55.045142 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_sales)
[0m20:27:55.055317 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m20:27:55.055921 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m20:27:55.056332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:55.348961 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:27:55.351003 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m20:27:55.449243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f27572a2-d058-4192-bccd-e1e585c4c3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c6f80d640>]}
[0m20:27:55.450398 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:27:55.450966 [info ] [MainThread]: 
[0m20:27:55.455740 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m20:27:55.456500 [info ] [Thread-1  ]: 1 of 1 START sql view model sales.bronze_payments .............................. [RUN]
[0m20:27:55.457616 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_payments)
[0m20:27:55.458124 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m20:27:55.461781 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m20:27:55.462571 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 20:27:55.458447 => 20:27:55.462240
[0m20:27:55.463188 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m20:27:55.500232 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m20:27:55.501158 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m20:27:55.501749 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace   view external_db.sales.bronze_payments
  
   as (
    with payments as (
     select * from external_db.stage.payments
)

select * from payments
  );
[0m20:27:55.502204 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:27:56.034962 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:27:56.066774 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 20:27:55.463596 => 20:27:56.066474
[0m20:27:56.067402 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m20:27:56.184924 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f27572a2-d058-4192-bccd-e1e585c4c3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c6c1cac70>]}
[0m20:27:56.186101 [info ] [Thread-1  ]: 1 of 1 OK created sql view model sales.bronze_payments ......................... [[32mSUCCESS 1[0m in 0.73s]
[0m20:27:56.187405 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m20:27:56.189500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:56.189992 [debug] [MainThread]: Connection 'model.development.bronze_payments' was properly closed.
[0m20:27:56.190449 [info ] [MainThread]: 
[0m20:27:56.191041 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.74 seconds (1.74s).
[0m20:27:56.192253 [debug] [MainThread]: Command end result
[0m20:27:56.200599 [info ] [MainThread]: 
[0m20:27:56.201331 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:27:56.201908 [info ] [MainThread]: 
[0m20:27:56.202803 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:27:56.203834 [debug] [MainThread]: Command `dbt run` succeeded at 20:27:56.203637 after 2.18 seconds
[0m20:27:56.204349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c757264c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c6f93a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c6e79edc0>]}
[0m20:27:56.204821 [debug] [MainThread]: Flushing usage events
[0m20:28:02.842156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ec3485b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39eac3b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39eac3b1c0>]}


============================== 20:28:02.846210 | b2254e3a-98a3-4261-b4b8-b9d4697dd9d1 ==============================
[0m20:28:02.846210 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:28:02.847288 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:28:03.186508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2254e3a-98a3-4261-b4b8-b9d4697dd9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e6537b50>]}
[0m20:28:03.208846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2254e3a-98a3-4261-b4b8-b9d4697dd9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e6554040>]}
[0m20:28:03.225386 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:28:03.257689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:03.258256 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:03.259294 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.intermediate
- models.development.bronze
[0m20:28:03.267886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2254e3a-98a3-4261-b4b8-b9d4697dd9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e53b6b20>]}
[0m20:28:03.276500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2254e3a-98a3-4261-b4b8-b9d4697dd9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e64319d0>]}
[0m20:28:03.277192 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:28:03.277816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2254e3a-98a3-4261-b4b8-b9d4697dd9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e6431a90>]}
[0m20:28:03.279354 [info ] [MainThread]: 
[0m20:28:03.280414 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:28:03.282029 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:28:03.300999 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:28:03.301622 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:28:03.302054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:03.933105 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:28:03.935875 [debug] [ThreadPool]: On list_external_db: Close
[0m20:28:04.085617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_sales)
[0m20:28:04.096012 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m20:28:04.096490 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m20:28:04.096934 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:04.394579 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m20:28:04.397240 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m20:28:04.501211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2254e3a-98a3-4261-b4b8-b9d4697dd9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e64312b0>]}
[0m20:28:04.502324 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:28:04.502897 [info ] [MainThread]: 
[0m20:28:04.508149 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m20:28:04.509021 [info ] [Thread-1  ]: 1 of 1 START sql view model sales.bronze_products .............................. [RUN]
[0m20:28:04.509954 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_products)
[0m20:28:04.510641 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m20:28:04.515015 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m20:28:04.515919 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 20:28:04.511057 => 20:28:04.515603
[0m20:28:04.516401 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m20:28:04.555734 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m20:28:04.557038 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m20:28:04.557678 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace   view external_db.sales.bronze_products
  
   as (
    with products as (
     select * from external_db.stage.products
)

select * from products
  );
[0m20:28:04.558327 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:28:04.931283 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:28:04.959277 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 20:28:04.516710 => 20:28:04.958983
[0m20:28:04.959812 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m20:28:05.057925 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2254e3a-98a3-4261-b4b8-b9d4697dd9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e4634d30>]}
[0m20:28:05.059020 [info ] [Thread-1  ]: 1 of 1 OK created sql view model sales.bronze_products ......................... [[32mSUCCESS 1[0m in 0.55s]
[0m20:28:05.060250 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m20:28:05.062523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:05.062965 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m20:28:05.063467 [info ] [MainThread]: 
[0m20:28:05.064029 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.78 seconds (1.78s).
[0m20:28:05.065173 [debug] [MainThread]: Command end result
[0m20:28:05.073795 [info ] [MainThread]: 
[0m20:28:05.074460 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:05.075147 [info ] [MainThread]: 
[0m20:28:05.075893 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:28:05.076957 [debug] [MainThread]: Command `dbt run` succeeded at 20:28:05.076779 after 2.26 seconds
[0m20:28:05.078318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39ec3485b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e4812a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e6506eb0>]}
[0m20:28:05.078868 [debug] [MainThread]: Flushing usage events
[0m20:28:11.761928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07f3c595b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07f2542760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07f2542130>]}


============================== 20:28:11.765708 | 3a081f7f-901c-4c81-87e2-3fddece99978 ==============================
[0m20:28:11.765708 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:28:11.766526 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:28:12.075867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a081f7f-901c-4c81-87e2-3fddece99978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ede62130>]}
[0m20:28:12.098556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a081f7f-901c-4c81-87e2-3fddece99978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ede56040>]}
[0m20:28:12.114701 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:28:12.140848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:12.141262 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:12.142015 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.intermediate
- models.development.bronze
[0m20:28:12.149761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a081f7f-901c-4c81-87e2-3fddece99978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07eccb6af0>]}
[0m20:28:12.164046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a081f7f-901c-4c81-87e2-3fddece99978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ecd0c8b0>]}
[0m20:28:12.165053 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:28:12.165710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a081f7f-901c-4c81-87e2-3fddece99978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ecd0caf0>]}
[0m20:28:12.167178 [info ] [MainThread]: 
[0m20:28:12.169036 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:28:12.171329 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:28:12.189620 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:28:12.190129 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:28:12.190571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:12.798410 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:28:12.801667 [debug] [ThreadPool]: On list_external_db: Close
[0m20:28:12.898923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_sales)
[0m20:28:12.909237 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m20:28:12.909769 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m20:28:12.910532 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:13.203698 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m20:28:13.206034 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m20:28:13.303223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a081f7f-901c-4c81-87e2-3fddece99978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ecd0c280>]}
[0m20:28:13.304460 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:28:13.305053 [info ] [MainThread]: 
[0m20:28:13.309844 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m20:28:13.310515 [info ] [Thread-1  ]: 1 of 1 START sql view model sales.bronze_customers ............................. [RUN]
[0m20:28:13.311655 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_customers)
[0m20:28:13.312226 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m20:28:13.316157 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m20:28:13.317191 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 20:28:13.312654 => 20:28:13.316780
[0m20:28:13.317761 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m20:28:13.358213 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m20:28:13.359484 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m20:28:13.360151 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace   view external_db.sales.bronze_customers
  
   as (
    with customers as (
     select * from external_db.stage.customers
)

select * from customers
  );
[0m20:28:13.360684 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:28:13.748627 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:28:13.776865 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 20:28:13.318161 => 20:28:13.776537
[0m20:28:13.777373 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m20:28:13.881844 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a081f7f-901c-4c81-87e2-3fddece99978', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07e6721f10>]}
[0m20:28:13.883055 [info ] [Thread-1  ]: 1 of 1 OK created sql view model sales.bronze_customers ........................ [[32mSUCCESS 1[0m in 0.57s]
[0m20:28:13.884123 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m20:28:13.886452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:13.887034 [debug] [MainThread]: Connection 'model.development.bronze_customers' was properly closed.
[0m20:28:13.887692 [info ] [MainThread]: 
[0m20:28:13.888308 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.72 seconds (1.72s).
[0m20:28:13.889430 [debug] [MainThread]: Command end result
[0m20:28:13.897776 [info ] [MainThread]: 
[0m20:28:13.898395 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:13.898898 [info ] [MainThread]: 
[0m20:28:13.899452 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:28:13.900480 [debug] [MainThread]: Command `dbt run` succeeded at 20:28:13.900287 after 2.16 seconds
[0m20:28:13.901051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07f3c595b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ede56040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07ec045e20>]}
[0m20:28:13.901491 [debug] [MainThread]: Flushing usage events
[0m20:28:20.860176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7022574550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7020e36700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7020e36130>]}


============================== 20:28:20.863289 | f99187bb-c975-4eaa-bc08-b3a7fb98a3b1 ==============================
[0m20:28:20.863289 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:28:20.864133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:28:21.169312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f99187bb-c975-4eaa-bc08-b3a7fb98a3b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701c70e0a0>]}
[0m20:28:21.190404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f99187bb-c975-4eaa-bc08-b3a7fb98a3b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701c753070>]}
[0m20:28:21.206610 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:28:21.232825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:21.233219 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:21.234156 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m20:28:21.242563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f99187bb-c975-4eaa-bc08-b3a7fb98a3b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701b5b6a00>]}
[0m20:28:21.251033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f99187bb-c975-4eaa-bc08-b3a7fb98a3b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701c6248b0>]}
[0m20:28:21.251915 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:28:21.252630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f99187bb-c975-4eaa-bc08-b3a7fb98a3b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701c624970>]}
[0m20:28:21.254047 [info ] [MainThread]: 
[0m20:28:21.254964 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:28:21.256595 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:28:21.274457 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:28:21.275216 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:28:21.275736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:21.869780 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:28:21.872813 [debug] [ThreadPool]: On list_external_db: Close
[0m20:28:22.009663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_sales)
[0m20:28:22.022041 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m20:28:22.022529 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m20:28:22.023003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:22.326438 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:28:22.329085 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m20:28:22.431355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f99187bb-c975-4eaa-bc08-b3a7fb98a3b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701c6246d0>]}
[0m20:28:22.432640 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:28:22.433327 [info ] [MainThread]: 
[0m20:28:22.438591 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m20:28:22.439378 [info ] [Thread-1  ]: 1 of 1 START sql view model sales.bronze_orders ................................ [RUN]
[0m20:28:22.440401 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_orders)
[0m20:28:22.440911 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m20:28:22.445730 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m20:28:22.446657 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 20:28:22.441271 => 20:28:22.446341
[0m20:28:22.447300 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m20:28:22.485393 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m20:28:22.486449 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m20:28:22.487095 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace   view external_db.sales.bronze_orders
  
   as (
    with orders as (
     select * from external_db.stage.orders
)

select * from orders
  );
[0m20:28:22.487658 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:28:22.869281 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:28:22.901493 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 20:28:22.447621 => 20:28:22.901189
[0m20:28:22.902085 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m20:28:23.014432 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f99187bb-c975-4eaa-bc08-b3a7fb98a3b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701aa0b910>]}
[0m20:28:23.015437 [info ] [Thread-1  ]: 1 of 1 OK created sql view model sales.bronze_orders ........................... [[32mSUCCESS 1[0m in 0.57s]
[0m20:28:23.016408 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m20:28:23.018549 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:23.018974 [debug] [MainThread]: Connection 'model.development.bronze_orders' was properly closed.
[0m20:28:23.019434 [info ] [MainThread]: 
[0m20:28:23.020030 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.76 seconds (1.76s).
[0m20:28:23.021333 [debug] [MainThread]: Command end result
[0m20:28:23.031079 [info ] [MainThread]: 
[0m20:28:23.031894 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:23.032430 [info ] [MainThread]: 
[0m20:28:23.033008 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:28:23.034271 [debug] [MainThread]: Command `dbt run` succeeded at 20:28:23.034096 after 2.19 seconds
[0m20:28:23.034787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7022574550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701aa0b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f701b596f40>]}
[0m20:28:23.035405 [debug] [MainThread]: Flushing usage events
[0m20:28:29.705498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3bceb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3a5c9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3a5c9640>]}


============================== 20:28:29.708816 | eac93127-5417-4e78-8cef-dc3009429fbf ==============================
[0m20:28:29.708816 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:28:29.709599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:28:30.030407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eac93127-5417-4e78-8cef-dc3009429fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed35eec0a0>]}
[0m20:28:30.050379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eac93127-5417-4e78-8cef-dc3009429fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed35ee7070>]}
[0m20:28:30.072264 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:28:30.111624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:30.112175 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:30.113045 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.staging
- models.development.intermediate
[0m20:28:30.121262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eac93127-5417-4e78-8cef-dc3009429fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed34d38a00>]}
[0m20:28:30.129412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eac93127-5417-4e78-8cef-dc3009429fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed34d868b0>]}
[0m20:28:30.130071 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:28:30.130604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eac93127-5417-4e78-8cef-dc3009429fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed34d86970>]}
[0m20:28:30.132089 [info ] [MainThread]: 
[0m20:28:30.133022 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:28:30.134364 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:28:30.152676 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:28:30.153187 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:28:30.153913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:30.803740 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:28:30.806397 [debug] [ThreadPool]: On list_external_db: Close
[0m20:28:30.915563 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_sales)
[0m20:28:30.924824 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m20:28:30.925386 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m20:28:30.925838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:31.361915 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:28:31.364689 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m20:28:31.465941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eac93127-5417-4e78-8cef-dc3009429fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed34d866d0>]}
[0m20:28:31.467209 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:28:31.468031 [info ] [MainThread]: 
[0m20:28:31.473720 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m20:28:31.474560 [info ] [Thread-1  ]: 1 of 1 START sql view model sales.bronze_payments .............................. [RUN]
[0m20:28:31.475556 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_payments)
[0m20:28:31.476080 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m20:28:31.480198 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m20:28:31.481197 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 20:28:31.476449 => 20:28:31.480767
[0m20:28:31.482178 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m20:28:31.520291 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m20:28:31.521461 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m20:28:31.521942 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace   view external_db.sales.bronze_payments
  
   as (
    with payments as (
     select * from external_db.stage.payments
)

select * from payments
  );
[0m20:28:31.522615 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:28:31.947689 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:28:31.982820 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 20:28:31.482548 => 20:28:31.982535
[0m20:28:31.983429 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m20:28:32.097480 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eac93127-5417-4e78-8cef-dc3009429fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed2efa2fd0>]}
[0m20:28:32.098445 [info ] [Thread-1  ]: 1 of 1 OK created sql view model sales.bronze_payments ......................... [[32mSUCCESS 1[0m in 0.62s]
[0m20:28:32.099881 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m20:28:32.102192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:32.102736 [debug] [MainThread]: Connection 'model.development.bronze_payments' was properly closed.
[0m20:28:32.103224 [info ] [MainThread]: 
[0m20:28:32.103936 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.97 seconds (1.97s).
[0m20:28:32.105314 [debug] [MainThread]: Command end result
[0m20:28:32.113723 [info ] [MainThread]: 
[0m20:28:32.114384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:32.115007 [info ] [MainThread]: 
[0m20:28:32.115624 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:28:32.116674 [debug] [MainThread]: Command `dbt run` succeeded at 20:28:32.116444 after 2.43 seconds
[0m20:28:32.117182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed3bceb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed34122d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed34d16f40>]}
[0m20:28:32.117712 [debug] [MainThread]: Flushing usage events
[0m20:28:38.596173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea6a610550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea68ed2670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea68ed2130>]}


============================== 20:28:38.599849 | 04dd10ff-0d19-403c-878e-bb71caa5b011 ==============================
[0m20:28:38.599849 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:28:38.600546 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:28:38.906483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04dd10ff-0d19-403c-878e-bb71caa5b011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea647aa0a0>]}
[0m20:28:38.927025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04dd10ff-0d19-403c-878e-bb71caa5b011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea647ef100>]}
[0m20:28:38.942752 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:28:38.968171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:38.968595 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:38.969639 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.bronze
- models.development.staging
[0m20:28:38.977662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04dd10ff-0d19-403c-878e-bb71caa5b011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea6466fa00>]}
[0m20:28:38.985889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04dd10ff-0d19-403c-878e-bb71caa5b011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea646c28b0>]}
[0m20:28:38.986527 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:28:38.987198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04dd10ff-0d19-403c-878e-bb71caa5b011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea646c2970>]}
[0m20:28:38.988618 [info ] [MainThread]: 
[0m20:28:38.989676 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:28:38.991372 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:28:39.009248 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:28:39.009879 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:28:39.010345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:39.548856 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:28:39.552086 [debug] [ThreadPool]: On list_external_db: Close
[0m20:28:39.672603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_sales)
[0m20:28:39.683103 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m20:28:39.683568 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m20:28:39.684121 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:39.997512 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:28:39.999816 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m20:28:40.108647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04dd10ff-0d19-403c-878e-bb71caa5b011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea646c26d0>]}
[0m20:28:40.109993 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:28:40.110634 [info ] [MainThread]: 
[0m20:28:40.115932 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m20:28:40.116648 [info ] [Thread-1  ]: 1 of 1 START sql view model sales.bronze_products .............................. [RUN]
[0m20:28:40.117784 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_products)
[0m20:28:40.118566 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m20:28:40.122888 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m20:28:40.124168 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 20:28:40.119054 => 20:28:40.123698
[0m20:28:40.124616 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m20:28:40.164534 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m20:28:40.165821 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m20:28:40.166546 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace   view external_db.sales.bronze_products
  
   as (
    with products as (
     select * from external_db.stage.products
)

select * from products
  );
[0m20:28:40.167116 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:28:40.605220 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:28:40.636504 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 20:28:40.125053 => 20:28:40.636219
[0m20:28:40.637041 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m20:28:40.772449 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04dd10ff-0d19-403c-878e-bb71caa5b011', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea61079d30>]}
[0m20:28:40.773565 [info ] [Thread-1  ]: 1 of 1 OK created sql view model sales.bronze_products ......................... [[32mSUCCESS 1[0m in 0.65s]
[0m20:28:40.774505 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m20:28:40.776620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:40.776969 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m20:28:40.777482 [info ] [MainThread]: 
[0m20:28:40.778036 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.79 seconds (1.79s).
[0m20:28:40.779155 [debug] [MainThread]: Command end result
[0m20:28:40.787607 [info ] [MainThread]: 
[0m20:28:40.788234 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:40.788743 [info ] [MainThread]: 
[0m20:28:40.789282 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:28:40.790432 [debug] [MainThread]: Command `dbt run` succeeded at 20:28:40.790202 after 2.21 seconds
[0m20:28:40.790948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea6a610550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea62da9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea6464ef40>]}
[0m20:28:40.791524 [debug] [MainThread]: Flushing usage events
[0m20:28:47.195627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3073add580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307239f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f307239f130>]}


============================== 20:28:47.199216 | f9d5bb66-0479-4034-8214-fc09ac3fd631 ==============================
[0m20:28:47.199216 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:28:47.199931 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:28:47.508542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f9d5bb66-0479-4034-8214-fc09ac3fd631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306dcbc0d0>]}
[0m20:28:47.531524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f9d5bb66-0479-4034-8214-fc09ac3fd631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306dcbf040>]}
[0m20:28:47.549027 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:28:47.578080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:47.578570 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:47.579463 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.intermediate
- models.development.bronze
[0m20:28:47.588326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9d5bb66-0479-4034-8214-fc09ac3fd631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306cb36a30>]}
[0m20:28:47.597498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f9d5bb66-0479-4034-8214-fc09ac3fd631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306cb8d8e0>]}
[0m20:28:47.598101 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:28:47.598653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9d5bb66-0479-4034-8214-fc09ac3fd631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306cb8d9a0>]}
[0m20:28:47.600161 [info ] [MainThread]: 
[0m20:28:47.601436 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:28:47.602874 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:28:47.623229 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:28:47.623976 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:28:47.624461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:48.251859 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:28:48.254841 [debug] [ThreadPool]: On list_external_db: Close
[0m20:28:48.354209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_sales)
[0m20:28:48.364380 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m20:28:48.364880 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m20:28:48.365289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:48.822108 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:28:48.824510 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m20:28:48.930887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f9d5bb66-0479-4034-8214-fc09ac3fd631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306cb8d280>]}
[0m20:28:48.932205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:28:48.932842 [info ] [MainThread]: 
[0m20:28:48.937684 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m20:28:48.938452 [info ] [Thread-1  ]: 1 of 1 START sql view model sales.bronze_customers ............................. [RUN]
[0m20:28:48.939591 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.bronze_customers)
[0m20:28:48.940232 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m20:28:48.944634 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m20:28:48.945695 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 20:28:48.940701 => 20:28:48.945256
[0m20:28:48.946360 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m20:28:48.987651 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m20:28:48.988808 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m20:28:48.989429 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace   view external_db.sales.bronze_customers
  
   as (
    with customers as (
     select * from external_db.stage.customers
)

select * from customers
  );
[0m20:28:48.989939 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:28:49.354058 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:28:49.388766 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 20:28:48.946752 => 20:28:49.388422
[0m20:28:49.389399 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m20:28:49.486652 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9d5bb66-0479-4034-8214-fc09ac3fd631', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306655ffd0>]}
[0m20:28:49.487775 [info ] [Thread-1  ]: 1 of 1 OK created sql view model sales.bronze_customers ........................ [[32mSUCCESS 1[0m in 0.55s]
[0m20:28:49.488804 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m20:28:49.490839 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:49.491431 [debug] [MainThread]: Connection 'model.development.bronze_customers' was properly closed.
[0m20:28:49.491909 [info ] [MainThread]: 
[0m20:28:49.492499 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m20:28:49.493548 [debug] [MainThread]: Command end result
[0m20:28:49.502564 [info ] [MainThread]: 
[0m20:28:49.503191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:49.503793 [info ] [MainThread]: 
[0m20:28:49.504433 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:28:49.505481 [debug] [MainThread]: Command `dbt run` succeeded at 20:28:49.505307 after 2.33 seconds
[0m20:28:49.506009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3073add580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306dcbf040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f306cb1d430>]}
[0m20:28:49.506563 [debug] [MainThread]: Flushing usage events
[0m20:28:56.442130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e410cc520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3f98e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3f98e2e0>]}


============================== 20:28:56.446461 | b306fb9d-ecfc-429d-b88b-4da7b3939d37 ==============================
[0m20:28:56.446461 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:28:56.447206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:28:56.759780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b306fb9d-ecfc-429d-b88b-4da7b3939d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3b2af130>]}
[0m20:28:56.786807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b306fb9d-ecfc-429d-b88b-4da7b3939d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3b2ac040>]}
[0m20:28:56.803357 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:28:56.830077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:28:56.830453 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:28:56.831599 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m20:28:56.839878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b306fb9d-ecfc-429d-b88b-4da7b3939d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3a0f69d0>]}
[0m20:28:56.848075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b306fb9d-ecfc-429d-b88b-4da7b3939d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3a14c880>]}
[0m20:28:56.848818 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:28:56.849374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b306fb9d-ecfc-429d-b88b-4da7b3939d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3a14c940>]}
[0m20:28:56.851095 [info ] [MainThread]: 
[0m20:28:56.852155 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:28:56.853586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:28:56.873075 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:28:56.873635 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:28:56.874184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:28:57.419332 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:28:57.422612 [debug] [ThreadPool]: On list_external_db: Close
[0m20:28:57.547846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_sales)
[0m20:28:57.558184 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m20:28:57.558814 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m20:28:57.559288 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:28:57.867498 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:28:57.870014 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m20:28:57.978069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b306fb9d-ecfc-429d-b88b-4da7b3939d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3a14c6a0>]}
[0m20:28:57.979231 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:28:57.979832 [info ] [MainThread]: 
[0m20:28:57.985336 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m20:28:57.986119 [info ] [Thread-1  ]: 1 of 1 START sql view model sales.fct_payment_details .......................... [RUN]
[0m20:28:57.987190 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.fct_payment_details)
[0m20:28:57.988040 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m20:28:57.993049 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m20:28:57.994146 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 20:28:57.988384 => 20:28:57.993847
[0m20:28:57.994699 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m20:28:58.032531 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m20:28:58.033742 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m20:28:58.034406 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace   view external_db.sales.fct_payment_details
  
   as (
    with payments as (
    select * from external_db.sales.bronze_payments
),

final as(
    select 
    payment_id,
    payment_method,
    order_id

    from payments where status = 'success'
)

select * from final
  );
[0m20:28:58.035013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:28:58.461164 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:28:58.488701 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 20:28:57.995056 => 20:28:58.488405
[0m20:28:58.489235 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m20:28:58.593222 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b306fb9d-ecfc-429d-b88b-4da7b3939d37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e38386fa0>]}
[0m20:28:58.594320 [info ] [Thread-1  ]: 1 of 1 OK created sql view model sales.fct_payment_details ..................... [[32mSUCCESS 1[0m in 0.61s]
[0m20:28:58.595440 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m20:28:58.597617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:28:58.598127 [debug] [MainThread]: Connection 'model.development.fct_payment_details' was properly closed.
[0m20:28:58.598574 [info ] [MainThread]: 
[0m20:28:58.599111 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m20:28:58.600448 [debug] [MainThread]: Command end result
[0m20:28:58.608678 [info ] [MainThread]: 
[0m20:28:58.609291 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:28:58.609925 [info ] [MainThread]: 
[0m20:28:58.610589 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:28:58.611891 [debug] [MainThread]: Command `dbt run` succeeded at 20:28:58.611718 after 2.19 seconds
[0m20:28:58.612576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e410cc520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e397367c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3a0d5f10>]}
[0m20:28:58.613099 [debug] [MainThread]: Flushing usage events
[0m20:29:05.181417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa691112580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68fa06760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68fa060a0>]}


============================== 20:29:05.184998 | be5a5e1e-e1d0-45bf-a364-21e0bba49415 ==============================
[0m20:29:05.184998 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:29:05.185829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:29:05.492318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be5a5e1e-e1d0-45bf-a364-21e0bba49415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68b325130>]}
[0m20:29:05.514830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be5a5e1e-e1d0-45bf-a364-21e0bba49415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68b326040>]}
[0m20:29:05.532458 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:29:05.560514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:29:05.560987 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:29:05.561790 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m20:29:05.571317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be5a5e1e-e1d0-45bf-a364-21e0bba49415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68a175af0>]}
[0m20:29:05.580827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be5a5e1e-e1d0-45bf-a364-21e0bba49415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68a1cc8b0>]}
[0m20:29:05.581449 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:29:05.582068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be5a5e1e-e1d0-45bf-a364-21e0bba49415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68a1ccaf0>]}
[0m20:29:05.583703 [info ] [MainThread]: 
[0m20:29:05.584758 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:29:05.586469 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:29:05.604678 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:29:05.605200 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:29:05.605623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:06.269789 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:29:06.272844 [debug] [ThreadPool]: On list_external_db: Close
[0m20:29:06.406019 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_sales)
[0m20:29:06.416407 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m20:29:06.416875 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m20:29:06.417394 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:06.716361 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m20:29:06.718693 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m20:29:06.822381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be5a5e1e-e1d0-45bf-a364-21e0bba49415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68a1cc280>]}
[0m20:29:06.823860 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:29:06.824447 [info ] [MainThread]: 
[0m20:29:06.831084 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m20:29:06.832082 [info ] [Thread-1  ]: 1 of 1 START sql view model sales.fct_order_detail ............................. [RUN]
[0m20:29:06.833099 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.fct_order_detail)
[0m20:29:06.833635 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m20:29:06.838250 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m20:29:06.839365 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 20:29:06.833988 => 20:29:06.838826
[0m20:29:06.840175 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m20:29:06.879935 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m20:29:06.881472 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m20:29:06.882002 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace   view external_db.sales.fct_order_detail
  
   as (
    with orders as (
    select * from external_db.sales.bronze_orders
),
products as (
    select * from external_db.sales.bronze_products
), 

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m20:29:06.882655 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:29:07.325143 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:29:07.353156 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 20:29:06.840603 => 20:29:07.352859
[0m20:29:07.353709 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m20:29:07.447567 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be5a5e1e-e1d0-45bf-a364-21e0bba49415', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68841a580>]}
[0m20:29:07.448757 [info ] [Thread-1  ]: 1 of 1 OK created sql view model sales.fct_order_detail ........................ [[32mSUCCESS 1[0m in 0.61s]
[0m20:29:07.450114 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m20:29:07.452213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:07.452600 [debug] [MainThread]: Connection 'model.development.fct_order_detail' was properly closed.
[0m20:29:07.453048 [info ] [MainThread]: 
[0m20:29:07.453768 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m20:29:07.454959 [debug] [MainThread]: Command end result
[0m20:29:07.463697 [info ] [MainThread]: 
[0m20:29:07.464471 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:29:07.465102 [info ] [MainThread]: 
[0m20:29:07.465918 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:29:07.466869 [debug] [MainThread]: Command `dbt run` succeeded at 20:29:07.466687 after 2.31 seconds
[0m20:29:07.467474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa691112580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68b326040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa68a1cca60>]}
[0m20:29:07.467989 [debug] [MainThread]: Flushing usage events
[0m20:29:14.335142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aafad5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aae3bf610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aae3bf3a0>]}


============================== 20:29:14.338601 | 09445b31-1244-4e82-a1be-78a4466957c7 ==============================
[0m20:29:14.338601 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:29:14.339604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:29:14.651304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09445b31-1244-4e82-a1be-78a4466957c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa9c970d0>]}
[0m20:29:14.673015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09445b31-1244-4e82-a1be-78a4466957c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa9cdb040>]}
[0m20:29:14.689134 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:29:14.716895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:29:14.717292 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:29:14.718102 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.bronze
- models.development.staging
[0m20:29:14.726745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09445b31-1244-4e82-a1be-78a4466957c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa8b37a30>]}
[0m20:29:14.734875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09445b31-1244-4e82-a1be-78a4466957c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa8b8b8e0>]}
[0m20:29:14.735456 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:29:14.735996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09445b31-1244-4e82-a1be-78a4466957c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa8b8b9a0>]}
[0m20:29:14.737593 [info ] [MainThread]: 
[0m20:29:14.738569 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:29:14.740011 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:29:14.759366 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:29:14.759830 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:29:14.760308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:15.400162 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:29:15.403071 [debug] [ThreadPool]: On list_external_db: Close
[0m20:29:15.511530 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_sales)
[0m20:29:15.522331 [debug] [ThreadPool]: Using snowflake connection "list_external_db_sales"
[0m20:29:15.522944 [debug] [ThreadPool]: On list_external_db_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_sales"} */
show terse objects in external_db.sales
[0m20:29:15.523458 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:29:15.806317 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m20:29:15.808796 [debug] [ThreadPool]: On list_external_db_sales: Close
[0m20:29:15.911056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09445b31-1244-4e82-a1be-78a4466957c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa8b8b280>]}
[0m20:29:15.912350 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:29:15.913391 [info ] [MainThread]: 
[0m20:29:15.918075 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m20:29:15.919008 [info ] [Thread-1  ]: 1 of 1 START sql view model sales.product_sales ................................ [RUN]
[0m20:29:15.920045 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_sales, now model.development.product_sales)
[0m20:29:15.920596 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m20:29:15.925276 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m20:29:15.926313 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 20:29:15.920943 => 20:29:15.925888
[0m20:29:15.926954 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m20:29:15.968057 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m20:29:15.969834 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m20:29:15.970405 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace   view external_db.sales.product_sales
  
   as (
    with order_details as (
    select * from external_db.sales.fct_order_detail
), 
customer as (
    select * from external_db.sales.bronze_customers
),
payments as (
    select * from external_db.sales.fct_payment_details
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m20:29:15.970974 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:29:16.455921 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:29:16.487310 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 20:29:15.927466 => 20:29:16.486912
[0m20:29:16.487940 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m20:29:16.591074 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09445b31-1244-4e82-a1be-78a4466957c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa2569040>]}
[0m20:29:16.592270 [info ] [Thread-1  ]: 1 of 1 OK created sql view model sales.product_sales ........................... [[32mSUCCESS 1[0m in 0.67s]
[0m20:29:16.593341 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m20:29:16.595430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:16.595881 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m20:29:16.596364 [info ] [MainThread]: 
[0m20:29:16.596964 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.86 seconds (1.86s).
[0m20:29:16.598040 [debug] [MainThread]: Command end result
[0m20:29:16.606934 [info ] [MainThread]: 
[0m20:29:16.607907 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:29:16.608477 [info ] [MainThread]: 
[0m20:29:16.609188 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:29:16.610330 [debug] [MainThread]: Command `dbt run` succeeded at 20:29:16.610139 after 2.30 seconds
[0m20:29:16.611010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aafad5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aad83acd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa8b17f70>]}
[0m20:29:16.611611 [debug] [MainThread]: Flushing usage events
[0m20:31:59.962335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60f36f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60dc4d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60dc4d1c0>]}


============================== 20:31:59.966328 | 5cff0c3a-0567-4a21-9a41-7fc363ddf5cd ==============================
[0m20:31:59.966328 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:31:59.967076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dags/dbt/logs', 'profiles_dir': 'dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:32:00.297648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cff0c3a-0567-4a21-9a41-7fc363ddf5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60955f0a0>]}
[0m20:32:00.319975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cff0c3a-0567-4a21-9a41-7fc363ddf5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60956a0d0>]}
[0m20:32:00.336839 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:32:00.346870 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:32:00.347512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5cff0c3a-0567-4a21-9a41-7fc363ddf5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60951aaf0>]}
[0m20:32:01.249187 [debug] [MainThread]: 1699: static parser successfully parsed sales/intermediate/fct_order_detail.sql
[0m20:32:01.267517 [debug] [MainThread]: 1699: static parser successfully parsed sales/intermediate/fct_payment_details.sql
[0m20:32:01.273442 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_orders.sql
[0m20:32:01.278507 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_payments.sql
[0m20:32:01.283672 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_customers.sql
[0m20:32:01.290690 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_products.sql
[0m20:32:01.295665 [debug] [MainThread]: 1699: static parser successfully parsed sales/core/product_sales.sql
[0m20:32:01.374872 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.intermediate
[0m20:32:01.382390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cff0c3a-0567-4a21-9a41-7fc363ddf5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe608389bb0>]}
[0m20:32:01.391092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cff0c3a-0567-4a21-9a41-7fc363ddf5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6080c14c0>]}
[0m20:32:01.391708 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:32:01.392247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cff0c3a-0567-4a21-9a41-7fc363ddf5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe608114880>]}
[0m20:32:01.394327 [info ] [MainThread]: 
[0m20:32:01.395761 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:32:01.397748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m20:32:01.459064 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m20:32:01.459803 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m20:32:01.460331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:32:02.195938 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01ad19d0-0000-f9de-0000-0001937e939d
[0m20:32:02.196793 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:32:02.197654 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:32:02.198072 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:32:02.199194 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m20:32:02.313284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cff0c3a-0567-4a21-9a41-7fc363ddf5cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe608114820>]}
[0m20:32:02.315005 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:32:02.315754 [info ] [MainThread]: 
[0m20:32:02.321219 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m20:32:02.322178 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m20:32:02.322735 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m20:32:02.327988 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m20:32:02.329162 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 20:32:02.323079 => 20:32:02.328769
[0m20:32:02.329752 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m20:32:02.330541 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 20:32:02.330196 => 20:32:02.330233
[0m20:32:02.331807 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m20:32:02.332460 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m20:32:02.333255 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m20:32:02.333784 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m20:32:02.337455 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m20:32:02.338402 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 20:32:02.334109 => 20:32:02.337978
[0m20:32:02.339474 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m20:32:02.340177 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 20:32:02.339863 => 20:32:02.339874
[0m20:32:02.341311 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m20:32:02.341983 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m20:32:02.342748 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m20:32:02.343334 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m20:32:02.347146 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m20:32:02.347999 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 20:32:02.343706 => 20:32:02.347691
[0m20:32:02.348904 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m20:32:02.349611 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 20:32:02.349287 => 20:32:02.349299
[0m20:32:02.350776 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m20:32:02.351384 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m20:32:02.352366 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m20:32:02.352870 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m20:32:02.356275 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m20:32:02.357067 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 20:32:02.353194 => 20:32:02.356766
[0m20:32:02.357613 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m20:32:02.358215 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 20:32:02.357928 => 20:32:02.357939
[0m20:32:02.359607 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m20:32:02.360942 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m20:32:02.361887 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_order_detail)
[0m20:32:02.362430 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m20:32:02.366258 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m20:32:02.367113 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 20:32:02.362777 => 20:32:02.366770
[0m20:32:02.367716 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m20:32:02.368449 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 20:32:02.368116 => 20:32:02.368129
[0m20:32:02.369711 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m20:32:02.370298 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m20:32:02.371044 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.fct_payment_details)
[0m20:32:02.371754 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m20:32:02.375128 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m20:32:02.376029 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 20:32:02.372157 => 20:32:02.375700
[0m20:32:02.376610 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m20:32:02.377384 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 20:32:02.377008 => 20:32:02.377020
[0m20:32:02.378671 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m20:32:02.379862 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m20:32:02.380753 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.product_sales)
[0m20:32:02.381353 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m20:32:02.385675 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m20:32:02.386629 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 20:32:02.381707 => 20:32:02.386276
[0m20:32:02.387120 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m20:32:02.387810 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 20:32:02.387521 => 20:32:02.387534
[0m20:32:02.388996 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m20:32:02.390340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:32:02.390809 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m20:32:02.393036 [debug] [MainThread]: Command end result
[0m20:32:02.404139 [debug] [MainThread]: Command `dbt compile` succeeded at 20:32:02.403925 after 2.46 seconds
[0m20:32:02.404693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe60f36f4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe609488f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6083921f0>]}
[0m20:32:02.405247 [debug] [MainThread]: Flushing usage events
[0m20:36:03.071242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f778b9d4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f778a2965e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f778a296310>]}


============================== 20:36:03.075349 | 1dbf3efc-1a8b-4e93-b6a4-0321ef06bf10 ==============================
[0m20:36:03.075349 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:36:03.076173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:36:03.399034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dbf3efc-1a8b-4e93-b6a4-0321ef06bf10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7785bb50a0>]}
[0m20:36:03.421430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dbf3efc-1a8b-4e93-b6a4-0321ef06bf10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7785ba9070>]}
[0m20:36:03.438161 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:36:03.465859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:36:03.466689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:36:03.467730 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.intermediate
- models.development.bronze
[0m20:36:03.476299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dbf3efc-1a8b-4e93-b6a4-0321ef06bf10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77849f8a00>]}
[0m20:36:03.484713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dbf3efc-1a8b-4e93-b6a4-0321ef06bf10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7785a878b0>]}
[0m20:36:03.485366 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:36:03.485902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dbf3efc-1a8b-4e93-b6a4-0321ef06bf10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7785a87970>]}
[0m20:36:03.487815 [info ] [MainThread]: 
[0m20:36:03.488967 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:36:03.490591 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:36:03.510181 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:36:03.510743 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:36:03.511323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:04.197211 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m20:36:04.200662 [debug] [ThreadPool]: On list_external_db: Close
[0m20:36:04.307885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now create_external_db_final_sales)
[0m20:36:04.309225 [debug] [ThreadPool]: Creating schema "database: "external_db"
schema: "final_sales"
"
[0m20:36:04.318920 [debug] [ThreadPool]: Using snowflake connection "create_external_db_final_sales"
[0m20:36:04.319544 [debug] [ThreadPool]: On create_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "create_external_db_final_sales"} */
create schema if not exists external_db.final_sales
[0m20:36:04.320055 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:04.823311 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:36:04.824929 [debug] [ThreadPool]: On create_external_db_final_sales: Close
[0m20:36:04.947184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_external_db_final_sales, now list_external_db_final_sales)
[0m20:36:04.956905 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m20:36:04.957452 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m20:36:04.957866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:05.233577 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m20:36:05.235825 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m20:36:05.342156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dbf3efc-1a8b-4e93-b6a4-0321ef06bf10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7785a876d0>]}
[0m20:36:05.343488 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:36:05.344278 [info ] [MainThread]: 
[0m20:36:05.348790 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m20:36:05.349500 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.bronze_orders .......................... [RUN]
[0m20:36:05.350419 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_orders)
[0m20:36:05.351870 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m20:36:05.356338 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m20:36:05.357444 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 20:36:05.352614 => 20:36:05.357056
[0m20:36:05.357950 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m20:36:05.398060 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m20:36:05.399401 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m20:36:05.400043 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace   view external_db.final_sales.bronze_orders
  
   as (
    with orders as (
     select * from external_db.stage.orders
)

select * from orders
  );
[0m20:36:05.400553 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:36:05.756505 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:36:05.784817 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 20:36:05.358294 => 20:36:05.784529
[0m20:36:05.785448 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m20:36:05.882831 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dbf3efc-1a8b-4e93-b6a4-0321ef06bf10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777fc79e50>]}
[0m20:36:05.883862 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.bronze_orders ..................... [[32mSUCCESS 1[0m in 0.53s]
[0m20:36:05.884901 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m20:36:05.887124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:05.887652 [debug] [MainThread]: Connection 'model.development.bronze_orders' was properly closed.
[0m20:36:05.888098 [info ] [MainThread]: 
[0m20:36:05.888675 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.40 seconds (2.40s).
[0m20:36:05.889816 [debug] [MainThread]: Command end result
[0m20:36:05.898005 [info ] [MainThread]: 
[0m20:36:05.898588 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:36:05.899280 [info ] [MainThread]: 
[0m20:36:05.900041 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:36:05.901024 [debug] [MainThread]: Command `dbt run` succeeded at 20:36:05.900862 after 2.86 seconds
[0m20:36:05.901530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f778b9d4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7785ba9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77849dd550>]}
[0m20:36:05.902051 [debug] [MainThread]: Flushing usage events
[0m20:36:12.616588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a5edf550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a47c75e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a47c73d0>]}


============================== 20:36:12.620296 | 18f16389-a9c8-4975-880b-7c71e8bbf049 ==============================
[0m20:36:12.620296 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:36:12.621057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:36:12.944340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18f16389-a9c8-4975-880b-7c71e8bbf049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a00e80a0>]}
[0m20:36:12.966968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18f16389-a9c8-4975-880b-7c71e8bbf049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a00e1100>]}
[0m20:36:12.984469 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:36:13.013411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:36:13.013953 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:36:13.014903 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m20:36:13.023939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18f16389-a9c8-4975-880b-7c71e8bbf049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839ef39a00>]}
[0m20:36:13.032771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18f16389-a9c8-4975-880b-7c71e8bbf049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839ef8c8b0>]}
[0m20:36:13.033500 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:36:13.034131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18f16389-a9c8-4975-880b-7c71e8bbf049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839ef8c970>]}
[0m20:36:13.035661 [info ] [MainThread]: 
[0m20:36:13.036728 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:36:13.038282 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:36:13.058475 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:36:13.059190 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:36:13.059806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:13.560746 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:36:13.563670 [debug] [ThreadPool]: On list_external_db: Close
[0m20:36:13.680200 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m20:36:13.690399 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m20:36:13.690907 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m20:36:13.695127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:13.999075 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:36:14.001261 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m20:36:14.103068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18f16389-a9c8-4975-880b-7c71e8bbf049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839ef8c6d0>]}
[0m20:36:14.104463 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:36:14.105044 [info ] [MainThread]: 
[0m20:36:14.110772 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m20:36:14.111590 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.bronze_payments ........................ [RUN]
[0m20:36:14.112568 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_payments)
[0m20:36:14.113091 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m20:36:14.117556 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m20:36:14.118577 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 20:36:14.113493 => 20:36:14.118125
[0m20:36:14.119172 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m20:36:14.156754 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m20:36:14.157985 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m20:36:14.158476 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace   view external_db.final_sales.bronze_payments
  
   as (
    with payments as (
     select * from external_db.stage.payments
)

select * from payments
  );
[0m20:36:14.158962 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:36:14.534400 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:36:14.562670 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 20:36:14.119593 => 20:36:14.562291
[0m20:36:14.563290 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m20:36:14.664019 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18f16389-a9c8-4975-880b-7c71e8bbf049', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839d9c3a90>]}
[0m20:36:14.665041 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.bronze_payments ................... [[32mSUCCESS 1[0m in 0.55s]
[0m20:36:14.666097 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m20:36:14.669062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:14.669563 [debug] [MainThread]: Connection 'model.development.bronze_payments' was properly closed.
[0m20:36:14.670047 [info ] [MainThread]: 
[0m20:36:14.671039 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m20:36:14.672373 [debug] [MainThread]: Command end result
[0m20:36:14.681514 [info ] [MainThread]: 
[0m20:36:14.682363 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:36:14.683170 [info ] [MainThread]: 
[0m20:36:14.684014 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:36:14.685265 [debug] [MainThread]: Command `dbt run` succeeded at 20:36:14.685069 after 2.09 seconds
[0m20:36:14.685879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a5edf550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839d9c3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f839ef16f40>]}
[0m20:36:14.686721 [debug] [MainThread]: Flushing usage events
[0m20:36:21.445990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43bd32d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43bbc156d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43bbc154c0>]}


============================== 20:36:21.449947 | d7b7b6cb-e42a-4f4e-880e-689340ae97cc ==============================
[0m20:36:21.449947 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:36:21.450741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:36:21.752512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7b7b6cb-e42a-4f4e-880e-689340ae97cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b7535130>]}
[0m20:36:21.774279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7b7b6cb-e42a-4f4e-880e-689340ae97cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b7529040>]}
[0m20:36:21.791617 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:36:21.819809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:36:21.820222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:36:21.821175 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.intermediate
[0m20:36:21.829606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7b7b6cb-e42a-4f4e-880e-689340ae97cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b63789d0>]}
[0m20:36:21.838229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7b7b6cb-e42a-4f4e-880e-689340ae97cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b635e880>]}
[0m20:36:21.838902 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:36:21.839618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b7b6cb-e42a-4f4e-880e-689340ae97cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b635e940>]}
[0m20:36:21.841208 [info ] [MainThread]: 
[0m20:36:21.842116 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:36:21.843591 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:36:21.862355 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:36:21.862978 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:36:21.863510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:22.490058 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:36:22.493241 [debug] [ThreadPool]: On list_external_db: Close
[0m20:36:22.590781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m20:36:22.601260 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m20:36:22.601714 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m20:36:22.602253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:23.132800 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m20:36:23.135440 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m20:36:23.268784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b7b6cb-e42a-4f4e-880e-689340ae97cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b635e6a0>]}
[0m20:36:23.270047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:36:23.270640 [info ] [MainThread]: 
[0m20:36:23.276273 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m20:36:23.277177 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.bronze_products ........................ [RUN]
[0m20:36:23.278112 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_products)
[0m20:36:23.278655 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m20:36:23.283900 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m20:36:23.285231 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 20:36:23.279182 => 20:36:23.284777
[0m20:36:23.285781 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m20:36:23.326045 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m20:36:23.327565 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m20:36:23.328078 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace   view external_db.final_sales.bronze_products
  
   as (
    with products as (
     select * from external_db.stage.products
)

select * from products
  );
[0m20:36:23.328568 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:36:23.695117 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:36:23.724875 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 20:36:23.286142 => 20:36:23.724230
[0m20:36:23.725490 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m20:36:23.834252 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b7b6cb-e42a-4f4e-880e-689340ae97cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b460dbe0>]}
[0m20:36:23.835685 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.bronze_products ................... [[32mSUCCESS 1[0m in 0.56s]
[0m20:36:23.836721 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m20:36:23.839780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:23.840218 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m20:36:23.840735 [info ] [MainThread]: 
[0m20:36:23.841315 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m20:36:23.842343 [debug] [MainThread]: Command end result
[0m20:36:23.850576 [info ] [MainThread]: 
[0m20:36:23.851226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:36:23.852037 [info ] [MainThread]: 
[0m20:36:23.852815 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:36:23.854259 [debug] [MainThread]: Command `dbt run` succeeded at 20:36:23.854058 after 2.43 seconds
[0m20:36:23.854896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43bd32d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b460dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43b6355f10>]}
[0m20:36:23.855469 [debug] [MainThread]: Flushing usage events
[0m20:36:30.502026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f85632460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f83f27580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f83f27130>]}


============================== 20:36:30.505123 | 9c1ffb9e-86e6-4389-b844-c32e761818e0 ==============================
[0m20:36:30.505123 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:36:30.505897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:36:30.802839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c1ffb9e-86e6-4389-b844-c32e761818e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7f840040>]}
[0m20:36:30.823354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c1ffb9e-86e6-4389-b844-c32e761818e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7f846640>]}
[0m20:36:30.839107 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:36:30.865375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:36:30.865740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:36:30.866573 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.staging
- models.development.intermediate
[0m20:36:30.874558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c1ffb9e-86e6-4389-b844-c32e761818e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7e6b8910>]}
[0m20:36:30.882668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c1ffb9e-86e6-4389-b844-c32e761818e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7e70c7c0>]}
[0m20:36:30.883372 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:36:30.883862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c1ffb9e-86e6-4389-b844-c32e761818e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7e70c880>]}
[0m20:36:30.885192 [info ] [MainThread]: 
[0m20:36:30.885997 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:36:30.887376 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:36:30.904921 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:36:30.905475 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:36:30.905951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:31.356545 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:36:31.359965 [debug] [ThreadPool]: On list_external_db: Close
[0m20:36:31.459568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m20:36:31.470113 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m20:36:31.470608 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m20:36:31.471081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:31.768769 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m20:36:31.771551 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m20:36:31.874283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c1ffb9e-86e6-4389-b844-c32e761818e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7e70c5e0>]}
[0m20:36:31.875537 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:36:31.876602 [info ] [MainThread]: 
[0m20:36:31.882015 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m20:36:31.882830 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.bronze_customers ....................... [RUN]
[0m20:36:31.884215 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m20:36:31.884801 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m20:36:31.889718 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m20:36:31.890804 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 20:36:31.885290 => 20:36:31.890394
[0m20:36:31.891486 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m20:36:31.935477 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m20:36:31.936619 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m20:36:31.937250 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace   view external_db.final_sales.bronze_customers
  
   as (
    with customers as (
     select * from external_db.stage.customers
)

select * from customers
  );
[0m20:36:31.937762 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:36:32.321534 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:36:32.351314 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 20:36:31.891871 => 20:36:32.350910
[0m20:36:32.352008 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m20:36:32.447681 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c1ffb9e-86e6-4389-b844-c32e761818e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7c11cd30>]}
[0m20:36:32.448863 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.bronze_customers .................. [[32mSUCCESS 1[0m in 0.56s]
[0m20:36:32.449914 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m20:36:32.452517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:32.452965 [debug] [MainThread]: Connection 'model.development.bronze_customers' was properly closed.
[0m20:36:32.453487 [info ] [MainThread]: 
[0m20:36:32.454887 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m20:36:32.456073 [debug] [MainThread]: Command end result
[0m20:36:32.465086 [info ] [MainThread]: 
[0m20:36:32.465725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:36:32.466390 [info ] [MainThread]: 
[0m20:36:32.467380 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:36:32.468605 [debug] [MainThread]: Command `dbt run` succeeded at 20:36:32.468395 after 1.99 seconds
[0m20:36:32.469278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f85632460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f7e696e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f833a3d00>]}
[0m20:36:32.470085 [debug] [MainThread]: Flushing usage events
[0m20:36:39.455013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd4a99520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd335b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd335b130>]}


============================== 20:36:39.458742 | a2b37c2f-6048-4be9-931a-213c6fbf7768 ==============================
[0m20:36:39.458742 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:36:39.459789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:36:39.766683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2b37c2f-6048-4be9-931a-213c6fbf7768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fcec7f130>]}
[0m20:36:39.788682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2b37c2f-6048-4be9-931a-213c6fbf7768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fcec79040>]}
[0m20:36:39.805725 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:36:39.832007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:36:39.832413 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:36:39.833486 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m20:36:39.841354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2b37c2f-6048-4be9-931a-213c6fbf7768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fcdaf8a60>]}
[0m20:36:39.850480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2b37c2f-6048-4be9-931a-213c6fbf7768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fcdb4e910>]}
[0m20:36:39.851021 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:36:39.851724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2b37c2f-6048-4be9-931a-213c6fbf7768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fcdb4e9d0>]}
[0m20:36:39.853176 [info ] [MainThread]: 
[0m20:36:39.854096 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:36:39.855442 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:36:39.874239 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:36:39.875220 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:36:39.875841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:40.611196 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:36:40.614312 [debug] [ThreadPool]: On list_external_db: Close
[0m20:36:40.737747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m20:36:40.747424 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m20:36:40.747999 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m20:36:40.748411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:41.181071 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:36:41.183555 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m20:36:41.279609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2b37c2f-6048-4be9-931a-213c6fbf7768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fcdb4e2b0>]}
[0m20:36:41.281110 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:36:41.281927 [info ] [MainThread]: 
[0m20:36:41.287455 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m20:36:41.288315 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.bronze_orders .......................... [RUN]
[0m20:36:41.289253 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_orders)
[0m20:36:41.289771 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m20:36:41.294536 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m20:36:41.295683 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 20:36:41.290192 => 20:36:41.295332
[0m20:36:41.296280 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m20:36:41.337560 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m20:36:41.338753 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m20:36:41.339439 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace   view external_db.final_sales.bronze_orders
  
   as (
    with orders as (
     select * from external_db.stage.orders
)

select * from orders
  );
[0m20:36:41.340232 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:36:41.766723 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:36:41.800472 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 20:36:41.296606 => 20:36:41.800179
[0m20:36:41.800999 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m20:36:41.920146 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b37c2f-6048-4be9-931a-213c6fbf7768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fcc557fd0>]}
[0m20:36:41.921113 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.bronze_orders ..................... [[32mSUCCESS 1[0m in 0.63s]
[0m20:36:41.922123 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m20:36:41.924475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:41.924884 [debug] [MainThread]: Connection 'model.development.bronze_orders' was properly closed.
[0m20:36:41.925426 [info ] [MainThread]: 
[0m20:36:41.925965 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.07 seconds (2.07s).
[0m20:36:41.926984 [debug] [MainThread]: Command end result
[0m20:36:41.935764 [info ] [MainThread]: 
[0m20:36:41.936493 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:36:41.937064 [info ] [MainThread]: 
[0m20:36:41.937648 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:36:41.938722 [debug] [MainThread]: Command `dbt run` succeeded at 20:36:41.938557 after 2.51 seconds
[0m20:36:41.939240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fd4a99520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fcc557fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fcdad4fa0>]}
[0m20:36:41.939754 [debug] [MainThread]: Flushing usage events
[0m20:36:48.538342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a66a5a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a653385e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a653385b0>]}


============================== 20:36:48.542264 | 09970d33-1c07-4e0d-82bc-bf5748615101 ==============================
[0m20:36:48.542264 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:36:48.543343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:36:48.841358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09970d33-1c07-4e0d-82bc-bf5748615101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a60c590a0>]}
[0m20:36:48.862013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09970d33-1c07-4e0d-82bc-bf5748615101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a60c580d0>]}
[0m20:36:48.878065 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:36:48.904557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:36:48.904974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:36:48.905755 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.intermediate
[0m20:36:48.914291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09970d33-1c07-4e0d-82bc-bf5748615101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5fab8970>]}
[0m20:36:48.922898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09970d33-1c07-4e0d-82bc-bf5748615101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5fb00820>]}
[0m20:36:48.923507 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:36:48.924062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09970d33-1c07-4e0d-82bc-bf5748615101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5fb008e0>]}
[0m20:36:48.925564 [info ] [MainThread]: 
[0m20:36:48.926450 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:36:48.927822 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:36:48.946546 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:36:48.947104 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:36:48.947618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:49.414379 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:36:49.417451 [debug] [ThreadPool]: On list_external_db: Close
[0m20:36:49.527982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m20:36:49.540441 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m20:36:49.540942 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m20:36:49.541397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:49.822049 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:36:49.824435 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m20:36:49.922606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09970d33-1c07-4e0d-82bc-bf5748615101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5fb00640>]}
[0m20:36:49.924359 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:36:49.925587 [info ] [MainThread]: 
[0m20:36:49.930702 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m20:36:49.931522 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.bronze_payments ........................ [RUN]
[0m20:36:49.932446 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_payments)
[0m20:36:49.933121 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m20:36:49.937694 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m20:36:49.938839 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 20:36:49.933472 => 20:36:49.938422
[0m20:36:49.939475 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m20:36:49.986826 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m20:36:49.988045 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m20:36:49.988596 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace   view external_db.final_sales.bronze_payments
  
   as (
    with payments as (
     select * from external_db.stage.payments
)

select * from payments
  );
[0m20:36:49.989132 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:36:50.359699 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:36:50.391376 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 20:36:49.940013 => 20:36:50.391044
[0m20:36:50.392013 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m20:36:50.491441 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09970d33-1c07-4e0d-82bc-bf5748615101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5f22b190>]}
[0m20:36:50.492532 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.bronze_payments ................... [[32mSUCCESS 1[0m in 0.56s]
[0m20:36:50.493821 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m20:36:50.496334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:50.496761 [debug] [MainThread]: Connection 'model.development.bronze_payments' was properly closed.
[0m20:36:50.497314 [info ] [MainThread]: 
[0m20:36:50.497991 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m20:36:50.499308 [debug] [MainThread]: Command end result
[0m20:36:50.507922 [info ] [MainThread]: 
[0m20:36:50.508628 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:36:50.509267 [info ] [MainThread]: 
[0m20:36:50.509798 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:36:50.510701 [debug] [MainThread]: Command `dbt run` succeeded at 20:36:50.510541 after 1.99 seconds
[0m20:36:50.511429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a66a5a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a60c580d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5fa9de20>]}
[0m20:36:50.512052 [debug] [MainThread]: Flushing usage events
[0m20:36:57.411395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ab088520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1a998a5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1a998a2e0>]}


============================== 20:36:57.415221 | 31014287-8cf0-4350-a96e-bacbbb5e0eac ==============================
[0m20:36:57.415221 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:36:57.415991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:36:57.723321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31014287-8cf0-4350-a96e-bacbbb5e0eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1a527f130>]}
[0m20:36:57.745840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31014287-8cf0-4350-a96e-bacbbb5e0eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1a52733a0>]}
[0m20:36:57.763044 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:36:57.790636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:36:57.791133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:36:57.792007 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.bronze
- models.development.staging
[0m20:36:57.800426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31014287-8cf0-4350-a96e-bacbbb5e0eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1a40f89d0>]}
[0m20:36:57.808627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31014287-8cf0-4350-a96e-bacbbb5e0eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1a4140880>]}
[0m20:36:57.809257 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:36:57.809828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31014287-8cf0-4350-a96e-bacbbb5e0eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1a4140940>]}
[0m20:36:57.811242 [info ] [MainThread]: 
[0m20:36:57.812132 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:36:57.814342 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:36:57.832834 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:36:57.833338 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:36:57.833806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:58.496551 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:36:58.499789 [debug] [ThreadPool]: On list_external_db: Close
[0m20:36:58.594979 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m20:36:58.605024 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m20:36:58.605622 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m20:36:58.606067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:58.895594 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:36:58.897929 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m20:36:58.996489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31014287-8cf0-4350-a96e-bacbbb5e0eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1a41406a0>]}
[0m20:36:58.997725 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:36:58.998353 [info ] [MainThread]: 
[0m20:36:59.003614 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m20:36:59.004304 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.bronze_products ........................ [RUN]
[0m20:36:59.005281 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_products)
[0m20:36:59.005807 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m20:36:59.010333 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m20:36:59.011195 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 20:36:59.006129 => 20:36:59.010884
[0m20:36:59.011786 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m20:36:59.051774 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m20:36:59.052904 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m20:36:59.053393 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace   view external_db.final_sales.bronze_products
  
   as (
    with products as (
     select * from external_db.stage.products
)

select * from products
  );
[0m20:36:59.053910 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:36:59.414136 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:36:59.446965 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 20:36:59.012086 => 20:36:59.446674
[0m20:36:59.447494 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m20:36:59.543916 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31014287-8cf0-4350-a96e-bacbbb5e0eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb19db5dfd0>]}
[0m20:36:59.544930 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.bronze_products ................... [[32mSUCCESS 1[0m in 0.54s]
[0m20:36:59.546223 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m20:36:59.548783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:59.549304 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m20:36:59.549821 [info ] [MainThread]: 
[0m20:36:59.550415 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.74 seconds (1.74s).
[0m20:36:59.551377 [debug] [MainThread]: Command end result
[0m20:36:59.562281 [info ] [MainThread]: 
[0m20:36:59.563104 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:36:59.563817 [info ] [MainThread]: 
[0m20:36:59.564739 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:36:59.565825 [debug] [MainThread]: Command `dbt run` succeeded at 20:36:59.565636 after 2.18 seconds
[0m20:36:59.566487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ab088520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1a40d4f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1a40dce80>]}
[0m20:36:59.567039 [debug] [MainThread]: Flushing usage events
[0m20:37:06.162012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5718de520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5701e0640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5701e0610>]}


============================== 20:37:06.165459 | 57267b75-4978-4625-b5e8-2bb84f1e7519 ==============================
[0m20:37:06.165459 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:37:06.166436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:37:06.485007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57267b75-4978-4625-b5e8-2bb84f1e7519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe56ba5c130>]}
[0m20:37:06.507522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57267b75-4978-4625-b5e8-2bb84f1e7519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe56bad5040>]}
[0m20:37:06.524911 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:37:06.551680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:37:06.552287 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:37:06.553285 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.bronze
- models.development.staging
[0m20:37:06.561321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57267b75-4978-4625-b5e8-2bb84f1e7519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe56a9379d0>]}
[0m20:37:06.570183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57267b75-4978-4625-b5e8-2bb84f1e7519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe56a98b880>]}
[0m20:37:06.570736 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:37:06.571296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57267b75-4978-4625-b5e8-2bb84f1e7519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe56a98b940>]}
[0m20:37:06.572887 [info ] [MainThread]: 
[0m20:37:06.574745 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:37:06.576073 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:37:06.594461 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:37:06.594991 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:37:06.595384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:07.215536 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:37:07.218626 [debug] [ThreadPool]: On list_external_db: Close
[0m20:37:07.320638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m20:37:07.331322 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m20:37:07.331861 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m20:37:07.332252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:07.679679 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:37:07.681944 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m20:37:07.807000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57267b75-4978-4625-b5e8-2bb84f1e7519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe56a98b6a0>]}
[0m20:37:07.808224 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:37:07.808785 [info ] [MainThread]: 
[0m20:37:07.813159 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m20:37:07.813872 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.bronze_customers ....................... [RUN]
[0m20:37:07.814757 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m20:37:07.815335 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m20:37:07.819575 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m20:37:07.820480 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 20:37:07.815716 => 20:37:07.820112
[0m20:37:07.821019 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m20:37:07.859132 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m20:37:07.860247 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m20:37:07.860765 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace   view external_db.final_sales.bronze_customers
  
   as (
    with customers as (
     select * from external_db.stage.customers
)

select * from customers
  );
[0m20:37:07.861233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:37:08.275927 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:37:08.307923 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 20:37:07.821359 => 20:37:08.307563
[0m20:37:08.308657 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m20:37:08.413916 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57267b75-4978-4625-b5e8-2bb84f1e7519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe56a8e7d30>]}
[0m20:37:08.414961 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.bronze_customers .................. [[32mSUCCESS 1[0m in 0.60s]
[0m20:37:08.416021 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m20:37:08.418266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:37:08.418679 [debug] [MainThread]: Connection 'model.development.bronze_customers' was properly closed.
[0m20:37:08.419312 [info ] [MainThread]: 
[0m20:37:08.420106 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m20:37:08.421154 [debug] [MainThread]: Command end result
[0m20:37:08.429619 [info ] [MainThread]: 
[0m20:37:08.430219 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:37:08.430867 [info ] [MainThread]: 
[0m20:37:08.431511 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:37:08.432520 [debug] [MainThread]: Command `dbt run` succeeded at 20:37:08.432325 after 2.29 seconds
[0m20:37:08.433150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5718de520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe56bad5040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe569cc6f70>]}
[0m20:37:08.433667 [debug] [MainThread]: Flushing usage events
[0m20:37:15.229243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3d2a54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3bb8f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3bb8f5e0>]}


============================== 20:37:15.233048 | 6b258e77-c136-46fa-87ce-8637fa0b3fbf ==============================
[0m20:37:15.233048 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:37:15.233915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:37:15.550650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b258e77-c136-46fa-87ce-8637fa0b3fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef374a7100>]}
[0m20:37:15.578652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b258e77-c136-46fa-87ce-8637fa0b3fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef374a40d0>]}
[0m20:37:15.595202 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:37:15.621480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:37:15.621957 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:37:15.622994 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.staging
- models.development.intermediate
[0m20:37:15.631362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b258e77-c136-46fa-87ce-8637fa0b3fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef362f8a30>]}
[0m20:37:15.640524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b258e77-c136-46fa-87ce-8637fa0b3fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3634e8e0>]}
[0m20:37:15.641150 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:37:15.641659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b258e77-c136-46fa-87ce-8637fa0b3fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3634e9a0>]}
[0m20:37:15.643187 [info ] [MainThread]: 
[0m20:37:15.644179 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:37:15.645716 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:37:15.663607 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:37:15.664160 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:37:15.664679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:16.173611 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:37:16.176880 [debug] [ThreadPool]: On list_external_db: Close
[0m20:37:16.293696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m20:37:16.306371 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m20:37:16.306830 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m20:37:16.307243 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:16.734250 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m20:37:16.736771 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m20:37:16.836031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b258e77-c136-46fa-87ce-8637fa0b3fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3634e280>]}
[0m20:37:16.837193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:37:16.837802 [info ] [MainThread]: 
[0m20:37:16.843668 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m20:37:16.844479 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.fct_order_detail ....................... [RUN]
[0m20:37:16.845477 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.fct_order_detail)
[0m20:37:16.846050 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m20:37:16.850810 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m20:37:16.851940 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 20:37:16.846507 => 20:37:16.851538
[0m20:37:16.852445 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m20:37:16.893069 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m20:37:16.894979 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m20:37:16.895528 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace   view external_db.final_sales.fct_order_detail
  
   as (
    with orders as (
    select * from external_db.final_sales.bronze_orders
),
products as (
    select * from external_db.final_sales.bronze_products
), 

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m20:37:16.896049 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:37:17.334035 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:37:17.361146 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 20:37:16.852906 => 20:37:17.360829
[0m20:37:17.361684 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m20:37:17.462507 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b258e77-c136-46fa-87ce-8637fa0b3fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef34588fd0>]}
[0m20:37:17.463836 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.fct_order_detail .................. [[32mSUCCESS 1[0m in 0.62s]
[0m20:37:17.464957 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m20:37:17.467894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:37:17.468395 [debug] [MainThread]: Connection 'model.development.fct_order_detail' was properly closed.
[0m20:37:17.468893 [info ] [MainThread]: 
[0m20:37:17.469524 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.83 seconds (1.83s).
[0m20:37:17.470509 [debug] [MainThread]: Command end result
[0m20:37:17.479759 [info ] [MainThread]: 
[0m20:37:17.480379 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:37:17.480914 [info ] [MainThread]: 
[0m20:37:17.481776 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:37:17.482995 [debug] [MainThread]: Command `dbt run` succeeded at 20:37:17.482809 after 2.28 seconds
[0m20:37:17.483572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3d2a54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3b00aeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef362d6f70>]}
[0m20:37:17.484077 [debug] [MainThread]: Flushing usage events
[0m20:37:24.145810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaf07d7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaef0b5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaef0b54f0>]}


============================== 20:37:24.149642 | 1d5ba34d-7879-4526-92eb-7abd4daa483e ==============================
[0m20:37:24.149642 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:37:24.150351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:37:24.472971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d5ba34d-7879-4526-92eb-7abd4daa483e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaea98f0a0>]}
[0m20:37:24.496112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d5ba34d-7879-4526-92eb-7abd4daa483e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaea9d2160>]}
[0m20:37:24.513526 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:37:24.541632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:37:24.542146 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:37:24.542995 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m20:37:24.551766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d5ba34d-7879-4526-92eb-7abd4daa483e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaea853a90>]}
[0m20:37:24.560797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d5ba34d-7879-4526-92eb-7abd4daa483e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaea8aa850>]}
[0m20:37:24.561706 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:37:24.562243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d5ba34d-7879-4526-92eb-7abd4daa483e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaea8aaa90>]}
[0m20:37:24.563706 [info ] [MainThread]: 
[0m20:37:24.564728 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:37:24.566013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:37:24.586079 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:37:24.586660 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:37:24.587141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:25.093864 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:37:25.096792 [debug] [ThreadPool]: On list_external_db: Close
[0m20:37:25.222124 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m20:37:25.232876 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m20:37:25.233795 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m20:37:25.234364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:25.674371 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m20:37:25.677416 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m20:37:25.777635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d5ba34d-7879-4526-92eb-7abd4daa483e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaea8aa220>]}
[0m20:37:25.778856 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:37:25.779756 [info ] [MainThread]: 
[0m20:37:25.785270 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m20:37:25.786020 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.fct_payment_details .................... [RUN]
[0m20:37:25.787227 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.fct_payment_details)
[0m20:37:25.787891 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m20:37:25.792038 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m20:37:25.792942 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 20:37:25.788316 => 20:37:25.792609
[0m20:37:25.793443 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m20:37:25.831864 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m20:37:25.833101 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m20:37:25.833614 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace   view external_db.final_sales.fct_payment_details
  
   as (
    with payments as (
    select * from external_db.final_sales.bronze_payments
),

final as(
    select 
    payment_id,
    payment_method,
    order_id

    from payments where status = 'success'
)

select * from final
  );
[0m20:37:25.834083 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:37:26.288700 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:37:26.319393 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 20:37:25.793757 => 20:37:26.319008
[0m20:37:26.320105 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m20:37:26.442926 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d5ba34d-7879-4526-92eb-7abd4daa483e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae82ae2b0>]}
[0m20:37:26.444096 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.fct_payment_details ............... [[32mSUCCESS 1[0m in 0.66s]
[0m20:37:26.445272 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m20:37:26.447838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:37:26.448301 [debug] [MainThread]: Connection 'model.development.fct_payment_details' was properly closed.
[0m20:37:26.448789 [info ] [MainThread]: 
[0m20:37:26.449704 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m20:37:26.451116 [debug] [MainThread]: Command end result
[0m20:37:26.459738 [info ] [MainThread]: 
[0m20:37:26.460561 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:37:26.461195 [info ] [MainThread]: 
[0m20:37:26.461742 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:37:26.462707 [debug] [MainThread]: Command `dbt run` succeeded at 20:37:26.462540 after 2.34 seconds
[0m20:37:26.463338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaf07d7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaea9d2160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaea8398e0>]}
[0m20:37:26.463838 [debug] [MainThread]: Flushing usage events
[0m20:37:33.324381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad36994520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad352566d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad352560a0>]}


============================== 20:37:33.327750 | 3311e4e0-8f11-4660-84d3-a24871f7c19d ==============================
[0m20:37:33.327750 [info ] [MainThread]: Running with dbt=1.5.1
[0m20:37:33.328696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:37:33.643598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3311e4e0-8f11-4660-84d3-a24871f7c19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad30b77130>]}
[0m20:37:33.666461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3311e4e0-8f11-4660-84d3-a24871f7c19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad30b79040>]}
[0m20:37:33.684677 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m20:37:33.712799 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:37:33.713340 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:37:33.714326 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m20:37:33.722496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3311e4e0-8f11-4660-84d3-a24871f7c19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2f9b89d0>]}
[0m20:37:33.731162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3311e4e0-8f11-4660-84d3-a24871f7c19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad30a49880>]}
[0m20:37:33.731907 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m20:37:33.732560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3311e4e0-8f11-4660-84d3-a24871f7c19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad30a49940>]}
[0m20:37:33.734706 [info ] [MainThread]: 
[0m20:37:33.735912 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:37:33.737347 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m20:37:33.758930 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m20:37:33.759641 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m20:37:33.760150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:37:34.284762 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m20:37:34.287934 [debug] [ThreadPool]: On list_external_db: Close
[0m20:37:34.412247 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m20:37:34.422641 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m20:37:34.423144 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m20:37:34.423702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:37:34.884090 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m20:37:34.886588 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m20:37:35.000510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3311e4e0-8f11-4660-84d3-a24871f7c19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad30a496a0>]}
[0m20:37:35.001708 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:37:35.002340 [info ] [MainThread]: 
[0m20:37:35.007185 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m20:37:35.008060 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.product_sales .......................... [RUN]
[0m20:37:35.009109 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.product_sales)
[0m20:37:35.009822 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m20:37:35.016175 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m20:37:35.017278 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 20:37:35.010207 => 20:37:35.016813
[0m20:37:35.018046 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m20:37:35.058957 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m20:37:35.060935 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m20:37:35.061677 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace   view external_db.final_sales.product_sales
  
   as (
    with order_details as (
    select * from external_db.final_sales.fct_order_detail
), 
customer as (
    select * from external_db.final_sales.bronze_customers
),
payments as (
    select * from external_db.final_sales.fct_payment_details
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m20:37:35.062262 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m20:37:35.580633 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:37:35.617760 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 20:37:35.018433 => 20:37:35.617463
[0m20:37:35.621020 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m20:37:35.726160 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3311e4e0-8f11-4660-84d3-a24871f7c19d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2d412070>]}
[0m20:37:35.727324 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.product_sales ..................... [[32mSUCCESS 1[0m in 0.72s]
[0m20:37:35.728434 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m20:37:35.730913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:37:35.731456 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m20:37:35.731946 [info ] [MainThread]: 
[0m20:37:35.733343 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m20:37:35.735297 [debug] [MainThread]: Command end result
[0m20:37:35.744401 [info ] [MainThread]: 
[0m20:37:35.745073 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:37:35.745800 [info ] [MainThread]: 
[0m20:37:35.746459 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:37:35.747565 [debug] [MainThread]: Command `dbt run` succeeded at 20:37:35.747390 after 2.44 seconds
[0m20:37:35.748143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad36994520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2f995f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad2f99ce80>]}
[0m20:37:35.751002 [debug] [MainThread]: Flushing usage events
[0m07:14:08.028525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d94bfa4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d934d85b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d934d81c0>]}


============================== 07:14:08.041015 | a8d83f24-caa7-474b-a5a5-db31ae696f1c ==============================
[0m07:14:08.041015 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:14:08.041910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dags/dbt/logs', 'profiles_dir': 'dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:14:09.440380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8d83f24-caa7-474b-a5a5-db31ae696f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d8ed2b040>]}
[0m07:14:09.460186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8d83f24-caa7-474b-a5a5-db31ae696f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d8ed34640>]}
[0m04:27:19.535143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86cdaf34c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86cc3ec5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86cc3ec190>]}


============================== 04:27:19.540179 | 870b68e6-c46e-47f1-80ac-049f5ac1b51a ==============================
[0m04:27:19.540179 [info ] [MainThread]: Running with dbt=1.5.1
[0m04:27:19.541422 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m04:27:20.972492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '870b68e6-c46e-47f1-80ac-049f5ac1b51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c7cd30a0>]}
[0m04:27:20.997037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '870b68e6-c46e-47f1-80ac-049f5ac1b51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c7cde0d0>]}
[0m04:27:21.017116 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m04:27:21.018044 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m04:27:21.018628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '870b68e6-c46e-47f1-80ac-049f5ac1b51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c7c8ee80>]}
[0m04:27:22.031470 [debug] [MainThread]: 1699: static parser successfully parsed sales/intermediate/fct_order_detail.sql
[0m04:27:22.056354 [debug] [MainThread]: 1699: static parser successfully parsed sales/intermediate/fct_payment_details.sql
[0m04:27:22.062407 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_orders.sql
[0m04:27:22.068016 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_payments.sql
[0m04:27:22.073272 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_customers.sql
[0m04:27:22.078819 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_products.sql
[0m04:27:22.084305 [debug] [MainThread]: 1699: static parser successfully parsed sales/core/product_sales.sql
[0m04:27:22.168297 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.bronze
- models.development.staging
[0m04:27:22.177089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '870b68e6-c46e-47f1-80ac-049f5ac1b51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c66a4ca0>]}
[0m04:27:22.186880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '870b68e6-c46e-47f1-80ac-049f5ac1b51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c6640310>]}
[0m04:27:22.187657 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m04:27:22.188543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '870b68e6-c46e-47f1-80ac-049f5ac1b51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c7c49250>]}
[0m04:27:22.191340 [info ] [MainThread]: 
[0m04:27:22.192842 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:27:22.194894 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m04:27:22.216781 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m04:27:22.217513 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m04:27:22.218025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:27:24.063827 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 2.0 seconds
[0m04:27:24.067359 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m04:27:24.188674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '870b68e6-c46e-47f1-80ac-049f5ac1b51a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c7c8ec10>]}
[0m04:27:24.190027 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:27:24.190710 [info ] [MainThread]: 
[0m04:27:24.200467 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m04:27:24.201486 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m04:27:24.202058 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m04:27:24.208043 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m04:27:24.209208 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 04:27:24.202527 => 04:27:24.208823
[0m04:27:24.209723 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m04:27:24.210357 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 04:27:24.210032 => 04:27:24.210067
[0m04:27:24.211515 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m04:27:24.212107 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m04:27:24.213215 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m04:27:24.213946 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m04:27:24.219282 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m04:27:24.220374 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 04:27:24.214322 => 04:27:24.220003
[0m04:27:24.220965 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m04:27:24.221623 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 04:27:24.221317 => 04:27:24.221330
[0m04:27:24.222889 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m04:27:24.223583 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m04:27:24.224452 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m04:27:24.225056 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m04:27:24.229439 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m04:27:24.230556 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 04:27:24.225428 => 04:27:24.230202
[0m04:27:24.231034 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m04:27:24.231729 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 04:27:24.231351 => 04:27:24.231363
[0m04:27:24.232931 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m04:27:24.233633 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m04:27:24.234824 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m04:27:24.235485 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m04:27:24.239363 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m04:27:24.240176 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 04:27:24.235820 => 04:27:24.239869
[0m04:27:24.240725 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m04:27:24.241357 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 04:27:24.241061 => 04:27:24.241073
[0m04:27:24.242552 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m04:27:24.243120 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m04:27:24.244326 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m04:27:24.244887 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m04:27:24.248831 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m04:27:24.249849 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 04:27:24.245282 => 04:27:24.249424
[0m04:27:24.250389 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m04:27:24.251157 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 04:27:24.250796 => 04:27:24.250826
[0m04:27:24.252463 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m04:27:24.253078 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m04:27:24.253909 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m04:27:24.254417 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m04:27:24.259795 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m04:27:24.260819 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 04:27:24.254735 => 04:27:24.260467
[0m04:27:24.261370 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m04:27:24.262063 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 04:27:24.261716 => 04:27:24.261748
[0m04:27:24.263276 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m04:27:24.264483 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m04:27:24.265326 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m04:27:24.265843 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m04:27:24.270675 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m04:27:24.271623 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 04:27:24.266209 => 04:27:24.271298
[0m04:27:24.272138 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m04:27:24.272853 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 04:27:24.272473 => 04:27:24.272486
[0m04:27:24.273966 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m04:27:24.275379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:27:24.275933 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m04:27:24.278249 [debug] [MainThread]: Command end result
[0m04:27:24.293430 [debug] [MainThread]: Command `dbt compile` succeeded at 04:27:24.293164 after 4.78 seconds
[0m04:27:24.294120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86cdaf34c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c668e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86c6b631c0>]}
[0m04:27:24.294691 [debug] [MainThread]: Flushing usage events
[0m04:35:57.081476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c9c804550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c9b0c6700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c9b0c60a0>]}


============================== 04:35:57.085447 | 90513bef-b677-49ce-8ef9-274594a04cf9 ==============================
[0m04:35:57.085447 [info ] [MainThread]: Running with dbt=1.5.1
[0m04:35:57.086220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m04:35:57.436357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90513bef-b677-49ce-8ef9-274594a04cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c969a10a0>]}
[0m04:35:57.459779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90513bef-b677-49ce-8ef9-274594a04cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c969e3070>]}
[0m04:35:57.483154 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m04:35:57.521053 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:35:57.521715 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:35:57.522760 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m04:35:57.532022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90513bef-b677-49ce-8ef9-274594a04cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c96864a00>]}
[0m04:35:57.542393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90513bef-b677-49ce-8ef9-274594a04cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c968c08b0>]}
[0m04:35:57.543066 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m04:35:57.543658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90513bef-b677-49ce-8ef9-274594a04cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c968c0970>]}
[0m04:35:57.545541 [info ] [MainThread]: 
[0m04:35:57.546628 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:35:57.548189 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m04:35:57.569791 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m04:35:57.570643 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m04:35:57.571322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:35:58.315740 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m04:35:58.318929 [debug] [ThreadPool]: On list_external_db: Close
[0m04:35:58.426677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now create_external_db_final_sales)
[0m04:35:58.428031 [debug] [ThreadPool]: Creating schema "database: "external_db"
schema: "final_sales"
"
[0m04:35:58.435947 [debug] [ThreadPool]: Using snowflake connection "create_external_db_final_sales"
[0m04:35:58.436551 [debug] [ThreadPool]: On create_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "create_external_db_final_sales"} */
create schema if not exists external_db.final_sales
[0m04:35:58.437065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:35:58.915986 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:35:58.917710 [debug] [ThreadPool]: On create_external_db_final_sales: Close
[0m04:35:59.042885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_external_db_final_sales, now list_external_db_final_sales)
[0m04:35:59.052892 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m04:35:59.053471 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m04:35:59.053965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:35:59.362926 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m04:35:59.365043 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m04:35:59.470831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90513bef-b677-49ce-8ef9-274594a04cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c968c06d0>]}
[0m04:35:59.472288 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:35:59.473002 [info ] [MainThread]: 
[0m04:35:59.478011 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m04:35:59.478866 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.bronze_orders .......................... [RUN]
[0m04:35:59.479804 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_orders)
[0m04:35:59.480837 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m04:35:59.485173 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m04:35:59.486129 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 04:35:59.481231 => 04:35:59.485787
[0m04:35:59.486636 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m04:35:59.530276 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m04:35:59.532087 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m04:35:59.532660 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace   view external_db.final_sales.bronze_orders
  
   as (
    with orders as (
     select * from external_db.stage.orders
)

select * from orders
  );
[0m04:35:59.533214 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:35:59.996568 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:36:00.029091 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 04:35:59.486979 => 04:36:00.028750
[0m04:36:00.029790 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m04:36:00.151066 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90513bef-b677-49ce-8ef9-274594a04cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c94ad5e80>]}
[0m04:36:00.152230 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.bronze_orders ..................... [[32mSUCCESS 1[0m in 0.67s]
[0m04:36:00.153456 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m04:36:00.155760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:36:00.156242 [debug] [MainThread]: Connection 'model.development.bronze_orders' was properly closed.
[0m04:36:00.156837 [info ] [MainThread]: 
[0m04:36:00.157467 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m04:36:00.158720 [debug] [MainThread]: Command end result
[0m04:36:00.167858 [info ] [MainThread]: 
[0m04:36:00.168548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:36:00.169142 [info ] [MainThread]: 
[0m04:36:00.169737 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:36:00.170863 [debug] [MainThread]: Command `dbt run` succeeded at 04:36:00.170684 after 3.11 seconds
[0m04:36:00.171442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c9c804550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c94fa7070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c96840f40>]}
[0m04:36:00.171948 [debug] [MainThread]: Flushing usage events
[0m04:36:07.871663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89123e5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8910cce670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8910cce0a0>]}


============================== 04:36:07.878288 | e709778c-b43c-4f78-9631-d23ff90096d2 ==============================
[0m04:36:07.878288 [info ] [MainThread]: Running with dbt=1.5.1
[0m04:36:07.879576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m04:36:08.218482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e709778c-b43c-4f78-9631-d23ff90096d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890c5e80a0>]}
[0m04:36:08.241615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e709778c-b43c-4f78-9631-d23ff90096d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890c5eb070>]}
[0m04:36:08.259870 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m04:36:08.290777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:36:08.291399 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:36:08.292369 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.intermediate
[0m04:36:08.301852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e709778c-b43c-4f78-9631-d23ff90096d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890c46ca00>]}
[0m04:36:08.312138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e709778c-b43c-4f78-9631-d23ff90096d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890c4b48b0>]}
[0m04:36:08.312956 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m04:36:08.313947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e709778c-b43c-4f78-9631-d23ff90096d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890c4b4970>]}
[0m04:36:08.315619 [info ] [MainThread]: 
[0m04:36:08.316843 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:36:08.318481 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m04:36:08.340022 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m04:36:08.340979 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m04:36:08.341393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:08.899107 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m04:36:08.904470 [debug] [ThreadPool]: On list_external_db: Close
[0m04:36:09.017590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m04:36:09.028465 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m04:36:09.029045 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m04:36:09.029482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:36:09.506530 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:36:09.508900 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m04:36:09.618874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e709778c-b43c-4f78-9631-d23ff90096d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890c4b46d0>]}
[0m04:36:09.620183 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:36:09.621116 [info ] [MainThread]: 
[0m04:36:09.626522 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m04:36:09.627321 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.bronze_payments ........................ [RUN]
[0m04:36:09.628360 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_payments)
[0m04:36:09.628937 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m04:36:09.633337 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m04:36:09.634306 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 04:36:09.629293 => 04:36:09.633972
[0m04:36:09.634830 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m04:36:09.676843 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m04:36:09.678186 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m04:36:09.678818 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace   view external_db.final_sales.bronze_payments
  
   as (
    with payments as (
     select * from external_db.stage.payments
)

select * from payments
  );
[0m04:36:09.679340 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:36:10.115206 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:36:10.146657 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 04:36:09.635206 => 04:36:10.146300
[0m04:36:10.147328 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m04:36:10.255442 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e709778c-b43c-4f78-9631-d23ff90096d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8909ec8a90>]}
[0m04:36:10.256578 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.bronze_payments ................... [[32mSUCCESS 1[0m in 0.63s]
[0m04:36:10.257651 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m04:36:10.259761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:36:10.260453 [debug] [MainThread]: Connection 'model.development.bronze_payments' was properly closed.
[0m04:36:10.261004 [info ] [MainThread]: 
[0m04:36:10.261632 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m04:36:10.262678 [debug] [MainThread]: Command end result
[0m04:36:10.271721 [info ] [MainThread]: 
[0m04:36:10.272485 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:36:10.273298 [info ] [MainThread]: 
[0m04:36:10.274114 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:36:10.275336 [debug] [MainThread]: Command `dbt run` succeeded at 04:36:10.275049 after 2.42 seconds
[0m04:36:10.276056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f89123e5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f890c44af40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8910149df0>]}
[0m04:36:10.276646 [debug] [MainThread]: Flushing usage events
[0m04:36:17.756398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa325a10550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa324346700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3243460a0>]}


============================== 04:36:17.760119 | 1e7db5fd-d28f-494b-ac57-fd26d2f075ce ==============================
[0m04:36:17.760119 [info ] [MainThread]: Running with dbt=1.5.1
[0m04:36:17.760879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m04:36:18.093714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e7db5fd-d28f-494b-ac57-fd26d2f075ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31ebf30a0>]}
[0m04:36:18.117390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e7db5fd-d28f-494b-ac57-fd26d2f075ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31fc37070>]}
[0m04:36:18.134685 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m04:36:18.163258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:36:18.163792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:36:18.164806 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.intermediate
[0m04:36:18.180654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e7db5fd-d28f-494b-ac57-fd26d2f075ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31eab8a00>]}
[0m04:36:18.192529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e7db5fd-d28f-494b-ac57-fd26d2f075ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31eb008b0>]}
[0m04:36:18.193387 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m04:36:18.194017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e7db5fd-d28f-494b-ac57-fd26d2f075ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31eb00970>]}
[0m04:36:18.195638 [info ] [MainThread]: 
[0m04:36:18.196765 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:36:18.198245 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m04:36:18.220193 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m04:36:18.221010 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m04:36:18.221636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:18.759591 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m04:36:18.762458 [debug] [ThreadPool]: On list_external_db: Close
[0m04:36:18.875673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m04:36:18.889296 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m04:36:18.890075 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m04:36:18.890588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:36:19.391052 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.0 seconds
[0m04:36:19.393626 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m04:36:19.509199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e7db5fd-d28f-494b-ac57-fd26d2f075ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31eb006d0>]}
[0m04:36:19.510603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:36:19.511264 [info ] [MainThread]: 
[0m04:36:19.516460 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m04:36:19.517357 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.bronze_products ........................ [RUN]
[0m04:36:19.518426 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_products)
[0m04:36:19.518997 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m04:36:19.523645 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m04:36:19.524753 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 04:36:19.519346 => 04:36:19.524336
[0m04:36:19.525326 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m04:36:19.568348 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m04:36:19.569933 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m04:36:19.570514 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace   view external_db.final_sales.bronze_products
  
   as (
    with products as (
     select * from external_db.stage.products
)

select * from products
  );
[0m04:36:19.571038 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:36:19.961168 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:36:19.991287 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 04:36:19.525680 => 04:36:19.990954
[0m04:36:19.991929 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m04:36:20.105246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e7db5fd-d28f-494b-ac57-fd26d2f075ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31d528c40>]}
[0m04:36:20.106376 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.bronze_products ................... [[32mSUCCESS 1[0m in 0.59s]
[0m04:36:20.107362 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m04:36:20.109588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:36:20.110035 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m04:36:20.110530 [info ] [MainThread]: 
[0m04:36:20.111104 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m04:36:20.112208 [debug] [MainThread]: Command end result
[0m04:36:20.121022 [info ] [MainThread]: 
[0m04:36:20.122160 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:36:20.122879 [info ] [MainThread]: 
[0m04:36:20.123884 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:36:20.125174 [debug] [MainThread]: Command `dbt run` succeeded at 04:36:20.124984 after 2.39 seconds
[0m04:36:20.125736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa325a10550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3237c1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa31ea94f40>]}
[0m04:36:20.126314 [debug] [MainThread]: Flushing usage events
[0m04:36:27.506511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6277b454c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627647a670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f627647a490>]}


============================== 04:36:27.510554 | ef4530ad-d6b4-4924-abf1-8595f7d523ee ==============================
[0m04:36:27.510554 [info ] [MainThread]: Running with dbt=1.5.1
[0m04:36:27.511436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m04:36:27.855161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef4530ad-d6b4-4924-abf1-8595f7d523ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6271d290a0>]}
[0m04:36:27.878256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef4530ad-d6b4-4924-abf1-8595f7d523ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6271d700d0>]}
[0m04:36:27.896411 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m04:36:27.926325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:36:27.926903 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:36:27.927862 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.bronze
- models.development.staging
[0m04:36:27.936880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef4530ad-d6b4-4924-abf1-8595f7d523ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6270bb8a00>]}
[0m04:36:27.945738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef4530ad-d6b4-4924-abf1-8595f7d523ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6271c368b0>]}
[0m04:36:27.946402 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m04:36:27.946976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef4530ad-d6b4-4924-abf1-8595f7d523ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6271c36970>]}
[0m04:36:27.948615 [info ] [MainThread]: 
[0m04:36:27.949642 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:36:27.951224 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m04:36:27.971086 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m04:36:27.971737 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m04:36:27.972280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:28.446997 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m04:36:28.450156 [debug] [ThreadPool]: On list_external_db: Close
[0m04:36:28.564164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m04:36:28.575291 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m04:36:28.575955 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m04:36:28.576449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:36:28.909948 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m04:36:28.912340 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m04:36:29.017153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef4530ad-d6b4-4924-abf1-8595f7d523ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6271c366d0>]}
[0m04:36:29.018517 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:36:29.019586 [info ] [MainThread]: 
[0m04:36:29.031853 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m04:36:29.033155 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.bronze_customers ....................... [RUN]
[0m04:36:29.034229 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m04:36:29.034774 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m04:36:29.039315 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m04:36:29.040718 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 04:36:29.035200 => 04:36:29.040301
[0m04:36:29.041373 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m04:36:29.088121 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m04:36:29.089562 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m04:36:29.090100 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace   view external_db.final_sales.bronze_customers
  
   as (
    with customers as (
     select * from external_db.stage.customers
)

select * from customers
  );
[0m04:36:29.090679 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:36:29.618606 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:36:29.649590 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 04:36:29.041750 => 04:36:29.649252
[0m04:36:29.650228 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m04:36:29.775362 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef4530ad-d6b4-4924-abf1-8595f7d523ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f626be2ae20>]}
[0m04:36:29.776442 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.bronze_customers .................. [[32mSUCCESS 1[0m in 0.74s]
[0m04:36:29.777518 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m04:36:29.779817 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:36:29.780294 [debug] [MainThread]: Connection 'model.development.bronze_customers' was properly closed.
[0m04:36:29.780789 [info ] [MainThread]: 
[0m04:36:29.781370 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.83 seconds (1.83s).
[0m04:36:29.782418 [debug] [MainThread]: Command end result
[0m04:36:29.794688 [info ] [MainThread]: 
[0m04:36:29.795957 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:36:29.796506 [info ] [MainThread]: 
[0m04:36:29.797147 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:36:29.798251 [debug] [MainThread]: Command `dbt run` succeeded at 04:36:29.798041 after 2.31 seconds
[0m04:36:29.798835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6277b454c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f626be2ae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6270b94f40>]}
[0m04:36:29.799399 [debug] [MainThread]: Flushing usage events
[0m04:36:37.680708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e72207580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e70ac9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e70ac90a0>]}


============================== 04:36:37.684642 | 929b9fdc-5749-468c-a844-85254ebb2598 ==============================
[0m04:36:37.684642 [info ] [MainThread]: Running with dbt=1.5.1
[0m04:36:37.685410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m04:36:38.028080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '929b9fdc-5749-468c-a844-85254ebb2598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e6c3990d0>]}
[0m04:36:38.050498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '929b9fdc-5749-468c-a844-85254ebb2598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e6c3e80d0>]}
[0m04:36:38.068521 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m04:36:38.096971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:36:38.097556 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:36:38.098483 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.intermediate
- models.development.bronze
[0m04:36:38.107337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '929b9fdc-5749-468c-a844-85254ebb2598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e6c268ac0>]}
[0m04:36:38.116300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '929b9fdc-5749-468c-a844-85254ebb2598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e6c2bc970>]}
[0m04:36:38.117066 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m04:36:38.117634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '929b9fdc-5749-468c-a844-85254ebb2598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e6c2bca30>]}
[0m04:36:38.119166 [info ] [MainThread]: 
[0m04:36:38.120208 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:36:38.122016 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m04:36:38.144826 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m04:36:38.145579 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m04:36:38.146092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:38.851827 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m04:36:38.854908 [debug] [ThreadPool]: On list_external_db: Close
[0m04:36:38.972142 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m04:36:38.984663 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m04:36:38.985316 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m04:36:38.985839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:36:39.311427 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m04:36:39.313897 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m04:36:39.428403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '929b9fdc-5749-468c-a844-85254ebb2598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e6c2bc310>]}
[0m04:36:39.429680 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:36:39.430291 [info ] [MainThread]: 
[0m04:36:39.434950 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m04:36:39.435741 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.bronze_orders .......................... [RUN]
[0m04:36:39.436879 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_orders)
[0m04:36:39.437429 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m04:36:39.448005 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m04:36:39.449338 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 04:36:39.443557 => 04:36:39.448959
[0m04:36:39.449856 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m04:36:39.493165 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m04:36:39.494504 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m04:36:39.495049 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace   view external_db.final_sales.bronze_orders
  
   as (
    with orders as (
     select * from external_db.stage.orders
)

select * from orders
  );
[0m04:36:39.495603 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:36:40.302575 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:36:40.336414 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 04:36:39.450238 => 04:36:40.336054
[0m04:36:40.342513 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m04:36:40.456867 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '929b9fdc-5749-468c-a844-85254ebb2598', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e6a49f8e0>]}
[0m04:36:40.457923 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.bronze_orders ..................... [[32mSUCCESS 1[0m in 1.02s]
[0m04:36:40.459024 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m04:36:40.461272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:36:40.461853 [debug] [MainThread]: Connection 'model.development.bronze_orders' was properly closed.
[0m04:36:40.462336 [info ] [MainThread]: 
[0m04:36:40.462924 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.34 seconds (2.34s).
[0m04:36:40.463996 [debug] [MainThread]: Command end result
[0m04:36:40.473182 [info ] [MainThread]: 
[0m04:36:40.473978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:36:40.474519 [info ] [MainThread]: 
[0m04:36:40.475100 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:36:40.476151 [debug] [MainThread]: Command `dbt run` succeeded at 04:36:40.475962 after 2.82 seconds
[0m04:36:40.476875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e72207580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e6a5d1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e6c244fa0>]}
[0m04:36:40.477450 [debug] [MainThread]: Flushing usage events
[0m04:36:47.925216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ef2de25b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ef16a4760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ef16a40a0>]}


============================== 04:36:47.929632 | 12a6ff96-fa22-40ad-ab68-185f9a601600 ==============================
[0m04:36:47.929632 [info ] [MainThread]: Running with dbt=1.5.1
[0m04:36:47.930429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m04:36:48.280765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12a6ff96-fa22-40ad-ab68-185f9a601600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eecfc5130>]}
[0m04:36:48.303999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12a6ff96-fa22-40ad-ab68-185f9a601600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eecfb8040>]}
[0m04:36:48.322459 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m04:36:48.352726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:36:48.353290 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:36:48.354226 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m04:36:48.363552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12a6ff96-fa22-40ad-ab68-185f9a601600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eece42af0>]}
[0m04:36:48.372793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12a6ff96-fa22-40ad-ab68-185f9a601600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eece968b0>]}
[0m04:36:48.373549 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m04:36:48.374143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12a6ff96-fa22-40ad-ab68-185f9a601600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eece96af0>]}
[0m04:36:48.375736 [info ] [MainThread]: 
[0m04:36:48.376777 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:36:48.378405 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m04:36:48.400553 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m04:36:48.401178 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m04:36:48.401730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:49.073407 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m04:36:49.076561 [debug] [ThreadPool]: On list_external_db: Close
[0m04:36:49.184005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m04:36:49.195282 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m04:36:49.195900 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m04:36:49.196432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:36:49.522015 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m04:36:49.524495 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m04:36:49.641841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12a6ff96-fa22-40ad-ab68-185f9a601600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eece96280>]}
[0m04:36:49.643207 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:36:49.643826 [info ] [MainThread]: 
[0m04:36:49.650101 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m04:36:49.651018 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.bronze_payments ........................ [RUN]
[0m04:36:49.652139 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_payments)
[0m04:36:49.652940 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m04:36:49.657904 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m04:36:49.659300 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 04:36:49.653404 => 04:36:49.658863
[0m04:36:49.659924 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m04:36:49.706089 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m04:36:49.707613 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m04:36:49.708156 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace   view external_db.final_sales.bronze_payments
  
   as (
    with payments as (
     select * from external_db.stage.payments
)

select * from payments
  );
[0m04:36:49.708717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:36:50.136103 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:36:50.173562 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 04:36:49.660415 => 04:36:50.173151
[0m04:36:50.174254 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m04:36:50.287495 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12a6ff96-fa22-40ad-ab68-185f9a601600', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eeb0a5130>]}
[0m04:36:50.288669 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.bronze_payments ................... [[32mSUCCESS 1[0m in 0.64s]
[0m04:36:50.289704 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m04:36:50.292056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:36:50.292642 [debug] [MainThread]: Connection 'model.development.bronze_payments' was properly closed.
[0m04:36:50.293161 [info ] [MainThread]: 
[0m04:36:50.294402 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m04:36:50.295941 [debug] [MainThread]: Command end result
[0m04:36:50.305952 [info ] [MainThread]: 
[0m04:36:50.306744 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:36:50.307281 [info ] [MainThread]: 
[0m04:36:50.307865 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:36:50.308953 [debug] [MainThread]: Command `dbt run` succeeded at 04:36:50.308762 after 2.41 seconds
[0m04:36:50.309619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ef2de25b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ef0b1cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3eeb1add60>]}
[0m04:36:50.310158 [debug] [MainThread]: Flushing usage events
[0m04:36:57.892024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1aec51490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ad52f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ad52f130>]}


============================== 04:36:57.896328 | fb883340-d9c8-4795-a51d-ca577ac76d36 ==============================
[0m04:36:57.896328 [info ] [MainThread]: Running with dbt=1.5.1
[0m04:36:57.897186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m04:36:58.222832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb883340-d9c8-4795-a51d-ca577ac76d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a8e46100>]}
[0m04:36:58.245696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb883340-d9c8-4795-a51d-ca577ac76d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a8e4e0a0>]}
[0m04:36:58.263502 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m04:36:58.292831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:36:58.293431 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:36:58.294507 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.intermediate
- models.development.bronze
[0m04:36:58.303400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb883340-d9c8-4795-a51d-ca577ac76d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a7cb7940>]}
[0m04:36:58.312940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb883340-d9c8-4795-a51d-ca577ac76d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a7d0c7f0>]}
[0m04:36:58.313655 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m04:36:58.314309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb883340-d9c8-4795-a51d-ca577ac76d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a7d0c8b0>]}
[0m04:36:58.315867 [info ] [MainThread]: 
[0m04:36:58.316941 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:36:58.318620 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m04:36:58.338867 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m04:36:58.339483 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m04:36:58.339904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:36:58.882756 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m04:36:58.885824 [debug] [ThreadPool]: On list_external_db: Close
[0m04:36:58.999936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m04:36:59.011373 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m04:36:59.012152 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m04:36:59.012744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:36:59.512410 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m04:36:59.514954 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m04:36:59.630175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb883340-d9c8-4795-a51d-ca577ac76d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a7d0c610>]}
[0m04:36:59.631503 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:36:59.632112 [info ] [MainThread]: 
[0m04:36:59.637157 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m04:36:59.637952 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.bronze_products ........................ [RUN]
[0m04:36:59.639058 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_products)
[0m04:36:59.639610 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m04:36:59.644775 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m04:36:59.645757 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 04:36:59.639980 => 04:36:59.645411
[0m04:36:59.646288 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m04:36:59.688705 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m04:36:59.690644 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m04:36:59.691212 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace   view external_db.final_sales.bronze_products
  
   as (
    with products as (
     select * from external_db.stage.products
)

select * from products
  );
[0m04:36:59.691725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:37:00.098525 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:37:00.132276 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 04:36:59.646636 => 04:37:00.131940
[0m04:37:00.132964 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m04:37:00.234530 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb883340-d9c8-4795-a51d-ca577ac76d36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a56e7850>]}
[0m04:37:00.235744 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.bronze_products ................... [[32mSUCCESS 1[0m in 0.60s]
[0m04:37:00.236803 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m04:37:00.239316 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:37:00.239773 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m04:37:00.240251 [info ] [MainThread]: 
[0m04:37:00.240862 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m04:37:00.242154 [debug] [MainThread]: Command end result
[0m04:37:00.251316 [info ] [MainThread]: 
[0m04:37:00.252059 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:37:00.252643 [info ] [MainThread]: 
[0m04:37:00.253242 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:37:00.254580 [debug] [MainThread]: Command `dbt run` succeeded at 04:37:00.254392 after 2.39 seconds
[0m04:37:00.255271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1aec51490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1a7c95e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1ac9a9dc0>]}
[0m04:37:00.255958 [debug] [MainThread]: Flushing usage events
[0m04:37:07.580975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92a014580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa928916610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9289162e0>]}


============================== 04:37:07.585096 | 39dabbab-ff8c-4161-9dc8-433c8da7c66c ==============================
[0m04:37:07.585096 [info ] [MainThread]: Running with dbt=1.5.1
[0m04:37:07.585899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m04:37:07.934891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39dabbab-ff8c-4161-9dc8-433c8da7c66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9231f70d0>]}
[0m04:37:07.959950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39dabbab-ff8c-4161-9dc8-433c8da7c66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9231f9730>]}
[0m04:37:07.978799 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m04:37:08.008021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:37:08.008775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:37:08.009789 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.intermediate
- models.development.bronze
[0m04:37:08.019509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39dabbab-ff8c-4161-9dc8-433c8da7c66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa923077ac0>]}
[0m04:37:08.028734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39dabbab-ff8c-4161-9dc8-433c8da7c66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9230cc970>]}
[0m04:37:08.029590 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m04:37:08.030180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39dabbab-ff8c-4161-9dc8-433c8da7c66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9230cca30>]}
[0m04:37:08.031776 [info ] [MainThread]: 
[0m04:37:08.032945 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:37:08.035184 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m04:37:08.055624 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m04:37:08.056425 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m04:37:08.056988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:37:08.573109 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m04:37:08.576298 [debug] [ThreadPool]: On list_external_db: Close
[0m04:37:08.735233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m04:37:08.746394 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m04:37:08.747157 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m04:37:08.747642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:37:09.210105 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m04:37:09.212739 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m04:37:09.321680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39dabbab-ff8c-4161-9dc8-433c8da7c66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9230cc310>]}
[0m04:37:09.322941 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:37:09.323682 [info ] [MainThread]: 
[0m04:37:09.328709 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m04:37:09.329559 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.bronze_customers ....................... [RUN]
[0m04:37:09.330593 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m04:37:09.331138 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m04:37:09.335824 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m04:37:09.336847 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 04:37:09.331522 => 04:37:09.336466
[0m04:37:09.337418 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m04:37:09.379444 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m04:37:09.380971 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m04:37:09.381543 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace   view external_db.final_sales.bronze_customers
  
   as (
    with customers as (
     select * from external_db.stage.customers
)

select * from customers
  );
[0m04:37:09.382253 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:37:09.928124 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:37:09.965539 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 04:37:09.338118 => 04:37:09.965177
[0m04:37:09.966228 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m04:37:10.072933 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39dabbab-ff8c-4161-9dc8-433c8da7c66c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9222f6100>]}
[0m04:37:10.074019 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.bronze_customers .................. [[32mSUCCESS 1[0m in 0.74s]
[0m04:37:10.075062 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m04:37:10.077703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:37:10.078253 [debug] [MainThread]: Connection 'model.development.bronze_customers' was properly closed.
[0m04:37:10.078786 [info ] [MainThread]: 
[0m04:37:10.079506 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.05 seconds (2.05s).
[0m04:37:10.081082 [debug] [MainThread]: Command end result
[0m04:37:10.090077 [info ] [MainThread]: 
[0m04:37:10.090838 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:37:10.091416 [info ] [MainThread]: 
[0m04:37:10.092021 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:37:10.093582 [debug] [MainThread]: Command `dbt run` succeeded at 04:37:10.093386 after 2.53 seconds
[0m04:37:10.094282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa92a014580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9223fdb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa923053fa0>]}
[0m04:37:10.094970 [debug] [MainThread]: Flushing usage events
[0m04:37:17.855577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff863d7e520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86265c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff86265c130>]}


============================== 04:37:17.859588 | 8cb72483-6d86-4677-9e8a-e6f31d157026 ==============================
[0m04:37:17.859588 [info ] [MainThread]: Running with dbt=1.5.1
[0m04:37:17.860348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m04:37:18.227348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cb72483-6d86-4677-9e8a-e6f31d157026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85df7d130>]}
[0m04:37:18.250000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cb72483-6d86-4677-9e8a-e6f31d157026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85df73040>]}
[0m04:37:18.267925 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m04:37:18.298505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:37:18.299114 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:37:18.300044 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.bronze
- models.development.staging
[0m04:37:18.308985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cb72483-6d86-4677-9e8a-e6f31d157026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85cdf99d0>]}
[0m04:37:18.318065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cb72483-6d86-4677-9e8a-e6f31d157026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85de4f880>]}
[0m04:37:18.318897 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m04:37:18.319483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cb72483-6d86-4677-9e8a-e6f31d157026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85de4f940>]}
[0m04:37:18.321119 [info ] [MainThread]: 
[0m04:37:18.322148 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:37:18.323619 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m04:37:18.343286 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m04:37:18.343918 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m04:37:18.344360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:37:18.875707 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m04:37:18.878698 [debug] [ThreadPool]: On list_external_db: Close
[0m04:37:18.993097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m04:37:19.004129 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m04:37:19.004845 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m04:37:19.005295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:37:19.307297 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m04:37:19.309970 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m04:37:19.410765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cb72483-6d86-4677-9e8a-e6f31d157026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85de4f6a0>]}
[0m04:37:19.412167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:37:19.412819 [info ] [MainThread]: 
[0m04:37:19.418569 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m04:37:19.419385 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.fct_order_detail ....................... [RUN]
[0m04:37:19.420434 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.fct_order_detail)
[0m04:37:19.421108 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m04:37:19.426009 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m04:37:19.427102 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 04:37:19.421486 => 04:37:19.426704
[0m04:37:19.427651 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m04:37:19.470927 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m04:37:19.472911 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m04:37:19.473502 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace   view external_db.final_sales.fct_order_detail
  
   as (
    with orders as (
    select * from external_db.final_sales.bronze_orders
),
products as (
    select * from external_db.final_sales.bronze_products
), 

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m04:37:19.474048 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:37:19.975735 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:37:20.005795 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 04:37:19.428008 => 04:37:20.005436
[0m04:37:20.006439 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m04:37:20.118024 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cb72483-6d86-4677-9e8a-e6f31d157026', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85c144400>]}
[0m04:37:20.119184 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.fct_order_detail .................. [[32mSUCCESS 1[0m in 0.70s]
[0m04:37:20.120172 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m04:37:20.122417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:37:20.122947 [debug] [MainThread]: Connection 'model.development.fct_order_detail' was properly closed.
[0m04:37:20.123446 [info ] [MainThread]: 
[0m04:37:20.124097 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 1.80 seconds (1.80s).
[0m04:37:20.125179 [debug] [MainThread]: Command end result
[0m04:37:20.134201 [info ] [MainThread]: 
[0m04:37:20.135172 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:37:20.135911 [info ] [MainThread]: 
[0m04:37:20.136760 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:37:20.138008 [debug] [MainThread]: Command `dbt run` succeeded at 04:37:20.137824 after 2.31 seconds
[0m04:37:20.138653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff863d7e520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85cdd6f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85cddde80>]}
[0m04:37:20.139214 [debug] [MainThread]: Flushing usage events
[0m04:37:27.547320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b9a89550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b8367700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b83674c0>]}


============================== 04:37:27.552169 | 0ce2aa49-3330-4012-bcc3-2c890be7069a ==============================
[0m04:37:27.552169 [info ] [MainThread]: Running with dbt=1.5.1
[0m04:37:27.553368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m04:37:27.918287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ce2aa49-3330-4012-bcc3-2c890be7069a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b3c7f0a0>]}
[0m04:37:27.943938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ce2aa49-3330-4012-bcc3-2c890be7069a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b3c7a070>]}
[0m04:37:27.963544 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m04:37:27.993037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:37:27.993682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:37:27.994672 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.intermediate
- models.development.bronze
[0m04:37:28.004702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ce2aa49-3330-4012-bcc3-2c890be7069a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b2af7a00>]}
[0m04:37:28.014347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ce2aa49-3330-4012-bcc3-2c890be7069a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b2b4e8b0>]}
[0m04:37:28.015089 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m04:37:28.015696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ce2aa49-3330-4012-bcc3-2c890be7069a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b2b4e970>]}
[0m04:37:28.017471 [info ] [MainThread]: 
[0m04:37:28.018630 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:37:28.020140 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m04:37:28.040466 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m04:37:28.041241 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m04:37:28.041698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:37:28.733182 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m04:37:28.736395 [debug] [ThreadPool]: On list_external_db: Close
[0m04:37:28.853919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m04:37:28.864622 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m04:37:28.865097 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m04:37:28.865485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:37:29.355708 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m04:37:29.358198 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m04:37:29.476831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ce2aa49-3330-4012-bcc3-2c890be7069a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b2b4e6d0>]}
[0m04:37:29.478160 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:37:29.478823 [info ] [MainThread]: 
[0m04:37:29.483891 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m04:37:29.484828 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.fct_payment_details .................... [RUN]
[0m04:37:29.485873 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.fct_payment_details)
[0m04:37:29.486668 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m04:37:29.491217 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m04:37:29.492269 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 04:37:29.487045 => 04:37:29.491903
[0m04:37:29.492979 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m04:37:29.535177 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m04:37:29.536940 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m04:37:29.537599 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace   view external_db.final_sales.fct_payment_details
  
   as (
    with payments as (
    select * from external_db.final_sales.bronze_payments
),

final as(
    select 
    payment_id,
    payment_method,
    order_id

    from payments where status = 'success'
)

select * from final
  );
[0m04:37:29.538220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:37:29.959823 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m04:37:29.990759 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 04:37:29.493334 => 04:37:29.990403
[0m04:37:29.991584 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m04:37:30.093319 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ce2aa49-3330-4012-bcc3-2c890be7069a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b0529340>]}
[0m04:37:30.094438 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.fct_payment_details ............... [[32mSUCCESS 1[0m in 0.61s]
[0m04:37:30.095536 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m04:37:30.097939 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:37:30.098416 [debug] [MainThread]: Connection 'model.development.fct_payment_details' was properly closed.
[0m04:37:30.098916 [info ] [MainThread]: 
[0m04:37:30.099609 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m04:37:30.100801 [debug] [MainThread]: Command end result
[0m04:37:30.109451 [info ] [MainThread]: 
[0m04:37:30.110125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:37:30.110710 [info ] [MainThread]: 
[0m04:37:30.111358 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:37:30.112517 [debug] [MainThread]: Command `dbt run` succeeded at 04:37:30.112247 after 2.59 seconds
[0m04:37:30.113124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b9a89550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b2addf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1b2ad4f40>]}
[0m04:37:30.113727 [debug] [MainThread]: Flushing usage events
[0m04:37:37.878276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ee1d13550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ee05d5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ee05d50a0>]}


============================== 04:37:37.882755 | 00043bc7-f82e-4772-b472-3c6750362653 ==============================
[0m04:37:37.882755 [info ] [MainThread]: Running with dbt=1.5.1
[0m04:37:37.883798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m04:37:38.215530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00043bc7-f82e-4772-b472-3c6750362653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6edbef20a0>]}
[0m04:37:38.238224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00043bc7-f82e-4772-b472-3c6750362653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6edbef1100>]}
[0m04:37:38.258253 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m04:37:38.286689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:37:38.287381 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:37:38.288272 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m04:37:38.297116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00043bc7-f82e-4772-b472-3c6750362653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6edad37a90>]}
[0m04:37:38.305662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00043bc7-f82e-4772-b472-3c6750362653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6edad8b850>]}
[0m04:37:38.306324 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m04:37:38.307004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00043bc7-f82e-4772-b472-3c6750362653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6edad8ba90>]}
[0m04:37:38.308873 [info ] [MainThread]: 
[0m04:37:38.309985 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:37:38.311646 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m04:37:38.334509 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m04:37:38.335240 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m04:37:38.335740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:37:38.878513 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m04:37:38.881967 [debug] [ThreadPool]: On list_external_db: Close
[0m04:37:39.000577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m04:37:39.011505 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m04:37:39.012020 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m04:37:39.012483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:37:39.326767 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m04:37:39.329381 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m04:37:39.433013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00043bc7-f82e-4772-b472-3c6750362653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6edad8b220>]}
[0m04:37:39.436793 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:37:39.437718 [info ] [MainThread]: 
[0m04:37:39.443619 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m04:37:39.444383 [info ] [Thread-1  ]: 1 of 1 START sql view model final_sales.product_sales .......................... [RUN]
[0m04:37:39.445480 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.product_sales)
[0m04:37:39.446076 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m04:37:39.451601 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m04:37:39.452803 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 04:37:39.446474 => 04:37:39.452407
[0m04:37:39.453388 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m04:37:39.499900 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m04:37:39.502374 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m04:37:39.503029 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace   view external_db.final_sales.product_sales
  
   as (
    with order_details as (
    select * from external_db.final_sales.fct_order_detail
), 
customer as (
    select * from external_db.final_sales.bronze_customers
),
payments as (
    select * from external_db.final_sales.fct_payment_details
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m04:37:39.503593 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m04:37:40.239090 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m04:37:40.268615 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 04:37:39.453748 => 04:37:40.268193
[0m04:37:40.269442 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m04:37:40.385459 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00043bc7-f82e-4772-b472-3c6750362653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eda0c9a00>]}
[0m04:37:40.386691 [info ] [Thread-1  ]: 1 of 1 OK created sql view model final_sales.product_sales ..................... [[32mSUCCESS 1[0m in 0.94s]
[0m04:37:40.387759 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m04:37:40.389883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:37:40.390529 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m04:37:40.391028 [info ] [MainThread]: 
[0m04:37:40.391681 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m04:37:40.392803 [debug] [MainThread]: Command end result
[0m04:37:40.401934 [info ] [MainThread]: 
[0m04:37:40.402741 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:37:40.403298 [info ] [MainThread]: 
[0m04:37:40.403896 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:37:40.404996 [debug] [MainThread]: Command `dbt run` succeeded at 04:37:40.404804 after 2.55 seconds
[0m04:37:40.405573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ee1d13550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6edbef1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6edad1d460>]}
[0m04:37:40.406237 [debug] [MainThread]: Flushing usage events
[0m04:44:02.450929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0eb19c430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e9a9f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e9a9f100>]}


============================== 04:44:02.454782 | 19b07a80-b051-4256-aa7d-f3c0bb0ab441 ==============================
[0m04:44:02.454782 [info ] [MainThread]: Running with dbt=1.5.1
[0m04:44:02.455545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m04:44:02.821329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19b07a80-b051-4256-aa7d-f3c0bb0ab441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e53880a0>]}
[0m04:44:02.843901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19b07a80-b051-4256-aa7d-f3c0bb0ab441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e538e070>]}
[0m04:44:02.863068 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m04:44:02.891561 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:44:02.892248 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:44:02.893339 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.bronze
- models.development.staging
[0m04:44:02.902245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19b07a80-b051-4256-aa7d-f3c0bb0ab441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e41f7a00>]}
[0m04:44:02.904300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19b07a80-b051-4256-aa7d-f3c0bb0ab441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e526d880>]}
[0m04:44:02.904853 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m04:44:02.905368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19b07a80-b051-4256-aa7d-f3c0bb0ab441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e526d8e0>]}
[0m04:44:02.907591 [info ] [MainThread]: 
[0m04:44:02.908474 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m04:44:02.910910 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m04:44:02.929655 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m04:44:02.930175 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m04:44:02.930659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:44:03.655913 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m04:44:03.659481 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m04:44:03.767972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19b07a80-b051-4256-aa7d-f3c0bb0ab441', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e41dd820>]}
[0m04:44:03.769236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m04:44:03.770555 [info ] [MainThread]: 
[0m04:44:03.775945 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m04:44:03.776913 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m04:44:03.777421 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m04:44:03.782753 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m04:44:03.783826 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 04:44:03.777762 => 04:44:03.783370
[0m04:44:03.784345 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m04:44:03.785027 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 04:44:03.784712 => 04:44:03.784747
[0m04:44:03.786290 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m04:44:03.786849 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m04:44:03.787568 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m04:44:03.788256 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m04:44:03.791929 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m04:44:03.792849 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 04:44:03.788570 => 04:44:03.792537
[0m04:44:03.793350 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m04:44:03.794016 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 04:44:03.793718 => 04:44:03.793731
[0m04:44:03.795123 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m04:44:03.795840 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m04:44:03.796717 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m04:44:03.797274 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m04:44:03.801060 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m04:44:03.802060 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 04:44:03.797784 => 04:44:03.801754
[0m04:44:03.802541 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m04:44:03.803147 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 04:44:03.802859 => 04:44:03.802871
[0m04:44:03.804253 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m04:44:03.804831 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m04:44:03.805717 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m04:44:03.806274 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m04:44:03.809854 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m04:44:03.810917 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 04:44:03.806604 => 04:44:03.810608
[0m04:44:03.811453 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m04:44:03.812045 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 04:44:03.811764 => 04:44:03.811775
[0m04:44:03.813370 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m04:44:03.814037 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m04:44:03.814787 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m04:44:03.815669 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m04:44:03.819380 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m04:44:03.820518 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 04:44:03.816033 => 04:44:03.820108
[0m04:44:03.821256 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m04:44:03.821963 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 04:44:03.821616 => 04:44:03.821627
[0m04:44:03.823164 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m04:44:03.823798 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m04:44:03.824563 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m04:44:03.825136 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m04:44:03.829259 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m04:44:03.830137 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 04:44:03.825712 => 04:44:03.829826
[0m04:44:03.830711 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m04:44:03.831345 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 04:44:03.831058 => 04:44:03.831069
[0m04:44:03.832509 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m04:44:03.833987 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m04:44:03.834787 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m04:44:03.835289 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m04:44:03.839476 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m04:44:03.840294 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 04:44:03.835635 => 04:44:03.839977
[0m04:44:03.840781 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m04:44:03.841372 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 04:44:03.841094 => 04:44:03.841105
[0m04:44:03.842400 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m04:44:03.843787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:44:03.844262 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m04:44:03.847169 [debug] [MainThread]: Command end result
[0m04:44:03.899770 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m04:44:03.900423 [info ] [MainThread]: Building catalog
[0m04:44:03.904373 [debug] [ThreadPool]: Acquiring new snowflake connection 'external_db.information_schema'
[0m04:44:03.917493 [debug] [ThreadPool]: Using snowflake connection "external_db.information_schema"
[0m04:44:03.918121 [debug] [ThreadPool]: On external_db.information_schema: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "external_db.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from external_db.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from external_db.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('final_sales') or upper("table_schema") = upper('stage'))
      order by "column_index"
[0m04:44:03.918702 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:44:06.688329 [debug] [ThreadPool]: SQL status: SUCCESS 36 in 3.0 seconds
[0m04:44:06.764555 [debug] [ThreadPool]: On external_db.information_schema: Close
[0m04:44:06.890229 [info ] [MainThread]: Catalog written to /home/satyam/airflow/target/catalog.json
[0m04:44:06.893270 [debug] [MainThread]: Command `dbt docs generate` succeeded at 04:44:06.893062 after 4.47 seconds
[0m04:44:06.893834 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m04:44:06.894650 [debug] [MainThread]: Connection 'external_db.information_schema' was properly closed.
[0m04:44:06.895375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0eb19c430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e538e070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0df55a2e0>]}
[0m04:44:06.896093 [debug] [MainThread]: Flushing usage events
[0m04:44:28.784359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45759fb3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45742be4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45742be1c0>]}


============================== 04:44:28.788421 | 890de79f-084a-4411-b8f1-a5b927a0a0dc ==============================
[0m04:44:28.788421 [info ] [MainThread]: Running with dbt=1.5.1
[0m04:44:28.789173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'dags/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m04:44:29.121383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '890de79f-084a-4411-b8f1-a5b927a0a0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f456fb17e80>]}
[0m04:44:29.143952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '890de79f-084a-4411-b8f1-a5b927a0a0dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f456fb17580>]}
[0m06:59:58.446958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125c6c0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125af81640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125af81190>]}


============================== 06:59:58.451082 | 444403d7-5898-4e14-93a4-ee8738bdcdc1 ==============================
[0m06:59:58.451082 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:59:58.451827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:59:58.797841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '444403d7-5898-4e14-93a4-ee8738bdcdc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12568a1130>]}
[0m06:59:58.819755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '444403d7-5898-4e14-93a4-ee8738bdcdc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125689e040>]}
[0m06:59:58.837368 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:59:58.850903 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading development: schema.yml - Runtime Error
    Syntax error near line 44
    ------------------------------
    41 |   - name: bronze_payments
    42 |     descripiton: dim table for payment
    43 | 
    44 |       columns:
    45 |       - name: payment_id
    46 |         description: primary for the payment table
    47 | 
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 44, column 14
[0m06:59:58.851776 [debug] [MainThread]: Command `dbt compile` failed at 06:59:58.851621 after 0.43 seconds
[0m06:59:58.852275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f125c6c0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12556dcaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12556dcac0>]}
[0m06:59:58.852917 [debug] [MainThread]: Flushing usage events
[0m07:00:58.222643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80bfdc0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80be682640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80be6821c0>]}


============================== 07:00:58.227743 | 18041b91-ad25-46b3-bf1a-73b9a97aa2a2 ==============================
[0m07:00:58.227743 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:00:58.228619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'dags/dbt/logs', 'profiles_dir': 'dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:00:58.561471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18041b91-ad25-46b3-bf1a-73b9a97aa2a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b9f99130>]}
[0m07:00:58.585290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18041b91-ad25-46b3-bf1a-73b9a97aa2a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b9f9f040>]}
[0m07:00:58.604379 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:00:58.635448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m07:00:58.636423 [debug] [MainThread]: Partial parsing: added file: development://models/schema.yml
[0m07:00:58.669126 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_order_details' in the 'models' section of file 'models/schema.yml'
[0m07:00:58.682395 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.intermediate
[0m07:00:58.690361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18041b91-ad25-46b3-bf1a-73b9a97aa2a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b8d7e9a0>]}
[0m07:00:58.700092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18041b91-ad25-46b3-bf1a-73b9a97aa2a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b8d9e460>]}
[0m07:00:58.700815 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m07:00:58.701441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18041b91-ad25-46b3-bf1a-73b9a97aa2a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b8d922b0>]}
[0m07:00:58.703589 [info ] [MainThread]: 
[0m07:00:58.704694 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:00:58.706554 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m07:00:58.724914 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m07:00:58.725579 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m07:00:58.726081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:59.496204 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m07:00:59.499593 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m07:00:59.607652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18041b91-ad25-46b3-bf1a-73b9a97aa2a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b8d9e430>]}
[0m07:00:59.609053 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:00:59.610039 [info ] [MainThread]: 
[0m07:00:59.616108 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m07:00:59.617075 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m07:00:59.617642 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m07:00:59.623312 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m07:00:59.624482 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 07:00:59.618010 => 07:00:59.624094
[0m07:00:59.625068 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m07:00:59.626225 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 07:00:59.625568 => 07:00:59.625604
[0m07:00:59.627878 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m07:00:59.628513 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m07:00:59.629583 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m07:00:59.630136 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m07:00:59.633945 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m07:00:59.634926 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 07:00:59.630457 => 07:00:59.634578
[0m07:00:59.635452 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m07:00:59.636131 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 07:00:59.635791 => 07:00:59.635804
[0m07:00:59.637380 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m07:00:59.638181 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m07:00:59.639190 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m07:00:59.639801 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m07:00:59.643786 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m07:00:59.644785 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 07:00:59.640136 => 07:00:59.644383
[0m07:00:59.645305 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m07:00:59.645942 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 07:00:59.645640 => 07:00:59.645654
[0m07:00:59.647180 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m07:00:59.647814 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m07:00:59.648715 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m07:00:59.649509 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m07:00:59.653530 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m07:00:59.654564 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 07:00:59.649998 => 07:00:59.654232
[0m07:00:59.655186 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m07:00:59.655991 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 07:00:59.655665 => 07:00:59.655679
[0m07:00:59.657257 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m07:00:59.657959 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m07:00:59.658848 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m07:00:59.659538 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m07:00:59.663244 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m07:00:59.664207 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 07:00:59.659952 => 07:00:59.663853
[0m07:00:59.664827 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m07:00:59.665563 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 07:00:59.665240 => 07:00:59.665255
[0m07:00:59.666836 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m07:00:59.667510 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m07:00:59.668613 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m07:00:59.669210 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m07:00:59.673507 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m07:00:59.674422 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 07:00:59.669765 => 07:00:59.674075
[0m07:00:59.674995 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m07:00:59.675660 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 07:00:59.675342 => 07:00:59.675355
[0m07:00:59.677004 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m07:00:59.678183 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m07:00:59.678968 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m07:00:59.679574 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m07:00:59.683588 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m07:00:59.684482 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 07:00:59.679914 => 07:00:59.684123
[0m07:00:59.685019 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m07:00:59.685743 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 07:00:59.685362 => 07:00:59.685374
[0m07:00:59.687184 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m07:00:59.688613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:00:59.689083 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m07:00:59.691380 [debug] [MainThread]: Command end result
[0m07:00:59.702118 [debug] [MainThread]: Command `dbt compile` succeeded at 07:00:59.701883 after 1.50 seconds
[0m07:00:59.702724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80bfdc0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b9f9f040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80b8d92280>]}
[0m07:00:59.703268 [debug] [MainThread]: Flushing usage events
[0m07:01:08.460357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ffe2f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94fe74d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94fe74d0a0>]}


============================== 07:01:08.464050 | 4133e0c1-d831-4aca-a99f-4f7aa59a273f ==============================
[0m07:01:08.464050 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:01:08.464813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'dags/dbt', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:01:08.807551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4133e0c1-d831-4aca-a99f-4f7aa59a273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94fa041130>]}
[0m07:01:08.830865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4133e0c1-d831-4aca-a99f-4f7aa59a273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94fa03a1c0>]}
[0m07:01:08.849452 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:01:08.879495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:01:08.880029 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:01:08.881032 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m07:01:08.895044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4133e0c1-d831-4aca-a99f-4f7aa59a273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f8e441f0>]}
[0m07:01:08.897284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4133e0c1-d831-4aca-a99f-4f7aa59a273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f8ea3fd0>]}
[0m07:01:08.897824 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m07:01:08.898401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4133e0c1-d831-4aca-a99f-4f7aa59a273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f8eab100>]}
[0m07:01:08.900454 [info ] [MainThread]: 
[0m07:01:08.901607 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:01:08.903581 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m07:01:08.923840 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m07:01:08.924881 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m07:01:08.925360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:01:09.435229 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m07:01:09.439045 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m07:01:09.550513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4133e0c1-d831-4aca-a99f-4f7aa59a273f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f8ea3a90>]}
[0m07:01:09.551802 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:01:09.552412 [info ] [MainThread]: 
[0m07:01:09.558813 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m07:01:09.559828 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m07:01:09.560423 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m07:01:09.565777 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m07:01:09.566960 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 07:01:09.560813 => 07:01:09.566483
[0m07:01:09.567474 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m07:01:09.568147 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 07:01:09.567807 => 07:01:09.567846
[0m07:01:09.569954 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m07:01:09.570695 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m07:01:09.571720 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m07:01:09.572270 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m07:01:09.576542 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m07:01:09.577561 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 07:01:09.572759 => 07:01:09.577130
[0m07:01:09.578067 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m07:01:09.578712 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 07:01:09.578406 => 07:01:09.578420
[0m07:01:09.579975 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m07:01:09.580680 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m07:01:09.581445 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m07:01:09.581959 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m07:01:09.586004 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m07:01:09.586969 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 07:01:09.582365 => 07:01:09.586654
[0m07:01:09.587557 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m07:01:09.588221 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 07:01:09.587907 => 07:01:09.587930
[0m07:01:09.589533 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m07:01:09.590243 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m07:01:09.591065 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m07:01:09.591580 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m07:01:09.595791 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m07:01:09.596997 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 07:01:09.591897 => 07:01:09.596669
[0m07:01:09.597535 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m07:01:09.598276 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 07:01:09.597963 => 07:01:09.597978
[0m07:01:09.599464 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m07:01:09.600049 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m07:01:09.601251 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m07:01:09.601774 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m07:01:09.605756 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m07:01:09.606605 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 07:01:09.602109 => 07:01:09.606290
[0m07:01:09.607107 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m07:01:09.607734 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 07:01:09.607434 => 07:01:09.607447
[0m07:01:09.609104 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m07:01:09.609709 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m07:01:09.610508 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m07:01:09.611301 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m07:01:09.615409 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m07:01:09.616305 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 07:01:09.611679 => 07:01:09.615981
[0m07:01:09.616836 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m07:01:09.617572 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 07:01:09.617214 => 07:01:09.617274
[0m07:01:09.618727 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m07:01:09.620106 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m07:01:09.621169 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m07:01:09.621685 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m07:01:09.625975 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m07:01:09.626788 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 07:01:09.622014 => 07:01:09.626478
[0m07:01:09.627372 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m07:01:09.627997 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 07:01:09.627701 => 07:01:09.627713
[0m07:01:09.629169 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m07:01:09.630464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:01:09.630915 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m07:01:09.633257 [debug] [MainThread]: Command end result
[0m07:01:09.647115 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m07:01:09.647664 [info ] [MainThread]: Building catalog
[0m07:01:09.652024 [debug] [ThreadPool]: Acquiring new snowflake connection 'external_db.information_schema'
[0m07:01:09.663046 [debug] [ThreadPool]: Using snowflake connection "external_db.information_schema"
[0m07:01:09.663780 [debug] [ThreadPool]: On external_db.information_schema: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "external_db.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from external_db.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from external_db.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('final_sales') or upper("table_schema") = upper('stage'))
      order by "column_index"
[0m07:01:09.664355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:01:12.344781 [debug] [ThreadPool]: SQL status: SUCCESS 36 in 3.0 seconds
[0m07:01:12.361234 [debug] [ThreadPool]: On external_db.information_schema: Close
[0m07:01:12.502468 [info ] [MainThread]: Catalog written to /home/satyam/airflow/target/catalog.json
[0m07:01:12.503883 [debug] [MainThread]: Command `dbt docs generate` succeeded at 07:01:12.503684 after 4.06 seconds
[0m07:01:12.504437 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m07:01:12.504995 [debug] [MainThread]: Connection 'external_db.information_schema' was properly closed.
[0m07:01:12.505504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94ffe2f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94fa03a1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94f821cd60>]}
[0m07:01:12.506037 [debug] [MainThread]: Flushing usage events
[0m07:01:18.984539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1802917460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18011da550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18011da2b0>]}


============================== 07:01:18.988719 | 42b34368-4f81-4508-9f75-4230bda2f059 ==============================
[0m07:01:18.988719 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:01:18.989478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dags/dbt/logs', 'version_check': 'True', 'profiles_dir': 'dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:01:19.340973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42b34368-4f81-4508-9f75-4230bda2f059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17fb9f5d90>]}
[0m07:01:19.363479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42b34368-4f81-4508-9f75-4230bda2f059', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17fb9f55e0>]}
[0m07:01:19.690029 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m07:01:19.701975 [error] [MainThread]: Traceback (most recent call last):
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 299, in docs_serve
    results = task.run()
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
  File "/usr/lib/python3.8/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/lib/python3.8/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m07:01:19.703541 [debug] [MainThread]: Command `dbt docs serve` failed at 07:01:19.703277 after 0.74 seconds
[0m07:01:19.704393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1802917460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17fb9ea100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17fb9ea310>]}
[0m07:01:19.705271 [debug] [MainThread]: Flushing usage events
[0m07:01:35.714862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb184244c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb16ce7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb16ce70d0>]}


============================== 07:01:35.718625 | f6a3ef88-ff2c-42e5-9b6e-c4ddb21990d0 ==============================
[0m07:01:35.718625 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:01:35.719572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:01:36.039450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6a3ef88-ff2c-42e5-9b6e-c4ddb21990d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb11538040>]}
[0m07:01:36.062703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6a3ef88-ff2c-42e5-9b6e-c4ddb21990d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb11535040>]}
[0m07:02:24.034205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe46fbe490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe458c1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe458c1550>]}


============================== 07:02:24.038089 | 7ef29093-40fe-4964-ac1c-39f0c7dc8df3 ==============================
[0m07:02:24.038089 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:02:24.038767 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'dags/dbt/logs', 'profiles_dir': 'dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:02:24.395504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ef29093-40fe-4964-ac1c-39f0c7dc8df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe411aa130>]}
[0m07:02:24.418016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ef29093-40fe-4964-ac1c-39f0c7dc8df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe411b0040>]}
[0m07:02:24.436812 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:02:24.466729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:02:24.467419 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:02:24.468375 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.staging
- models.development.intermediate
[0m07:02:24.478416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ef29093-40fe-4964-ac1c-39f0c7dc8df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe3ff841f0>]}
[0m07:02:24.481024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ef29093-40fe-4964-ac1c-39f0c7dc8df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe3ffe3fd0>]}
[0m07:02:24.481657 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m07:02:24.482296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ef29093-40fe-4964-ac1c-39f0c7dc8df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe3ffeb100>]}
[0m07:02:24.484707 [info ] [MainThread]: 
[0m07:02:24.485870 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:02:24.487885 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m07:02:24.507313 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m07:02:24.508143 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m07:02:24.508768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:02:25.283802 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m07:02:25.287389 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m07:02:25.405601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ef29093-40fe-4964-ac1c-39f0c7dc8df3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe3ffe3a90>]}
[0m07:02:25.406776 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:02:25.407330 [info ] [MainThread]: 
[0m07:02:25.412303 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m07:02:25.413076 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m07:02:25.413546 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m07:02:25.418411 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m07:02:25.419605 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 07:02:25.413874 => 07:02:25.419072
[0m07:02:25.420044 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m07:02:25.420734 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 07:02:25.420330 => 07:02:25.420361
[0m07:02:25.421968 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m07:02:25.422560 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m07:02:25.423437 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m07:02:25.424047 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m07:02:25.428116 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m07:02:25.429371 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 07:02:25.424433 => 07:02:25.428920
[0m07:02:25.429928 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m07:02:25.430613 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 07:02:25.430293 => 07:02:25.430305
[0m07:02:25.431712 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m07:02:25.432283 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m07:02:25.433015 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m07:02:25.433500 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m07:02:25.436704 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m07:02:25.437592 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 07:02:25.433814 => 07:02:25.437283
[0m07:02:25.438049 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m07:02:25.438599 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 07:02:25.438336 => 07:02:25.438346
[0m07:02:25.439908 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m07:02:25.440438 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m07:02:25.441302 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m07:02:25.441896 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m07:02:25.445315 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m07:02:25.446183 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 07:02:25.442237 => 07:02:25.445899
[0m07:02:25.446700 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m07:02:25.447278 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 07:02:25.447022 => 07:02:25.447032
[0m07:02:25.448241 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m07:02:25.448854 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m07:02:25.449787 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m07:02:25.450376 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m07:02:25.454369 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m07:02:25.455505 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 07:02:25.450795 => 07:02:25.455079
[0m07:02:25.456083 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m07:02:25.456806 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 07:02:25.456425 => 07:02:25.456435
[0m07:02:25.458150 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m07:02:25.458845 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m07:02:25.459691 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m07:02:25.460211 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m07:02:25.463779 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m07:02:25.464738 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 07:02:25.460525 => 07:02:25.464382
[0m07:02:25.465227 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m07:02:25.465802 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 07:02:25.465527 => 07:02:25.465537
[0m07:02:25.466999 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m07:02:25.468254 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m07:02:25.469035 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m07:02:25.469612 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m07:02:25.473535 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m07:02:25.474495 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 07:02:25.469957 => 07:02:25.474021
[0m07:02:25.475027 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m07:02:25.476075 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 07:02:25.475765 => 07:02:25.475777
[0m07:02:25.477669 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m07:02:25.478968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:02:25.479443 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m07:02:25.481645 [debug] [MainThread]: Command end result
[0m07:02:25.495161 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m07:02:25.495646 [info ] [MainThread]: Building catalog
[0m07:02:25.498868 [debug] [ThreadPool]: Acquiring new snowflake connection 'external_db.information_schema'
[0m07:02:25.509186 [debug] [ThreadPool]: Using snowflake connection "external_db.information_schema"
[0m07:02:25.509799 [debug] [ThreadPool]: On external_db.information_schema: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "external_db.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from external_db.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from external_db.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('stage') or upper("table_schema") = upper('final_sales'))
      order by "column_index"
[0m07:02:25.510442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:02:28.151279 [debug] [ThreadPool]: SQL status: SUCCESS 36 in 3.0 seconds
[0m07:02:28.169707 [debug] [ThreadPool]: On external_db.information_schema: Close
[0m07:02:28.295715 [info ] [MainThread]: Catalog written to /home/satyam/airflow/target/catalog.json
[0m07:02:28.297648 [debug] [MainThread]: Command `dbt docs generate` succeeded at 07:02:28.297434 after 4.29 seconds
[0m07:02:28.298751 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m07:02:28.299288 [debug] [MainThread]: Connection 'external_db.information_schema' was properly closed.
[0m07:02:28.299861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe46fbe490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe411b0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe3da5ce50>]}
[0m07:02:28.300462 [debug] [MainThread]: Flushing usage events
[0m07:02:40.767177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14e6d08430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14e55e6580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14e55e60d0>]}


============================== 07:02:40.771409 | 910c1ec8-f06e-4b74-94b6-c3345bd44579 ==============================
[0m07:02:40.771409 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:02:40.772179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': 'dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:02:41.102157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '910c1ec8-f06e-4b74-94b6-c3345bd44579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14e0e40f10>]}
[0m07:02:41.125412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '910c1ec8-f06e-4b74-94b6-c3345bd44579', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14e0e40610>]}
[0m07:03:51.529047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc176c4e430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc175538580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1755380d0>]}


============================== 07:03:51.533069 | 2a92d999-b57f-419a-a494-f61dd5be601f ==============================
[0m07:03:51.533069 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:03:51.534407 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'dags/dbt', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:03:51.894133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2a92d999-b57f-419a-a494-f61dd5be601f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16fd76f10>]}
[0m07:03:51.917713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2a92d999-b57f-419a-a494-f61dd5be601f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc16fd76610>]}
[0m07:05:09.493597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7079f253d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707880f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707880f190>]}


============================== 07:05:09.497829 | 92b96268-448c-40f9-8b72-87fcc24616cf ==============================
[0m07:05:09.497829 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:05:09.498687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:05:09.834104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92b96268-448c-40f9-8b72-87fcc24616cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707412cf70>]}
[0m07:05:09.859775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92b96268-448c-40f9-8b72-87fcc24616cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707412c610>]}
[0m07:05:09.879431 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:05:09.910703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:05:09.911244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:05:09.912194 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.intermediate
- models.development.bronze
[0m07:05:09.922084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92b96268-448c-40f9-8b72-87fcc24616cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7072f00f40>]}
[0m07:05:09.932996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92b96268-448c-40f9-8b72-87fcc24616cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7072fdcb50>]}
[0m07:05:09.933818 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m07:05:09.934445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92b96268-448c-40f9-8b72-87fcc24616cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7072fdceb0>]}
[0m07:05:09.936653 [info ] [MainThread]: 
[0m07:05:09.937703 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:05:09.941255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m07:05:09.960735 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m07:05:09.961285 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m07:05:09.961730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:05:10.705392 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m07:05:10.708916 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m07:05:10.814372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92b96268-448c-40f9-8b72-87fcc24616cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7072f63d00>]}
[0m07:05:10.815744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:05:10.816834 [info ] [MainThread]: 
[0m07:05:10.823346 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m07:05:10.824364 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m07:05:10.824908 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m07:05:10.830141 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m07:05:10.831200 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 07:05:10.825295 => 07:05:10.830750
[0m07:05:10.831798 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m07:05:10.832618 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 07:05:10.832221 => 07:05:10.832257
[0m07:05:10.834059 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m07:05:10.834729 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m07:05:10.836058 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m07:05:10.836675 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m07:05:10.840352 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m07:05:10.841877 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 07:05:10.837036 => 07:05:10.841525
[0m07:05:10.842350 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m07:05:10.842965 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 07:05:10.842688 => 07:05:10.842701
[0m07:05:10.844189 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m07:05:10.844813 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m07:05:10.845543 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m07:05:10.846045 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m07:05:10.849612 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m07:05:10.850587 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 07:05:10.846396 => 07:05:10.850265
[0m07:05:10.851219 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m07:05:10.852046 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 07:05:10.851651 => 07:05:10.851663
[0m07:05:10.853245 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m07:05:10.853794 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m07:05:10.855037 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m07:05:10.855579 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m07:05:10.859114 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m07:05:10.860069 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 07:05:10.855960 => 07:05:10.859689
[0m07:05:10.860694 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m07:05:10.861355 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 07:05:10.861074 => 07:05:10.861086
[0m07:05:10.862451 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m07:05:10.863005 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m07:05:10.863823 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m07:05:10.864762 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m07:05:10.868637 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m07:05:10.869742 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 07:05:10.865183 => 07:05:10.869337
[0m07:05:10.870247 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m07:05:10.871022 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 07:05:10.870664 => 07:05:10.870677
[0m07:05:10.872230 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m07:05:10.872924 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m07:05:10.873728 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m07:05:10.874662 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m07:05:10.880501 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m07:05:10.881484 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 07:05:10.875042 => 07:05:10.881133
[0m07:05:10.882095 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m07:05:10.882930 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 07:05:10.882486 => 07:05:10.882498
[0m07:05:10.884129 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m07:05:10.885385 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m07:05:10.886197 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m07:05:10.886726 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m07:05:10.890903 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m07:05:10.891728 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 07:05:10.887054 => 07:05:10.891401
[0m07:05:10.892196 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m07:05:10.892954 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 07:05:10.892559 => 07:05:10.892570
[0m07:05:10.894134 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m07:05:10.895486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:05:10.895931 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m07:05:10.898111 [debug] [MainThread]: Command end result
[0m07:05:10.908086 [debug] [MainThread]: Command `dbt compile` succeeded at 07:05:10.907879 after 1.44 seconds
[0m07:05:10.908699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7079f253d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707412c610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7072fdcbe0>]}
[0m07:05:10.909246 [debug] [MainThread]: Flushing usage events
[0m07:05:44.281427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca9ab614c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca9947f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca9947f310>]}


============================== 07:05:44.285716 | aedfa5af-a6f3-46e2-bb80-a6cbc19f7602 ==============================
[0m07:05:44.285716 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:05:44.286504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dags/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:05:44.639452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aedfa5af-a6f3-46e2-bb80-a6cbc19f7602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca94d4ac70>]}
[0m07:05:44.663523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aedfa5af-a6f3-46e2-bb80-a6cbc19f7602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca94d6b040>]}
[0m07:05:44.683338 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:05:44.716739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:05:44.717337 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:05:44.718266 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m07:05:44.728332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aedfa5af-a6f3-46e2-bb80-a6cbc19f7602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca93b43220>]}
[0m07:05:44.730818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aedfa5af-a6f3-46e2-bb80-a6cbc19f7602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca94c47130>]}
[0m07:05:44.731413 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m07:05:44.732018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aedfa5af-a6f3-46e2-bb80-a6cbc19f7602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca94c47100>]}
[0m07:05:44.734351 [info ] [MainThread]: 
[0m07:05:44.735433 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:05:44.737297 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m07:05:44.755870 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m07:05:44.756634 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m07:05:44.757162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:05:45.456273 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m07:05:45.459663 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m07:05:45.562484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aedfa5af-a6f3-46e2-bb80-a6cbc19f7602', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca93ba2fa0>]}
[0m07:05:45.564061 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:05:45.565028 [info ] [MainThread]: 
[0m07:05:45.571311 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m07:05:45.572344 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.development.bronze_customers'
[0m07:05:45.572924 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m07:05:45.578651 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m07:05:45.579749 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 07:05:45.573301 => 07:05:45.579272
[0m07:05:45.580387 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m07:05:45.581102 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 07:05:45.580750 => 07:05:45.580786
[0m07:05:45.582321 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m07:05:45.583092 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m07:05:45.583989 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m07:05:45.584581 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m07:05:45.588367 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m07:05:45.589539 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 07:05:45.584946 => 07:05:45.589187
[0m07:05:45.590060 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m07:05:45.590707 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 07:05:45.590412 => 07:05:45.590423
[0m07:05:45.591813 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m07:05:45.592416 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m07:05:45.593366 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m07:05:45.593939 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m07:05:45.597602 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m07:05:45.598698 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 07:05:45.594249 => 07:05:45.598171
[0m07:05:45.599198 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m07:05:45.599832 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 07:05:45.599527 => 07:05:45.599539
[0m07:05:45.601033 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m07:05:45.601618 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m07:05:45.602427 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m07:05:45.602958 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m07:05:45.606735 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m07:05:45.607981 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 07:05:45.603289 => 07:05:45.607624
[0m07:05:45.608475 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m07:05:45.609167 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 07:05:45.608852 => 07:05:45.608865
[0m07:05:45.610321 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m07:05:45.610926 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m07:05:45.611914 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m07:05:45.612653 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m07:05:45.616795 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m07:05:45.617799 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 07:05:45.612996 => 07:05:45.617458
[0m07:05:45.618358 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m07:05:45.619049 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 07:05:45.618720 => 07:05:45.618733
[0m07:05:45.620248 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m07:05:45.620888 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m07:05:45.621833 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m07:05:45.622381 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m07:05:45.626195 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m07:05:45.627061 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 07:05:45.622714 => 07:05:45.626771
[0m07:05:45.627648 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m07:05:45.628251 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 07:05:45.627947 => 07:05:45.627958
[0m07:05:45.629398 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m07:05:45.630687 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m07:05:45.631734 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m07:05:45.632347 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m07:05:45.637256 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m07:05:45.638815 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 07:05:45.632746 => 07:05:45.638391
[0m07:05:45.639372 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m07:05:45.640087 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 07:05:45.639774 => 07:05:45.639788
[0m07:05:45.641324 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m07:05:45.642668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:05:45.643084 [debug] [MainThread]: Connection 'list_external_db_final_sales' was properly closed.
[0m07:05:45.643459 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m07:05:45.645669 [debug] [MainThread]: Command end result
[0m07:05:45.659200 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m07:05:45.659684 [info ] [MainThread]: Building catalog
[0m07:05:45.662868 [debug] [ThreadPool]: Acquiring new snowflake connection 'external_db.information_schema'
[0m07:05:45.674441 [debug] [ThreadPool]: Using snowflake connection "external_db.information_schema"
[0m07:05:45.675080 [debug] [ThreadPool]: On external_db.information_schema: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "external_db.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from external_db.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from external_db.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('final_sales') or upper("table_schema") = upper('stage'))
      order by "column_index"
[0m07:05:45.675690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:05:47.722869 [debug] [ThreadPool]: SQL status: SUCCESS 36 in 2.0 seconds
[0m07:05:47.741528 [debug] [ThreadPool]: On external_db.information_schema: Close
[0m07:05:47.885031 [info ] [MainThread]: Catalog written to /home/satyam/airflow/target/catalog.json
[0m07:05:47.886619 [debug] [MainThread]: Command `dbt docs generate` succeeded at 07:05:47.886349 after 3.63 seconds
[0m07:05:47.887155 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m07:05:47.887575 [debug] [MainThread]: Connection 'external_db.information_schema' was properly closed.
[0m07:05:47.888274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca9ab614c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca94d6b040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca94c470a0>]}
[0m07:05:47.888960 [debug] [MainThread]: Flushing usage events
[0m07:06:23.379096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a24bb400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a0da5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57a0da50d0>]}


============================== 07:06:23.383028 | 01c24e9c-dcfd-409c-b219-cd84af4a7304 ==============================
[0m07:06:23.383028 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:06:23.383850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dags/dbt/logs', 'profiles_dir': 'dags/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:06:23.733457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01c24e9c-dcfd-409c-b219-cd84af4a7304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f579c6bdfa0>]}
[0m07:06:23.756860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01c24e9c-dcfd-409c-b219-cd84af4a7304', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f579c6bd5e0>]}
[0m07:10:49.517767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff04a71460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0335b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff0335b250>]}


============================== 07:10:49.521427 | 06e038f1-0256-4eee-bc65-52706fa81c85 ==============================
[0m07:10:49.521427 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:10:49.522402 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': 'dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:10:49.843223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06e038f1-0256-4eee-bc65-52706fa81c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efefdbb3d90>]}
[0m07:10:49.864684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '06e038f1-0256-4eee-bc65-52706fa81c85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efefdbb35e0>]}
[0m07:10:50.226192 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m07:10:50.228390 [error] [MainThread]: Traceback (most recent call last):
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 299, in docs_serve
    results = task.run()
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
  File "/usr/lib/python3.8/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/lib/python3.8/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m07:10:50.230242 [debug] [MainThread]: Command `dbt docs serve` failed at 07:10:50.230013 after 0.73 seconds
[0m07:10:50.231196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff04a71460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efefdb9a100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efefdb9a310>]}
[0m07:10:50.231871 [debug] [MainThread]: Flushing usage events
[0m07:11:08.491461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32eb5e14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32e9ebf610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32e9ebf250>]}


============================== 07:11:08.495049 | f0328a06-ae4e-49ea-8fd5-fe0a655641f6 ==============================
[0m07:11:08.495049 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:11:08.495791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'dags/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:11:08.815117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0328a06-ae4e-49ea-8fd5-fe0a655641f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32e5715040>]}
[0m07:11:08.837006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0328a06-ae4e-49ea-8fd5-fe0a655641f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32e5719040>]}
[0m07:11:09.202706 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m07:11:09.205051 [error] [MainThread]: Traceback (most recent call last):
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 299, in docs_serve
    results = task.run()
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
  File "/usr/lib/python3.8/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/lib/python3.8/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m07:11:09.206474 [debug] [MainThread]: Command `dbt docs serve` failed at 07:11:09.206255 after 0.74 seconds
[0m07:11:09.207057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32eb5e14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32e5710340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32e5710310>]}
[0m07:11:09.207753 [debug] [MainThread]: Flushing usage events
[0m07:11:18.972062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa34ee0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa337a35e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa337a30d0>]}


============================== 07:11:18.975635 | 6fafab13-23ce-4504-87e2-c2c615709db3 ==============================
[0m07:11:18.975635 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:11:18.976324 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'dags/dbt', 'log_path': 'dags/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:11:19.291631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fafab13-23ce-4504-87e2-c2c615709db3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa2dff3fa0>]}
[0m07:11:19.313791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fafab13-23ce-4504-87e2-c2c615709db3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa2dff3610>]}
[0m07:18:05.921717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2399087520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23979a4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23979a45b0>]}


============================== 07:18:05.925751 | 2e83400d-717c-46ad-98a1-27956fa7c254 ==============================
[0m07:18:05.925751 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:18:05.926441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dags/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:18:06.271209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e83400d-717c-46ad-98a1-27956fa7c254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f239326fcd0>]}
[0m07:18:06.293587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e83400d-717c-46ad-98a1-27956fa7c254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f239321ebe0>]}
[0m07:18:06.314726 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:18:06.315712 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:18:06.316275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2e83400d-717c-46ad-98a1-27956fa7c254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2393246e80>]}
[0m07:18:07.307059 [debug] [MainThread]: 1699: static parser successfully parsed sales/intermediate/fct_order_detail.sql
[0m07:18:07.328177 [debug] [MainThread]: 1699: static parser successfully parsed sales/intermediate/fct_payment_details.sql
[0m07:18:07.333146 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_orders.sql
[0m07:18:07.338200 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_payments.sql
[0m07:18:07.342986 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_customers.sql
[0m07:18:07.348675 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_products.sql
[0m07:18:07.353950 [debug] [MainThread]: 1699: static parser successfully parsed sales/core/product_sales.sql
[0m07:18:07.405368 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_order_details' in the 'models' section of file 'models/schema.yml'
[0m07:18:07.464932 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m07:18:07.472358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e83400d-717c-46ad-98a1-27956fa7c254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2391c3d610>]}
[0m07:18:07.474587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e83400d-717c-46ad-98a1-27956fa7c254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2393240220>]}
[0m07:18:07.475229 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m07:18:07.475790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e83400d-717c-46ad-98a1-27956fa7c254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2392128d90>]}
[0m07:18:07.477967 [info ] [MainThread]: 
[0m07:18:07.479305 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:18:07.481557 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m07:18:07.503865 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m07:18:07.504450 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m07:18:07.504879 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:18:08.345982 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m07:18:08.349556 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m07:18:08.474293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e83400d-717c-46ad-98a1-27956fa7c254', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2391c45310>]}
[0m07:18:08.475684 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:18:08.477053 [info ] [MainThread]: 
[0m07:18:08.483611 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m07:18:08.484662 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m07:18:08.485237 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m07:18:08.490505 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m07:18:08.491760 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 07:18:08.485591 => 07:18:08.491194
[0m07:18:08.492360 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m07:18:08.493161 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 07:18:08.492716 => 07:18:08.492767
[0m07:18:08.494408 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m07:18:08.494995 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m07:18:08.496075 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m07:18:08.496743 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m07:18:08.501759 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m07:18:08.502761 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 07:18:08.497983 => 07:18:08.502399
[0m07:18:08.503283 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m07:18:08.503934 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 07:18:08.503612 => 07:18:08.503627
[0m07:18:08.505259 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m07:18:08.505956 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m07:18:08.506996 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m07:18:08.507608 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m07:18:08.511965 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m07:18:08.512988 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 07:18:08.508071 => 07:18:08.512674
[0m07:18:08.513559 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m07:18:08.514220 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 07:18:08.513916 => 07:18:08.513927
[0m07:18:08.515478 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m07:18:08.516082 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m07:18:08.516935 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m07:18:08.517452 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m07:18:08.521375 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m07:18:08.522675 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 07:18:08.517803 => 07:18:08.522338
[0m07:18:08.523235 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m07:18:08.523867 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 07:18:08.523572 => 07:18:08.523585
[0m07:18:08.526135 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m07:18:08.526930 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m07:18:08.528324 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m07:18:08.529064 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m07:18:08.533411 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m07:18:08.534407 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 07:18:08.529492 => 07:18:08.534006
[0m07:18:08.535003 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m07:18:08.535703 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 07:18:08.535386 => 07:18:08.535415
[0m07:18:08.537695 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m07:18:08.538445 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m07:18:08.539492 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m07:18:08.540045 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m07:18:08.545622 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m07:18:08.546648 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 07:18:08.540427 => 07:18:08.546346
[0m07:18:08.547159 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m07:18:08.547778 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 07:18:08.547487 => 07:18:08.547498
[0m07:18:08.548979 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m07:18:08.549985 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m07:18:08.550831 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m07:18:08.551325 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m07:18:08.555763 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m07:18:08.557096 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 07:18:08.551685 => 07:18:08.556671
[0m07:18:08.557773 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m07:18:08.558457 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 07:18:08.558147 => 07:18:08.558161
[0m07:18:08.559877 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m07:18:08.561166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:18:08.561597 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m07:18:08.563748 [debug] [MainThread]: Command end result
[0m07:18:08.577002 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m07:18:08.577503 [info ] [MainThread]: Building catalog
[0m07:18:08.581039 [debug] [ThreadPool]: Acquiring new snowflake connection 'external_db.information_schema'
[0m07:18:08.592193 [debug] [ThreadPool]: Using snowflake connection "external_db.information_schema"
[0m07:18:08.592802 [debug] [ThreadPool]: On external_db.information_schema: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "external_db.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from external_db.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from external_db.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('stage') or upper("table_schema") = upper('final_sales'))
      order by "column_index"
[0m07:18:08.593374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:18:10.851285 [debug] [ThreadPool]: SQL status: SUCCESS 36 in 2.0 seconds
[0m07:18:10.868686 [debug] [ThreadPool]: On external_db.information_schema: Close
[0m07:18:10.996211 [info ] [MainThread]: Catalog written to /home/satyam/airflow/target/catalog.json
[0m07:18:10.997914 [debug] [MainThread]: Command `dbt docs generate` succeeded at 07:18:10.997730 after 5.10 seconds
[0m07:18:10.998404 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m07:18:10.998961 [debug] [MainThread]: Connection 'external_db.information_schema' was properly closed.
[0m07:18:10.999484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2399087520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f239321ebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2392182400>]}
[0m07:18:11.000088 [debug] [MainThread]: Flushing usage events
[0m07:19:21.509730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd29844430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd28147640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd28147100>]}


============================== 07:19:21.514001 | 0bcb414f-87c9-4854-acab-aec18d3de153 ==============================
[0m07:19:21.514001 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:19:21.514861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:19:21.869275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bcb414f-87c9-4854-acab-aec18d3de153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd23a3e0a0>]}
[0m07:19:21.892490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bcb414f-87c9-4854-acab-aec18d3de153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd23a39310>]}
[0m07:19:21.912698 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:19:21.946671 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:19:21.947647 [debug] [MainThread]: Partial parsing: updated file: development://models/schema.yml
[0m07:19:21.980192 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m07:19:21.990148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bcb414f-87c9-4854-acab-aec18d3de153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd2286b640>]}
[0m07:19:21.993066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bcb414f-87c9-4854-acab-aec18d3de153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd228ae160>]}
[0m07:19:21.994046 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m07:19:21.994728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bcb414f-87c9-4854-acab-aec18d3de153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd228ae1c0>]}
[0m07:19:21.996868 [info ] [MainThread]: 
[0m07:19:21.998274 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:19:22.000298 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m07:19:22.023674 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m07:19:22.024298 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m07:19:22.024819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:19:22.745475 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m07:19:22.748993 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m07:19:22.849088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bcb414f-87c9-4854-acab-aec18d3de153', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd22861520>]}
[0m07:19:22.850525 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:19:22.851247 [info ] [MainThread]: 
[0m07:19:22.856144 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m07:19:22.857045 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m07:19:22.857536 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m07:19:22.862886 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m07:19:22.864172 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 07:19:22.857893 => 07:19:22.863599
[0m07:19:22.864809 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m07:19:22.865446 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 07:19:22.865133 => 07:19:22.865166
[0m07:19:22.866716 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m07:19:22.867285 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m07:19:22.868046 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m07:19:22.868781 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m07:19:22.873567 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m07:19:22.874433 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 07:19:22.869109 => 07:19:22.874036
[0m07:19:22.874991 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m07:19:22.875637 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 07:19:22.875329 => 07:19:22.875356
[0m07:19:22.876900 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m07:19:22.877453 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m07:19:22.878345 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m07:19:22.878814 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m07:19:22.882462 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m07:19:22.883328 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 07:19:22.879116 => 07:19:22.883036
[0m07:19:22.883842 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m07:19:22.884683 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 07:19:22.884240 => 07:19:22.884269
[0m07:19:22.885774 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m07:19:22.886360 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m07:19:22.887091 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m07:19:22.887610 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m07:19:22.890900 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m07:19:22.891798 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 07:19:22.887951 => 07:19:22.891491
[0m07:19:22.892349 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m07:19:22.893144 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 07:19:22.892842 => 07:19:22.892853
[0m07:19:22.894316 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m07:19:22.894991 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m07:19:22.895801 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m07:19:22.896399 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m07:19:22.899978 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m07:19:22.900906 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 07:19:22.896901 => 07:19:22.900582
[0m07:19:22.901362 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m07:19:22.901949 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 07:19:22.901680 => 07:19:22.901690
[0m07:19:22.902939 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m07:19:22.903458 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m07:19:22.904272 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m07:19:22.904879 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m07:19:22.908820 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m07:19:22.909589 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 07:19:22.905275 => 07:19:22.909272
[0m07:19:22.910089 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m07:19:22.910760 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 07:19:22.910480 => 07:19:22.910490
[0m07:19:22.912156 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m07:19:22.913753 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m07:19:22.914818 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m07:19:22.915364 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m07:19:22.920046 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m07:19:22.921109 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 07:19:22.915721 => 07:19:22.920719
[0m07:19:22.921692 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m07:19:22.922328 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 07:19:22.922038 => 07:19:22.922053
[0m07:19:22.923525 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m07:19:22.924761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:19:22.925309 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m07:19:22.927505 [debug] [MainThread]: Command end result
[0m07:19:22.939617 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m07:19:22.940136 [info ] [MainThread]: Building catalog
[0m07:19:22.944213 [debug] [ThreadPool]: Acquiring new snowflake connection 'external_db.information_schema'
[0m07:19:22.954421 [debug] [ThreadPool]: Using snowflake connection "external_db.information_schema"
[0m07:19:22.955047 [debug] [ThreadPool]: On external_db.information_schema: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "external_db.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from external_db.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from external_db.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('stage') or upper("table_schema") = upper('final_sales'))
      order by "column_index"
[0m07:19:22.955685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:19:25.226149 [debug] [ThreadPool]: SQL status: SUCCESS 36 in 2.0 seconds
[0m07:19:25.243410 [debug] [ThreadPool]: On external_db.information_schema: Close
[0m07:19:25.361520 [info ] [MainThread]: Catalog written to /home/satyam/airflow/target/catalog.json
[0m07:19:25.363430 [debug] [MainThread]: Command `dbt docs generate` succeeded at 07:19:25.363232 after 3.87 seconds
[0m07:19:25.363912 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m07:19:25.364361 [debug] [MainThread]: Connection 'external_db.information_schema' was properly closed.
[0m07:19:25.364888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd29844430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd23a39310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efd228a5dc0>]}
[0m07:19:25.365493 [debug] [MainThread]: Flushing usage events
[0m07:20:11.346769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8862554460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8860e3e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8860e3e100>]}


============================== 07:20:11.351143 | 7a75a178-118f-4116-93ab-129affca2314 ==============================
[0m07:20:11.351143 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:20:11.351975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'dags/dbt', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:20:11.696484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a75a178-118f-4116-93ab-129affca2314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f885c75ad90>]}
[0m07:20:11.720335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a75a178-118f-4116-93ab-129affca2314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f885c75a5e0>]}
[0m07:27:24.044887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7085bcc4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70845027c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70845025b0>]}


============================== 07:27:24.048772 | c606626a-3988-4ea7-8968-e4ff2ee304bc ==============================
[0m07:27:24.048772 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:27:24.049594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:27:24.404707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c606626a-3988-4ea7-8968-e4ff2ee304bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707fdcfaf0>]}
[0m07:27:24.428822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c606626a-3988-4ea7-8968-e4ff2ee304bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707fdeeb50>]}
[0m07:27:24.447959 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:27:24.449001 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:27:24.449583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c606626a-3988-4ea7-8968-e4ff2ee304bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707fda6940>]}
[0m07:27:25.398663 [debug] [MainThread]: 1699: static parser successfully parsed sales/intermediate/fct_order_detail.sql
[0m07:27:25.418809 [debug] [MainThread]: 1699: static parser successfully parsed sales/intermediate/fct_payment_details.sql
[0m07:27:25.424242 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_orders.sql
[0m07:27:25.430104 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_payments.sql
[0m07:27:25.436027 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_customers.sql
[0m07:27:25.441834 [debug] [MainThread]: 1699: static parser successfully parsed sales/bronze/bronze_products.sql
[0m07:27:25.447715 [debug] [MainThread]: 1699: static parser successfully parsed sales/core/product_sales.sql
[0m07:27:25.572206 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.staging
- models.development.intermediate
[0m07:27:25.580266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c606626a-3988-4ea7-8968-e4ff2ee304bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707e78ea30>]}
[0m07:27:25.583084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c606626a-3988-4ea7-8968-e4ff2ee304bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707fda6a90>]}
[0m07:27:25.583747 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m07:27:25.584297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c606626a-3988-4ea7-8968-e4ff2ee304bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707e78be50>]}
[0m07:27:25.586542 [info ] [MainThread]: 
[0m07:27:25.587787 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:27:25.589884 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m07:27:25.610671 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m07:27:25.611470 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m07:27:25.611987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:27:26.419438 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m07:27:26.424063 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m07:27:26.560091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c606626a-3988-4ea7-8968-e4ff2ee304bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707e718040>]}
[0m07:27:26.561545 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:27:26.562749 [info ] [MainThread]: 
[0m07:27:26.568013 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m07:27:26.569405 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.development.bronze_customers'
[0m07:27:26.569969 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m07:27:26.576826 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m07:27:26.578352 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 07:27:26.570295 => 07:27:26.577755
[0m07:27:26.579073 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m07:27:26.579890 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 07:27:26.579542 => 07:27:26.579579
[0m07:27:26.581446 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m07:27:26.582170 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m07:27:26.583226 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m07:27:26.584195 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m07:27:26.588911 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m07:27:26.589973 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 07:27:26.584618 => 07:27:26.589661
[0m07:27:26.590504 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m07:27:26.591397 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 07:27:26.590977 => 07:27:26.590990
[0m07:27:26.592849 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m07:27:26.593578 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m07:27:26.594622 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m07:27:26.595515 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m07:27:26.599456 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m07:27:26.600364 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 07:27:26.595928 => 07:27:26.600051
[0m07:27:26.600985 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m07:27:26.601751 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 07:27:26.601377 => 07:27:26.601387
[0m07:27:26.602993 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m07:27:26.603774 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m07:27:26.604861 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m07:27:26.605438 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m07:27:26.609510 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m07:27:26.610776 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 07:27:26.605837 => 07:27:26.610436
[0m07:27:26.611392 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m07:27:26.612079 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 07:27:26.611782 => 07:27:26.611792
[0m07:27:26.613509 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m07:27:26.614150 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m07:27:26.615140 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m07:27:26.615741 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m07:27:26.622342 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m07:27:26.623316 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 07:27:26.616126 => 07:27:26.622970
[0m07:27:26.623977 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m07:27:26.624784 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 07:27:26.624416 => 07:27:26.624429
[0m07:27:26.625996 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m07:27:26.626711 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m07:27:26.627674 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m07:27:26.628306 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m07:27:26.632499 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m07:27:26.633483 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 07:27:26.628755 => 07:27:26.633176
[0m07:27:26.634028 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m07:27:26.634748 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 07:27:26.634427 => 07:27:26.634438
[0m07:27:26.636317 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m07:27:26.637520 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m07:27:26.638348 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m07:27:26.638932 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m07:27:26.643178 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m07:27:26.644225 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 07:27:26.639584 => 07:27:26.643826
[0m07:27:26.644857 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m07:27:26.645605 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 07:27:26.645295 => 07:27:26.645305
[0m07:27:26.646747 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m07:27:26.648071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:27:26.648467 [debug] [MainThread]: Connection 'list_external_db_final_sales' was properly closed.
[0m07:27:26.648959 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m07:27:26.651516 [debug] [MainThread]: Command end result
[0m07:27:26.664010 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m07:27:26.664470 [info ] [MainThread]: Building catalog
[0m07:27:26.668139 [debug] [ThreadPool]: Acquiring new snowflake connection 'external_db.information_schema'
[0m07:27:26.678961 [debug] [ThreadPool]: Using snowflake connection "external_db.information_schema"
[0m07:27:26.679734 [debug] [ThreadPool]: On external_db.information_schema: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "external_db.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from external_db.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from external_db.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('final_sales') or upper("table_schema") = upper('stage'))
      order by "column_index"
[0m07:27:26.680452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:27:28.779224 [debug] [ThreadPool]: SQL status: SUCCESS 36 in 2.0 seconds
[0m07:27:28.796208 [debug] [ThreadPool]: On external_db.information_schema: Close
[0m07:27:28.911093 [info ] [MainThread]: Catalog written to /home/satyam/airflow/target/catalog.json
[0m07:27:28.913063 [debug] [MainThread]: Command `dbt docs generate` succeeded at 07:27:28.912876 after 4.89 seconds
[0m07:27:28.913573 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m07:27:28.913949 [debug] [MainThread]: Connection 'external_db.information_schema' was properly closed.
[0m07:27:28.914416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7085bcc4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707fdcfaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707fda5d00>]}
[0m07:27:28.914916 [debug] [MainThread]: Flushing usage events
[0m07:28:59.619639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d370e14c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d359a4610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d359a4250>]}


============================== 07:28:59.623839 | eaf1fcec-837e-4d80-8d1c-d7e5707a3c0d ==============================
[0m07:28:59.623839 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:28:59.624717 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'dags/dbt', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:28:59.967219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eaf1fcec-837e-4d80-8d1c-d7e5707a3c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d301ec040>]}
[0m07:28:59.991883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eaf1fcec-837e-4d80-8d1c-d7e5707a3c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d301f4040>]}
[0m11:06:35.700367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f7f7a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f6858070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f68582e0>]}


============================== 11:06:35.704480 | 478e948b-3961-4a5e-ad5e-f3a16f3a543b ==============================
[0m11:06:35.704480 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:06:35.705251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:06:36.073390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '478e948b-3961-4a5e-ad5e-f3a16f3a543b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f21310a0>]}
[0m11:06:36.097949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '478e948b-3961-4a5e-ad5e-f3a16f3a543b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f21760d0>]}
[0m11:06:36.117271 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:06:36.118105 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:06:36.118690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '478e948b-3961-4a5e-ad5e-f3a16f3a543b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f2120c70>]}
[0m11:06:37.094386 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_order_detail.sql
[0m11:06:37.122436 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_order_detail.sql
[0m11:06:37.125481 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_payment_details.sql
[0m11:06:37.133993 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_payment_details.sql
[0m11:06:37.138594 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m11:06:37.145855 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m11:06:37.149126 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m11:06:37.155845 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m11:06:37.158765 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m11:06:37.164948 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m11:06:37.168823 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m11:06:37.175397 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m11:06:37.178226 [debug] [MainThread]: 1603: static parser failed on sales/core/product_sales.sql
[0m11:06:37.186703 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/core/product_sales.sql
[0m11:06:37.309786 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.staging
- models.development.intermediate
[0m11:06:37.371505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '478e948b-3961-4a5e-ad5e-f3a16f3a543b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f67bc820>]}
[0m11:06:37.381266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '478e948b-3961-4a5e-ad5e-f3a16f3a543b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f2152af0>]}
[0m11:06:37.381910 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:06:37.382476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '478e948b-3961-4a5e-ad5e-f3a16f3a543b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f21521f0>]}
[0m11:06:37.384451 [info ] [MainThread]: 
[0m11:06:37.385430 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:06:37.387334 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m11:06:37.406335 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m11:06:37.406824 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m11:06:37.407297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:06:38.203504 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m11:06:38.207289 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m11:06:38.313598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '478e948b-3961-4a5e-ad5e-f3a16f3a543b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f2152520>]}
[0m11:06:38.314948 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:06:38.315937 [info ] [MainThread]: 
[0m11:06:38.321307 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m11:06:38.322156 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m11:06:38.322678 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m11:06:38.332446 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 11:06:38.323091 => 11:06:38.331719
[0m11:06:38.352975 [debug] [Thread-1  ]: Compilation Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)
  Required var 'run_date' not found in config:
  Vars supplied to bronze_customers = {
      "business_time": "2016-06-01"
  }
[0m11:06:38.353893 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m11:06:38.354597 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m11:06:38.355546 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m11:06:38.356077 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m11:06:38.361429 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 11:06:38.356435 => 11:06:38.361103
[0m11:06:38.362770 [debug] [Thread-1  ]: Compilation Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)
  Required var 'run_date' not found in config:
  Vars supplied to bronze_orders = {
      "business_time": "2016-06-01"
  }
[0m11:06:38.363445 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m11:06:38.364335 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m11:06:38.365386 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m11:06:38.365983 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m11:06:38.370510 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 11:06:38.366434 => 11:06:38.370076
[0m11:06:38.371695 [debug] [Thread-1  ]: Compilation Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)
  Required var 'run_date' not found in config:
  Vars supplied to bronze_payments = {
      "business_time": "2016-06-01"
  }
[0m11:06:38.372392 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m11:06:38.373120 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m11:06:38.373959 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m11:06:38.374531 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m11:06:38.379204 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 11:06:38.374946 => 11:06:38.378870
[0m11:06:38.380631 [debug] [Thread-1  ]: Compilation Error in model bronze_products (models/sales/bronze/bronze_products.sql)
  Required var 'run_date' not found in config:
  Vars supplied to bronze_products = {
      "business_time": "2016-06-01"
  }
[0m11:06:38.381502 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m11:06:38.382475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:06:38.382896 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m11:06:38.383497 [error] [MainThread]: Encountered an error:
Runtime Error
  Compilation Error in model bronze_products (models/sales/bronze/bronze_products.sql)
    Required var 'run_date' not found in config:
    Vars supplied to bronze_products = {
        "business_time": "2016-06-01"
    }
[0m11:06:38.384568 [debug] [MainThread]: Command `dbt compile` failed at 11:06:38.384368 after 2.71 seconds
[0m11:06:38.385359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8f7f7a4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e2561760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8e2561430>]}
[0m11:06:38.385904 [debug] [MainThread]: Flushing usage events
[0m11:07:25.107042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd59cd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd42b1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd42b1190>]}


============================== 11:07:25.110956 | 5b495495-fb31-484e-90f7-0449d78caa62 ==============================
[0m11:07:25.110956 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:07:25.111849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'dags/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:07:25.436314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b495495-fb31-484e-90f7-0449d78caa62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccfb8a100>]}
[0m11:07:25.458032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b495495-fb31-484e-90f7-0449d78caa62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccfbc80d0>]}
[0m11:07:25.474086 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:07:25.483582 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:07:25.484155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5b495495-fb31-484e-90f7-0449d78caa62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccfb7dd90>]}
[0m11:07:26.398041 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_order_detail.sql
[0m11:07:26.427282 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_order_detail.sql
[0m11:07:26.429836 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_payment_details.sql
[0m11:07:26.436741 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_payment_details.sql
[0m11:07:26.439947 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m11:07:26.446069 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m11:07:26.448464 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m11:07:26.455834 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m11:07:26.458187 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m11:07:26.463977 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m11:07:26.467092 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m11:07:26.472812 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m11:07:26.475384 [debug] [MainThread]: 1603: static parser failed on sales/core/product_sales.sql
[0m11:07:26.483455 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/core/product_sales.sql
[0m11:07:26.645988 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.staging
- models.development.intermediate
[0m11:07:26.653544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b495495-fb31-484e-90f7-0449d78caa62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cce55f250>]}
[0m11:07:26.661722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b495495-fb31-484e-90f7-0449d78caa62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccfba3cd0>]}
[0m11:07:26.662462 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:07:26.663029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b495495-fb31-484e-90f7-0449d78caa62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd4b74220>]}
[0m11:07:26.665214 [info ] [MainThread]: 
[0m11:07:26.666235 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:07:26.668761 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m11:07:26.688425 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m11:07:26.689033 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m11:07:26.689501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:07:27.431244 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m11:07:27.435275 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m11:07:27.532641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b495495-fb31-484e-90f7-0449d78caa62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cce55f2e0>]}
[0m11:07:27.533847 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:07:27.534451 [info ] [MainThread]: 
[0m11:07:27.539848 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m11:07:27.540805 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m11:07:27.541442 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m11:07:27.547805 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m11:07:27.548938 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 11:07:27.541852 => 11:07:27.548453
[0m11:07:27.549555 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m11:07:27.550323 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 11:07:27.549977 => 11:07:27.550012
[0m11:07:27.551542 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m11:07:27.552137 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m11:07:27.552919 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m11:07:27.553431 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m11:07:27.557933 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m11:07:27.559532 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 11:07:27.553763 => 11:07:27.559204
[0m11:07:27.560022 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m11:07:27.560735 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 11:07:27.560341 => 11:07:27.560357
[0m11:07:27.561951 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m11:07:27.562509 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m11:07:27.563260 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m11:07:27.563916 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m11:07:27.568320 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m11:07:27.569389 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 11:07:27.564241 => 11:07:27.569071
[0m11:07:27.569897 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m11:07:27.570516 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 11:07:27.570224 => 11:07:27.570236
[0m11:07:27.571592 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m11:07:27.572263 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m11:07:27.573272 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m11:07:27.573876 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m11:07:27.578198 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m11:07:27.579001 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 11:07:27.574222 => 11:07:27.578699
[0m11:07:27.579529 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m11:07:27.580139 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 11:07:27.579862 => 11:07:27.579874
[0m11:07:27.581259 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m11:07:27.581811 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m11:07:27.582552 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m11:07:27.583090 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m11:07:27.588182 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m11:07:27.589346 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 11:07:27.583468 => 11:07:27.589044
[0m11:07:27.589890 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m11:07:27.590905 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 11:07:27.590617 => 11:07:27.590629
[0m11:07:27.592180 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m11:07:27.592854 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m11:07:27.593659 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m11:07:27.594242 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m11:07:27.600340 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m11:07:27.601292 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 11:07:27.594630 => 11:07:27.600964
[0m11:07:27.601846 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m11:07:27.602513 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 11:07:27.602213 => 11:07:27.602225
[0m11:07:27.603726 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m11:07:27.604857 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m11:07:27.605615 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m11:07:27.606521 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m11:07:27.615212 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m11:07:27.616088 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 11:07:27.606885 => 11:07:27.615791
[0m11:07:27.616652 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m11:07:27.617418 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 11:07:27.617081 => 11:07:27.617094
[0m11:07:27.618610 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m11:07:27.619758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:07:27.620149 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m11:07:27.622415 [debug] [MainThread]: Command end result
[0m11:07:27.633880 [debug] [MainThread]: Command `dbt compile` succeeded at 11:07:27.633666 after 2.55 seconds
[0m11:07:27.634544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd59cd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd2de9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cd2dc09d0>]}
[0m11:07:27.635070 [debug] [MainThread]: Flushing usage events
[0m11:41:28.805294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59bb4d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59a44e7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59a44e610>]}


============================== 11:41:28.808881 | 37bd1bcf-6833-4775-a75e-e48535abcd45 ==============================
[0m11:41:28.808881 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:41:28.809816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:41:29.149185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37bd1bcf-6833-4775-a75e-e48535abcd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd595d14c70>]}
[0m11:41:29.172312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37bd1bcf-6833-4775-a75e-e48535abcd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd595d3e6d0>]}
[0m11:41:29.190323 [debug] [MainThread]: checksum: 332f65646e66ee97141cf62e50d5e186961811ebbf70f0de4e68a26bd713aeec, vars: {'run_date': datetime.datetime(2023, 6, 22, 0, 0, tzinfo=datetime.timezone.utc)}, profile: , target: , version: 1.5.1
[0m11:41:29.200453 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:41:29.201062 [debug] [MainThread]: previous checksum: 332f65646e66ee97141cf62e50d5e186961811ebbf70f0de4e68a26bd713aeec, current checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c
[0m11:41:29.201501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '37bd1bcf-6833-4775-a75e-e48535abcd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd594baff70>]}
[0m11:41:30.155181 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_order_detail.sql
[0m11:41:30.183365 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_order_detail.sql
[0m11:41:30.186614 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_payment_details.sql
[0m11:41:30.194567 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_payment_details.sql
[0m11:41:30.198433 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m11:41:30.206140 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m11:41:30.209556 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m11:41:30.217844 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m11:41:30.220858 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m11:41:30.227805 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m11:41:30.231109 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m11:41:30.238520 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m11:41:30.241474 [debug] [MainThread]: 1603: static parser failed on sales/core/product_sales.sql
[0m11:41:30.250745 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/core/product_sales.sql
[0m11:41:30.422574 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.staging
- models.development.intermediate
[0m11:41:30.430270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37bd1bcf-6833-4775-a75e-e48535abcd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5946f49a0>]}
[0m11:41:30.440361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37bd1bcf-6833-4775-a75e-e48535abcd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd595d20340>]}
[0m11:41:30.440968 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:41:30.441519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37bd1bcf-6833-4775-a75e-e48535abcd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd598f5ceb0>]}
[0m11:41:30.443093 [info ] [MainThread]: 
[0m11:41:30.444229 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:41:30.446256 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m11:41:30.464981 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m11:41:30.465552 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m11:41:30.465967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:31.153899 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m11:41:31.157655 [debug] [ThreadPool]: On list_external_db: Close
[0m11:41:31.242305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now create_external_db_final_sales)
[0m11:41:31.243518 [debug] [ThreadPool]: Creating schema "database: "external_db"
schema: "final_sales"
"
[0m11:41:31.251594 [debug] [ThreadPool]: Using snowflake connection "create_external_db_final_sales"
[0m11:41:31.252158 [debug] [ThreadPool]: On create_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "create_external_db_final_sales"} */
create schema if not exists external_db.final_sales
[0m11:41:31.252712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:31.625247 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:41:31.626962 [debug] [ThreadPool]: On create_external_db_final_sales: Close
[0m11:41:31.749707 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_external_db_final_sales, now list_external_db_final_sales)
[0m11:41:31.759061 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m11:41:31.759527 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m11:41:31.759951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:32.223299 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m11:41:32.225554 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m11:41:32.336666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37bd1bcf-6833-4775-a75e-e48535abcd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd595c12100>]}
[0m11:41:32.338177 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:32.338837 [info ] [MainThread]: 
[0m11:41:32.343863 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m11:41:32.344634 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m11:41:32.345474 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_orders)
[0m11:41:32.346311 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m11:41:32.351572 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m11:41:32.353163 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 11:41:32.346676 => 11:41:32.352721
[0m11:41:32.353961 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m11:41:32.431912 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m11:41:32.433498 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m11:41:32.434010 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace transient table external_db.final_sales.bronze_orders
         as
        (

with orders as (
     select *, 
     2023-06-22 00:00:00+00:00 as run_date from external_db.stage.orders
)

select * from orders
        );
[0m11:41:32.434503 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:41:32.828750 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad22fd-0000-fb87-0000-0001937ec1d9
[0m11:41:32.829495 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 16 unexpected '00'.
syntax error line 7 at position 28 unexpected '00'.
[0m11:41:32.830318 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 11:41:32.354408 => 11:41:32.829973
[0m11:41:32.830908 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m11:41:32.961656 [debug] [Thread-1  ]: Database Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 16 unexpected '00'.
  syntax error line 7 at position 28 unexpected '00'.
  compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m11:41:32.962703 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37bd1bcf-6833-4775-a75e-e48535abcd45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd595d20640>]}
[0m11:41:32.963683 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model final_sales.bronze_orders .......... [[31mERROR[0m in 0.62s]
[0m11:41:32.964695 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m11:41:32.967089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:32.967585 [debug] [MainThread]: Connection 'model.development.bronze_orders' was properly closed.
[0m11:41:32.968111 [info ] [MainThread]: 
[0m11:41:32.968857 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m11:41:32.969717 [debug] [MainThread]: Command end result
[0m11:41:32.981279 [info ] [MainThread]: 
[0m11:41:32.981927 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:41:32.982434 [info ] [MainThread]: 
[0m11:41:32.983258 [error] [MainThread]: [33mDatabase Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)[0m
[0m11:41:32.983864 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:41:32.984428 [error] [MainThread]:   syntax error line 7 at position 16 unexpected '00'.
[0m11:41:32.984986 [error] [MainThread]:   syntax error line 7 at position 28 unexpected '00'.
[0m11:41:32.985482 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m11:41:32.985990 [info ] [MainThread]: 
[0m11:41:32.986536 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:41:32.987541 [debug] [MainThread]: Command `dbt run` failed at 11:41:32.987361 after 4.20 seconds
[0m11:41:32.988101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59bb4d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd59acfc370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5941a92e0>]}
[0m11:41:32.988690 [debug] [MainThread]: Flushing usage events
[0m11:41:40.210325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba7803670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba612a880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba612a160>]}


============================== 11:41:40.214672 | 6fbbbffe-d78e-4248-a622-bacfade82103 ==============================
[0m11:41:40.214672 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:41:40.215515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:41:40.553089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fbbbffe-d78e-4248-a622-bacfade82103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba09d5d60>]}
[0m11:41:40.576309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fbbbffe-d78e-4248-a622-bacfade82103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba09f5130>]}
[0m11:41:40.594585 [debug] [MainThread]: checksum: 332f65646e66ee97141cf62e50d5e186961811ebbf70f0de4e68a26bd713aeec, vars: {'run_date': datetime.datetime(2023, 6, 22, 0, 0, tzinfo=datetime.timezone.utc)}, profile: , target: , version: 1.5.1
[0m11:41:40.626590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:41:40.627192 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:41:40.628172 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.bronze
- models.development.staging
[0m11:41:40.637672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fbbbffe-d78e-4248-a622-bacfade82103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba080f850>]}
[0m11:41:40.647546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fbbbffe-d78e-4248-a622-bacfade82103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba08f7730>]}
[0m11:41:40.648136 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:41:40.648719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fbbbffe-d78e-4248-a622-bacfade82103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba08f7850>]}
[0m11:41:40.650475 [info ] [MainThread]: 
[0m11:41:40.651638 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:41:40.653723 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m11:41:40.673128 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m11:41:40.673679 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m11:41:40.674183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:41.126256 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:41:41.129504 [debug] [ThreadPool]: On list_external_db: Close
[0m11:41:41.247389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m11:41:41.259549 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m11:41:41.260008 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m11:41:41.260407 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:41.742956 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m11:41:41.746060 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m11:41:41.856552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fbbbffe-d78e-4248-a622-bacfade82103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba08f74f0>]}
[0m11:41:41.858074 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:41.858642 [info ] [MainThread]: 
[0m11:41:41.863911 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m11:41:41.864675 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m11:41:41.865708 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_payments)
[0m11:41:41.866410 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m11:41:41.871427 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m11:41:41.872796 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 11:41:41.866836 => 11:41:41.872388
[0m11:41:41.873475 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m11:41:41.948125 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m11:41:41.949427 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m11:41:41.950012 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace transient table external_db.final_sales.bronze_payments
         as
        (

with payments as (
     select *, 
     2023-06-22 00:00:00+00:00 as run_date from external_db.stage.payments
)

select * from payments
        );
[0m11:41:41.950663 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:41:42.421652 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad22fd-0000-fb4f-0000-0001937eb1e1
[0m11:41:42.422376 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 16 unexpected '00'.
syntax error line 7 at position 28 unexpected '00'.
[0m11:41:42.423164 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 11:41:41.873817 => 11:41:42.422852
[0m11:41:42.423689 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m11:41:42.536824 [debug] [Thread-1  ]: Database Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 16 unexpected '00'.
  syntax error line 7 at position 28 unexpected '00'.
  compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m11:41:42.537750 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fbbbffe-d78e-4248-a622-bacfade82103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba0420fd0>]}
[0m11:41:42.539361 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model final_sales.bronze_payments ........ [[31mERROR[0m in 0.67s]
[0m11:41:42.540147 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m11:41:42.542892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:42.543374 [debug] [MainThread]: Connection 'model.development.bronze_payments' was properly closed.
[0m11:41:42.543799 [info ] [MainThread]: 
[0m11:41:42.544338 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.89 seconds (1.89s).
[0m11:41:42.545283 [debug] [MainThread]: Command end result
[0m11:41:42.555226 [info ] [MainThread]: 
[0m11:41:42.556072 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:41:42.556884 [info ] [MainThread]: 
[0m11:41:42.557775 [error] [MainThread]: [33mDatabase Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)[0m
[0m11:41:42.558636 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:41:42.559383 [error] [MainThread]:   syntax error line 7 at position 16 unexpected '00'.
[0m11:41:42.560037 [error] [MainThread]:   syntax error line 7 at position 28 unexpected '00'.
[0m11:41:42.560872 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m11:41:42.571504 [info ] [MainThread]: 
[0m11:41:42.573046 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:41:42.574129 [debug] [MainThread]: Command `dbt run` failed at 11:41:42.573950 after 2.39 seconds
[0m11:41:42.574750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba7803670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba09f5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffba02e8ca0>]}
[0m11:41:42.575369 [debug] [MainThread]: Flushing usage events
[0m11:41:49.547015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aeb1fa580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae9b23790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae9b230d0>]}


============================== 11:41:49.550562 | 6e125dff-c63e-41d2-8615-301c041be446 ==============================
[0m11:41:49.550562 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:41:49.551251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:41:49.871895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e125dff-c63e-41d2-8615-301c041be446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae43c8c70>]}
[0m11:41:49.893918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e125dff-c63e-41d2-8615-301c041be446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae4381b80>]}
[0m11:41:49.911581 [debug] [MainThread]: checksum: 332f65646e66ee97141cf62e50d5e186961811ebbf70f0de4e68a26bd713aeec, vars: {'run_date': datetime.datetime(2023, 6, 22, 0, 0, tzinfo=datetime.timezone.utc)}, profile: , target: , version: 1.5.1
[0m11:41:49.939607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:41:49.940052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:41:49.940996 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.staging
- models.development.intermediate
[0m11:41:49.950224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e125dff-c63e-41d2-8615-301c041be446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae420e760>]}
[0m11:41:49.960094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e125dff-c63e-41d2-8615-301c041be446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae42f75e0>]}
[0m11:41:49.960799 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:41:49.961344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e125dff-c63e-41d2-8615-301c041be446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae42f76d0>]}
[0m11:41:49.962877 [info ] [MainThread]: 
[0m11:41:49.964081 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:41:49.966519 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m11:41:49.986539 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m11:41:49.987132 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m11:41:49.987633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:50.454912 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m11:41:50.458099 [debug] [ThreadPool]: On list_external_db: Close
[0m11:41:50.560005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m11:41:50.569707 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m11:41:50.570311 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m11:41:50.570749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:50.907240 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m11:41:50.909544 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m11:41:51.033079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e125dff-c63e-41d2-8615-301c041be446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae43a86a0>]}
[0m11:41:51.034409 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:51.035092 [info ] [MainThread]: 
[0m11:41:51.040108 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m11:41:51.040965 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m11:41:51.041971 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_products)
[0m11:41:51.042491 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m11:41:51.048050 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m11:41:51.049251 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 11:41:51.042897 => 11:41:51.048852
[0m11:41:51.049845 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m11:41:51.133165 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m11:41:51.134610 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m11:41:51.135202 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace transient table external_db.final_sales.bronze_products
         as
        (

with products as (
     select *, 
     2023-06-22 00:00:00+00:00 as run_date from external_db.stage.products
)

select * from products
        );
[0m11:41:51.135706 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:41:51.484971 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad22fd-0000-fb87-0000-0001937ec1e9
[0m11:41:51.485755 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 16 unexpected '00'.
syntax error line 7 at position 28 unexpected '00'.
[0m11:41:51.486721 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 11:41:51.050344 => 11:41:51.486426
[0m11:41:51.487376 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m11:41:51.616091 [debug] [Thread-1  ]: Database Error in model bronze_products (models/sales/bronze/bronze_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 16 unexpected '00'.
  syntax error line 7 at position 28 unexpected '00'.
  compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m11:41:51.616987 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e125dff-c63e-41d2-8615-301c041be446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7adf6330d0>]}
[0m11:41:51.617858 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model final_sales.bronze_products ........ [[31mERROR[0m in 0.58s]
[0m11:41:51.618710 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m11:41:51.620566 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:51.620989 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m11:41:51.621376 [info ] [MainThread]: 
[0m11:41:51.621905 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.66 seconds (1.66s).
[0m11:41:51.622620 [debug] [MainThread]: Command end result
[0m11:41:51.632981 [info ] [MainThread]: 
[0m11:41:51.633764 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:41:51.634316 [info ] [MainThread]: 
[0m11:41:51.634845 [error] [MainThread]: [33mDatabase Error in model bronze_products (models/sales/bronze/bronze_products.sql)[0m
[0m11:41:51.635446 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:41:51.636006 [error] [MainThread]:   syntax error line 7 at position 16 unexpected '00'.
[0m11:41:51.636651 [error] [MainThread]:   syntax error line 7 at position 28 unexpected '00'.
[0m11:41:51.637215 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m11:41:51.637722 [info ] [MainThread]: 
[0m11:41:51.638548 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:41:51.639476 [debug] [MainThread]: Command `dbt run` failed at 11:41:51.639316 after 2.11 seconds
[0m11:41:51.640076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aeb1fa580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae4381b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae43a82e0>]}
[0m11:41:51.640626 [debug] [MainThread]: Flushing usage events
[0m11:41:58.918571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f073ee0a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f073d732760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f073d7320d0>]}


============================== 11:41:58.921840 | c1a8f8f1-306a-4629-8cd1-398eaaef65a7 ==============================
[0m11:41:58.921840 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:41:58.922540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:41:59.250480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1a8f8f1-306a-4629-8cd1-398eaaef65a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0737ff6190>]}
[0m11:41:59.273896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1a8f8f1-306a-4629-8cd1-398eaaef65a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0737feb040>]}
[0m11:41:59.291724 [debug] [MainThread]: checksum: 332f65646e66ee97141cf62e50d5e186961811ebbf70f0de4e68a26bd713aeec, vars: {'run_date': datetime.datetime(2023, 6, 22, 0, 0, tzinfo=datetime.timezone.utc)}, profile: , target: , version: 1.5.1
[0m11:41:59.327475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:41:59.328134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:41:59.329073 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m11:41:59.337836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1a8f8f1-306a-4629-8cd1-398eaaef65a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0737e10730>]}
[0m11:41:59.347967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1a8f8f1-306a-4629-8cd1-398eaaef65a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0737ef65e0>]}
[0m11:41:59.348701 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:41:59.349326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1a8f8f1-306a-4629-8cd1-398eaaef65a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0737ef6730>]}
[0m11:41:59.351109 [info ] [MainThread]: 
[0m11:41:59.352389 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:41:59.354051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m11:41:59.374887 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m11:41:59.375529 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m11:41:59.376037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:00.269217 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:42:00.273204 [debug] [ThreadPool]: On list_external_db: Close
[0m11:42:00.383053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m11:42:00.393347 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m11:42:00.393990 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m11:42:00.394603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:00.913262 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m11:42:00.915822 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m11:42:01.049035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1a8f8f1-306a-4629-8cd1-398eaaef65a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0737e70b50>]}
[0m11:42:01.050583 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:42:01.051122 [info ] [MainThread]: 
[0m11:42:01.056261 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m11:42:01.056977 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m11:42:01.057924 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m11:42:01.058396 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m11:42:01.063632 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m11:42:01.064964 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 11:42:01.058732 => 11:42:01.064405
[0m11:42:01.065642 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m11:42:01.144719 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m11:42:01.146654 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m11:42:01.147353 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace transient table external_db.final_sales.bronze_customers
         as
        (

with customers as (
     select *, 
     2023-06-22 00:00:00+00:00 as run_date  from external_db.stage.customers
)

select * from customers
        );
[0m11:42:01.148016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:42:01.411532 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad22fe-0000-fb87-0000-0001937ec1ed
[0m11:42:01.412329 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 16 unexpected '00'.
syntax error line 7 at position 28 unexpected '00'.
[0m11:42:01.413239 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 11:42:01.066087 => 11:42:01.412877
[0m11:42:01.413962 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m11:42:01.506763 [debug] [Thread-1  ]: Database Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 16 unexpected '00'.
  syntax error line 7 at position 28 unexpected '00'.
  compiled Code at target/run/development/models/sales/bronze/bronze_customers.sql
[0m11:42:01.507502 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1a8f8f1-306a-4629-8cd1-398eaaef65a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0737220d00>]}
[0m11:42:01.508383 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model final_sales.bronze_customers ....... [[31mERROR[0m in 0.45s]
[0m11:42:01.509174 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m11:42:01.511452 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:01.511951 [debug] [MainThread]: Connection 'model.development.bronze_customers' was properly closed.
[0m11:42:01.512542 [info ] [MainThread]: 
[0m11:42:01.513192 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m11:42:01.513960 [debug] [MainThread]: Command end result
[0m11:42:01.522587 [info ] [MainThread]: 
[0m11:42:01.523169 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:42:01.523802 [info ] [MainThread]: 
[0m11:42:01.524419 [error] [MainThread]: [33mDatabase Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)[0m
[0m11:42:01.525001 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:42:01.525432 [error] [MainThread]:   syntax error line 7 at position 16 unexpected '00'.
[0m11:42:01.525849 [error] [MainThread]:   syntax error line 7 at position 28 unexpected '00'.
[0m11:42:01.526349 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_customers.sql
[0m11:42:01.526843 [info ] [MainThread]: 
[0m11:42:01.527357 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:42:01.528224 [debug] [MainThread]: Command `dbt run` failed at 11:42:01.528079 after 2.63 seconds
[0m11:42:01.528746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f073ee0a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0737e10f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0737220d00>]}
[0m11:42:01.529269 [debug] [MainThread]: Flushing usage events
[0m11:48:10.456236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c603e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c4940790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c4940550>]}


============================== 11:48:10.460354 | 9e37214a-7b87-4903-ab35-460f121dab0f ==============================
[0m11:48:10.460354 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:48:10.461200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:48:10.812946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e37214a-7b87-4903-ab35-460f121dab0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32bf1f4e20>]}
[0m11:48:10.834471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e37214a-7b87-4903-ab35-460f121dab0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32bf1f4190>]}
[0m11:48:10.853242 [debug] [MainThread]: checksum: 332f65646e66ee97141cf62e50d5e186961811ebbf70f0de4e68a26bd713aeec, vars: {'run_date': datetime.datetime(2023, 6, 22, 0, 0, tzinfo=datetime.timezone.utc)}, profile: , target: , version: 1.5.1
[0m11:48:10.880775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 7 files changed.
[0m11:48:10.881497 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/intermediate/fct_order_detail.sql
[0m11:48:10.882098 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_products.sql
[0m11:48:10.882814 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_orders.sql
[0m11:48:10.883649 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/intermediate/fct_payment_details.sql
[0m11:48:10.884412 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/core/product_sales.sql
[0m11:48:10.885185 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_customers.sql
[0m11:48:10.885892 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_payments.sql
[0m11:48:10.919054 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_order_detail.sql
[0m11:48:10.945264 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_order_detail.sql
[0m11:48:10.949724 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m11:48:10.957220 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m11:48:10.960399 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m11:48:10.967311 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m11:48:10.971293 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_payment_details.sql
[0m11:48:10.979322 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_payment_details.sql
[0m11:48:10.982355 [debug] [MainThread]: 1603: static parser failed on sales/core/product_sales.sql
[0m11:48:10.993628 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/core/product_sales.sql
[0m11:48:10.996921 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m11:48:11.004124 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m11:48:11.007258 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m11:48:11.014555 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m11:48:11.062960 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.intermediate
[0m11:48:11.072084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e37214a-7b87-4903-ab35-460f121dab0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32bf03d880>]}
[0m11:48:11.082147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e37214a-7b87-4903-ab35-460f121dab0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32bf0f3610>]}
[0m11:48:11.082898 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:48:11.083997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e37214a-7b87-4903-ab35-460f121dab0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32bf0f3760>]}
[0m11:48:11.085762 [info ] [MainThread]: 
[0m11:48:11.087140 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:48:11.088629 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m11:48:11.108964 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m11:48:11.109691 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m11:48:11.110162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:11.871454 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:48:11.874762 [debug] [ThreadPool]: On list_external_db: Close
[0m11:48:11.991024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m11:48:12.002121 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m11:48:12.002783 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m11:48:12.003372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:12.414004 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m11:48:12.416457 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m11:48:12.560197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e37214a-7b87-4903-ab35-460f121dab0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32bf070c40>]}
[0m11:48:12.561672 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:48:12.562313 [info ] [MainThread]: 
[0m11:48:12.567396 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m11:48:12.568302 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m11:48:12.569623 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_orders)
[0m11:48:12.570222 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m11:48:12.575010 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m11:48:12.575921 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 11:48:12.570587 => 11:48:12.575600
[0m11:48:12.576398 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m11:48:12.655233 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m11:48:12.656999 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m11:48:12.657601 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace transient table external_db.final_sales.bronze_orders
         as
        (

with orders as (
     select *, 
     2023-06-22 00:00:00+00:00 as run_date from external_db.stage.orders
)

select * from orders
        );
[0m11:48:12.658226 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:48:13.013148 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2304-0000-fb4f-0000-0001937eb1f1
[0m11:48:13.013856 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 16 unexpected '00'.
syntax error line 7 at position 28 unexpected '00'.
[0m11:48:13.014714 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 11:48:12.576770 => 11:48:13.014371
[0m11:48:13.015272 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m11:48:13.142383 [debug] [Thread-1  ]: Database Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 16 unexpected '00'.
  syntax error line 7 at position 28 unexpected '00'.
  compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m11:48:13.143370 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e37214a-7b87-4903-ab35-460f121dab0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32befdb9d0>]}
[0m11:48:13.144306 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model final_sales.bronze_orders .......... [[31mERROR[0m in 0.57s]
[0m11:48:13.145511 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m11:48:13.147822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:13.148281 [debug] [MainThread]: Connection 'model.development.bronze_orders' was properly closed.
[0m11:48:13.148859 [info ] [MainThread]: 
[0m11:48:13.149847 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m11:48:13.151013 [debug] [MainThread]: Command end result
[0m11:48:13.234566 [info ] [MainThread]: 
[0m11:48:13.235379 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:48:13.235873 [info ] [MainThread]: 
[0m11:48:13.236399 [error] [MainThread]: [33mDatabase Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)[0m
[0m11:48:13.237000 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:48:13.237504 [error] [MainThread]:   syntax error line 7 at position 16 unexpected '00'.
[0m11:48:13.237977 [error] [MainThread]:   syntax error line 7 at position 28 unexpected '00'.
[0m11:48:13.238428 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m11:48:13.238905 [info ] [MainThread]: 
[0m11:48:13.239488 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:48:13.240455 [debug] [MainThread]: Command `dbt run` failed at 11:48:13.240278 after 2.80 seconds
[0m11:48:13.241204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32c603e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32bf070be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32befed070>]}
[0m11:48:13.241837 [debug] [MainThread]: Flushing usage events
[0m11:48:20.536256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04feec5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04e812730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04e812340>]}


============================== 11:48:20.540302 | 50edccbf-bdb7-4d3f-a75b-b35642ccb5d2 ==============================
[0m11:48:20.540302 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:48:20.541297 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:48:20.881760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50edccbf-bdb7-4d3f-a75b-b35642ccb5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04a0e4d00>]}
[0m11:48:20.906010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50edccbf-bdb7-4d3f-a75b-b35642ccb5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04a105880>]}
[0m11:48:20.926152 [debug] [MainThread]: checksum: 332f65646e66ee97141cf62e50d5e186961811ebbf70f0de4e68a26bd713aeec, vars: {'run_date': datetime.datetime(2023, 6, 22, 0, 0, tzinfo=datetime.timezone.utc)}, profile: , target: , version: 1.5.1
[0m11:48:20.956851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:48:20.957350 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:48:20.958313 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.intermediate
[0m11:48:20.968656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50edccbf-bdb7-4d3f-a75b-b35642ccb5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb048f117f0>]}
[0m11:48:20.978314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50edccbf-bdb7-4d3f-a75b-b35642ccb5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb048fea670>]}
[0m11:48:20.978908 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:48:20.979722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50edccbf-bdb7-4d3f-a75b-b35642ccb5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb048fea760>]}
[0m11:48:20.981240 [info ] [MainThread]: 
[0m11:48:20.982245 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:48:20.983971 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m11:48:21.004292 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m11:48:21.004924 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m11:48:21.005472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:21.537747 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:48:21.541121 [debug] [ThreadPool]: On list_external_db: Close
[0m11:48:21.656803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m11:48:21.667576 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m11:48:21.668226 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m11:48:21.668838 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:22.140638 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m11:48:22.142814 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m11:48:22.237731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50edccbf-bdb7-4d3f-a75b-b35642ccb5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb048fea4f0>]}
[0m11:48:22.239383 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:48:22.240106 [info ] [MainThread]: 
[0m11:48:22.246120 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m11:48:22.246939 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m11:48:22.247914 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_payments)
[0m11:48:22.248452 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m11:48:22.254476 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m11:48:22.255538 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 11:48:22.248886 => 11:48:22.255171
[0m11:48:22.256115 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m11:48:22.340421 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m11:48:22.341910 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m11:48:22.342470 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace transient table external_db.final_sales.bronze_payments
         as
        (

with payments as (
     select *, 
     2023-06-22 00:00:00+00:00 as run_date from external_db.stage.payments
)

select * from payments
        );
[0m11:48:22.342980 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:48:22.770884 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2304-0000-fb87-0000-0001937ec1f9
[0m11:48:22.771583 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 16 unexpected '00'.
syntax error line 7 at position 28 unexpected '00'.
[0m11:48:22.772447 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 11:48:22.256471 => 11:48:22.772113
[0m11:48:22.773020 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m11:48:22.878357 [debug] [Thread-1  ]: Database Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 16 unexpected '00'.
  syntax error line 7 at position 28 unexpected '00'.
  compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m11:48:22.879299 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50edccbf-bdb7-4d3f-a75b-b35642ccb5d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04818a100>]}
[0m11:48:22.880129 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model final_sales.bronze_payments ........ [[31mERROR[0m in 0.63s]
[0m11:48:22.880949 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m11:48:22.883419 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:22.883989 [debug] [MainThread]: Connection 'model.development.bronze_payments' was properly closed.
[0m11:48:22.884403 [info ] [MainThread]: 
[0m11:48:22.885003 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m11:48:22.885922 [debug] [MainThread]: Command end result
[0m11:48:22.896907 [info ] [MainThread]: 
[0m11:48:22.897561 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:48:22.898054 [info ] [MainThread]: 
[0m11:48:22.898564 [error] [MainThread]: [33mDatabase Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)[0m
[0m11:48:22.899720 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:48:22.900270 [error] [MainThread]:   syntax error line 7 at position 16 unexpected '00'.
[0m11:48:22.900866 [error] [MainThread]:   syntax error line 7 at position 28 unexpected '00'.
[0m11:48:22.901611 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m11:48:22.902474 [info ] [MainThread]: 
[0m11:48:22.903055 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:48:22.904181 [debug] [MainThread]: Command `dbt run` failed at 11:48:22.904014 after 2.39 seconds
[0m11:48:22.904726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04feec5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb04a105880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0481d4dc0>]}
[0m11:48:22.905281 [debug] [MainThread]: Flushing usage events
[0m11:48:30.236978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369e337580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369cc6d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369cc6d160>]}


============================== 11:48:30.240670 | b07aeb44-16c1-4c97-928c-ffad60fc33d5 ==============================
[0m11:48:30.240670 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:48:30.241504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:48:30.563107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b07aeb44-16c1-4c97-928c-ffad60fc33d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3698537ac0>]}
[0m11:48:30.585414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b07aeb44-16c1-4c97-928c-ffad60fc33d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36984e8b80>]}
[0m11:48:30.602408 [debug] [MainThread]: checksum: 332f65646e66ee97141cf62e50d5e186961811ebbf70f0de4e68a26bd713aeec, vars: {'run_date': datetime.datetime(2023, 6, 22, 0, 0, tzinfo=datetime.timezone.utc)}, profile: , target: , version: 1.5.1
[0m11:48:30.631632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:48:30.632141 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:48:30.633117 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.bronze
- models.development.staging
[0m11:48:30.642348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b07aeb44-16c1-4c97-928c-ffad60fc33d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3697350760>]}
[0m11:48:30.652736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b07aeb44-16c1-4c97-928c-ffad60fc33d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36984595e0>]}
[0m11:48:30.653409 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:48:30.653970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b07aeb44-16c1-4c97-928c-ffad60fc33d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36984596d0>]}
[0m11:48:30.655581 [info ] [MainThread]: 
[0m11:48:30.657011 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:48:30.658522 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m11:48:30.677400 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m11:48:30.678034 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m11:48:30.678523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:31.196562 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:48:31.199605 [debug] [ThreadPool]: On list_external_db: Close
[0m11:48:31.311921 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m11:48:31.322988 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m11:48:31.323577 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m11:48:31.324103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:31.660495 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m11:48:31.662776 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m11:48:31.784230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b07aeb44-16c1-4c97-928c-ffad60fc33d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3698512730>]}
[0m11:48:31.785675 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:48:31.786312 [info ] [MainThread]: 
[0m11:48:31.791472 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m11:48:31.792287 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m11:48:31.793349 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_products)
[0m11:48:31.794009 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m11:48:31.799539 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m11:48:31.800562 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 11:48:31.794428 => 11:48:31.800205
[0m11:48:31.801166 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m11:48:31.883957 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m11:48:31.885720 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m11:48:31.886286 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace transient table external_db.final_sales.bronze_products
         as
        (

with products as (
     select *, 
     2023-06-22 00:00:00+00:00 as run_date from external_db.stage.products
)

select * from products
        );
[0m11:48:31.886835 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:48:32.193811 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2304-0000-fb87-0000-0001937ec1fd
[0m11:48:32.194557 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 16 unexpected '00'.
syntax error line 7 at position 28 unexpected '00'.
[0m11:48:32.195480 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 11:48:31.801543 => 11:48:32.195134
[0m11:48:32.196084 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m11:48:32.303729 [debug] [Thread-1  ]: Database Error in model bronze_products (models/sales/bronze/bronze_products.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 16 unexpected '00'.
  syntax error line 7 at position 28 unexpected '00'.
  compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m11:48:32.304703 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b07aeb44-16c1-4c97-928c-ffad60fc33d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36973b1b80>]}
[0m11:48:32.305704 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model final_sales.bronze_products ........ [[31mERROR[0m in 0.51s]
[0m11:48:32.306604 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m11:48:32.308876 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:32.309366 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m11:48:32.309946 [info ] [MainThread]: 
[0m11:48:32.310566 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.65 seconds (1.65s).
[0m11:48:32.311752 [debug] [MainThread]: Command end result
[0m11:48:32.322561 [info ] [MainThread]: 
[0m11:48:32.323446 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:48:32.324249 [info ] [MainThread]: 
[0m11:48:32.324944 [error] [MainThread]: [33mDatabase Error in model bronze_products (models/sales/bronze/bronze_products.sql)[0m
[0m11:48:32.325531 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:48:32.326068 [error] [MainThread]:   syntax error line 7 at position 16 unexpected '00'.
[0m11:48:32.326698 [error] [MainThread]:   syntax error line 7 at position 28 unexpected '00'.
[0m11:48:32.327237 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m11:48:32.327789 [info ] [MainThread]: 
[0m11:48:32.328395 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:48:32.329528 [debug] [MainThread]: Command `dbt run` failed at 11:48:32.329329 after 2.11 seconds
[0m11:48:32.330263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f369e337580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36984e8b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3696821490>]}
[0m11:48:32.330855 [debug] [MainThread]: Flushing usage events
[0m11:48:39.605897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32041315b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3202a57700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3202a573a0>]}


============================== 11:48:39.610245 | d7b3b39c-701e-4ff2-a256-b3bdf82ec945 ==============================
[0m11:48:39.610245 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:48:39.611070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:48:39.939153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7b3b39c-701e-4ff2-a256-b3bdf82ec945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31fe327c70>]}
[0m11:48:39.961851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7b3b39c-701e-4ff2-a256-b3bdf82ec945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31fe349430>]}
[0m11:48:39.978426 [debug] [MainThread]: checksum: 332f65646e66ee97141cf62e50d5e186961811ebbf70f0de4e68a26bd713aeec, vars: {'run_date': datetime.datetime(2023, 6, 22, 0, 0, tzinfo=datetime.timezone.utc)}, profile: , target: , version: 1.5.1
[0m11:48:40.006883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:48:40.007409 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:48:40.008485 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.intermediate
[0m11:48:40.017229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7b3b39c-701e-4ff2-a256-b3bdf82ec945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31fd14f7c0>]}
[0m11:48:40.026567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7b3b39c-701e-4ff2-a256-b3bdf82ec945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31fe248640>]}
[0m11:48:40.027231 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:48:40.027768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b3b39c-701e-4ff2-a256-b3bdf82ec945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31fe248730>]}
[0m11:48:40.029268 [info ] [MainThread]: 
[0m11:48:40.030398 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:48:40.031791 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m11:48:40.051280 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m11:48:40.051757 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m11:48:40.052303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:48:40.724144 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:48:40.727779 [debug] [ThreadPool]: On list_external_db: Close
[0m11:48:40.839383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m11:48:40.850348 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m11:48:40.850894 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m11:48:40.851355 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:48:41.164870 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m11:48:41.167230 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m11:48:41.281615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b3b39c-701e-4ff2-a256-b3bdf82ec945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31fe2487c0>]}
[0m11:48:41.283138 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:48:41.283850 [info ] [MainThread]: 
[0m11:48:41.289816 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m11:48:41.290578 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m11:48:41.291599 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m11:48:41.292129 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m11:48:41.298199 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m11:48:41.299316 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 11:48:41.292511 => 11:48:41.298944
[0m11:48:41.299956 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m11:48:41.383240 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m11:48:41.384913 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m11:48:41.385631 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace transient table external_db.final_sales.bronze_customers
         as
        (

with customers as (
     select *, 
     2023-06-22 00:00:00+00:00 as run_date  from external_db.stage.customers
)

select * from customers
        );
[0m11:48:41.386231 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:48:41.733438 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2304-0000-fb87-0000-0001937ec201
[0m11:48:41.734277 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 16 unexpected '00'.
syntax error line 7 at position 28 unexpected '00'.
[0m11:48:41.735323 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 11:48:41.300327 => 11:48:41.734884
[0m11:48:41.735900 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m11:48:41.867578 [debug] [Thread-1  ]: Database Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 16 unexpected '00'.
  syntax error line 7 at position 28 unexpected '00'.
  compiled Code at target/run/development/models/sales/bronze/bronze_customers.sql
[0m11:48:41.869447 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b3b39c-701e-4ff2-a256-b3bdf82ec945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31fc3cc130>]}
[0m11:48:41.870452 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model final_sales.bronze_customers ....... [[31mERROR[0m in 0.58s]
[0m11:48:41.871248 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m11:48:41.873783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:48:41.874240 [debug] [MainThread]: Connection 'model.development.bronze_customers' was properly closed.
[0m11:48:41.874744 [info ] [MainThread]: 
[0m11:48:41.875295 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m11:48:41.876135 [debug] [MainThread]: Command end result
[0m11:48:41.885699 [info ] [MainThread]: 
[0m11:48:41.886382 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:48:41.886904 [info ] [MainThread]: 
[0m11:48:41.887456 [error] [MainThread]: [33mDatabase Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)[0m
[0m11:48:41.887955 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m11:48:41.888450 [error] [MainThread]:   syntax error line 7 at position 16 unexpected '00'.
[0m11:48:41.889019 [error] [MainThread]:   syntax error line 7 at position 28 unexpected '00'.
[0m11:48:41.889547 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_customers.sql
[0m11:48:41.890053 [info ] [MainThread]: 
[0m11:48:41.890622 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:48:41.891728 [debug] [MainThread]: Command `dbt run` failed at 11:48:41.891552 after 2.31 seconds
[0m11:48:41.892413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32041315b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31fe2fc4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31fc414f10>]}
[0m11:48:41.893087 [debug] [MainThread]: Flushing usage events
[0m11:50:57.396473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2041f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1ecfc640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1ecfc1c0>]}


============================== 11:50:57.404734 | ccd4d3b2-9605-4686-a059-9d390716daa4 ==============================
[0m11:50:57.404734 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:50:57.405581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:50:57.738957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccd4d3b2-9605-4686-a059-9d390716daa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f195f9130>]}
[0m11:50:57.761012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccd4d3b2-9605-4686-a059-9d390716daa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f195f1040>]}
[0m11:50:57.780023 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:50:57.791031 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:50:57.791833 [debug] [MainThread]: previous checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, current checksum: 332f65646e66ee97141cf62e50d5e186961811ebbf70f0de4e68a26bd713aeec
[0m11:50:57.792241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ccd4d3b2-9605-4686-a059-9d390716daa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f195a8b20>]}
[0m11:50:58.753907 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_order_detail.sql
[0m11:50:58.785951 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_order_detail.sql
[0m11:50:58.789447 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_payment_details.sql
[0m11:50:58.798689 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_payment_details.sql
[0m11:50:58.802406 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m11:50:58.809457 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m11:50:58.812079 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m11:50:58.819483 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m11:50:58.822156 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m11:50:58.829162 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m11:50:58.832029 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m11:50:58.838510 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m11:50:58.842007 [debug] [MainThread]: 1603: static parser failed on sales/core/product_sales.sql
[0m11:50:58.851818 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/core/product_sales.sql
[0m11:50:59.026317 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.staging
- models.development.intermediate
[0m11:50:59.034424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccd4d3b2-9605-4686-a059-9d390716daa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f18f5d5b0>]}
[0m11:50:59.044938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccd4d3b2-9605-4686-a059-9d390716daa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1f5c41f0>]}
[0m11:50:59.045548 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:50:59.046106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccd4d3b2-9605-4686-a059-9d390716daa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1fe9e610>]}
[0m11:50:59.048437 [info ] [MainThread]: 
[0m11:50:59.049645 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:50:59.052218 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m11:50:59.073448 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m11:50:59.074172 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m11:50:59.074730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:50:59.789461 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m11:50:59.793042 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m11:51:00.214421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccd4d3b2-9605-4686-a059-9d390716daa4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f18f5d0d0>]}
[0m11:51:00.215875 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:00.216718 [info ] [MainThread]: 
[0m11:51:00.223597 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m11:51:00.224745 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m11:51:00.225414 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m11:51:00.231563 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m11:51:00.232675 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 11:51:00.225807 => 11:51:00.232240
[0m11:51:00.233324 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m11:51:00.234494 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 11:51:00.233709 => 11:51:00.234031
[0m11:51:00.235851 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m11:51:00.236483 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m11:51:00.237653 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m11:51:00.238285 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m11:51:00.242991 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m11:51:00.243964 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 11:51:00.238630 => 11:51:00.243564
[0m11:51:00.244552 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m11:51:00.245342 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 11:51:00.244948 => 11:51:00.244979
[0m11:51:00.246647 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m11:51:00.247315 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m11:51:00.248218 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m11:51:00.248754 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m11:51:00.253530 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m11:51:00.254481 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 11:51:00.249091 => 11:51:00.254139
[0m11:51:00.255009 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m11:51:00.255692 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 11:51:00.255363 => 11:51:00.255377
[0m11:51:00.257284 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m11:51:00.257974 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m11:51:00.258845 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m11:51:00.259513 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m11:51:00.264130 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m11:51:00.265642 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 11:51:00.259890 => 11:51:00.265273
[0m11:51:00.266240 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m11:51:00.267016 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 11:51:00.266681 => 11:51:00.266697
[0m11:51:00.268310 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m11:51:00.269098 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m11:51:00.270117 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m11:51:00.270869 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m11:51:00.276714 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m11:51:00.278133 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 11:51:00.271378 => 11:51:00.277648
[0m11:51:00.278695 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m11:51:00.279374 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 11:51:00.279046 => 11:51:00.279064
[0m11:51:00.280767 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m11:51:00.281453 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m11:51:00.282278 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m11:51:00.282816 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m11:51:00.290338 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m11:51:00.291424 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 11:51:00.283166 => 11:51:00.291047
[0m11:51:00.292040 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m11:51:00.292808 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 11:51:00.292423 => 11:51:00.292438
[0m11:51:00.294096 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m11:51:00.295465 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m11:51:00.296288 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m11:51:00.296925 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m11:51:00.305898 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m11:51:00.306982 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 11:51:00.297312 => 11:51:00.306548
[0m11:51:00.307561 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m11:51:00.308309 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 11:51:00.307981 => 11:51:00.307998
[0m11:51:00.310101 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m11:51:00.311905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:00.312452 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m11:51:00.315060 [debug] [MainThread]: Command end result
[0m11:51:00.328048 [debug] [MainThread]: Command `dbt compile` succeeded at 11:51:00.327768 after 2.95 seconds
[0m11:51:00.328732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2041f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f195e08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f1d835d30>]}
[0m11:51:00.329333 [debug] [MainThread]: Flushing usage events
[0m11:51:14.953029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49fa2b5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f8bdf550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f8bdf220>]}


============================== 11:51:14.957056 | 5d6fdfd1-1d2a-41ef-bf4d-c6abecc07688 ==============================
[0m11:51:14.957056 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:51:14.957818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dags/dbt/logs', 'profiles_dir': 'dags/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:51:15.307604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d6fdfd1-1d2a-41ef-bf4d-c6abecc07688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f44d1f70>]}
[0m11:51:15.331610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d6fdfd1-1d2a-41ef-bf4d-c6abecc07688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f44d1610>]}
[0m11:51:15.351081 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m11:51:15.380403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:51:15.380908 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:51:15.381844 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.intermediate
[0m11:51:15.391577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d6fdfd1-1d2a-41ef-bf4d-c6abecc07688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f32cd460>]}
[0m11:51:15.400938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d6fdfd1-1d2a-41ef-bf4d-c6abecc07688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f33b2310>]}
[0m11:51:15.401649 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:51:15.402433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d6fdfd1-1d2a-41ef-bf4d-c6abecc07688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f33b2460>]}
[0m11:51:15.404840 [info ] [MainThread]: 
[0m11:51:15.405940 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:51:15.407987 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m11:51:15.427424 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m11:51:15.427991 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m11:51:15.428461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:16.083249 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m11:51:16.086747 [debug] [ThreadPool]: On list_external_db: Close
[0m11:51:16.213162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m11:51:16.224126 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m11:51:16.224680 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m11:51:16.225143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:16.750797 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m11:51:16.752913 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m11:51:16.901031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d6fdfd1-1d2a-41ef-bf4d-c6abecc07688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f332df40>]}
[0m11:51:16.902507 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:16.903173 [info ] [MainThread]: 
[0m11:51:16.908759 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m11:51:16.909574 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m11:51:16.910562 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m11:51:16.911114 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m11:51:16.917124 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m11:51:16.918118 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 11:51:16.911512 => 11:51:16.917757
[0m11:51:16.918656 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m11:51:17.004712 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m11:51:17.006398 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m11:51:17.006971 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace transient table external_db.final_sales.bronze_customers
         as
        (

with customers as (
     select *, 
     2023-06-22 as run_date  from external_db.stage.customers
)

select * from customers
        );
[0m11:51:17.007566 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:51:18.450318 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:51:18.462267 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m11:51:18.462793 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m11:51:18.524162 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:51:18.555268 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 11:51:16.919025 => 11:51:18.554944
[0m11:51:18.555870 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m11:51:18.658924 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6fdfd1-1d2a-41ef-bf4d-c6abecc07688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f0d5d3a0>]}
[0m11:51:18.660199 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 1[0m in 1.75s]
[0m11:51:18.661332 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m11:51:18.662122 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m11:51:18.662764 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m11:51:18.663759 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m11:51:18.664715 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m11:51:18.670207 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m11:51:18.671297 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 11:51:18.665124 => 11:51:18.670837
[0m11:51:18.673737 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m11:51:18.678812 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m11:51:18.680193 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m11:51:18.680815 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace transient table external_db.final_sales.bronze_orders
         as
        (

with orders as (
     select *, 
     2023-06-22 as run_date from external_db.stage.orders
)

select * from orders
        );
[0m11:51:18.681284 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:51:19.531719 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:51:19.537139 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m11:51:19.537774 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m11:51:19.606255 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:51:19.609979 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 11:51:18.674144 => 11:51:19.609691
[0m11:51:19.610492 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m11:51:19.734373 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6fdfd1-1d2a-41ef-bf4d-c6abecc07688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f0d2d460>]}
[0m11:51:19.735641 [info ] [Thread-1  ]: 2 of 7 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 1[0m in 1.07s]
[0m11:51:19.737137 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m11:51:19.737893 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m11:51:19.738458 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m11:51:19.739291 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m11:51:19.739998 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m11:51:19.747340 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m11:51:19.748342 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 11:51:19.741254 => 11:51:19.747974
[0m11:51:19.748936 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m11:51:19.753720 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m11:51:19.754980 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m11:51:19.755476 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace transient table external_db.final_sales.bronze_payments
         as
        (

with payments as (
     select *, 
     2023-06-22 as run_date from external_db.stage.payments
)

select * from payments
        );
[0m11:51:19.755964 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:51:21.011382 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:51:21.016536 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m11:51:21.017185 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m11:51:21.082535 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:51:21.086887 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 11:51:19.749296 => 11:51:21.086579
[0m11:51:21.087530 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m11:51:21.192996 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6fdfd1-1d2a-41ef-bf4d-c6abecc07688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f0d2d250>]}
[0m11:51:21.194235 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 1[0m in 1.45s]
[0m11:51:21.195551 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m11:51:21.196151 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m11:51:21.197238 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m11:51:21.198560 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m11:51:21.199041 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m11:51:21.203980 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m11:51:21.205229 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 11:51:21.199418 => 11:51:21.204789
[0m11:51:21.205752 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m11:51:21.210817 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m11:51:21.211894 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m11:51:21.212421 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace transient table external_db.final_sales.bronze_products
         as
        (

with products as (
     select *, 
     2023-06-22 as run_date from external_db.stage.products
)

select * from products
        );
[0m11:51:21.212947 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:51:22.101368 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:51:22.107452 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m11:51:22.107940 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m11:51:22.195975 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:51:22.199542 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 11:51:21.206084 => 11:51:22.199234
[0m11:51:22.200164 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m11:51:22.321600 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6fdfd1-1d2a-41ef-bf4d-c6abecc07688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f0ceefa0>]}
[0m11:51:22.322714 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 1[0m in 1.12s]
[0m11:51:22.323596 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m11:51:22.324187 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m11:51:22.324825 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m11:51:22.326112 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m11:51:22.326585 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m11:51:22.336623 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m11:51:22.337585 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 11:51:22.327025 => 11:51:22.337252
[0m11:51:22.338956 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m11:51:22.343887 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m11:51:22.345226 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m11:51:22.345844 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace transient table external_db.final_sales.fct_payment_details
         as
        (

with payments as (
    select * from external_db.final_sales.bronze_payments
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
        );
[0m11:51:22.346397 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:51:22.995727 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:51:23.001380 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m11:51:23.001981 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m11:51:23.062831 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:51:23.067093 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 11:51:22.339442 => 11:51:23.066794
[0m11:51:23.067708 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m11:51:23.178911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6fdfd1-1d2a-41ef-bf4d-c6abecc07688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f0d0a7f0>]}
[0m11:51:23.180129 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 1[0m in 0.85s]
[0m11:51:23.181492 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m11:51:23.182422 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m11:51:23.183517 [info ] [Thread-1  ]: 6 of 7 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m11:51:23.184520 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m11:51:23.185202 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m11:51:23.192335 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m11:51:23.193370 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 11:51:23.185531 => 11:51:23.193017
[0m11:51:23.193911 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m11:51:23.268313 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m11:51:23.270353 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m11:51:23.270929 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace transient table external_db.final_sales.fct_order_detail
         as
        (
with orders as (
    select * from external_db.final_sales.bronze_orders
   
),

products as (
    select * from external_db.final_sales.bronze_products
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_date
    from orders
    left join products using (product_id)
)
select * from final
        );
[0m11:51:23.271496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:51:24.082602 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:51:24.088610 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m11:51:24.089114 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m11:51:24.146083 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:51:24.149741 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 11:51:23.194248 => 11:51:24.149446
[0m11:51:24.150235 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m11:51:24.248573 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6fdfd1-1d2a-41ef-bf4d-c6abecc07688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f332df40>]}
[0m11:51:24.249875 [info ] [Thread-1  ]: 6 of 7 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 1[0m in 1.06s]
[0m11:51:24.250946 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m11:51:24.252502 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m11:51:24.253302 [info ] [Thread-1  ]: 7 of 7 START sql incremental model final_sales.product_sales ................... [RUN]
[0m11:51:24.254259 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m11:51:24.254808 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m11:51:24.263046 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m11:51:24.263914 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 11:51:24.255269 => 11:51:24.263599
[0m11:51:24.264531 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m11:51:24.269760 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m11:51:24.271497 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m11:51:24.272295 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace transient table external_db.final_sales.product_sales
         as
        (

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
        );
[0m11:51:24.273066 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:51:25.247618 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:51:25.252718 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m11:51:25.253278 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m11:51:25.349735 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:51:25.353455 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 11:51:24.264992 => 11:51:25.353144
[0m11:51:25.354069 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m11:51:25.458223 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d6fdfd1-1d2a-41ef-bf4d-c6abecc07688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f0cb5e50>]}
[0m11:51:25.459610 [info ] [Thread-1  ]: 7 of 7 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 1[0m in 1.20s]
[0m11:51:25.460586 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m11:51:25.462761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:25.463299 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m11:51:25.463921 [info ] [MainThread]: 
[0m11:51:25.464824 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 10.06 seconds (10.06s).
[0m11:51:25.467484 [debug] [MainThread]: Command end result
[0m11:51:25.477518 [info ] [MainThread]: 
[0m11:51:25.478137 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:25.478736 [info ] [MainThread]: 
[0m11:51:25.479265 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:51:25.480648 [debug] [MainThread]: Command `dbt run` succeeded at 11:51:25.480408 after 10.55 seconds
[0m11:51:25.481287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49fa2b5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f44d1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f49f33b2130>]}
[0m11:51:25.481879 [debug] [MainThread]: Flushing usage events
[0m11:54:56.573428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55e8ea4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55d208040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55d208370>]}


============================== 11:54:56.577816 | ffa96307-dc0e-4573-b950-f2e2e7fff256 ==============================
[0m11:54:56.577816 [info ] [MainThread]: Running with dbt=1.5.1
[0m11:54:56.578557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dags/dbt/logs', 'debug': 'False', 'profiles_dir': 'dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m11:54:56.933419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffa96307-dc0e-4573-b950-f2e2e7fff256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe558af1100>]}
[0m11:54:56.956616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffa96307-dc0e-4573-b950-f2e2e7fff256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe558afc0a0>]}
[0m11:54:56.975582 [debug] [MainThread]: checksum: 518582be7b55697d4b7425a2eabd56b025e80bae3faea46064d56fa479f3a66b, vars: {'run_date': '2023-06-22'}, profile: , target: , version: 1.5.1
[0m11:54:56.986927 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m11:54:56.987625 [debug] [MainThread]: previous checksum: 518582be7b55697d4b7425a2eabd56b025e80bae3faea46064d56fa479f3a66b, current checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c
[0m11:54:56.988063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ffa96307-dc0e-4573-b950-f2e2e7fff256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe558aabdc0>]}
[0m11:54:57.982867 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_order_detail.sql
[0m11:54:58.013286 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_order_detail.sql
[0m11:54:58.016529 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_payment_details.sql
[0m11:54:58.025865 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_payment_details.sql
[0m11:54:58.029382 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m11:54:58.037971 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m11:54:58.041622 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m11:54:58.049510 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m11:54:58.052262 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m11:54:58.061159 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m11:54:58.064339 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m11:54:58.071383 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m11:54:58.074694 [debug] [MainThread]: 1603: static parser failed on sales/core/product_sales.sql
[0m11:54:58.085221 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/core/product_sales.sql
[0m11:54:58.275041 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m11:54:58.284276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffa96307-dc0e-4573-b950-f2e2e7fff256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5574cd9d0>]}
[0m11:54:58.296709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffa96307-dc0e-4573-b950-f2e2e7fff256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe558ad9970>]}
[0m11:54:58.297475 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m11:54:58.298271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffa96307-dc0e-4573-b950-f2e2e7fff256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe558ad9730>]}
[0m11:54:58.300669 [info ] [MainThread]: 
[0m11:54:58.302613 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:54:58.305631 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m11:54:58.327620 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m11:54:58.328272 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m11:54:58.328735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:59.062785 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m11:54:59.066227 [debug] [ThreadPool]: On list_external_db: Close
[0m11:54:59.174088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now create_external_db_final_sales)
[0m11:54:59.175277 [debug] [ThreadPool]: Creating schema "database: "external_db"
schema: "final_sales"
"
[0m11:54:59.183840 [debug] [ThreadPool]: Using snowflake connection "create_external_db_final_sales"
[0m11:54:59.184328 [debug] [ThreadPool]: On create_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "create_external_db_final_sales"} */
create schema if not exists external_db.final_sales
[0m11:54:59.184813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:54:59.652905 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:54:59.654790 [debug] [ThreadPool]: On create_external_db_final_sales: Close
[0m11:54:59.757148 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_external_db_final_sales, now list_external_db_final_sales)
[0m11:54:59.767044 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m11:54:59.767691 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m11:54:59.768279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:55:00.133114 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m11:55:00.135705 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m11:55:00.266244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffa96307-dc0e-4573-b950-f2e2e7fff256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe558ad9730>]}
[0m11:55:00.267666 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:55:00.268244 [info ] [MainThread]: 
[0m11:55:00.272665 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m11:55:00.273457 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m11:55:00.275021 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m11:55:00.275674 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m11:55:00.281409 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m11:55:00.282371 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 11:55:00.276243 => 11:55:00.282035
[0m11:55:00.282894 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m11:55:00.359735 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m11:55:00.361107 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m11:55:00.361644 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace transient table external_db.final_sales.bronze_customers
         as
        (

with customers as (
     select *, 
     2023-06-22 as run_date  from external_db.stage.customers
)

select * from customers
        );
[0m11:55:00.362169 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:55:01.062605 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:55:01.076224 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m11:55:01.076853 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m11:55:01.155638 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:55:01.185828 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 11:55:00.283231 => 11:55:01.185470
[0m11:55:01.186590 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m11:55:01.299242 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffa96307-dc0e-4573-b950-f2e2e7fff256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55676ee50>]}
[0m11:55:01.300338 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 1[0m in 1.02s]
[0m11:55:01.301317 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m11:55:01.302100 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m11:55:01.302724 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m11:55:01.303677 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m11:55:01.304208 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m11:55:01.309500 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m11:55:01.310464 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 11:55:01.304554 => 11:55:01.310126
[0m11:55:01.310960 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m11:55:01.315830 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m11:55:01.316847 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m11:55:01.317338 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace transient table external_db.final_sales.bronze_orders
         as
        (

with orders as (
     select *, 
     2023-06-22 as run_date from external_db.stage.orders
)

select * from orders
        );
[0m11:55:01.317916 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:55:02.072503 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:55:02.078285 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m11:55:02.078935 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m11:55:02.145345 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:55:02.149974 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 11:55:01.311287 => 11:55:02.149646
[0m11:55:02.150543 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m11:55:02.271558 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffa96307-dc0e-4573-b950-f2e2e7fff256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe556880dc0>]}
[0m11:55:02.272922 [info ] [Thread-1  ]: 2 of 7 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 1[0m in 0.97s]
[0m11:55:02.274780 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m11:55:02.275855 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m11:55:02.277252 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m11:55:02.279352 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m11:55:02.281333 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m11:55:02.287437 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m11:55:02.288358 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 11:55:02.281742 => 11:55:02.288034
[0m11:55:02.289011 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m11:55:02.293844 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m11:55:02.295179 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m11:55:02.295690 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace transient table external_db.final_sales.bronze_payments
         as
        (

with payments as (
     select *, 
     2023-06-22 as run_date from external_db.stage.payments
)

select * from payments
        );
[0m11:55:02.296203 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:55:02.952873 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:55:02.958983 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m11:55:02.959700 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m11:55:03.024684 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:55:03.029344 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 11:55:02.289360 => 11:55:03.029003
[0m11:55:03.029952 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m11:55:03.135298 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffa96307-dc0e-4573-b950-f2e2e7fff256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55676ee50>]}
[0m11:55:03.136489 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 1[0m in 0.86s]
[0m11:55:03.137443 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m11:55:03.138652 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m11:55:03.139370 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m11:55:03.140379 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m11:55:03.141092 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m11:55:03.148219 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m11:55:03.149453 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 11:55:03.141648 => 11:55:03.149065
[0m11:55:03.149941 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m11:55:03.154950 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m11:55:03.156164 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m11:55:03.156736 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace transient table external_db.final_sales.bronze_products
         as
        (

with products as (
     select *, 
     2023-06-22 as run_date from external_db.stage.products
)

select * from products
        );
[0m11:55:03.157203 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:55:03.792131 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:55:03.797841 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m11:55:03.798408 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m11:55:03.868740 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:55:03.872799 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 11:55:03.150314 => 11:55:03.872451
[0m11:55:03.873356 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m11:55:04.005299 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffa96307-dc0e-4573-b950-f2e2e7fff256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55677eb20>]}
[0m11:55:04.006630 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 1[0m in 0.86s]
[0m11:55:04.007717 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m11:55:04.008976 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m11:55:04.009997 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m11:55:04.011395 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m11:55:04.012017 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m11:55:04.018347 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m11:55:04.020827 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 11:55:04.012374 => 11:55:04.020433
[0m11:55:04.021332 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m11:55:04.026502 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m11:55:04.027885 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m11:55:04.028451 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace transient table external_db.final_sales.fct_payment_details
         as
        (

with payments as (
    select * from external_db.final_sales.bronze_payments
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
        );
[0m11:55:04.028961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:55:04.669006 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:55:04.674687 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m11:55:04.675289 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m11:55:04.735961 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:55:04.740046 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 11:55:04.021660 => 11:55:04.739751
[0m11:55:04.740641 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m11:55:04.832719 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffa96307-dc0e-4573-b950-f2e2e7fff256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe554e95ee0>]}
[0m11:55:04.833897 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 1[0m in 0.82s]
[0m11:55:04.835087 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m11:55:04.835817 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m11:55:04.836860 [info ] [Thread-1  ]: 6 of 7 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m11:55:04.837897 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m11:55:04.838372 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m11:55:04.845064 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m11:55:04.846075 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 11:55:04.838802 => 11:55:04.845743
[0m11:55:04.846650 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m11:55:04.851916 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m11:55:04.853515 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m11:55:04.854109 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace transient table external_db.final_sales.fct_order_detail
         as
        (
with orders as (
    select * from external_db.final_sales.bronze_orders
   
),

products as (
    select * from external_db.final_sales.bronze_products
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_date
    from orders
    left join products using (product_id)
)
select * from final
        );
[0m11:55:04.854728 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:55:05.705884 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:55:05.711415 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m11:55:05.712242 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m11:55:05.770340 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:55:05.774507 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 11:55:04.847014 => 11:55:05.774138
[0m11:55:05.775041 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m11:55:05.871036 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffa96307-dc0e-4573-b950-f2e2e7fff256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe554ea4d30>]}
[0m11:55:05.872118 [info ] [Thread-1  ]: 6 of 7 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 1[0m in 1.03s]
[0m11:55:05.873175 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m11:55:05.874524 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m11:55:05.875308 [info ] [Thread-1  ]: 7 of 7 START sql incremental model final_sales.product_sales ................... [RUN]
[0m11:55:05.876195 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m11:55:05.876844 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m11:55:05.885324 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m11:55:05.886523 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 11:55:05.877163 => 11:55:05.886075
[0m11:55:05.887137 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m11:55:05.892101 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m11:55:05.893667 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m11:55:05.894273 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace transient table external_db.final_sales.product_sales
         as
        (

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
        );
[0m11:55:05.894996 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:55:06.850043 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:55:06.855811 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m11:55:06.856295 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m11:55:06.911245 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:55:06.914487 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 11:55:05.887619 => 11:55:06.914200
[0m11:55:06.915014 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m11:55:07.010601 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffa96307-dc0e-4573-b950-f2e2e7fff256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55684e070>]}
[0m11:55:07.011751 [info ] [Thread-1  ]: 7 of 7 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 1[0m in 1.13s]
[0m11:55:07.012751 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m11:55:07.015095 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:07.015496 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m11:55:07.016001 [info ] [MainThread]: 
[0m11:55:07.016683 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 8.71 seconds (8.71s).
[0m11:55:07.019265 [debug] [MainThread]: Command end result
[0m11:55:07.029679 [info ] [MainThread]: 
[0m11:55:07.030677 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:55:07.031217 [info ] [MainThread]: 
[0m11:55:07.031789 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m11:55:07.032862 [debug] [MainThread]: Command `dbt run` succeeded at 11:55:07.032670 after 10.48 seconds
[0m11:55:07.033382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55e8ea4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55da96790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe55daa2130>]}
[0m11:55:07.033866 [debug] [MainThread]: Flushing usage events
[0m12:10:46.315100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aaa418430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa8d36520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa8d36160>]}


============================== 12:10:46.319068 | 8c9301d6-dd54-46d1-b333-e9f237edea3f ==============================
[0m12:10:46.319068 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:10:46.319774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:10:46.639550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c9301d6-dd54-46d1-b333-e9f237edea3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa35f6d90>]}
[0m12:10:46.662821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c9301d6-dd54-46d1-b333-e9f237edea3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa35f6550>]}
[0m12:10:46.679925 [debug] [MainThread]: checksum: 518582be7b55697d4b7425a2eabd56b025e80bae3faea46064d56fa479f3a66b, vars: {'run_date': '2023-06-22'}, profile: , target: , version: 1.5.1
[0m12:10:46.709230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m12:10:46.710066 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_products.sql
[0m12:10:46.710669 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_payments.sql
[0m12:10:46.711372 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_orders.sql
[0m12:10:46.743790 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m12:10:46.765840 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m12:10:46.769314 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m12:10:46.776635 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m12:10:46.779740 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m12:10:46.787204 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m12:10:46.821082 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m12:10:46.828007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c9301d6-dd54-46d1-b333-e9f237edea3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa2fd9d90>]}
[0m12:10:46.837971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c9301d6-dd54-46d1-b333-e9f237edea3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa347d250>]}
[0m12:10:46.838620 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:10:46.839213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c9301d6-dd54-46d1-b333-e9f237edea3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa347d3a0>]}
[0m12:10:46.841448 [info ] [MainThread]: 
[0m12:10:46.842513 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:10:46.844668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:10:46.864196 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:10:46.864834 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:10:46.865361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:47.554823 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:10:47.558289 [debug] [ThreadPool]: On list_external_db: Close
[0m12:10:47.659988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m12:10:47.670424 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:10:47.670942 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:10:47.671353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:48.190365 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m12:10:48.193375 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:10:48.321605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c9301d6-dd54-46d1-b333-e9f237edea3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa35aefa0>]}
[0m12:10:48.323076 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:10:48.323678 [info ] [MainThread]: 
[0m12:10:48.328665 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:10:48.329523 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:10:48.330611 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:10:48.331210 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:10:48.338072 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:10:48.339130 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:10:48.331631 => 12:10:48.338708
[0m12:10:48.339817 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:10:48.412617 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:10:48.413429 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     2023-06-22 as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m12:10:48.413952 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:10:48.811134 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:10:48.823236 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:10:48.823856 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m12:10:48.907079 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:10:48.913123 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:10:48.913758 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m12:10:48.991860 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:10:49.005868 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:10:49.006607 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m12:10:49.081655 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:10:49.129357 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m12:10:49.131294 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:10:49.131921 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m12:10:49.217135 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:10:49.217904 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:10:49.218453 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m12:10:50.125264 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m12:10:50.126241 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:10:50.126841 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m12:10:50.338983 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:10:50.419205 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:10:50.419897 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m12:10:50.519782 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:10:50.551066 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:10:48.340158 => 12:10:50.550731
[0m12:10:50.551701 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:10:50.671884 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c9301d6-dd54-46d1-b333-e9f237edea3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa0a339a0>]}
[0m12:10:50.673157 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 10[0m in 2.34s]
[0m12:10:50.674432 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:10:50.675101 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:10:50.675830 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:10:50.677098 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:10:50.677726 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:10:50.683448 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:10:50.684567 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:10:50.678459 => 12:10:50.684226
[0m12:10:50.685121 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:10:50.690164 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:10:50.690690 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     2023-06-22 :: timestamp as run_date from external_db.stage.orders
)

select * from orders
  );
[0m12:10:50.691213 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:10:51.011234 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad231a-0000-fb4f-0000-0001937eb2d9
[0m12:10:51.011964 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001044 (42P13): SQL compilation error: error line 8 at position 12
Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:10:51.012815 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:10:50.685484 => 12:10:51.012446
[0m12:10:51.013369 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:10:51.127685 [debug] [Thread-1  ]: Database Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)
  001044 (42P13): SQL compilation error: error line 8 at position 12
  Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:10:51.128740 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c9301d6-dd54-46d1-b333-e9f237edea3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa22ae760>]}
[0m12:10:51.129667 [error] [Thread-1  ]: 2 of 7 ERROR creating sql incremental model final_sales.bronze_orders .......... [[31mERROR[0m in 0.45s]
[0m12:10:51.130545 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:10:51.131212 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:10:51.132141 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:10:51.133479 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:10:51.134029 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:10:51.139690 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:10:51.140636 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:10:51.134485 => 12:10:51.140271
[0m12:10:51.141496 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:10:51.146870 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:10:51.147477 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     2023-06-22 :: timestamp as run_date from external_db.stage.payments
)

select * from payments
  );
[0m12:10:51.148007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:10:51.503048 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad231a-0000-fb4f-0000-0001937eb2dd
[0m12:10:51.503903 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001044 (42P13): SQL compilation error: error line 8 at position 12
Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:10:51.504832 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:10:51.141901 => 12:10:51.504408
[0m12:10:51.505499 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:10:51.629712 [debug] [Thread-1  ]: Database Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)
  001044 (42P13): SQL compilation error: error line 8 at position 12
  Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:10:51.630704 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c9301d6-dd54-46d1-b333-e9f237edea3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa0a5cfd0>]}
[0m12:10:51.631672 [error] [Thread-1  ]: 3 of 7 ERROR creating sql incremental model final_sales.bronze_payments ........ [[31mERROR[0m in 0.50s]
[0m12:10:51.632511 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:10:51.633431 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:10:51.634591 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:10:51.636017 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:10:51.636688 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:10:51.641878 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:10:51.643002 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:10:51.637308 => 12:10:51.642624
[0m12:10:51.643547 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:10:51.648478 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:10:51.649202 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     2023-06-22 :: timestamp as run_date from external_db.stage.products
)

select * from products
  );
[0m12:10:51.649698 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:10:52.008312 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad231a-0000-fb87-0000-0001937ec301
[0m12:10:52.009188 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001044 (42P13): SQL compilation error: error line 8 at position 12
Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:10:52.010081 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:10:51.643876 => 12:10:52.009743
[0m12:10:52.010708 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:10:52.134868 [debug] [Thread-1  ]: Database Error in model bronze_products (models/sales/bronze/bronze_products.sql)
  001044 (42P13): SQL compilation error: error line 8 at position 12
  Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:10:52.135739 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c9301d6-dd54-46d1-b333-e9f237edea3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa2362160>]}
[0m12:10:52.136820 [error] [Thread-1  ]: 4 of 7 ERROR creating sql incremental model final_sales.bronze_products ........ [[31mERROR[0m in 0.50s]
[0m12:10:52.138114 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:10:52.138775 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:10:52.139644 [info ] [Thread-1  ]: 5 of 7 SKIP relation final_sales.fct_payment_details ........................... [[33mSKIP[0m]
[0m12:10:52.140805 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:10:52.141447 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:10:52.142346 [info ] [Thread-1  ]: 6 of 7 SKIP relation final_sales.fct_order_detail .............................. [[33mSKIP[0m]
[0m12:10:52.143240 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:10:52.144521 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:10:52.145252 [info ] [Thread-1  ]: 7 of 7 SKIP relation final_sales.product_sales ................................. [[33mSKIP[0m]
[0m12:10:52.145933 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:10:52.148128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:52.148729 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m12:10:52.149308 [info ] [MainThread]: 
[0m12:10:52.149901 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 5.31 seconds (5.31s).
[0m12:10:52.156905 [debug] [MainThread]: Command end result
[0m12:10:52.169139 [info ] [MainThread]: 
[0m12:10:52.169873 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:10:52.170416 [info ] [MainThread]: 
[0m12:10:52.170964 [error] [MainThread]: [33mDatabase Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)[0m
[0m12:10:52.171491 [error] [MainThread]:   001044 (42P13): SQL compilation error: error line 8 at position 12
[0m12:10:52.172010 [error] [MainThread]:   Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:10:52.172493 [info ] [MainThread]: 
[0m12:10:52.173210 [error] [MainThread]: [33mDatabase Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)[0m
[0m12:10:52.173758 [error] [MainThread]:   001044 (42P13): SQL compilation error: error line 8 at position 12
[0m12:10:52.174629 [error] [MainThread]:   Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:10:52.175160 [info ] [MainThread]: 
[0m12:10:52.175705 [error] [MainThread]: [33mDatabase Error in model bronze_products (models/sales/bronze/bronze_products.sql)[0m
[0m12:10:52.176279 [error] [MainThread]:   001044 (42P13): SQL compilation error: error line 8 at position 12
[0m12:10:52.176882 [error] [MainThread]:   Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:10:52.177442 [info ] [MainThread]: 
[0m12:10:52.178029 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=3 TOTAL=7
[0m12:10:52.179136 [debug] [MainThread]: Command `dbt run` failed at 12:10:52.178940 after 5.89 seconds
[0m12:10:52.179727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aaa418430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa08ffe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa08fff40>]}
[0m12:10:52.180281 [debug] [MainThread]: Flushing usage events
[0m12:13:07.636998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173227f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1730b9e640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1730b9e070>]}


============================== 12:13:07.641917 | 03c36523-c754-4b5a-9b04-6f4774a06264 ==============================
[0m12:13:07.641917 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:13:07.642779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'dags/dbt/logs', 'profiles_dir': 'dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:13:08.016725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03c36523-c754-4b5a-9b04-6f4774a06264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f172c490160>]}
[0m12:13:08.038771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03c36523-c754-4b5a-9b04-6f4774a06264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f172c4873a0>]}
[0m12:13:08.055220 [debug] [MainThread]: checksum: 518582be7b55697d4b7425a2eabd56b025e80bae3faea46064d56fa479f3a66b, vars: {'run_date': '2023-06-22'}, profile: , target: , version: 1.5.1
[0m12:13:08.084492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:13:08.084983 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:13:08.085891 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m12:13:08.094094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03c36523-c754-4b5a-9b04-6f4774a06264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f172b28d550>]}
[0m12:13:08.104502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03c36523-c754-4b5a-9b04-6f4774a06264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f172b2fe400>]}
[0m12:13:08.105115 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:13:08.105612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03c36523-c754-4b5a-9b04-6f4774a06264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f172b2fe550>]}
[0m12:13:08.107688 [info ] [MainThread]: 
[0m12:13:08.108740 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:13:08.110548 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:13:08.132043 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:13:08.132629 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:13:08.133115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:08.858259 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:13:08.861801 [debug] [ThreadPool]: On list_external_db: Close
[0m12:13:08.975125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now create_external_db_final_sales)
[0m12:13:08.976187 [debug] [ThreadPool]: Creating schema "database: "external_db"
schema: "final_sales"
"
[0m12:13:08.983882 [debug] [ThreadPool]: Using snowflake connection "create_external_db_final_sales"
[0m12:13:08.984329 [debug] [ThreadPool]: On create_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "create_external_db_final_sales"} */
create schema if not exists external_db.final_sales
[0m12:13:08.984960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:09.447634 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:13:09.449629 [debug] [ThreadPool]: On create_external_db_final_sales: Close
[0m12:13:09.568032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_external_db_final_sales, now list_external_db_final_sales)
[0m12:13:09.578817 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:13:09.579494 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:13:09.579950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:13:09.891303 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m12:13:09.893765 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:13:10.009417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03c36523-c754-4b5a-9b04-6f4774a06264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f172c443970>]}
[0m12:13:10.010913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:13:10.012008 [info ] [MainThread]: 
[0m12:13:10.017625 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:13:10.018450 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:13:10.019985 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:13:10.020540 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:13:10.026530 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:13:10.027562 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:13:10.021061 => 12:13:10.027195
[0m12:13:10.028151 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:13:10.116286 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m12:13:10.117882 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:13:10.118445 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace transient table external_db.final_sales.bronze_customers
         as
        (

with customers as (
     select *, 
     2023-06-22 as run_date  from external_db.stage.customers
)

select * from customers
        );
[0m12:13:10.119013 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:13:10.959492 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:13:10.970558 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:13:10.971113 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m12:13:11.037506 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:13:11.076379 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:13:10.028537 => 12:13:11.075999
[0m12:13:11.077133 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:13:11.189711 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03c36523-c754-4b5a-9b04-6f4774a06264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f172b28d8b0>]}
[0m12:13:11.190973 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 1[0m in 1.17s]
[0m12:13:11.192513 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:13:11.193188 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:13:11.194110 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:13:11.195229 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:13:11.195841 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:13:11.201027 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:13:11.201939 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:13:11.196169 => 12:13:11.201622
[0m12:13:11.202444 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:13:11.207123 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:13:11.208409 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:13:11.209022 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace transient table external_db.final_sales.bronze_orders
         as
        (

with orders as (
     select *, 
     2023-06-22 :: timestamp as run_date from external_db.stage.orders
)

select * from orders
        );
[0m12:13:11.209485 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:13:11.556752 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad231d-0000-fb4f-0000-0001937eb351
[0m12:13:11.557444 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001044 (42P13): SQL compilation error: error line 7 at position 12
Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:13:11.558338 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:13:11.202767 => 12:13:11.557959
[0m12:13:11.558984 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:13:11.673446 [debug] [Thread-1  ]: Database Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)
  001044 (42P13): SQL compilation error: error line 7 at position 12
  Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
  compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:13:11.674257 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03c36523-c754-4b5a-9b04-6f4774a06264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1728d49e80>]}
[0m12:13:11.675090 [error] [Thread-1  ]: 2 of 7 ERROR creating sql incremental model final_sales.bronze_orders .......... [[31mERROR[0m in 0.48s]
[0m12:13:11.675916 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:13:11.676790 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:13:11.677576 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:13:11.678770 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:13:11.679279 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:13:11.685332 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:13:11.686525 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:13:11.679589 => 12:13:11.686147
[0m12:13:11.687169 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:13:11.691572 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:13:11.692840 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:13:11.693413 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace transient table external_db.final_sales.bronze_payments
         as
        (

with payments as (
     select *, 
     2023-06-22 :: timestamp as run_date from external_db.stage.payments
)

select * from payments
        );
[0m12:13:11.693967 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:13:11.988257 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad231d-0000-fb87-0000-0001937ec361
[0m12:13:11.989071 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001044 (42P13): SQL compilation error: error line 7 at position 12
Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:13:11.989908 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:13:11.687487 => 12:13:11.989531
[0m12:13:11.990491 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:13:12.088725 [debug] [Thread-1  ]: Database Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)
  001044 (42P13): SQL compilation error: error line 7 at position 12
  Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
  compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m12:13:12.089541 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03c36523-c754-4b5a-9b04-6f4774a06264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1728d2b8b0>]}
[0m12:13:12.090324 [error] [Thread-1  ]: 3 of 7 ERROR creating sql incremental model final_sales.bronze_payments ........ [[31mERROR[0m in 0.41s]
[0m12:13:12.091276 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:13:12.092120 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:13:12.092885 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:13:12.093886 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:13:12.094412 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:13:12.101324 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:13:12.102450 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:13:12.094953 => 12:13:12.102047
[0m12:13:12.102960 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:13:12.107239 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:13:12.108466 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:13:12.109026 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace transient table external_db.final_sales.bronze_products
         as
        (

with products as (
     select *, 
     2023-06-22 :: timestamp as run_date from external_db.stage.products
)

select * from products
        );
[0m12:13:12.109489 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:13:12.444243 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad231d-0000-fb87-0000-0001937ec365
[0m12:13:12.445062 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001044 (42P13): SQL compilation error: error line 7 at position 12
Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:13:12.445908 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:13:12.103258 => 12:13:12.445558
[0m12:13:12.446470 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:13:12.574787 [debug] [Thread-1  ]: Database Error in model bronze_products (models/sales/bronze/bronze_products.sql)
  001044 (42P13): SQL compilation error: error line 7 at position 12
  Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
  compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m12:13:12.575672 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03c36523-c754-4b5a-9b04-6f4774a06264', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1728c06d60>]}
[0m12:13:12.577094 [error] [Thread-1  ]: 4 of 7 ERROR creating sql incremental model final_sales.bronze_products ........ [[31mERROR[0m in 0.48s]
[0m12:13:12.577900 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:13:12.578639 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:13:12.580636 [info ] [Thread-1  ]: 5 of 7 SKIP relation final_sales.fct_payment_details ........................... [[33mSKIP[0m]
[0m12:13:12.581552 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:13:12.582130 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:13:12.582723 [info ] [Thread-1  ]: 6 of 7 SKIP relation final_sales.fct_order_detail .............................. [[33mSKIP[0m]
[0m12:13:12.583505 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:13:12.584711 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:13:12.585268 [info ] [Thread-1  ]: 7 of 7 SKIP relation final_sales.product_sales ................................. [[33mSKIP[0m]
[0m12:13:12.586090 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:13:12.589022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:12.589536 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m12:13:12.589985 [info ] [MainThread]: 
[0m12:13:12.590530 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m12:13:12.591739 [debug] [MainThread]: Command end result
[0m12:13:12.601104 [info ] [MainThread]: 
[0m12:13:12.601786 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:13:12.602321 [info ] [MainThread]: 
[0m12:13:12.602826 [error] [MainThread]: [33mDatabase Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)[0m
[0m12:13:12.603585 [error] [MainThread]:   001044 (42P13): SQL compilation error: error line 7 at position 12
[0m12:13:12.604153 [error] [MainThread]:   Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:13:12.604894 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:13:12.605409 [info ] [MainThread]: 
[0m12:13:12.605953 [error] [MainThread]: [33mDatabase Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)[0m
[0m12:13:12.606611 [error] [MainThread]:   001044 (42P13): SQL compilation error: error line 7 at position 12
[0m12:13:12.607141 [error] [MainThread]:   Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:13:12.607699 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m12:13:12.608305 [info ] [MainThread]: 
[0m12:13:12.608898 [error] [MainThread]: [33mDatabase Error in model bronze_products (models/sales/bronze/bronze_products.sql)[0m
[0m12:13:12.613715 [error] [MainThread]:   001044 (42P13): SQL compilation error: error line 7 at position 12
[0m12:13:12.614327 [error] [MainThread]:   Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:13:12.614935 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m12:13:12.615431 [info ] [MainThread]: 
[0m12:13:12.615997 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=3 TOTAL=7
[0m12:13:12.617233 [debug] [MainThread]: Command `dbt run` failed at 12:13:12.617016 after 5.01 seconds
[0m12:13:12.617928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f173227f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f172c4873a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1728c06d60>]}
[0m12:13:12.618533 [debug] [MainThread]: Flushing usage events
[0m12:15:55.892956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6600d4d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ff6505b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ff650520>]}


============================== 12:15:55.896773 | 6e4f9775-830a-48a3-93ee-1723ea94b41e ==============================
[0m12:15:55.896773 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:15:55.897492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:15:56.255416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e4f9775-830a-48a3-93ee-1723ea94b41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65faf45100>]}
[0m12:15:56.278937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e4f9775-830a-48a3-93ee-1723ea94b41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65faf41670>]}
[0m12:15:56.300178 [debug] [MainThread]: checksum: 518582be7b55697d4b7425a2eabd56b025e80bae3faea46064d56fa479f3a66b, vars: {'run_date': '2023-06-22'}, profile: , target: , version: 1.5.1
[0m12:15:56.311626 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m12:15:56.312372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6e4f9775-830a-48a3-93ee-1723ea94b41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65faef5a90>]}
[0m12:15:57.289184 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_order_detail.sql
[0m12:15:57.317830 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_order_detail.sql
[0m12:15:57.321300 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_payment_details.sql
[0m12:15:57.328359 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_payment_details.sql
[0m12:15:57.332034 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m12:15:57.339120 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m12:15:57.342115 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m12:15:57.349760 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m12:15:57.352664 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m12:15:57.358963 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m12:15:57.361888 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m12:15:57.368530 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m12:15:57.371392 [debug] [MainThread]: 1603: static parser failed on sales/core/product_sales.sql
[0m12:15:57.381026 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/core/product_sales.sql
[0m12:15:57.554399 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.bronze
- models.development.staging
[0m12:15:57.562710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e4f9775-830a-48a3-93ee-1723ea94b41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65f98ef400>]}
[0m12:15:57.572658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e4f9775-830a-48a3-93ee-1723ea94b41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65faf1bd60>]}
[0m12:15:57.573425 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:15:57.574166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e4f9775-830a-48a3-93ee-1723ea94b41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6600932bb0>]}
[0m12:15:57.576542 [info ] [MainThread]: 
[0m12:15:57.577699 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:15:57.579877 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:15:57.599622 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:15:57.600263 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:15:57.600755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:58.382889 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:15:58.386282 [debug] [ThreadPool]: On list_external_db: Close
[0m12:15:58.514325 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m12:15:58.524986 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:15:58.525495 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:15:58.525904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:15:58.839822 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:15:58.842164 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:15:58.969271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e4f9775-830a-48a3-93ee-1723ea94b41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65f98eea00>]}
[0m12:15:58.970775 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:15:58.971530 [info ] [MainThread]: 
[0m12:15:58.978345 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:15:58.979107 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:15:58.979980 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:15:58.980650 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:15:58.986144 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:15:58.987268 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:15:58.981105 => 12:15:58.986788
[0m12:15:58.987865 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:15:59.065393 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:15:59.066282 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     2023-06-22 as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m12:15:59.066789 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:15:59.486649 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:15:59.500831 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:15:59.501550 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m12:15:59.584922 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:15:59.592546 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:15:59.593251 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m12:15:59.670703 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:15:59.683549 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:15:59.684220 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m12:15:59.746295 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:15:59.793953 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m12:15:59.795781 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:15:59.796289 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m12:15:59.882113 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:15:59.882865 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:15:59.883345 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m12:16:00.338574 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:16:00.339501 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:16:00.339994 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m12:16:00.577983 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:16:00.589817 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:16:00.590351 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m12:16:00.687881 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:16:00.717920 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:15:58.988243 => 12:16:00.717583
[0m12:16:00.718615 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:16:00.847706 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e4f9775-830a-48a3-93ee-1723ea94b41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65f8cb0eb0>]}
[0m12:16:00.848903 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 10[0m in 1.87s]
[0m12:16:00.849864 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:16:00.850532 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:16:00.851151 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:16:00.852777 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:16:00.853331 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:16:00.858377 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:16:00.859346 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:16:00.853677 => 12:16:00.859019
[0m12:16:00.859969 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:16:00.884024 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:16:00.885761 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:16:00.886300 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace transient table external_db.final_sales.bronze_orders
         as
        (

with orders as (
     select *, 
     2023-06-22 :: timestamp as run_date from external_db.stage.orders
)

select * from orders
        );
[0m12:16:00.886802 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:16:01.241766 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2320-0000-fb4f-0000-0001937eb371
[0m12:16:01.242821 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001044 (42P13): SQL compilation error: error line 7 at position 12
Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:16:01.243621 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:16:00.860310 => 12:16:01.243280
[0m12:16:01.244500 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:16:01.356629 [debug] [Thread-1  ]: Database Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)
  001044 (42P13): SQL compilation error: error line 7 at position 12
  Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
  compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:16:01.357526 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e4f9775-830a-48a3-93ee-1723ea94b41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65f82c96a0>]}
[0m12:16:01.358563 [error] [Thread-1  ]: 2 of 7 ERROR creating sql incremental model final_sales.bronze_orders .......... [[31mERROR[0m in 0.51s]
[0m12:16:01.360053 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:16:01.360787 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:16:01.361536 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:16:01.363109 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:16:01.363691 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:16:01.369337 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:16:01.370300 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:16:01.364099 => 12:16:01.369959
[0m12:16:01.370809 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:16:01.380147 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:16:01.381472 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:16:01.382447 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace transient table external_db.final_sales.bronze_payments
         as
        (

with payments as (
     select *, 
     2023-06-22 :: timestamp as run_date from external_db.stage.payments
)

select * from payments
        );
[0m12:16:01.382968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:16:01.685791 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2320-0000-fb87-0000-0001937ec375
[0m12:16:01.686589 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001044 (42P13): SQL compilation error: error line 7 at position 12
Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:16:01.687411 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:16:01.371574 => 12:16:01.687054
[0m12:16:01.688024 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:16:01.791643 [debug] [Thread-1  ]: Database Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)
  001044 (42P13): SQL compilation error: error line 7 at position 12
  Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
  compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m12:16:01.792631 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e4f9775-830a-48a3-93ee-1723ea94b41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65f8cb0d90>]}
[0m12:16:01.793550 [error] [Thread-1  ]: 3 of 7 ERROR creating sql incremental model final_sales.bronze_payments ........ [[31mERROR[0m in 0.43s]
[0m12:16:01.794392 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:16:01.795116 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:16:01.795995 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:16:01.797646 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:16:01.798400 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:16:01.803834 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:16:01.805274 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:16:01.798757 => 12:16:01.804895
[0m12:16:01.805796 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:16:01.811159 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:16:01.812374 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:16:01.813344 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace transient table external_db.final_sales.bronze_products
         as
        (

with products as (
     select *, 
     2023-06-22 :: timestamp as run_date from external_db.stage.products
)

select * from products
        );
[0m12:16:01.813985 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:16:02.288321 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2320-0000-fb4f-0000-0001937eb375
[0m12:16:02.289062 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001044 (42P13): SQL compilation error: error line 7 at position 12
Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:16:02.289972 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:16:01.806177 => 12:16:02.289574
[0m12:16:02.290541 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:16:02.407006 [debug] [Thread-1  ]: Database Error in model bronze_products (models/sales/bronze/bronze_products.sql)
  001044 (42P13): SQL compilation error: error line 7 at position 12
  Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
  compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m12:16:02.407863 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e4f9775-830a-48a3-93ee-1723ea94b41e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65f83b0ca0>]}
[0m12:16:02.409041 [error] [Thread-1  ]: 4 of 7 ERROR creating sql incremental model final_sales.bronze_products ........ [[31mERROR[0m in 0.61s]
[0m12:16:02.409876 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:16:02.411017 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:16:02.411647 [info ] [Thread-1  ]: 5 of 7 SKIP relation final_sales.fct_payment_details ........................... [[33mSKIP[0m]
[0m12:16:02.412343 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:16:02.413569 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:16:02.414229 [info ] [Thread-1  ]: 6 of 7 SKIP relation final_sales.fct_order_detail .............................. [[33mSKIP[0m]
[0m12:16:02.414910 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:16:02.416158 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:16:02.416756 [info ] [Thread-1  ]: 7 of 7 SKIP relation final_sales.product_sales ................................. [[33mSKIP[0m]
[0m12:16:02.417723 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:16:02.419743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:02.420164 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m12:16:02.420651 [info ] [MainThread]: 
[0m12:16:02.421549 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 4.84 seconds (4.84s).
[0m12:16:02.423611 [debug] [MainThread]: Command end result
[0m12:16:02.433420 [info ] [MainThread]: 
[0m12:16:02.434112 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m12:16:02.434759 [info ] [MainThread]: 
[0m12:16:02.435319 [error] [MainThread]: [33mDatabase Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)[0m
[0m12:16:02.435786 [error] [MainThread]:   001044 (42P13): SQL compilation error: error line 7 at position 12
[0m12:16:02.436244 [error] [MainThread]:   Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:16:02.436821 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:16:02.437349 [info ] [MainThread]: 
[0m12:16:02.437970 [error] [MainThread]: [33mDatabase Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)[0m
[0m12:16:02.438459 [error] [MainThread]:   001044 (42P13): SQL compilation error: error line 7 at position 12
[0m12:16:02.439088 [error] [MainThread]:   Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:16:02.439571 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m12:16:02.440062 [info ] [MainThread]: 
[0m12:16:02.440526 [error] [MainThread]: [33mDatabase Error in model bronze_products (models/sales/bronze/bronze_products.sql)[0m
[0m12:16:02.441019 [error] [MainThread]:   001044 (42P13): SQL compilation error: error line 7 at position 12
[0m12:16:02.441585 [error] [MainThread]:   Invalid argument types for function '-': (NUMBER(5,0), TIMESTAMP_NTZ(0))
[0m12:16:02.442034 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m12:16:02.442502 [info ] [MainThread]: 
[0m12:16:02.443094 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=3 TOTAL=7
[0m12:16:02.444200 [debug] [MainThread]: Command `dbt run` failed at 12:16:02.444030 after 6.57 seconds
[0m12:16:02.444800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6600d4d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65ffedb280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65f98efa00>]}
[0m12:16:02.445378 [debug] [MainThread]: Flushing usage events
[0m12:19:40.265557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406a3824c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4068c855e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4068c85160>]}


============================== 12:19:40.269254 | 4d3cb3f4-2fc8-4bda-933c-74e3c9db3dda ==============================
[0m12:19:40.269254 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:19:40.269963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'dags/dbt/logs', 'profiles_dir': 'dags/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:19:40.588457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d3cb3f4-2fc8-4bda-933c-74e3c9db3dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4064578100>]}
[0m12:19:40.612729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d3cb3f4-2fc8-4bda-933c-74e3c9db3dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40645750a0>]}
[0m12:19:40.630756 [debug] [MainThread]: checksum: 518582be7b55697d4b7425a2eabd56b025e80bae3faea46064d56fa479f3a66b, vars: {'run_date': '2023-06-22'}, profile: , target: , version: 1.5.1
[0m12:19:40.659037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m12:19:40.659867 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_customers.sql
[0m12:19:40.660479 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_payments.sql
[0m12:19:40.661152 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_orders.sql
[0m12:19:40.661820 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_products.sql
[0m12:19:40.695092 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m12:19:40.715680 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m12:19:40.718405 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m12:19:40.725559 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m12:19:40.728704 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m12:19:40.734923 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m12:19:40.737488 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m12:19:40.744601 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m12:19:40.778072 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.intermediate
- models.development.bronze
[0m12:19:40.784035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d3cb3f4-2fc8-4bda-933c-74e3c9db3dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4062f18ee0>]}
[0m12:19:40.792991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d3cb3f4-2fc8-4bda-933c-74e3c9db3dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40633bc2e0>]}
[0m12:19:40.793566 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:19:40.794097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d3cb3f4-2fc8-4bda-933c-74e3c9db3dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40633bc430>]}
[0m12:19:40.796111 [info ] [MainThread]: 
[0m12:19:40.796999 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:19:40.798798 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:19:40.816527 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:19:40.817186 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:19:40.818064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:41.646608 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:19:41.649700 [debug] [ThreadPool]: On list_external_db: Close
[0m12:19:41.747865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m12:19:41.758116 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:19:41.758543 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:19:41.758999 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:42.056527 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:19:42.059113 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:19:42.165516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d3cb3f4-2fc8-4bda-933c-74e3c9db3dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4064529bb0>]}
[0m12:19:42.166930 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:19:42.167579 [info ] [MainThread]: 
[0m12:19:42.176337 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:19:42.177237 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:19:42.178269 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:19:42.178851 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:19:42.187073 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:19:42.188293 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:19:42.179232 => 12:19:42.187909
[0m12:19:42.188826 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:19:42.269868 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:19:42.271222 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     2023-06-22:: date as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m12:19:42.271817 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:42.587125 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2323-0000-fb87-0000-0001937ec379
[0m12:19:42.588142 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001007 (22023): SQL compilation error:
invalid type [CAST(22 AS DATE)] for parameter 'TO_DATE'
[0m12:19:42.589750 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:19:42.189176 => 12:19:42.589150
[0m12:19:42.591017 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:19:42.704025 [debug] [Thread-1  ]: Database Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)
  001007 (22023): SQL compilation error:
  invalid type [CAST(22 AS DATE)] for parameter 'TO_DATE'
[0m12:19:42.704903 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3cb3f4-2fc8-4bda-933c-74e3c9db3dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40621dc100>]}
[0m12:19:42.705969 [error] [Thread-1  ]: 1 of 7 ERROR creating sql incremental model final_sales.bronze_customers ....... [[31mERROR[0m in 0.53s]
[0m12:19:42.706792 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:19:42.707707 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:19:42.708372 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:19:42.710063 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:19:42.710991 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:19:42.718101 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:19:42.718971 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:19:42.712253 => 12:19:42.718660
[0m12:19:42.719419 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:19:42.743103 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:19:42.744482 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:19:42.745129 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace transient table external_db.final_sales.bronze_orders
         as
        (

with orders as (
     select *, 
     2023-06-22 :: date as run_date from external_db.stage.orders
)

select * from orders
        );
[0m12:19:42.745637 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:43.286002 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2323-0000-fb4f-0000-0001937eb381
[0m12:19:43.286730 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001007 (22023): SQL compilation error:
invalid type [CAST(22 AS DATE)] for parameter 'TO_DATE'
[0m12:19:43.287559 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:19:42.719717 => 12:19:43.287213
[0m12:19:43.288138 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:19:43.386686 [debug] [Thread-1  ]: Database Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)
  001007 (22023): SQL compilation error:
  invalid type [CAST(22 AS DATE)] for parameter 'TO_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:19:43.387620 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3cb3f4-2fc8-4bda-933c-74e3c9db3dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40621ea730>]}
[0m12:19:43.388685 [error] [Thread-1  ]: 2 of 7 ERROR creating sql incremental model final_sales.bronze_orders .......... [[31mERROR[0m in 0.68s]
[0m12:19:43.389500 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:19:43.390175 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:19:43.390895 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:19:43.392305 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:19:43.392946 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:19:43.400183 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:19:43.401184 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:19:43.393331 => 12:19:43.400817
[0m12:19:43.401691 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:19:43.471026 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:19:43.472399 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:19:43.472896 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace transient table external_db.final_sales.bronze_payments
         as
        (

with payments as (
     select *, 
     2023-06-22 :: date as run_date from external_db.stage.payments
)

select * from payments
        );
[0m12:19:43.473524 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:43.797215 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2323-0000-fb87-0000-0001937ec37d
[0m12:19:43.797892 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001007 (22023): SQL compilation error:
invalid type [CAST(22 AS DATE)] for parameter 'TO_DATE'
[0m12:19:43.798779 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:19:43.401998 => 12:19:43.798454
[0m12:19:43.799406 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:19:43.903348 [debug] [Thread-1  ]: Database Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)
  001007 (22023): SQL compilation error:
  invalid type [CAST(22 AS DATE)] for parameter 'TO_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m12:19:43.904284 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3cb3f4-2fc8-4bda-933c-74e3c9db3dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406097f970>]}
[0m12:19:43.905287 [error] [Thread-1  ]: 3 of 7 ERROR creating sql incremental model final_sales.bronze_payments ........ [[31mERROR[0m in 0.51s]
[0m12:19:43.906162 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:19:43.907390 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:19:43.908407 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:19:43.909844 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:19:43.910709 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:19:43.915665 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:19:43.916679 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:19:43.911102 => 12:19:43.916340
[0m12:19:43.917222 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:19:43.921827 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:19:43.922845 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:19:43.923458 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace transient table external_db.final_sales.bronze_products
         as
        (

with products as (
     select *, 
     2023-06-22 :: date as run_date from external_db.stage.products
)

select * from products
        );
[0m12:19:43.923905 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:19:44.240784 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2323-0000-fb4f-0000-0001937eb385
[0m12:19:44.241577 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001007 (22023): SQL compilation error:
invalid type [CAST(22 AS DATE)] for parameter 'TO_DATE'
[0m12:19:44.242419 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:19:43.917548 => 12:19:44.242054
[0m12:19:44.243024 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:19:44.341740 [debug] [Thread-1  ]: Database Error in model bronze_products (models/sales/bronze/bronze_products.sql)
  001007 (22023): SQL compilation error:
  invalid type [CAST(22 AS DATE)] for parameter 'TO_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m12:19:44.342561 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d3cb3f4-2fc8-4bda-933c-74e3c9db3dda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40622a31c0>]}
[0m12:19:44.343483 [error] [Thread-1  ]: 4 of 7 ERROR creating sql incremental model final_sales.bronze_products ........ [[31mERROR[0m in 0.43s]
[0m12:19:44.344818 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:19:44.345557 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:19:44.346278 [info ] [Thread-1  ]: 5 of 7 SKIP relation final_sales.fct_payment_details ........................... [[33mSKIP[0m]
[0m12:19:44.347242 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:19:44.348475 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:19:44.349118 [info ] [Thread-1  ]: 6 of 7 SKIP relation final_sales.fct_order_detail .............................. [[33mSKIP[0m]
[0m12:19:44.349830 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:19:44.351274 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:19:44.351838 [info ] [Thread-1  ]: 7 of 7 SKIP relation final_sales.product_sales ................................. [[33mSKIP[0m]
[0m12:19:44.352561 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:19:44.354782 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:44.355264 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m12:19:44.355740 [info ] [MainThread]: 
[0m12:19:44.356271 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 3.56 seconds (3.56s).
[0m12:19:44.357613 [debug] [MainThread]: Command end result
[0m12:19:44.366767 [info ] [MainThread]: 
[0m12:19:44.367490 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m12:19:44.368101 [info ] [MainThread]: 
[0m12:19:44.368655 [error] [MainThread]: [33mDatabase Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)[0m
[0m12:19:44.369248 [error] [MainThread]:   001007 (22023): SQL compilation error:
[0m12:19:44.369734 [error] [MainThread]:   invalid type [CAST(22 AS DATE)] for parameter 'TO_DATE'
[0m12:19:44.370201 [info ] [MainThread]: 
[0m12:19:44.370752 [error] [MainThread]: [33mDatabase Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)[0m
[0m12:19:44.371308 [error] [MainThread]:   001007 (22023): SQL compilation error:
[0m12:19:44.371770 [error] [MainThread]:   invalid type [CAST(22 AS DATE)] for parameter 'TO_DATE'
[0m12:19:44.372276 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:19:44.372817 [info ] [MainThread]: 
[0m12:19:44.373297 [error] [MainThread]: [33mDatabase Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)[0m
[0m12:19:44.373769 [error] [MainThread]:   001007 (22023): SQL compilation error:
[0m12:19:44.374228 [error] [MainThread]:   invalid type [CAST(22 AS DATE)] for parameter 'TO_DATE'
[0m12:19:44.374706 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m12:19:44.375318 [info ] [MainThread]: 
[0m12:19:44.375816 [error] [MainThread]: [33mDatabase Error in model bronze_products (models/sales/bronze/bronze_products.sql)[0m
[0m12:19:44.376326 [error] [MainThread]:   001007 (22023): SQL compilation error:
[0m12:19:44.376845 [error] [MainThread]:   invalid type [CAST(22 AS DATE)] for parameter 'TO_DATE'
[0m12:19:44.377324 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m12:19:44.377855 [info ] [MainThread]: 
[0m12:19:44.378468 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=3 TOTAL=7
[0m12:19:44.379787 [debug] [MainThread]: Command `dbt run` failed at 12:19:44.379617 after 4.14 seconds
[0m12:19:44.380311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406a3824c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f40645750a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f406097f970>]}
[0m12:19:44.380860 [debug] [MainThread]: Flushing usage events
[0m12:21:48.227034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34c5f5b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34c48855b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34c4885100>]}


============================== 12:21:48.235132 | d459e4cf-cb51-495f-bdc7-6e29a5c87584 ==============================
[0m12:21:48.235132 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:21:48.236868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:21:48.586840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd459e4cf-cb51-495f-bdc7-6e29a5c87584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34c017a040>]}
[0m12:21:48.607338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd459e4cf-cb51-495f-bdc7-6e29a5c87584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34c0176070>]}
[0m12:21:48.624110 [debug] [MainThread]: checksum: 518582be7b55697d4b7425a2eabd56b025e80bae3faea46064d56fa479f3a66b, vars: {'run_date': '2023-06-22'}, profile: , target: , version: 1.5.1
[0m12:21:48.654441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m12:21:48.655222 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_payments.sql
[0m12:21:48.655925 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_orders.sql
[0m12:21:48.656541 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_products.sql
[0m12:21:48.657314 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_customers.sql
[0m12:21:48.689891 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m12:21:48.709767 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m12:21:48.712978 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m12:21:48.720203 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m12:21:48.723144 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m12:21:48.729611 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m12:21:48.732237 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m12:21:48.738769 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m12:21:48.773467 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m12:21:48.781125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd459e4cf-cb51-495f-bdc7-6e29a5c87584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34bef70f40>]}
[0m12:21:48.790238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd459e4cf-cb51-495f-bdc7-6e29a5c87584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34befbe340>]}
[0m12:21:48.790838 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:21:48.791361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd459e4cf-cb51-495f-bdc7-6e29a5c87584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34befbe490>]}
[0m12:21:48.793371 [info ] [MainThread]: 
[0m12:21:48.794459 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:21:48.796536 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:21:48.818165 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:21:48.818841 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:21:48.819474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:49.540004 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:21:49.543300 [debug] [ThreadPool]: On list_external_db: Close
[0m12:21:49.657101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m12:21:49.667163 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:21:49.667596 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:21:49.668012 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:50.110100 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:21:50.112513 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:21:50.207725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd459e4cf-cb51-495f-bdc7-6e29a5c87584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34c01292e0>]}
[0m12:21:50.209130 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:21:50.209925 [info ] [MainThread]: 
[0m12:21:50.216348 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:21:50.217250 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:21:50.218242 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:21:50.218909 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:21:50.224738 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:21:50.225798 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:21:50.219448 => 12:21:50.225440
[0m12:21:50.226289 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:21:50.292526 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:21:50.293134 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date(2023-06-22) as run_date as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m12:21:50.293647 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:21:50.602282 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2325-0000-fb87-0000-0001937ec381
[0m12:21:50.603002 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 37 unexpected 'as'.
syntax error line 11 at position 0 unexpected 'select'.
[0m12:21:50.603792 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:21:50.226614 => 12:21:50.603470
[0m12:21:50.604311 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:21:50.708740 [debug] [Thread-1  ]: Database Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 37 unexpected 'as'.
  syntax error line 11 at position 0 unexpected 'select'.
[0m12:21:50.709718 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd459e4cf-cb51-495f-bdc7-6e29a5c87584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34bc576250>]}
[0m12:21:50.710586 [error] [Thread-1  ]: 1 of 7 ERROR creating sql incremental model final_sales.bronze_customers ....... [[31mERROR[0m in 0.49s]
[0m12:21:50.711377 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:21:50.712017 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:21:50.712670 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:21:50.713908 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:21:50.714743 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:21:50.719847 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:21:50.720815 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:21:50.715245 => 12:21:50.720407
[0m12:21:50.721319 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:21:50.743923 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:21:50.745648 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:21:50.746216 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace transient table external_db.final_sales.bronze_orders
         as
        (

with orders as (
     select *, 
     to_date(2023-06-22) as run_date as run_date from external_db.stage.orders
)

select * from orders
        );
[0m12:21:50.746707 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:21:51.016006 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2325-0000-fb4f-0000-0001937eb391
[0m12:21:51.016794 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 37 unexpected 'as'.
syntax error line 10 at position 0 unexpected 'select'.
[0m12:21:51.017625 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:21:50.721669 => 12:21:51.017236
[0m12:21:51.018250 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:21:51.121159 [debug] [Thread-1  ]: Database Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 37 unexpected 'as'.
  syntax error line 10 at position 0 unexpected 'select'.
  compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:21:51.122027 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd459e4cf-cb51-495f-bdc7-6e29a5c87584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34bdeab580>]}
[0m12:21:51.123033 [error] [Thread-1  ]: 2 of 7 ERROR creating sql incremental model final_sales.bronze_orders .......... [[31mERROR[0m in 0.41s]
[0m12:21:51.123877 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:21:51.124577 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:21:51.125271 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:21:51.127221 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:21:51.127867 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:21:51.134014 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:21:51.135076 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:21:51.128227 => 12:21:51.134692
[0m12:21:51.135681 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:21:51.142580 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:21:51.144716 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:21:51.145341 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace transient table external_db.final_sales.bronze_payments
         as
        (

with payments as (
     select *, 
     to_date(2023-06-22) as run_date from external_db.stage.payments
)

select * from payments
        );
[0m12:21:51.145958 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:21:51.531839 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2325-0000-fb87-0000-0001937ec385
[0m12:21:51.532639 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001007 (22023): SQL compilation error:
invalid type [TO_DATE((2023 - 6) - 22)] for parameter 'TO_DATE'
[0m12:21:51.533509 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:21:51.136098 => 12:21:51.533146
[0m12:21:51.534100 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:21:51.639394 [debug] [Thread-1  ]: Database Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)
  001007 (22023): SQL compilation error:
  invalid type [TO_DATE((2023 - 6) - 22)] for parameter 'TO_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m12:21:51.640314 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd459e4cf-cb51-495f-bdc7-6e29a5c87584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34bdea65e0>]}
[0m12:21:51.641353 [error] [Thread-1  ]: 3 of 7 ERROR creating sql incremental model final_sales.bronze_payments ........ [[31mERROR[0m in 0.51s]
[0m12:21:51.642134 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:21:51.642792 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:21:51.643533 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:21:51.645045 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:21:51.645588 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:21:51.650931 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:21:51.652030 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:21:51.646079 => 12:21:51.651638
[0m12:21:51.652545 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:21:51.657654 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:21:51.658915 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:21:51.659462 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace transient table external_db.final_sales.bronze_products
         as
        (

with products as (
     select *, 
     to_date(2023-06-22) as run_date from external_db.stage.products
)

select * from products
        );
[0m12:21:51.660049 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:21:51.937551 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2325-0000-fb4f-0000-0001937eb395
[0m12:21:51.938411 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001007 (22023): SQL compilation error:
invalid type [TO_DATE((2023 - 6) - 22)] for parameter 'TO_DATE'
[0m12:21:51.939289 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:21:51.652930 => 12:21:51.938936
[0m12:21:51.939799 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:21:52.034775 [debug] [Thread-1  ]: Database Error in model bronze_products (models/sales/bronze/bronze_products.sql)
  001007 (22023): SQL compilation error:
  invalid type [TO_DATE((2023 - 6) - 22)] for parameter 'TO_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m12:21:52.035675 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd459e4cf-cb51-495f-bdc7-6e29a5c87584', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34bc4a73d0>]}
[0m12:21:52.036666 [error] [Thread-1  ]: 4 of 7 ERROR creating sql incremental model final_sales.bronze_products ........ [[31mERROR[0m in 0.39s]
[0m12:21:52.037461 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:21:52.038106 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:21:52.038708 [info ] [Thread-1  ]: 5 of 7 SKIP relation final_sales.fct_payment_details ........................... [[33mSKIP[0m]
[0m12:21:52.039486 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:21:52.040555 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:21:52.041206 [info ] [Thread-1  ]: 6 of 7 SKIP relation final_sales.fct_order_detail .............................. [[33mSKIP[0m]
[0m12:21:52.041988 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:21:52.043353 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:21:52.043976 [info ] [Thread-1  ]: 7 of 7 SKIP relation final_sales.product_sales ................................. [[33mSKIP[0m]
[0m12:21:52.044627 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:21:52.046635 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:52.047033 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m12:21:52.047484 [info ] [MainThread]: 
[0m12:21:52.047999 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m12:21:52.049423 [debug] [MainThread]: Command end result
[0m12:21:52.058914 [info ] [MainThread]: 
[0m12:21:52.059568 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m12:21:52.060090 [info ] [MainThread]: 
[0m12:21:52.060638 [error] [MainThread]: [33mDatabase Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)[0m
[0m12:21:52.061167 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m12:21:52.061774 [error] [MainThread]:   syntax error line 8 at position 37 unexpected 'as'.
[0m12:21:52.062325 [error] [MainThread]:   syntax error line 11 at position 0 unexpected 'select'.
[0m12:21:52.062820 [info ] [MainThread]: 
[0m12:21:52.063682 [error] [MainThread]: [33mDatabase Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)[0m
[0m12:21:52.064338 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m12:21:52.064888 [error] [MainThread]:   syntax error line 7 at position 37 unexpected 'as'.
[0m12:21:52.065501 [error] [MainThread]:   syntax error line 10 at position 0 unexpected 'select'.
[0m12:21:52.066516 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:21:52.067081 [info ] [MainThread]: 
[0m12:21:52.067616 [error] [MainThread]: [33mDatabase Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)[0m
[0m12:21:52.068162 [error] [MainThread]:   001007 (22023): SQL compilation error:
[0m12:21:52.068766 [error] [MainThread]:   invalid type [TO_DATE((2023 - 6) - 22)] for parameter 'TO_DATE'
[0m12:21:52.069388 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m12:21:52.069912 [info ] [MainThread]: 
[0m12:21:52.070424 [error] [MainThread]: [33mDatabase Error in model bronze_products (models/sales/bronze/bronze_products.sql)[0m
[0m12:21:52.070990 [error] [MainThread]:   001007 (22023): SQL compilation error:
[0m12:21:52.071476 [error] [MainThread]:   invalid type [TO_DATE((2023 - 6) - 22)] for parameter 'TO_DATE'
[0m12:21:52.071997 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m12:21:52.072534 [info ] [MainThread]: 
[0m12:21:52.073267 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=3 TOTAL=7
[0m12:21:52.074244 [debug] [MainThread]: Command `dbt run` failed at 12:21:52.074070 after 3.87 seconds
[0m12:21:52.074775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34c5f5b490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34c0176070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34befbe160>]}
[0m12:21:52.075300 [debug] [MainThread]: Flushing usage events
[0m12:26:44.957565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e2ffd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e1900580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e1900400>]}


============================== 12:26:44.960736 | deaaebed-f619-40eb-a973-a5859c067988 ==============================
[0m12:26:44.960736 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:26:44.961382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:26:45.272204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'deaaebed-f619-40eb-a973-a5859c067988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dd1edf70>]}
[0m12:26:45.293715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'deaaebed-f619-40eb-a973-a5859c067988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dd1ed610>]}
[0m12:26:45.310130 [debug] [MainThread]: checksum: 518582be7b55697d4b7425a2eabd56b025e80bae3faea46064d56fa479f3a66b, vars: {'run_date': '2023-06-22'}, profile: , target: , version: 1.5.1
[0m12:26:45.338104 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m12:26:45.339099 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_orders.sql
[0m12:26:45.339649 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_products.sql
[0m12:26:45.340211 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_payments.sql
[0m12:26:45.340907 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_customers.sql
[0m12:26:45.372768 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m12:26:45.391942 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m12:26:45.394460 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m12:26:45.400727 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m12:26:45.403312 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m12:26:45.409160 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m12:26:45.411922 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m12:26:45.418416 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m12:26:45.455212 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m12:26:45.463037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'deaaebed-f619-40eb-a973-a5859c067988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dbb9ee80>]}
[0m12:26:45.471355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'deaaebed-f619-40eb-a973-a5859c067988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dd078280>]}
[0m12:26:45.471905 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:26:45.472492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deaaebed-f619-40eb-a973-a5859c067988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dd0783d0>]}
[0m12:26:45.474524 [info ] [MainThread]: 
[0m12:26:45.475417 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:26:45.477336 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:26:45.495615 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:26:45.496169 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:26:45.496888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:46.390861 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:26:46.393850 [debug] [ThreadPool]: On list_external_db: Close
[0m12:26:46.491560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m12:26:46.501579 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:26:46.502076 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:26:46.502630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:26:46.929666 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:26:46.932022 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:26:47.033459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deaaebed-f619-40eb-a973-a5859c067988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dd067d00>]}
[0m12:26:47.034972 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:26:47.036224 [info ] [MainThread]: 
[0m12:26:47.041659 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:26:47.042664 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:26:47.043664 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:26:47.044176 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:26:47.049240 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:26:47.050331 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:26:47.044518 => 12:26:47.049971
[0m12:26:47.050903 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:26:47.124751 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:26:47.125526 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date(2023-06-22, 'YYYY-MM-DD') as run_date as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m12:26:47.126068 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:26:47.449314 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad232a-0000-fb87-0000-0001937ec391
[0m12:26:47.450026 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 51 unexpected 'as'.
syntax error line 11 at position 0 unexpected 'select'.
[0m12:26:47.451002 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:26:47.051237 => 12:26:47.450623
[0m12:26:47.451545 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:26:47.561942 [debug] [Thread-1  ]: Database Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 51 unexpected 'as'.
  syntax error line 11 at position 0 unexpected 'select'.
[0m12:26:47.562752 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deaaebed-f619-40eb-a973-a5859c067988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dae5c130>]}
[0m12:26:47.563791 [error] [Thread-1  ]: 1 of 7 ERROR creating sql incremental model final_sales.bronze_customers ....... [[31mERROR[0m in 0.52s]
[0m12:26:47.565147 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:26:47.565921 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:26:47.566901 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:26:47.568128 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:26:47.568707 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:26:47.574609 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:26:47.575949 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:26:47.569047 => 12:26:47.575250
[0m12:26:47.576543 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:26:47.602951 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:26:47.604142 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:26:47.604760 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace transient table external_db.final_sales.bronze_orders
         as
        (

with orders as (
     select *, 
     to_date(2023-06-22, 'YYYY-MM-DD') as run_date as run_date from external_db.stage.orders
)

select * from orders
        );
[0m12:26:47.605261 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:26:47.865470 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad232a-0000-fb87-0000-0001937ec395
[0m12:26:47.866576 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 51 unexpected 'as'.
syntax error line 10 at position 0 unexpected 'select'.
[0m12:26:47.867632 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:26:47.576890 => 12:26:47.867125
[0m12:26:47.868350 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:26:47.957728 [debug] [Thread-1  ]: Database Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 51 unexpected 'as'.
  syntax error line 10 at position 0 unexpected 'select'.
  compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:26:47.958928 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deaaebed-f619-40eb-a973-a5859c067988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82daf10850>]}
[0m12:26:47.960142 [error] [Thread-1  ]: 2 of 7 ERROR creating sql incremental model final_sales.bronze_orders .......... [[31mERROR[0m in 0.39s]
[0m12:26:47.960804 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:26:47.961344 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:26:47.961877 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:26:47.963116 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:26:47.963690 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:26:47.969618 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:26:47.970613 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:26:47.964038 => 12:26:47.970261
[0m12:26:47.971057 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:26:48.034227 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:26:48.035699 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:26:48.036259 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace transient table external_db.final_sales.bronze_payments
         as
        (

with payments as (
     select *, 
     to_date(2023-06-22, 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
        );
[0m12:26:48.036790 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:26:48.365363 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad232a-0000-fb87-0000-0001937ec399
[0m12:26:48.366124 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001007 (22023): SQL compilation error:
invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
[0m12:26:48.366850 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:26:47.971326 => 12:26:48.366544
[0m12:26:48.367407 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:26:48.482799 [debug] [Thread-1  ]: Database Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)
  001007 (22023): SQL compilation error:
  invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m12:26:48.483694 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deaaebed-f619-40eb-a973-a5859c067988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dbfe17f0>]}
[0m12:26:48.484627 [error] [Thread-1  ]: 3 of 7 ERROR creating sql incremental model final_sales.bronze_payments ........ [[31mERROR[0m in 0.52s]
[0m12:26:48.485860 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:26:48.486809 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:26:48.487817 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:26:48.488952 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:26:48.489425 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:26:48.493973 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:26:48.494943 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:26:48.489736 => 12:26:48.494582
[0m12:26:48.495510 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:26:48.499837 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:26:48.500918 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:26:48.501539 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace transient table external_db.final_sales.bronze_products
         as
        (

with products as (
     select *, 
     to_date(2023-06-22,'YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
        );
[0m12:26:48.502158 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:26:48.788742 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad232a-0000-fb4f-0000-0001937eb399
[0m12:26:48.789496 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001007 (22023): SQL compilation error:
invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
[0m12:26:48.790411 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:26:48.495918 => 12:26:48.790075
[0m12:26:48.791011 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:26:48.891305 [debug] [Thread-1  ]: Database Error in model bronze_products (models/sales/bronze/bronze_products.sql)
  001007 (22023): SQL compilation error:
  invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m12:26:48.892264 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deaaebed-f619-40eb-a973-a5859c067988', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dae4eee0>]}
[0m12:26:48.893274 [error] [Thread-1  ]: 4 of 7 ERROR creating sql incremental model final_sales.bronze_products ........ [[31mERROR[0m in 0.40s]
[0m12:26:48.894065 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:26:48.894721 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:26:48.895317 [info ] [Thread-1  ]: 5 of 7 SKIP relation final_sales.fct_payment_details ........................... [[33mSKIP[0m]
[0m12:26:48.896365 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:26:48.897027 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:26:48.897669 [info ] [Thread-1  ]: 6 of 7 SKIP relation final_sales.fct_order_detail .............................. [[33mSKIP[0m]
[0m12:26:48.898671 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:26:48.900879 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:26:48.901489 [info ] [Thread-1  ]: 7 of 7 SKIP relation final_sales.product_sales ................................. [[33mSKIP[0m]
[0m12:26:48.902456 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:26:48.904745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:48.905229 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m12:26:48.905785 [info ] [MainThread]: 
[0m12:26:48.906583 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 3.43 seconds (3.43s).
[0m12:26:48.908219 [debug] [MainThread]: Command end result
[0m12:26:48.918846 [info ] [MainThread]: 
[0m12:26:48.919529 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m12:26:48.920076 [info ] [MainThread]: 
[0m12:26:48.920610 [error] [MainThread]: [33mDatabase Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)[0m
[0m12:26:48.921241 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m12:26:48.921742 [error] [MainThread]:   syntax error line 8 at position 51 unexpected 'as'.
[0m12:26:48.922200 [error] [MainThread]:   syntax error line 11 at position 0 unexpected 'select'.
[0m12:26:48.922661 [info ] [MainThread]: 
[0m12:26:48.923142 [error] [MainThread]: [33mDatabase Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)[0m
[0m12:26:48.923670 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m12:26:48.924140 [error] [MainThread]:   syntax error line 7 at position 51 unexpected 'as'.
[0m12:26:48.924661 [error] [MainThread]:   syntax error line 10 at position 0 unexpected 'select'.
[0m12:26:48.925139 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:26:48.925592 [info ] [MainThread]: 
[0m12:26:48.926036 [error] [MainThread]: [33mDatabase Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)[0m
[0m12:26:48.926471 [error] [MainThread]:   001007 (22023): SQL compilation error:
[0m12:26:48.926907 [error] [MainThread]:   invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
[0m12:26:48.927332 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m12:26:48.927778 [info ] [MainThread]: 
[0m12:26:48.928234 [error] [MainThread]: [33mDatabase Error in model bronze_products (models/sales/bronze/bronze_products.sql)[0m
[0m12:26:48.928729 [error] [MainThread]:   001007 (22023): SQL compilation error:
[0m12:26:48.929195 [error] [MainThread]:   invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
[0m12:26:48.929728 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m12:26:48.930653 [info ] [MainThread]: 
[0m12:26:48.931399 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=3 TOTAL=7
[0m12:26:48.932352 [debug] [MainThread]: Command `dbt run` failed at 12:26:48.932193 after 4.00 seconds
[0m12:26:48.932928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e2ffd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dbb9ee20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82dbfe17f0>]}
[0m12:26:48.933453 [debug] [MainThread]: Flushing usage events
[0m12:33:17.843980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182d237490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182bafa040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182bafa310>]}


============================== 12:33:17.848454 | c06d09dc-5b5e-4b3e-a31a-05cfc773da2f ==============================
[0m12:33:17.848454 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:33:17.849221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:33:18.208175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c06d09dc-5b5e-4b3e-a31a-05cfc773da2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18263a8a90>]}
[0m12:33:18.230700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c06d09dc-5b5e-4b3e-a31a-05cfc773da2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18263fb070>]}
[0m12:33:18.249141 [debug] [MainThread]: checksum: 518582be7b55697d4b7425a2eabd56b025e80bae3faea46064d56fa479f3a66b, vars: {'run_date': '2023-06-22'}, profile: , target: , version: 1.5.1
[0m12:33:18.280969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:33:18.281639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:33:18.282671 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m12:33:18.294449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c06d09dc-5b5e-4b3e-a31a-05cfc773da2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182620c400>]}
[0m12:33:18.304018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c06d09dc-5b5e-4b3e-a31a-05cfc773da2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182627d2b0>]}
[0m12:33:18.305680 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:33:18.306948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c06d09dc-5b5e-4b3e-a31a-05cfc773da2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182627d400>]}
[0m12:33:18.309899 [info ] [MainThread]: 
[0m12:33:18.310982 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:33:18.313812 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:33:18.335414 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:33:18.336228 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:33:18.336788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:33:19.007312 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:33:19.010869 [debug] [ThreadPool]: On list_external_db: Close
[0m12:33:19.111935 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m12:33:19.124307 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:33:19.125321 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:33:19.125807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:33:19.400970 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:33:19.403776 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:33:19.508095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c06d09dc-5b5e-4b3e-a31a-05cfc773da2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1826218ac0>]}
[0m12:33:19.509491 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:33:19.510203 [info ] [MainThread]: 
[0m12:33:19.516125 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:33:19.516897 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:33:19.517822 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:33:19.518365 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:33:19.523916 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:33:19.524962 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:33:19.518843 => 12:33:19.524633
[0m12:33:19.525473 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:33:19.597507 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:33:19.598261 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date(2023-06-22, 'YYYY-MM-DD') as run_date as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m12:33:19.598829 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:33:19.898773 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2331-0000-fb87-0000-0001937ec3cd
[0m12:33:19.899513 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 8 at position 51 unexpected 'as'.
syntax error line 11 at position 0 unexpected 'select'.
[0m12:33:19.900348 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:33:19.525863 => 12:33:19.899993
[0m12:33:19.900931 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:33:19.998959 [debug] [Thread-1  ]: Database Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 8 at position 51 unexpected 'as'.
  syntax error line 11 at position 0 unexpected 'select'.
[0m12:33:19.999941 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c06d09dc-5b5e-4b3e-a31a-05cfc773da2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18254e6d00>]}
[0m12:33:20.000896 [error] [Thread-1  ]: 1 of 7 ERROR creating sql incremental model final_sales.bronze_customers ....... [[31mERROR[0m in 0.48s]
[0m12:33:20.001685 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:33:20.002368 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:33:20.003036 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:33:20.004009 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:33:20.004693 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:33:20.010605 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:33:20.011618 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:33:20.005435 => 12:33:20.011269
[0m12:33:20.012140 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:33:20.035261 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:33:20.036762 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:33:20.037351 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace transient table external_db.final_sales.bronze_orders
         as
        (

with orders as (
     select *, 
     to_date(2023-06-22, 'YYYY-MM-DD') as run_date as run_date from external_db.stage.orders
)

select * from orders
        );
[0m12:33:20.037967 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:33:20.307197 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2331-0000-fb87-0000-0001937ec3d1
[0m12:33:20.308126 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 51 unexpected 'as'.
syntax error line 10 at position 0 unexpected 'select'.
[0m12:33:20.309491 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:33:20.012513 => 12:33:20.308824
[0m12:33:20.310076 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:33:20.410282 [debug] [Thread-1  ]: Database Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 51 unexpected 'as'.
  syntax error line 10 at position 0 unexpected 'select'.
  compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:33:20.411203 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c06d09dc-5b5e-4b3e-a31a-05cfc773da2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182626ed90>]}
[0m12:33:20.412139 [error] [Thread-1  ]: 2 of 7 ERROR creating sql incremental model final_sales.bronze_orders .......... [[31mERROR[0m in 0.41s]
[0m12:33:20.413035 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:33:20.413659 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:33:20.414423 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:33:20.415315 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:33:20.415837 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:33:20.421760 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:33:20.423204 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:33:20.416281 => 12:33:20.422820
[0m12:33:20.423712 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:33:20.428448 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:33:20.429652 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:33:20.430208 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace transient table external_db.final_sales.bronze_payments
         as
        (

with payments as (
     select *, 
     to_date(2023-06-22, 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
        );
[0m12:33:20.430724 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:33:20.900533 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2331-0000-fb87-0000-0001937ec3d5
[0m12:33:20.901546 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001007 (22023): SQL compilation error:
invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
[0m12:33:20.902448 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:33:20.424030 => 12:33:20.902077
[0m12:33:20.903106 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:33:21.007629 [debug] [Thread-1  ]: Database Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)
  001007 (22023): SQL compilation error:
  invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m12:33:21.008643 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c06d09dc-5b5e-4b3e-a31a-05cfc773da2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182626e880>]}
[0m12:33:21.010274 [error] [Thread-1  ]: 3 of 7 ERROR creating sql incremental model final_sales.bronze_payments ........ [[31mERROR[0m in 0.59s]
[0m12:33:21.011147 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:33:21.011879 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:33:21.012533 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:33:21.013576 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:33:21.014217 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:33:21.019544 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:33:21.020954 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:33:21.014553 => 12:33:21.020576
[0m12:33:21.021582 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:33:21.027054 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:33:21.028419 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:33:21.029076 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace transient table external_db.final_sales.bronze_products
         as
        (

with products as (
     select *, 
     to_date(2023-06-22,'YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
        );
[0m12:33:21.029674 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:33:21.346486 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2331-0000-fb4f-0000-0001937eb3d5
[0m12:33:21.347321 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001007 (22023): SQL compilation error:
invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
[0m12:33:21.348247 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:33:21.021991 => 12:33:21.347824
[0m12:33:21.348903 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:33:21.466637 [debug] [Thread-1  ]: Database Error in model bronze_products (models/sales/bronze/bronze_products.sql)
  001007 (22023): SQL compilation error:
  invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m12:33:21.467577 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c06d09dc-5b5e-4b3e-a31a-05cfc773da2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1824373b50>]}
[0m12:33:21.468436 [error] [Thread-1  ]: 4 of 7 ERROR creating sql incremental model final_sales.bronze_products ........ [[31mERROR[0m in 0.45s]
[0m12:33:21.469806 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:33:21.470990 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:33:21.471639 [info ] [Thread-1  ]: 5 of 7 SKIP relation final_sales.fct_payment_details ........................... [[33mSKIP[0m]
[0m12:33:21.472412 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:33:21.473920 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:33:21.474838 [info ] [Thread-1  ]: 6 of 7 SKIP relation final_sales.fct_order_detail .............................. [[33mSKIP[0m]
[0m12:33:21.475558 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:33:21.476649 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:33:21.477257 [info ] [Thread-1  ]: 7 of 7 SKIP relation final_sales.product_sales ................................. [[33mSKIP[0m]
[0m12:33:21.477980 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:33:21.480398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:33:21.480877 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m12:33:21.481378 [info ] [MainThread]: 
[0m12:33:21.481975 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m12:33:21.483141 [debug] [MainThread]: Command end result
[0m12:33:21.494232 [info ] [MainThread]: 
[0m12:33:21.495020 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m12:33:21.495539 [info ] [MainThread]: 
[0m12:33:21.496063 [error] [MainThread]: [33mDatabase Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)[0m
[0m12:33:21.496610 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m12:33:21.497162 [error] [MainThread]:   syntax error line 8 at position 51 unexpected 'as'.
[0m12:33:21.497685 [error] [MainThread]:   syntax error line 11 at position 0 unexpected 'select'.
[0m12:33:21.498189 [info ] [MainThread]: 
[0m12:33:21.498700 [error] [MainThread]: [33mDatabase Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)[0m
[0m12:33:21.499199 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m12:33:21.499701 [error] [MainThread]:   syntax error line 7 at position 51 unexpected 'as'.
[0m12:33:21.500174 [error] [MainThread]:   syntax error line 10 at position 0 unexpected 'select'.
[0m12:33:21.500694 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:33:21.501197 [info ] [MainThread]: 
[0m12:33:21.501833 [error] [MainThread]: [33mDatabase Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)[0m
[0m12:33:21.502360 [error] [MainThread]:   001007 (22023): SQL compilation error:
[0m12:33:21.502877 [error] [MainThread]:   invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
[0m12:33:21.503404 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m12:33:21.503920 [info ] [MainThread]: 
[0m12:33:21.505191 [error] [MainThread]: [33mDatabase Error in model bronze_products (models/sales/bronze/bronze_products.sql)[0m
[0m12:33:21.505805 [error] [MainThread]:   001007 (22023): SQL compilation error:
[0m12:33:21.506303 [error] [MainThread]:   invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
[0m12:33:21.506786 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m12:33:21.507280 [info ] [MainThread]: 
[0m12:33:21.507802 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=3 TOTAL=7
[0m12:33:21.508807 [debug] [MainThread]: Command `dbt run` failed at 12:33:21.508623 after 3.69 seconds
[0m12:33:21.509370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182d237490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182627d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f182627d310>]}
[0m12:33:21.509904 [debug] [MainThread]: Flushing usage events
[0m12:35:50.139212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cc80a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cb0cd5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cb0cd430>]}


============================== 12:35:50.143382 | 99df2bf6-c823-476e-a03a-edf9e2b0701b ==============================
[0m12:35:50.143382 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:35:50.144206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:35:50.471323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99df2bf6-c823-476e-a03a-edf9e2b0701b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c69e0040>]}
[0m12:35:50.493454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99df2bf6-c823-476e-a03a-edf9e2b0701b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c69e6070>]}
[0m12:35:50.523268 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:35:50.533708 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:35:50.534313 [debug] [MainThread]: previous checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, current checksum: 518582be7b55697d4b7425a2eabd56b025e80bae3faea46064d56fa479f3a66b
[0m12:35:50.534758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '99df2bf6-c823-476e-a03a-edf9e2b0701b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c699bdc0>]}
[0m12:35:51.535525 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_order_detail.sql
[0m12:35:51.563500 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_order_detail.sql
[0m12:35:51.566689 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_payment_details.sql
[0m12:35:51.574180 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_payment_details.sql
[0m12:35:51.577787 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m12:35:51.584668 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m12:35:51.587616 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m12:35:51.595761 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m12:35:51.598834 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m12:35:51.605548 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m12:35:51.608338 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m12:35:51.614757 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m12:35:51.617413 [debug] [MainThread]: 1603: static parser failed on sales/core/product_sales.sql
[0m12:35:51.627254 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/core/product_sales.sql
[0m12:35:51.798126 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.staging
- models.development.intermediate
[0m12:35:51.805793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99df2bf6-c823-476e-a03a-edf9e2b0701b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c53683d0>]}
[0m12:35:51.816063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99df2bf6-c823-476e-a03a-edf9e2b0701b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c69c0d00>]}
[0m12:35:51.816715 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:35:51.817302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99df2bf6-c823-476e-a03a-edf9e2b0701b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c69c0a00>]}
[0m12:35:51.819497 [info ] [MainThread]: 
[0m12:35:51.820646 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:35:51.822662 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:35:51.841999 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:35:51.842739 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:35:51.843336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:35:52.623889 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:35:52.627301 [debug] [ThreadPool]: On list_external_db: Close
[0m12:35:52.728947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now create_external_db_final_sales)
[0m12:35:52.730141 [debug] [ThreadPool]: Creating schema "database: "external_db"
schema: "final_sales"
"
[0m12:35:52.738445 [debug] [ThreadPool]: Using snowflake connection "create_external_db_final_sales"
[0m12:35:52.739095 [debug] [ThreadPool]: On create_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "create_external_db_final_sales"} */
create schema if not exists external_db.final_sales
[0m12:35:52.739557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:53.066361 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:35:53.068081 [debug] [ThreadPool]: On create_external_db_final_sales: Close
[0m12:35:53.180193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_external_db_final_sales, now list_external_db_final_sales)
[0m12:35:53.189934 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:35:53.190509 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:35:53.190965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:35:53.621412 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m12:35:53.623668 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:35:53.718730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99df2bf6-c823-476e-a03a-edf9e2b0701b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c53791c0>]}
[0m12:35:53.720305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:35:53.721030 [info ] [MainThread]: 
[0m12:35:53.726166 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:35:53.726930 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:35:53.728465 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:35:53.729015 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:35:53.734207 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:35:53.735308 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:35:53.729398 => 12:35:53.734893
[0m12:35:53.735913 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:35:53.816669 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m12:35:53.818129 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:35:53.818768 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace transient table external_db.final_sales.bronze_customers
         as
        (

with customers as (
     select *, 
     to_date(2023-06-22, 'YYYY-MM-DD') as run_date as run_date  from external_db.stage.customers
)

select * from customers
        );
[0m12:35:53.819369 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:54.141984 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2333-0000-fb87-0000-0001937ec3f1
[0m12:35:54.143005 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 51 unexpected 'as'.
syntax error line 10 at position 0 unexpected 'select'.
[0m12:35:54.143922 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:35:53.736748 => 12:35:54.143534
[0m12:35:54.144505 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:35:54.260090 [debug] [Thread-1  ]: Database Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 51 unexpected 'as'.
  syntax error line 10 at position 0 unexpected 'select'.
  compiled Code at target/run/development/models/sales/bronze/bronze_customers.sql
[0m12:35:54.261141 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99df2bf6-c823-476e-a03a-edf9e2b0701b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c464de20>]}
[0m12:35:54.262114 [error] [Thread-1  ]: 1 of 7 ERROR creating sql incremental model final_sales.bronze_customers ....... [[31mERROR[0m in 0.53s]
[0m12:35:54.263292 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:35:54.264101 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:35:54.265012 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:35:54.265999 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:35:54.266534 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:35:54.272204 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:35:54.273787 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:35:54.266895 => 12:35:54.273342
[0m12:35:54.274326 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:35:54.279312 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:35:54.280630 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:35:54.281218 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace transient table external_db.final_sales.bronze_orders
         as
        (

with orders as (
     select *, 
     to_date(2023-06-22, 'YYYY-MM-DD') as run_date as run_date from external_db.stage.orders
)

select * from orders
        );
[0m12:35:54.281760 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:54.597044 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2333-0000-fb4f-0000-0001937eb3fd
[0m12:35:54.597781 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 51 unexpected 'as'.
syntax error line 10 at position 0 unexpected 'select'.
[0m12:35:54.598678 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:35:54.274680 => 12:35:54.598326
[0m12:35:54.599278 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:35:54.697881 [debug] [Thread-1  ]: Database Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 51 unexpected 'as'.
  syntax error line 10 at position 0 unexpected 'select'.
  compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:35:54.698762 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99df2bf6-c823-476e-a03a-edf9e2b0701b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c465bdc0>]}
[0m12:35:54.699690 [error] [Thread-1  ]: 2 of 7 ERROR creating sql incremental model final_sales.bronze_orders .......... [[31mERROR[0m in 0.43s]
[0m12:35:54.700865 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:35:54.701725 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:35:54.702447 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:35:54.703710 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:35:54.704281 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:35:54.709320 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:35:54.710347 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:35:54.704682 => 12:35:54.709967
[0m12:35:54.710907 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:35:54.715981 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:35:54.717361 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:35:54.717906 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace transient table external_db.final_sales.bronze_payments
         as
        (

with payments as (
     select *, 
     to_date(2023-06-22, 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
        );
[0m12:35:54.718533 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:55.042863 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2333-0000-fb4f-0000-0001937eb401
[0m12:35:55.043724 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001007 (22023): SQL compilation error:
invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
[0m12:35:55.044713 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:35:54.711285 => 12:35:55.044294
[0m12:35:55.045337 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:35:55.158586 [debug] [Thread-1  ]: Database Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)
  001007 (22023): SQL compilation error:
  invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m12:35:55.159464 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99df2bf6-c823-476e-a03a-edf9e2b0701b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c460bc10>]}
[0m12:35:55.160371 [error] [Thread-1  ]: 3 of 7 ERROR creating sql incremental model final_sales.bronze_payments ........ [[31mERROR[0m in 0.46s]
[0m12:35:55.161507 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:35:55.162211 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:35:55.163049 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:35:55.164061 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:35:55.164632 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:35:55.169939 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:35:55.171405 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:35:55.165001 => 12:35:55.170970
[0m12:35:55.171946 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:35:55.177248 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:35:55.178759 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:35:55.179436 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace transient table external_db.final_sales.bronze_products
         as
        (

with products as (
     select *, 
     to_date(2023-06-22,'YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
        );
[0m12:35:55.179980 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:35:55.472789 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2333-0000-fb4f-0000-0001937eb405
[0m12:35:55.473564 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001007 (22023): SQL compilation error:
invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
[0m12:35:55.474382 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:35:55.172328 => 12:35:55.474025
[0m12:35:55.474922 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:35:55.581840 [debug] [Thread-1  ]: Database Error in model bronze_products (models/sales/bronze/bronze_products.sql)
  001007 (22023): SQL compilation error:
  invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m12:35:55.582881 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99df2bf6-c823-476e-a03a-edf9e2b0701b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c465b100>]}
[0m12:35:55.583788 [error] [Thread-1  ]: 4 of 7 ERROR creating sql incremental model final_sales.bronze_products ........ [[31mERROR[0m in 0.42s]
[0m12:35:55.584607 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:35:55.585310 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:35:55.586162 [info ] [Thread-1  ]: 5 of 7 SKIP relation final_sales.fct_payment_details ........................... [[33mSKIP[0m]
[0m12:35:55.587338 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:35:55.587957 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:35:55.588763 [info ] [Thread-1  ]: 6 of 7 SKIP relation final_sales.fct_order_detail .............................. [[33mSKIP[0m]
[0m12:35:55.589567 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:35:55.590915 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:35:55.591510 [info ] [Thread-1  ]: 7 of 7 SKIP relation final_sales.product_sales ................................. [[33mSKIP[0m]
[0m12:35:55.592335 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:35:55.594647 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:35:55.595092 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m12:35:55.595632 [info ] [MainThread]: 
[0m12:35:55.596222 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 3.78 seconds (3.78s).
[0m12:35:55.597353 [debug] [MainThread]: Command end result
[0m12:35:55.611074 [info ] [MainThread]: 
[0m12:35:55.611815 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m12:35:55.614319 [info ] [MainThread]: 
[0m12:35:55.615395 [error] [MainThread]: [33mDatabase Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)[0m
[0m12:35:55.616433 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m12:35:55.617559 [error] [MainThread]:   syntax error line 7 at position 51 unexpected 'as'.
[0m12:35:55.618410 [error] [MainThread]:   syntax error line 10 at position 0 unexpected 'select'.
[0m12:35:55.619302 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_customers.sql
[0m12:35:55.620214 [info ] [MainThread]: 
[0m12:35:55.621266 [error] [MainThread]: [33mDatabase Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)[0m
[0m12:35:55.622491 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m12:35:55.623553 [error] [MainThread]:   syntax error line 7 at position 51 unexpected 'as'.
[0m12:35:55.624486 [error] [MainThread]:   syntax error line 10 at position 0 unexpected 'select'.
[0m12:35:55.625290 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:35:55.626197 [info ] [MainThread]: 
[0m12:35:55.627086 [error] [MainThread]: [33mDatabase Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)[0m
[0m12:35:55.628000 [error] [MainThread]:   001007 (22023): SQL compilation error:
[0m12:35:55.628950 [error] [MainThread]:   invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
[0m12:35:55.629839 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m12:35:55.630730 [info ] [MainThread]: 
[0m12:35:55.631646 [error] [MainThread]: [33mDatabase Error in model bronze_products (models/sales/bronze/bronze_products.sql)[0m
[0m12:35:55.632849 [error] [MainThread]:   001007 (22023): SQL compilation error:
[0m12:35:55.634069 [error] [MainThread]:   invalid type [TO_DATE((2023 - 6) - 22, 'YYYY-MM-DD')] for parameter 'TO_DATE'
[0m12:35:55.635042 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m12:35:55.635901 [info ] [MainThread]: 
[0m12:35:55.636810 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=3 TOTAL=7
[0m12:35:55.638419 [debug] [MainThread]: Command `dbt run` failed at 12:35:55.638206 after 5.52 seconds
[0m12:35:55.639464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cc80a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c69e6070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04cb9ae730>]}
[0m12:35:55.640103 [debug] [MainThread]: Flushing usage events
[0m12:36:56.965846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4715da5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f471468e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f471468e2e0>]}


============================== 12:36:56.969804 | e97e6f47-b9a6-4dc3-b5f4-18f155b3955f ==============================
[0m12:36:56.969804 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:36:56.970552 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:36:57.298991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e97e6f47-b9a6-4dc3-b5f4-18f155b3955f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470ffb2f70>]}
[0m12:36:57.321279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e97e6f47-b9a6-4dc3-b5f4-18f155b3955f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470ffb2610>]}
[0m12:36:57.338498 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:36:57.366007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m12:36:57.366714 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_payments.sql
[0m12:36:57.367315 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_orders.sql
[0m12:36:57.367897 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_customers.sql
[0m12:36:57.368615 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_products.sql
[0m12:36:57.400346 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m12:36:57.425664 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m12:36:57.428343 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m12:36:57.434891 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m12:36:57.437623 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m12:36:57.446270 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m12:36:57.449145 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m12:36:57.455690 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m12:36:57.494698 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.staging
- models.development.intermediate
[0m12:36:57.502342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e97e6f47-b9a6-4dc3-b5f4-18f155b3955f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470edade80>]}
[0m12:36:57.512077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e97e6f47-b9a6-4dc3-b5f4-18f155b3955f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470edfe280>]}
[0m12:36:57.512783 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:36:57.513306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e97e6f47-b9a6-4dc3-b5f4-18f155b3955f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470edfe3d0>]}
[0m12:36:57.515416 [info ] [MainThread]: 
[0m12:36:57.516488 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:36:57.521263 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:36:57.540173 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:36:57.540832 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:36:57.541358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:36:58.219616 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:36:58.222802 [debug] [ThreadPool]: On list_external_db: Close
[0m12:36:58.325673 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m12:36:58.337697 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:36:58.338270 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:36:58.338680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:36:58.624404 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m12:36:58.626634 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:36:58.732413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e97e6f47-b9a6-4dc3-b5f4-18f155b3955f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470ededd00>]}
[0m12:36:58.733941 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:36:58.734557 [info ] [MainThread]: 
[0m12:36:58.740924 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:36:58.741633 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:36:58.742745 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:36:58.743252 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:36:58.748976 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:36:58.750204 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:36:58.743674 => 12:36:58.749730
[0m12:36:58.750706 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:36:58.829085 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m12:36:58.830484 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:36:58.830978 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace transient table external_db.final_sales.bronze_customers
         as
        (

with customers as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date as run_date  from external_db.stage.customers
)

select * from customers
        );
[0m12:36:58.831475 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:36:59.287785 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2334-0000-fb87-0000-0001937ec3f5
[0m12:36:59.289430 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 53 unexpected 'as'.
syntax error line 10 at position 0 unexpected 'select'.
[0m12:36:59.290304 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:36:58.751022 => 12:36:59.289944
[0m12:36:59.290830 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:36:59.385294 [debug] [Thread-1  ]: Database Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 53 unexpected 'as'.
  syntax error line 10 at position 0 unexpected 'select'.
  compiled Code at target/run/development/models/sales/bronze/bronze_customers.sql
[0m12:36:59.386280 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e97e6f47-b9a6-4dc3-b5f4-18f155b3955f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470edb1190>]}
[0m12:36:59.387248 [error] [Thread-1  ]: 1 of 7 ERROR creating sql incremental model final_sales.bronze_customers ....... [[31mERROR[0m in 0.64s]
[0m12:36:59.388496 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:36:59.389299 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:36:59.390329 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:36:59.391489 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:36:59.392068 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:36:59.397643 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:36:59.398603 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:36:59.392533 => 12:36:59.398286
[0m12:36:59.399105 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:36:59.403818 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:36:59.405028 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:36:59.405653 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace transient table external_db.final_sales.bronze_orders
         as
        (

with orders as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date as run_date from external_db.stage.orders
)

select * from orders
        );
[0m12:36:59.406380 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:36:59.705381 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2334-0000-fb4f-0000-0001937eb411
[0m12:36:59.706072 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 53 unexpected 'as'.
syntax error line 10 at position 0 unexpected 'select'.
[0m12:36:59.706969 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:36:59.399474 => 12:36:59.706593
[0m12:36:59.707588 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:36:59.816355 [debug] [Thread-1  ]: Database Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 53 unexpected 'as'.
  syntax error line 10 at position 0 unexpected 'select'.
  compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:36:59.817500 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e97e6f47-b9a6-4dc3-b5f4-18f155b3955f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4713b09b80>]}
[0m12:36:59.818496 [error] [Thread-1  ]: 2 of 7 ERROR creating sql incremental model final_sales.bronze_orders .......... [[31mERROR[0m in 0.43s]
[0m12:36:59.819888 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:36:59.820630 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:36:59.821261 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:36:59.822748 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:36:59.823362 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:36:59.828863 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:36:59.829928 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:36:59.823715 => 12:36:59.829563
[0m12:36:59.830479 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:36:59.835333 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:36:59.836539 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:36:59.837114 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace transient table external_db.final_sales.bronze_payments
         as
        (

with payments as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
        );
[0m12:36:59.837617 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:01.261310 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:37:01.274830 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:37:01.275458 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m12:37:01.335556 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:37:01.439317 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:36:59.830860 => 12:37:01.438837
[0m12:37:01.440041 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:37:01.548677 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e97e6f47-b9a6-4dc3-b5f4-18f155b3955f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470dccb0d0>]}
[0m12:37:01.549765 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 1[0m in 1.73s]
[0m12:37:01.551078 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:37:01.551760 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:37:01.552892 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:37:01.553962 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:37:01.554554 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:37:01.560315 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:37:01.561682 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:37:01.554977 => 12:37:01.561097
[0m12:37:01.562242 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:37:01.567795 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:37:01.569069 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:37:01.569592 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace transient table external_db.final_sales.bronze_products
         as
        (

with products as (
     select *, 
     to_date('2023-06-22','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
        );
[0m12:37:01.570146 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:02.800956 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:37:02.806319 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:37:02.806865 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m12:37:02.869981 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:37:02.874316 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:37:01.562599 => 12:37:02.873996
[0m12:37:02.874889 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:37:02.985383 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e97e6f47-b9a6-4dc3-b5f4-18f155b3955f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470ed80400>]}
[0m12:37:02.986612 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 1[0m in 1.43s]
[0m12:37:02.987858 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:37:02.988643 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:37:02.989671 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m12:37:02.990823 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m12:37:02.991537 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m12:37:03.001797 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m12:37:03.002809 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 12:37:02.992079 => 12:37:03.002466
[0m12:37:03.003577 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m12:37:03.008658 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m12:37:03.010171 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:37:03.010866 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace transient table external_db.final_sales.fct_payment_details
         as
        (

with payments as (
    select * from external_db.final_sales.bronze_payments
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
        );
[0m12:37:03.011454 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:37:03.830314 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:37:03.835486 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:37:03.836174 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m12:37:03.907880 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:37:03.912466 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 12:37:03.003949 => 12:37:03.912118
[0m12:37:03.913067 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m12:37:04.014411 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e97e6f47-b9a6-4dc3-b5f4-18f155b3955f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470dccb0a0>]}
[0m12:37:04.015714 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 1[0m in 1.02s]
[0m12:37:04.016809 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:37:04.017538 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:37:04.018373 [info ] [Thread-1  ]: 6 of 7 SKIP relation final_sales.fct_order_detail .............................. [[33mSKIP[0m]
[0m12:37:04.019200 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:37:04.020701 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:37:04.021448 [info ] [Thread-1  ]: 7 of 7 SKIP relation final_sales.product_sales ................................. [[33mSKIP[0m]
[0m12:37:04.022203 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:37:04.024303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:04.024809 [debug] [MainThread]: Connection 'model.development.fct_payment_details' was properly closed.
[0m12:37:04.025286 [info ] [MainThread]: 
[0m12:37:04.025820 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 6.51 seconds (6.51s).
[0m12:37:04.027778 [debug] [MainThread]: Command end result
[0m12:37:04.038328 [info ] [MainThread]: 
[0m12:37:04.038928 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m12:37:04.039418 [info ] [MainThread]: 
[0m12:37:04.040039 [error] [MainThread]: [33mDatabase Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)[0m
[0m12:37:04.040559 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m12:37:04.041169 [error] [MainThread]:   syntax error line 7 at position 53 unexpected 'as'.
[0m12:37:04.041764 [error] [MainThread]:   syntax error line 10 at position 0 unexpected 'select'.
[0m12:37:04.042224 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_customers.sql
[0m12:37:04.042878 [info ] [MainThread]: 
[0m12:37:04.043346 [error] [MainThread]: [33mDatabase Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)[0m
[0m12:37:04.043805 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m12:37:04.044259 [error] [MainThread]:   syntax error line 7 at position 53 unexpected 'as'.
[0m12:37:04.044758 [error] [MainThread]:   syntax error line 10 at position 0 unexpected 'select'.
[0m12:37:04.045198 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:37:04.045784 [info ] [MainThread]: 
[0m12:37:04.046345 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=2 TOTAL=7
[0m12:37:04.047435 [debug] [MainThread]: Command `dbt run` failed at 12:37:04.047195 after 7.10 seconds
[0m12:37:04.048018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4715da5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470fe8e970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f470fe8ef70>]}
[0m12:37:04.048528 [debug] [MainThread]: Flushing usage events
[0m12:38:22.610964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d1a1d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d02df640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d02df100>]}


============================== 12:38:22.614521 | 3d6e35a7-2528-4485-97c8-d106e10803d8 ==============================
[0m12:38:22.614521 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:38:22.615188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:38:22.955389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d6e35a7-2528-4485-97c8-d106e10803d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69cabf6100>]}
[0m12:38:22.978358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d6e35a7-2528-4485-97c8-d106e10803d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69cabec0d0>]}
[0m12:38:22.998434 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:38:23.028105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:38:23.028954 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_customers.sql
[0m12:38:23.029736 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_orders.sql
[0m12:38:23.067664 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m12:38:23.091089 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m12:38:23.094675 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m12:38:23.102237 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m12:38:23.135932 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.intermediate
[0m12:38:23.143310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d6e35a7-2528-4485-97c8-d106e10803d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69ca5a98e0>]}
[0m12:38:23.151992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d6e35a7-2528-4485-97c8-d106e10803d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69caaf43d0>]}
[0m12:38:23.152946 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:38:23.153602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d6e35a7-2528-4485-97c8-d106e10803d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69caaf4520>]}
[0m12:38:23.155765 [info ] [MainThread]: 
[0m12:38:23.156925 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:38:23.158931 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:38:23.179613 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:38:23.180324 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:38:23.180993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:23.829900 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:38:23.833627 [debug] [ThreadPool]: On list_external_db: Close
[0m12:38:23.941419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m12:38:23.951546 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:38:23.952047 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:38:23.952511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:24.272675 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:38:24.275701 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:38:24.389315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d6e35a7-2528-4485-97c8-d106e10803d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69caba7340>]}
[0m12:38:24.390646 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:38:24.391217 [info ] [MainThread]: 
[0m12:38:24.396563 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:38:24.397557 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:38:24.398490 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:38:24.399149 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:38:24.404846 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:38:24.405882 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:38:24.399517 => 12:38:24.405471
[0m12:38:24.406426 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:38:24.484643 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m12:38:24.485971 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:38:24.486449 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace transient table external_db.final_sales.bronze_customers
         as
        (

with customers as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
        );
[0m12:38:24.486954 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:38:25.283469 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:38:25.295407 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:38:25.296076 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m12:38:25.349730 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:38:25.378794 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:38:24.406821 => 12:38:25.378454
[0m12:38:25.379478 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:38:25.480414 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d6e35a7-2528-4485-97c8-d106e10803d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69ca544850>]}
[0m12:38:25.481866 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 1[0m in 1.08s]
[0m12:38:25.482956 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:38:25.483622 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:38:25.484365 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:38:25.485840 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:38:25.486423 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:38:25.491657 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:38:25.492775 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:38:25.486780 => 12:38:25.492415
[0m12:38:25.493439 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:38:25.498600 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:38:25.499933 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:38:25.500528 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace transient table external_db.final_sales.bronze_orders
         as
        (

with orders as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
        );
[0m12:38:25.501134 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:38:26.211820 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:38:26.217110 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:38:26.217711 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m12:38:26.283238 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:38:26.287758 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:38:25.493769 => 12:38:26.287311
[0m12:38:26.288406 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:38:26.397966 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d6e35a7-2528-4485-97c8-d106e10803d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69abf95e80>]}
[0m12:38:26.399130 [info ] [Thread-1  ]: 2 of 7 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 1[0m in 0.91s]
[0m12:38:26.400581 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:38:26.401399 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:38:26.402010 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:38:26.402916 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:38:26.403400 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:38:26.409788 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:38:26.410714 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:38:26.403749 => 12:38:26.410371
[0m12:38:26.411408 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:38:26.493000 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:38:26.493723 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
  );
[0m12:38:26.494373 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:38:26.857193 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:38:26.869619 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:38:26.870402 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m12:38:26.950814 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:38:26.956947 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:38:26.957419 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m12:38:27.030781 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:38:27.043134 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:38:27.043694 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m12:38:27.113965 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:38:27.157811 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:38:27.159719 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:38:27.160215 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m12:38:27.241602 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:38:27.242299 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:38:27.242775 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m12:38:27.703375 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:38:27.704303 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:38:27.704885 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m12:38:27.927017 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:38:27.932091 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:38:27.932719 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m12:38:28.038502 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:38:28.042621 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:38:26.411864 => 12:38:28.042323
[0m12:38:28.043201 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:38:28.140193 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d6e35a7-2528-4485-97c8-d106e10803d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69c986edc0>]}
[0m12:38:28.141281 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 10[0m in 1.74s]
[0m12:38:28.142235 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:38:28.143027 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:38:28.143601 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:38:28.144643 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:38:28.145441 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:38:28.150757 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:38:28.151770 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:38:28.145890 => 12:38:28.151351
[0m12:38:28.152257 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:38:28.159461 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:38:28.160024 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_date('2023-06-22','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
  );
[0m12:38:28.160572 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:38:28.547685 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:38:28.552328 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:38:28.552949 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m12:38:28.625681 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:38:28.630473 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:38:28.630949 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m12:38:28.696782 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:38:28.701739 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:38:28.702341 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m12:38:28.763887 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:38:28.768282 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:38:28.770013 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:38:28.770534 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m12:38:28.846814 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:38:28.847461 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:38:28.847974 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m12:38:29.342410 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:38:29.343243 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:38:29.343773 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m12:38:29.583146 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:38:29.588102 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:38:29.588658 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m12:38:29.678241 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:38:29.681881 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:38:28.152701 => 12:38:29.681568
[0m12:38:29.682400 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:38:29.787860 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d6e35a7-2528-4485-97c8-d106e10803d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69ca5f4490>]}
[0m12:38:29.789046 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 10[0m in 1.64s]
[0m12:38:29.789952 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:38:29.790573 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:38:29.791150 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m12:38:29.791961 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m12:38:29.792434 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m12:38:29.803385 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m12:38:29.804382 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 12:38:29.792897 => 12:38:29.804101
[0m12:38:29.804874 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m12:38:29.809578 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:38:29.810154 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where 2023-06-22 = run_date
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
  );
[0m12:38:29.810694 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:38:30.103301 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2336-0000-fb4f-0000-0001937eb43d
[0m12:38:30.104066 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001038 (22023): SQL compilation error:
Can not convert parameter 'BRONZE_PAYMENTS.RUN_DATE' of type [DATE] into expected type [NUMBER(6,0)]
[0m12:38:30.104868 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 12:38:29.805238 => 12:38:30.104519
[0m12:38:30.105472 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m12:38:30.212905 [debug] [Thread-1  ]: Database Error in model fct_payment_details (models/sales/intermediate/fct_payment_details.sql)
  001038 (22023): SQL compilation error:
  Can not convert parameter 'BRONZE_PAYMENTS.RUN_DATE' of type [DATE] into expected type [NUMBER(6,0)]
[0m12:38:30.213691 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d6e35a7-2528-4485-97c8-d106e10803d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69ca57d310>]}
[0m12:38:30.214807 [error] [Thread-1  ]: 5 of 7 ERROR creating sql incremental model final_sales.fct_payment_details .... [[31mERROR[0m in 0.42s]
[0m12:38:30.215636 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:38:30.216219 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:38:30.217261 [info ] [Thread-1  ]: 6 of 7 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m12:38:30.218333 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m12:38:30.218823 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m12:38:30.225838 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m12:38:30.226858 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 12:38:30.219142 => 12:38:30.226438
[0m12:38:30.227446 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m12:38:30.234752 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m12:38:30.236096 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:38:30.236667 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace transient table external_db.final_sales.fct_order_detail
         as
        (
with orders as (
    select * from external_db.final_sales.bronze_orders
   
),

products as (
    select * from external_db.final_sales.bronze_products
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_date
    from orders
    left join products using (product_id)
)
select * from final
        );
[0m12:38:30.237191 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:38:31.125692 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:38:31.133655 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:38:31.134261 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m12:38:31.197164 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:38:31.200904 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 12:38:30.227843 => 12:38:31.200551
[0m12:38:31.201448 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m12:38:31.303572 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d6e35a7-2528-4485-97c8-d106e10803d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69abf95e80>]}
[0m12:38:31.304969 [info ] [Thread-1  ]: 6 of 7 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 1[0m in 1.09s]
[0m12:38:31.306175 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:38:31.307657 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:38:31.308224 [info ] [Thread-1  ]: 7 of 7 SKIP relation final_sales.product_sales ................................. [[33mSKIP[0m]
[0m12:38:31.308941 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:38:31.311257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:31.311752 [debug] [MainThread]: Connection 'model.development.fct_order_detail' was properly closed.
[0m12:38:31.312287 [info ] [MainThread]: 
[0m12:38:31.312872 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 8.16 seconds (8.16s).
[0m12:38:31.315313 [debug] [MainThread]: Command end result
[0m12:38:31.324957 [info ] [MainThread]: 
[0m12:38:31.325513 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:38:31.325997 [info ] [MainThread]: 
[0m12:38:31.326465 [error] [MainThread]: [33mDatabase Error in model fct_payment_details (models/sales/intermediate/fct_payment_details.sql)[0m
[0m12:38:31.326938 [error] [MainThread]:   001038 (22023): SQL compilation error:
[0m12:38:31.327383 [error] [MainThread]:   Can not convert parameter 'BRONZE_PAYMENTS.RUN_DATE' of type [DATE] into expected type [NUMBER(6,0)]
[0m12:38:31.327841 [info ] [MainThread]: 
[0m12:38:31.328330 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=1 TOTAL=7
[0m12:38:31.329283 [debug] [MainThread]: Command `dbt run` failed at 12:38:31.329065 after 8.74 seconds
[0m12:38:31.329856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69d1a1d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69abf98610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69abf59d00>]}
[0m12:38:31.330315 [debug] [MainThread]: Flushing usage events
[0m12:43:33.392028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9c1520430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9bfe0a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9bfe0a100>]}


============================== 12:43:33.396074 | c2fd07ed-d1d8-4de5-9519-0e077d76a4d3 ==============================
[0m12:43:33.396074 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:43:33.397048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:43:33.746002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2fd07ed-d1d8-4de5-9519-0e077d76a4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9bb726d90>]}
[0m12:43:33.769052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2fd07ed-d1d8-4de5-9519-0e077d76a4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9bb7265e0>]}
[0m12:43:33.787629 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:43:33.816768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m12:43:33.817513 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/intermediate/fct_order_detail.sql
[0m12:43:33.818171 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/intermediate/fct_payment_details.sql
[0m12:43:33.850393 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_order_detail.sql
[0m12:43:33.877686 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_order_detail.sql
[0m12:43:33.880862 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_payment_details.sql
[0m12:43:33.888365 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_payment_details.sql
[0m12:43:33.920915 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.staging
- models.development.intermediate
[0m12:43:33.928208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2fd07ed-d1d8-4de5-9519-0e077d76a4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ba4b8e80>]}
[0m12:43:33.937471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2fd07ed-d1d8-4de5-9519-0e077d76a4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ba5f12e0>]}
[0m12:43:33.938055 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:43:33.938822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2fd07ed-d1d8-4de5-9519-0e077d76a4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ba5f1430>]}
[0m12:43:33.940983 [info ] [MainThread]: 
[0m12:43:33.941957 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:43:33.943852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:43:33.962439 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:43:33.962993 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:43:33.963487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:43:34.664579 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:43:34.667410 [debug] [ThreadPool]: On list_external_db: Close
[0m12:43:34.768891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m12:43:34.780220 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:43:34.780900 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:43:34.781350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:43:35.088700 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:43:35.091517 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:43:35.190937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2fd07ed-d1d8-4de5-9519-0e077d76a4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ba56ef10>]}
[0m12:43:35.192324 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:43:35.193361 [info ] [MainThread]: 
[0m12:43:35.199770 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:43:35.200519 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:43:35.201553 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:43:35.202110 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:43:35.207265 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:43:35.208208 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:43:35.202455 => 12:43:35.207874
[0m12:43:35.208751 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:43:35.281779 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:43:35.282471 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m12:43:35.283035 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:43:35.649765 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:35.662059 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:43:35.662665 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m12:43:35.738953 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:43:35.744855 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:43:35.745551 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m12:43:35.832332 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:43:35.844436 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:43:35.845112 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m12:43:35.916555 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:43:35.959455 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m12:43:35.961726 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:43:35.962208 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m12:43:36.040253 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:36.041021 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:43:36.041609 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m12:43:36.986967 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m12:43:36.988201 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:43:36.988835 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m12:43:37.226987 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:37.238223 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:43:37.238761 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m12:43:37.330838 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:37.359845 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:43:35.209078 => 12:43:37.359547
[0m12:43:37.360378 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:43:37.467829 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fd07ed-d1d8-4de5-9519-0e077d76a4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9ba460df0>]}
[0m12:43:37.468928 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 10[0m in 2.27s]
[0m12:43:37.469929 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:43:37.470634 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:43:37.471322 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:43:37.472502 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:43:37.473184 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:43:37.548318 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:43:37.549504 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:43:37.473565 => 12:43:37.549136
[0m12:43:37.550021 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:43:37.556519 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:43:37.557225 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
  );
[0m12:43:37.558070 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:43:37.943936 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:37.947937 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:43:37.948427 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m12:43:38.029940 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:43:38.035047 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:43:38.035548 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m12:43:38.102958 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:43:38.108680 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:43:38.109240 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m12:43:38.186516 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:43:38.191788 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:43:38.193747 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:43:38.194268 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m12:43:38.289912 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:38.290901 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:43:38.291510 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")

;
[0m12:43:38.977754 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad233b-0000-fb4f-0000-0001937eb459
[0m12:43:38.978575 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m12:43:38.979445 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:43:37.550369 => 12:43:38.979071
[0m12:43:38.979974 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:43:39.134424 [debug] [Thread-1  ]: Database Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:43:39.135328 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fd07ed-d1d8-4de5-9519-0e077d76a4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9b86b0130>]}
[0m12:43:39.136354 [error] [Thread-1  ]: 2 of 7 ERROR creating sql incremental model final_sales.bronze_orders .......... [[31mERROR[0m in 1.66s]
[0m12:43:39.137175 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:43:39.137908 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:43:39.138890 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:43:39.139948 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:43:39.140449 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:43:39.145704 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:43:39.146709 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:43:39.140814 => 12:43:39.146399
[0m12:43:39.147241 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:43:39.152222 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:43:39.152810 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
  );
[0m12:43:39.153348 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:43:39.675696 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:43:39.682672 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:43:39.683211 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m12:43:39.756233 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:43:39.761549 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:43:39.762042 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m12:43:39.827828 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:43:39.833228 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:43:39.833748 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m12:43:39.894788 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:43:39.899829 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:43:39.901562 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:43:39.902078 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m12:43:39.985292 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:39.986099 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:43:39.986674 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m12:43:40.495232 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m12:43:40.496032 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:43:40.496828 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m12:43:40.720155 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:40.725832 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:43:40.726426 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m12:43:40.814175 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:40.818002 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:43:39.147595 => 12:43:40.817698
[0m12:43:40.818545 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:43:40.925118 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fd07ed-d1d8-4de5-9519-0e077d76a4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9b86b0160>]}
[0m12:43:40.926265 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 10[0m in 1.79s]
[0m12:43:40.927270 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:43:40.927895 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:43:40.928555 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:43:40.929552 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:43:40.930428 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:43:40.936908 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:43:40.938089 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:43:40.931055 => 12:43:40.937708
[0m12:43:40.938739 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:43:40.943839 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:43:40.944319 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_date('2023-06-22','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
  );
[0m12:43:40.944852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:43:41.345983 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:41.351115 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:43:41.351689 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m12:43:41.432704 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:43:41.438151 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:43:41.438786 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m12:43:41.517655 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:43:41.522601 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:43:41.523129 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m12:43:41.590449 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:43:41.595165 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:43:41.597168 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:43:41.597647 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m12:43:41.678624 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:41.679298 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:43:41.679933 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m12:43:42.017557 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:43:42.018454 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:43:42.018957 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m12:43:42.231026 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:42.236774 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:43:42.237321 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m12:43:42.322401 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:42.326431 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:43:40.939198 => 12:43:42.326004
[0m12:43:42.327011 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:43:42.429958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fd07ed-d1d8-4de5-9519-0e077d76a4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9b86b0160>]}
[0m12:43:42.430959 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 10[0m in 1.50s]
[0m12:43:42.432555 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:43:42.433369 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:43:42.434451 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m12:43:42.435683 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m12:43:42.436234 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m12:43:42.445356 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m12:43:42.446348 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 12:43:42.437267 => 12:43:42.446002
[0m12:43:42.446978 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m12:43:42.452305 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:43:42.452933 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
  );
[0m12:43:42.453888 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:43:42.866701 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:42.871171 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:43:42.871770 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m12:43:42.951377 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:43:42.956873 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:43:42.957459 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m12:43:43.031790 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:43:43.037468 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:43:43.038024 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m12:43:43.100913 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:43:43.106239 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m12:43:43.107984 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:43:43.108491 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m12:43:43.187138 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:43.188062 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:43:43.188695 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")

;
[0m12:43:43.611211 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.0 seconds
[0m12:43:43.612031 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:43:43.612554 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m12:43:43.821033 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:43.826537 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:43:43.827133 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m12:43:43.928874 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:43:43.932961 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 12:43:42.447352 => 12:43:43.932574
[0m12:43:43.933558 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m12:43:44.032957 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c2fd07ed-d1d8-4de5-9519-0e077d76a4d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9b8609a30>]}
[0m12:43:44.034120 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 8[0m in 1.60s]
[0m12:43:44.035332 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:43:44.036077 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:43:44.037093 [info ] [Thread-1  ]: 6 of 7 SKIP relation final_sales.fct_order_detail .............................. [[33mSKIP[0m]
[0m12:43:44.038048 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:43:44.039360 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:43:44.040152 [info ] [Thread-1  ]: 7 of 7 SKIP relation final_sales.product_sales ................................. [[33mSKIP[0m]
[0m12:43:44.041004 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:43:44.043273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:43:44.043784 [debug] [MainThread]: Connection 'model.development.fct_payment_details' was properly closed.
[0m12:43:44.044328 [info ] [MainThread]: 
[0m12:43:44.045042 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 10.10 seconds (10.10s).
[0m12:43:44.047651 [debug] [MainThread]: Command end result
[0m12:43:44.064782 [info ] [MainThread]: 
[0m12:43:44.065574 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:43:44.066135 [info ] [MainThread]: 
[0m12:43:44.066766 [error] [MainThread]: [33mDatabase Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)[0m
[0m12:43:44.067343 [error] [MainThread]:   100090 (42P18): Duplicate row detected during DML action
[0m12:43:44.067946 [error] [MainThread]:   Row Values: [redacted]
[0m12:43:44.068499 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:43:44.069118 [info ] [MainThread]: 
[0m12:43:44.069678 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 TOTAL=7
[0m12:43:44.070647 [debug] [MainThread]: Command `dbt run` failed at 12:43:44.070478 after 10.70 seconds
[0m12:43:44.071218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9c1520430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9b9839f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9b857dcd0>]}
[0m12:43:44.071872 [debug] [MainThread]: Flushing usage events
[0m12:46:14.340228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342b7c4520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342a0a2640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342a0a2100>]}


============================== 12:46:14.344018 | 31f1b52b-6ba9-44ba-b179-cf04486fa2bd ==============================
[0m12:46:14.344018 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:46:14.344878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:46:14.669080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31f1b52b-6ba9-44ba-b179-cf04486fa2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34259bc100>]}
[0m12:46:14.690385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31f1b52b-6ba9-44ba-b179-cf04486fa2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34259b90d0>]}
[0m12:46:14.706563 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:46:14.735611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:46:14.736546 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/bronze/bronze_orders.sql
[0m12:46:14.771554 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m12:46:14.791136 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m12:46:14.817865 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m12:46:14.824305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31f1b52b-6ba9-44ba-b179-cf04486fa2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3424359400>]}
[0m12:46:14.833457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31f1b52b-6ba9-44ba-b179-cf04486fa2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3425846340>]}
[0m12:46:14.834126 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:46:14.834804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31f1b52b-6ba9-44ba-b179-cf04486fa2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3425846490>]}
[0m12:46:14.837000 [info ] [MainThread]: 
[0m12:46:14.837947 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:46:14.841090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:46:14.858905 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:46:14.859525 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:46:14.860144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:15.535569 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:46:15.538930 [debug] [ThreadPool]: On list_external_db: Close
[0m12:46:15.641804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m12:46:15.652111 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:46:15.652720 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:46:15.653245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:15.964231 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:46:15.966862 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:46:16.064202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31f1b52b-6ba9-44ba-b179-cf04486fa2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3425837f70>]}
[0m12:46:16.065484 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:46:16.066057 [info ] [MainThread]: 
[0m12:46:16.071597 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:46:16.072296 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:46:16.073246 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:46:16.073827 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:46:16.079439 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:46:16.080428 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:46:16.074465 => 12:46:16.080061
[0m12:46:16.081044 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:46:16.154830 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:46:16.155662 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m12:46:16.156162 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:16.685881 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:16.698584 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:46:16.699097 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m12:46:16.773454 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:46:16.778804 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:46:16.779362 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m12:46:16.844372 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:46:16.855242 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:46:16.855749 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m12:46:16.918769 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:46:16.962103 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m12:46:16.963927 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:46:16.964421 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m12:46:17.053483 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:17.054335 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:46:17.054940 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m12:46:17.511045 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:46:17.512244 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:46:17.512942 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m12:46:17.716020 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:17.727126 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:46:17.727714 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m12:46:17.817421 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:17.843454 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:46:16.081467 => 12:46:17.843150
[0m12:46:17.843985 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:46:17.941433 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31f1b52b-6ba9-44ba-b179-cf04486fa2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34176c2e20>]}
[0m12:46:17.942668 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 10[0m in 1.87s]
[0m12:46:17.944404 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:46:17.945092 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:46:17.945741 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:46:17.946943 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:46:17.947441 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:46:17.954090 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:46:17.955018 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:46:17.947809 => 12:46:17.954698
[0m12:46:17.955541 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:46:18.024815 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:46:18.025462 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
  );
[0m12:46:18.025953 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:18.384580 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:18.389388 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:46:18.389969 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m12:46:18.467921 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:46:18.472980 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:46:18.473522 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m12:46:18.544298 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:46:18.549721 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:46:18.550328 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m12:46:18.617470 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:46:18.622975 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:46:18.625058 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:46:18.625732 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m12:46:18.707259 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:18.708211 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:46:18.708867 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")

;
[0m12:46:19.179309 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad233e-0000-fb87-0000-0001937ec4b9
[0m12:46:19.180206 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m12:46:19.181164 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:46:17.955848 => 12:46:19.180781
[0m12:46:19.181740 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:46:19.330465 [debug] [Thread-1  ]: Database Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:46:19.331339 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31f1b52b-6ba9-44ba-b179-cf04486fa2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3417616d00>]}
[0m12:46:19.332176 [error] [Thread-1  ]: 2 of 7 ERROR creating sql incremental model final_sales.bronze_orders .......... [[31mERROR[0m in 1.38s]
[0m12:46:19.333074 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:46:19.333708 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:46:19.334361 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:46:19.335503 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:46:19.336144 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:46:19.341209 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:46:19.342176 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:46:19.336515 => 12:46:19.341833
[0m12:46:19.342832 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:46:19.348025 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:46:19.348526 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
  );
[0m12:46:19.349077 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:19.728974 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:19.733843 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:46:19.734348 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m12:46:19.816734 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:46:19.824467 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:46:19.825145 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m12:46:19.894937 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:46:19.900625 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:46:19.901188 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m12:46:19.967130 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:46:19.972398 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:46:19.974514 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:46:19.975063 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m12:46:20.069504 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:20.070406 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:46:20.070915 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m12:46:20.698915 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m12:46:20.699675 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:46:20.700118 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m12:46:20.900801 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:20.906646 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:46:20.907317 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m12:46:21.003670 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:21.008029 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:46:19.343207 => 12:46:21.007737
[0m12:46:21.008803 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:46:21.115692 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31f1b52b-6ba9-44ba-b179-cf04486fa2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3415d11220>]}
[0m12:46:21.117070 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 10[0m in 1.78s]
[0m12:46:21.118135 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:46:21.118863 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:46:21.119959 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:46:21.121003 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:46:21.121493 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:46:21.125999 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:46:21.127194 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:46:21.121814 => 12:46:21.126735
[0m12:46:21.127844 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:46:21.133398 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:46:21.135344 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_date('2023-06-22','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
  );
[0m12:46:21.135875 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:21.499248 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:21.504101 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:46:21.504761 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m12:46:21.573040 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:46:21.578623 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:46:21.579165 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m12:46:21.646254 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:46:21.652041 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:46:21.652555 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m12:46:21.725185 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:46:21.730420 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:46:21.735514 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:46:21.736168 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m12:46:21.807768 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:21.808559 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:46:21.809327 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m12:46:22.235619 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:46:22.236397 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:46:22.236898 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m12:46:22.427105 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:22.433240 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:46:22.433996 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m12:46:22.527988 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:22.532110 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:46:21.128187 => 12:46:22.531748
[0m12:46:22.532795 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:46:22.639449 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31f1b52b-6ba9-44ba-b179-cf04486fa2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3415c6b310>]}
[0m12:46:22.640691 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 10[0m in 1.52s]
[0m12:46:22.641795 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:46:22.642403 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:46:22.643187 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m12:46:22.644776 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m12:46:22.645440 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m12:46:22.655203 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m12:46:22.656282 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 12:46:22.645777 => 12:46:22.655958
[0m12:46:22.656894 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m12:46:22.662103 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:46:22.662646 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
  );
[0m12:46:22.663166 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:23.029028 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:23.033300 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:46:23.034296 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m12:46:23.110883 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:46:23.116218 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:46:23.116986 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m12:46:23.181025 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:46:23.186010 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:46:23.186480 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m12:46:23.248538 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:46:23.253067 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m12:46:23.254877 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:46:23.255315 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m12:46:23.345677 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:23.346246 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:46:23.346795 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")

;
[0m12:46:23.874503 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 1.0 seconds
[0m12:46:23.875352 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:46:23.875944 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m12:46:24.088335 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:24.094070 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:46:24.094582 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m12:46:24.187432 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:24.191704 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 12:46:22.657261 => 12:46:24.191382
[0m12:46:24.192179 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m12:46:24.296111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31f1b52b-6ba9-44ba-b179-cf04486fa2bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3415c1b490>]}
[0m12:46:24.297389 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 8[0m in 1.65s]
[0m12:46:24.298303 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:46:24.298960 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:46:24.299563 [info ] [Thread-1  ]: 6 of 7 SKIP relation final_sales.fct_order_detail .............................. [[33mSKIP[0m]
[0m12:46:24.300620 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:46:24.301905 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:46:24.302720 [info ] [Thread-1  ]: 7 of 7 SKIP relation final_sales.product_sales ................................. [[33mSKIP[0m]
[0m12:46:24.303558 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:46:24.305493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:24.306039 [debug] [MainThread]: Connection 'model.development.fct_payment_details' was properly closed.
[0m12:46:24.306609 [info ] [MainThread]: 
[0m12:46:24.307142 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 9.47 seconds (9.47s).
[0m12:46:24.309044 [debug] [MainThread]: Command end result
[0m12:46:24.319721 [info ] [MainThread]: 
[0m12:46:24.320284 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:46:24.321018 [info ] [MainThread]: 
[0m12:46:24.321652 [error] [MainThread]: [33mDatabase Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)[0m
[0m12:46:24.322159 [error] [MainThread]:   100090 (42P18): Duplicate row detected during DML action
[0m12:46:24.322692 [error] [MainThread]:   Row Values: [redacted]
[0m12:46:24.323152 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:46:24.323726 [info ] [MainThread]: 
[0m12:46:24.324307 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 TOTAL=7
[0m12:46:24.325476 [debug] [MainThread]: Command `dbt run` failed at 12:46:24.325245 after 10.01 seconds
[0m12:46:24.326002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342b7c4520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34176e9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34176e9ee0>]}
[0m12:46:24.326521 [debug] [MainThread]: Flushing usage events
[0m12:46:50.215207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febbe9784c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febbd23b5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febbd23b1f0>]}


============================== 12:46:50.218637 | d4e386d5-5d80-4622-9934-a14e19863de9 ==============================
[0m12:46:50.218637 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:46:50.219421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:46:50.545664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4e386d5-5d80-4622-9934-a14e19863de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb8b59100>]}
[0m12:46:50.566838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4e386d5-5d80-4622-9934-a14e19863de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb8b540a0>]}
[0m12:46:50.583994 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:46:50.611200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:46:50.611665 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:46:50.612767 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m12:46:50.620468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4e386d5-5d80-4622-9934-a14e19863de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb794e4c0>]}
[0m12:46:50.628889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4e386d5-5d80-4622-9934-a14e19863de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb8a54370>]}
[0m12:46:50.629508 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:46:50.630032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4e386d5-5d80-4622-9934-a14e19863de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb8a544c0>]}
[0m12:46:50.632062 [info ] [MainThread]: 
[0m12:46:50.633689 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:46:50.635566 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:46:50.665332 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:46:50.666125 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:46:50.666755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:46:51.332908 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:46:51.335994 [debug] [ThreadPool]: On list_external_db: Close
[0m12:46:51.453311 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now create_external_db_final_sales)
[0m12:46:51.454616 [debug] [ThreadPool]: Creating schema "database: "external_db"
schema: "final_sales"
"
[0m12:46:51.462244 [debug] [ThreadPool]: Using snowflake connection "create_external_db_final_sales"
[0m12:46:51.462739 [debug] [ThreadPool]: On create_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "create_external_db_final_sales"} */
create schema if not exists external_db.final_sales
[0m12:46:51.463153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:51.922515 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:51.923978 [debug] [ThreadPool]: On create_external_db_final_sales: Close
[0m12:46:52.030471 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_external_db_final_sales, now list_external_db_final_sales)
[0m12:46:52.040774 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:46:52.041407 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:46:52.041899 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:46:52.359687 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m12:46:52.362166 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:46:52.471895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4e386d5-5d80-4622-9934-a14e19863de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb8b07880>]}
[0m12:46:52.473398 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:46:52.474006 [info ] [MainThread]: 
[0m12:46:52.479377 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:46:52.480130 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:46:52.481494 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:46:52.482029 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:46:52.487405 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:46:52.488571 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:46:52.482389 => 12:46:52.488106
[0m12:46:52.489114 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:46:52.567616 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m12:46:52.569214 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:46:52.569793 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace transient table external_db.final_sales.bronze_customers
         as
        (

with customers as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
        );
[0m12:46:52.570355 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:53.245376 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:53.256130 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:46:53.256805 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m12:46:53.329026 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:53.355602 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:46:52.489443 => 12:46:53.355309
[0m12:46:53.356565 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:46:53.466333 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4e386d5-5d80-4622-9934-a14e19863de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb6cfc130>]}
[0m12:46:53.468311 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 1[0m in 0.98s]
[0m12:46:53.469822 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:46:53.470453 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:46:53.471461 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:46:53.472575 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:46:53.473204 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:46:53.478120 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:46:53.479085 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:46:53.473618 => 12:46:53.478712
[0m12:46:53.479571 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:46:53.484574 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:46:53.485780 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:46:53.486221 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace transient table external_db.final_sales.bronze_orders
         as
        (

with orders as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
        );
[0m12:46:53.486722 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:54.137085 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:54.142729 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:46:54.143355 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m12:46:54.206988 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:54.210574 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:46:53.479911 => 12:46:54.210243
[0m12:46:54.211042 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:46:54.318577 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4e386d5-5d80-4622-9934-a14e19863de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb53cbfa0>]}
[0m12:46:54.319653 [info ] [Thread-1  ]: 2 of 7 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 1[0m in 0.85s]
[0m12:46:54.320711 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:46:54.321398 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:46:54.322123 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:46:54.323329 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:46:54.324000 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:46:54.330229 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:46:54.331380 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:46:54.325205 => 12:46:54.330993
[0m12:46:54.332021 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:46:54.338305 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:46:54.339448 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:46:54.340043 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace transient table external_db.final_sales.bronze_payments
         as
        (

with payments as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
        );
[0m12:46:54.340523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:54.978933 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:54.984812 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:46:54.985443 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m12:46:55.054781 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:55.060005 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:46:54.332425 => 12:46:55.059678
[0m12:46:55.060607 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:46:55.153104 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4e386d5-5d80-4622-9934-a14e19863de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb8b07b80>]}
[0m12:46:55.154228 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 1[0m in 0.83s]
[0m12:46:55.160909 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:46:55.161543 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:46:55.162492 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:46:55.163713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:46:55.164202 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:46:55.169534 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:46:55.170635 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:46:55.164960 => 12:46:55.170194
[0m12:46:55.171239 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:46:55.176681 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:46:55.183321 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:46:55.185384 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace transient table external_db.final_sales.bronze_products
         as
        (

with products as (
     select *, 
     to_date('2023-06-22','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
        );
[0m12:46:55.187309 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:55.874128 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:55.879599 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:46:55.880246 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m12:46:55.936730 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:55.940000 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:46:55.171699 => 12:46:55.939711
[0m12:46:55.940553 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:46:56.042544 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4e386d5-5d80-4622-9934-a14e19863de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb539b310>]}
[0m12:46:56.043705 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 1[0m in 0.88s]
[0m12:46:56.044775 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:46:56.045348 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:46:56.045902 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m12:46:56.047234 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m12:46:56.047749 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m12:46:56.061543 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m12:46:56.062838 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 12:46:56.048069 => 12:46:56.062448
[0m12:46:56.063652 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m12:46:56.068947 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m12:46:56.070129 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:46:56.070739 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace transient table external_db.final_sales.fct_payment_details
         as
        (

with payments as (
    select * from external_db.final_sales.bronze_payments
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
        );
[0m12:46:56.071215 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:56.791557 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:56.796444 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:46:56.797038 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m12:46:56.855710 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:56.859857 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 12:46:56.064054 => 12:46:56.859523
[0m12:46:56.860408 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m12:46:56.961734 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4e386d5-5d80-4622-9934-a14e19863de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb6c3bee0>]}
[0m12:46:56.963350 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 1[0m in 0.91s]
[0m12:46:56.964475 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:46:56.965192 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:46:56.965868 [info ] [Thread-1  ]: 6 of 7 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m12:46:56.967079 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m12:46:56.967610 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m12:46:56.977421 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m12:46:56.978526 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 12:46:56.967971 => 12:46:56.978041
[0m12:46:56.979085 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m12:46:57.055935 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m12:46:57.057741 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:46:57.058629 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace transient table external_db.final_sales.fct_order_detail
         as
        (
with orders as (
    select * from external_db.final_sales.bronze_orders
   
),

products as (
    select * from external_db.final_sales.bronze_products
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_date
    from orders
    left join products using (product_id)
)
select * from final
        );
[0m12:46:57.059499 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:57.927847 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:57.934287 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:46:57.934809 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m12:46:57.994471 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:57.998919 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 12:46:56.979434 => 12:46:57.998622
[0m12:46:57.999443 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m12:46:58.095825 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4e386d5-5d80-4622-9934-a14e19863de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb537bf70>]}
[0m12:46:58.097085 [info ] [Thread-1  ]: 6 of 7 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 1[0m in 1.13s]
[0m12:46:58.098133 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:46:58.099721 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:46:58.100329 [info ] [Thread-1  ]: 7 of 7 START sql incremental model final_sales.product_sales ................... [RUN]
[0m12:46:58.101260 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m12:46:58.101847 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m12:46:58.110171 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m12:46:58.111163 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 12:46:58.102291 => 12:46:58.110861
[0m12:46:58.111657 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m12:46:58.116702 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m12:46:58.118462 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:46:58.118954 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace transient table external_db.final_sales.product_sales
         as
        (

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
        );
[0m12:46:58.119441 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:46:59.065711 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:46:59.070409 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:46:59.070932 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m12:46:59.130552 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:46:59.134462 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 12:46:58.112078 => 12:46:59.134198
[0m12:46:59.134962 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m12:46:59.234088 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4e386d5-5d80-4622-9934-a14e19863de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb712f430>]}
[0m12:46:59.235462 [info ] [Thread-1  ]: 7 of 7 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 1[0m in 1.13s]
[0m12:46:59.236591 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:46:59.238983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:46:59.239386 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m12:46:59.239824 [info ] [MainThread]: 
[0m12:46:59.240323 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 8.61 seconds (8.61s).
[0m12:46:59.242643 [debug] [MainThread]: Command end result
[0m12:46:59.253933 [info ] [MainThread]: 
[0m12:46:59.254621 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:46:59.255123 [info ] [MainThread]: 
[0m12:46:59.255629 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:46:59.256926 [debug] [MainThread]: Command `dbt run` succeeded at 12:46:59.256735 after 9.06 seconds
[0m12:46:59.257413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febbe9784c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb8b540a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febb8a543d0>]}
[0m12:46:59.258113 [debug] [MainThread]: Flushing usage events
[0m12:47:07.652561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de43bd4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de2c805e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de2c80490>]}


============================== 12:47:07.656457 | ef15d3eb-0367-4325-9564-f0d53b07e6a8 ==============================
[0m12:47:07.656457 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:47:07.657355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:47:07.984942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef15d3eb-0367-4325-9564-f0d53b07e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dde59e100>]}
[0m12:47:08.008318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef15d3eb-0367-4325-9564-f0d53b07e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dde59c0a0>]}
[0m12:47:08.025834 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:47:08.055722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:47:08.056294 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:47:08.057295 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.bronze
- models.development.staging
[0m12:47:08.066210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef15d3eb-0367-4325-9564-f0d53b07e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ddd38e4c0>]}
[0m12:47:08.075723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef15d3eb-0367-4325-9564-f0d53b07e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dde494370>]}
[0m12:47:08.076348 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:47:08.076968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef15d3eb-0367-4325-9564-f0d53b07e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dde4944c0>]}
[0m12:47:08.079301 [info ] [MainThread]: 
[0m12:47:08.080460 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:47:08.082628 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:47:08.106888 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:47:08.107570 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:47:08.108042 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:08.785292 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:47:08.788674 [debug] [ThreadPool]: On list_external_db: Close
[0m12:47:08.876373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m12:47:08.887374 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:47:08.887960 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:47:08.888470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:09.339393 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m12:47:09.342170 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:47:09.446931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef15d3eb-0367-4325-9564-f0d53b07e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ddd3eed00>]}
[0m12:47:09.448563 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:09.449716 [info ] [MainThread]: 
[0m12:47:09.456456 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:47:09.457324 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:47:09.458370 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:47:09.459095 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:47:09.464635 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:47:09.465605 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:47:09.459612 => 12:47:09.465256
[0m12:47:09.466074 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:47:09.538814 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:47:09.539569 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m12:47:09.540103 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:47:09.908464 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:09.921115 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:47:09.921776 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m12:47:10.002170 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:47:10.008443 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:47:10.009029 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m12:47:10.078492 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:47:10.091718 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:47:10.092561 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m12:47:10.154877 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:47:10.200779 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m12:47:10.202977 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:47:10.203689 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m12:47:10.282279 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:10.283039 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:47:10.283589 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m12:47:10.727822 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:47:10.728748 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:47:10.729322 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m12:47:10.933743 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:10.947519 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:47:10.948203 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m12:47:11.034565 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:11.067485 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:47:09.466399 => 12:47:11.067127
[0m12:47:11.068134 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:47:11.166055 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef15d3eb-0367-4325-9564-f0d53b07e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ddc6287c0>]}
[0m12:47:11.167175 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 10[0m in 1.71s]
[0m12:47:11.168402 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:47:11.169149 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:47:11.169974 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:47:11.171366 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:47:11.171905 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:47:11.177053 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:47:11.178099 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:47:11.172258 => 12:47:11.177726
[0m12:47:11.178672 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:47:11.185408 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:47:11.185970 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
  );
[0m12:47:11.186468 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:47:11.572268 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:11.576617 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:47:11.577148 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m12:47:11.655821 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:47:11.661347 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:47:11.661945 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m12:47:11.735760 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:47:11.741087 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:47:11.741580 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m12:47:11.806326 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:47:11.811547 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:47:11.813410 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:47:11.813924 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m12:47:11.893798 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:11.894634 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:47:11.895237 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")

;
[0m12:47:12.286097 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad233f-0000-fb4f-0000-0001937eb551
[0m12:47:12.286862 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m12:47:12.287837 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:47:11.179037 => 12:47:12.287416
[0m12:47:12.288434 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:47:12.453225 [debug] [Thread-1  ]: Database Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:47:12.454123 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef15d3eb-0367-4325-9564-f0d53b07e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ddc64b3d0>]}
[0m12:47:12.455141 [error] [Thread-1  ]: 2 of 7 ERROR creating sql incremental model final_sales.bronze_orders .......... [[31mERROR[0m in 1.28s]
[0m12:47:12.456026 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:47:12.456637 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:47:12.457630 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:47:12.458874 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:47:12.459426 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:47:12.465418 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:47:12.466403 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:47:12.459795 => 12:47:12.466051
[0m12:47:12.466927 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:47:12.472802 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:47:12.473975 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
  );
[0m12:47:12.474972 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:47:12.832222 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:12.836996 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:47:12.837559 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m12:47:12.902581 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:47:12.908335 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:47:12.908962 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m12:47:12.976120 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:47:12.984326 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:47:12.984954 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m12:47:13.129804 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:47:13.139500 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:47:13.141686 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:47:13.142224 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m12:47:13.254465 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:13.255227 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:47:13.255899 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m12:47:13.734876 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:47:13.735700 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:47:13.736180 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m12:47:13.946193 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:13.951691 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:47:13.952250 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m12:47:14.042779 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:14.047369 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:47:12.467356 => 12:47:14.047032
[0m12:47:14.047957 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:47:14.139161 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef15d3eb-0367-4325-9564-f0d53b07e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ddc5c9400>]}
[0m12:47:14.140287 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 10[0m in 1.68s]
[0m12:47:14.141327 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:47:14.142051 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:47:14.142993 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:47:14.144249 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:47:14.144879 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:47:14.150452 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:47:14.151749 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:47:14.145241 => 12:47:14.151400
[0m12:47:14.152289 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:47:14.158287 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:47:14.158891 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_date('2023-06-22','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
  );
[0m12:47:14.159448 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:47:14.503023 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:14.507496 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:47:14.507999 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m12:47:14.583700 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:47:14.588952 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:47:14.589527 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m12:47:14.652668 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:47:14.659603 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:47:14.660222 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m12:47:14.719812 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:47:14.724640 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:47:14.726477 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:47:14.727472 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m12:47:14.814177 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:14.815085 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:47:14.816025 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m12:47:15.130529 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:47:15.131467 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:47:15.132746 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m12:47:15.320868 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:15.329541 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:47:15.330291 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m12:47:15.426196 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:15.430032 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:47:14.152720 => 12:47:15.429722
[0m12:47:15.430654 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:47:15.529938 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef15d3eb-0367-4325-9564-f0d53b07e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ddc48ad60>]}
[0m12:47:15.531032 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 10[0m in 1.39s]
[0m12:47:15.531998 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:47:15.532674 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:47:15.533306 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m12:47:15.534345 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m12:47:15.534870 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m12:47:15.546383 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m12:47:15.547585 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 12:47:15.535213 => 12:47:15.547253
[0m12:47:15.548112 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m12:47:15.553251 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:47:15.553825 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
  );
[0m12:47:15.554410 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:47:15.917966 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:15.922734 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:47:15.923236 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m12:47:15.999737 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:47:16.006553 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:47:16.007152 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m12:47:16.085467 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:47:16.091466 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:47:16.092046 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m12:47:16.155307 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:47:16.160885 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m12:47:16.162674 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:47:16.163251 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m12:47:16.241554 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:16.242345 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:47:16.242999 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")

;
[0m12:47:16.697581 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.0 seconds
[0m12:47:16.698631 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:47:16.699217 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m12:47:16.920997 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:16.926167 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:47:16.926669 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m12:47:17.020455 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:47:17.024350 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 12:47:15.548468 => 12:47:17.024031
[0m12:47:17.024949 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m12:47:17.133361 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef15d3eb-0367-4325-9564-f0d53b07e6a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ddc5b9d90>]}
[0m12:47:17.134618 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 8[0m in 1.60s]
[0m12:47:17.135597 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:47:17.136299 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:47:17.136891 [info ] [Thread-1  ]: 6 of 7 SKIP relation final_sales.fct_order_detail .............................. [[33mSKIP[0m]
[0m12:47:17.137912 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:47:17.139351 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:47:17.139951 [info ] [Thread-1  ]: 7 of 7 SKIP relation final_sales.product_sales ................................. [[33mSKIP[0m]
[0m12:47:17.140701 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:47:17.142930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:17.143336 [debug] [MainThread]: Connection 'model.development.fct_payment_details' was properly closed.
[0m12:47:17.143855 [info ] [MainThread]: 
[0m12:47:17.144564 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 9.06 seconds (9.06s).
[0m12:47:17.146283 [debug] [MainThread]: Command end result
[0m12:47:17.157327 [info ] [MainThread]: 
[0m12:47:17.157942 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:47:17.158416 [info ] [MainThread]: 
[0m12:47:17.158887 [error] [MainThread]: [33mDatabase Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)[0m
[0m12:47:17.159366 [error] [MainThread]:   100090 (42P18): Duplicate row detected during DML action
[0m12:47:17.159857 [error] [MainThread]:   Row Values: [redacted]
[0m12:47:17.160628 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m12:47:17.161174 [info ] [MainThread]: 
[0m12:47:17.161740 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=2 TOTAL=7
[0m12:47:17.162760 [debug] [MainThread]: Command `dbt run` failed at 12:47:17.162536 after 9.53 seconds
[0m12:47:17.163306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de43bd4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4de20fad30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dde494370>]}
[0m12:47:17.163839 [debug] [MainThread]: Flushing usage events
[0m12:52:25.757457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa612b2a4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa611408610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa611408100>]}


============================== 12:52:25.761032 | 33facbf4-2e86-4641-95c2-591c2b5dc67e ==============================
[0m12:52:25.761032 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:52:25.761718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:52:26.086503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33facbf4-2e86-4641-95c2-591c2b5dc67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60cd1a0a0>]}
[0m12:52:26.111159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33facbf4-2e86-4641-95c2-591c2b5dc67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60cd250d0>]}
[0m12:52:26.130904 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:52:26.160544 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:26.161140 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:26.162025 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m12:52:26.170875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33facbf4-2e86-4641-95c2-591c2b5dc67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60bb0c460>]}
[0m12:52:26.180159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33facbf4-2e86-4641-95c2-591c2b5dc67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60bb7e310>]}
[0m12:52:26.180907 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:52:26.181474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33facbf4-2e86-4641-95c2-591c2b5dc67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60bb7e460>]}
[0m12:52:26.183515 [info ] [MainThread]: 
[0m12:52:26.184561 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:52:26.186461 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:52:26.205049 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:52:26.205758 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:52:26.206312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:26.933296 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:52:26.940262 [debug] [ThreadPool]: On list_external_db: Close
[0m12:52:27.054120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m12:52:27.065343 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:52:27.065943 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:52:27.066414 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:27.512547 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m12:52:27.515118 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:52:27.618803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33facbf4-2e86-4641-95c2-591c2b5dc67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60bb6cf10>]}
[0m12:52:27.620378 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:52:27.621048 [info ] [MainThread]: 
[0m12:52:27.626118 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:52:27.626924 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:52:27.627920 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:52:27.628706 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:52:27.633956 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:52:27.634942 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:52:27.629088 => 12:52:27.634579
[0m12:52:27.635549 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:52:27.701161 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:52:27.701893 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m12:52:27.702410 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:52:28.105839 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:28.118182 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:52:28.118674 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m12:52:28.196254 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:52:28.201478 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:52:28.202002 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m12:52:28.266003 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:52:28.276995 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:52:28.277550 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m12:52:28.353908 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:52:28.398682 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m12:52:28.400369 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:52:28.400883 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m12:52:28.491617 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:28.492386 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:52:28.493106 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m12:52:29.446512 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m12:52:29.447444 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:52:29.448011 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m12:52:29.662383 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:29.673590 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:52:29.674269 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m12:52:29.772043 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:29.803465 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:52:27.635915 => 12:52:29.803100
[0m12:52:29.804129 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:52:29.906174 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33facbf4-2e86-4641-95c2-591c2b5dc67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6095ab940>]}
[0m12:52:29.907355 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 10[0m in 2.28s]
[0m12:52:29.908652 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:52:29.909290 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:52:29.910404 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:52:29.911533 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:52:29.912039 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:52:29.916990 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:52:29.918030 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:52:29.912395 => 12:52:29.917650
[0m12:52:29.918548 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:52:29.923230 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:52:29.923898 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
  );
[0m12:52:29.924401 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:52:30.312482 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:30.317342 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:52:30.317864 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m12:52:30.399025 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:52:30.405038 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:52:30.405593 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m12:52:30.479887 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:52:30.485314 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:52:30.485934 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m12:52:30.548996 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:52:30.554704 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:52:30.556465 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:52:30.557186 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m12:52:30.635422 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:30.636110 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:52:30.636612 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")

;
[0m12:52:31.149466 [debug] [Thread-1  ]: SQL status: SUCCESS 11 in 1.0 seconds
[0m12:52:31.150405 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:52:31.150913 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m12:52:31.360285 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:31.366257 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:52:31.366844 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m12:52:31.452077 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:31.457034 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:52:29.918859 => 12:52:31.456702
[0m12:52:31.457567 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:52:31.555389 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33facbf4-2e86-4641-95c2-591c2b5dc67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60adeefa0>]}
[0m12:52:31.556366 [info ] [Thread-1  ]: 2 of 7 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 11[0m in 1.64s]
[0m12:52:31.557221 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:52:31.557813 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:52:31.558457 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:52:31.559672 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:52:31.560145 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:52:31.565470 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:52:31.566537 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:52:31.560465 => 12:52:31.566176
[0m12:52:31.567139 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:52:31.573160 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:52:31.573632 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
  );
[0m12:52:31.574311 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:52:31.970808 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:31.976863 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:52:31.977881 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m12:52:32.058684 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:52:32.069455 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:52:32.070053 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m12:52:32.128402 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:52:32.203714 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:52:32.204568 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m12:52:32.270107 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:52:32.275509 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:52:32.277486 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:52:32.278013 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m12:52:32.357038 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:32.358016 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:52:32.358585 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m12:52:32.979839 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m12:52:32.980962 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:52:32.981483 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m12:52:33.186947 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:33.192062 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:52:33.192784 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m12:52:33.281676 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:33.285637 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:52:31.567642 => 12:52:33.285275
[0m12:52:33.286194 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:52:33.390674 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33facbf4-2e86-4641-95c2-591c2b5dc67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6095d5760>]}
[0m12:52:33.391626 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 10[0m in 1.83s]
[0m12:52:33.392823 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:52:33.394799 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:52:33.395692 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:52:33.397047 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:52:33.397591 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:52:33.405140 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:52:33.406931 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:52:33.397979 => 12:52:33.406336
[0m12:52:33.407536 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:52:33.413484 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:52:33.414767 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_date('2023-06-22','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
  );
[0m12:52:33.415251 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:52:33.804826 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:33.809299 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:52:33.809795 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m12:52:33.882355 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:52:33.887864 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:52:33.890019 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m12:52:33.962548 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:52:33.968143 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:52:33.968637 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m12:52:34.040988 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:52:34.046656 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:52:34.048326 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:52:34.048817 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m12:52:34.138547 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:34.139306 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:52:34.139859 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m12:52:34.782318 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m12:52:34.783159 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:52:34.783651 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m12:52:34.998669 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:35.006491 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:52:35.006990 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m12:52:35.105542 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:35.114872 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:52:33.408040 => 12:52:35.114408
[0m12:52:35.115641 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:52:35.235799 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33facbf4-2e86-4641-95c2-591c2b5dc67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60950ef70>]}
[0m12:52:35.236997 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 10[0m in 1.84s]
[0m12:52:35.238369 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:52:35.239348 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:52:35.240104 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m12:52:35.241292 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m12:52:35.241877 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m12:52:35.253337 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m12:52:35.254665 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 12:52:35.242343 => 12:52:35.254277
[0m12:52:35.255280 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m12:52:35.261184 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:52:35.261774 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
  );
[0m12:52:35.262765 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:52:35.648004 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:35.653451 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:52:35.654109 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m12:52:35.729014 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:52:35.734404 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:52:35.734935 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m12:52:35.804420 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:52:35.810055 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:52:35.810591 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m12:52:35.871094 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:52:35.876402 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m12:52:35.878132 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:52:35.878703 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m12:52:35.954750 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:35.955329 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:52:35.955824 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")

;
[0m12:52:36.339457 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.0 seconds
[0m12:52:36.340317 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:52:36.340830 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m12:52:36.544792 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:36.552318 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:52:36.553327 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m12:52:36.638941 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:36.644040 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 12:52:35.255778 => 12:52:36.643739
[0m12:52:36.644635 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m12:52:36.743608 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33facbf4-2e86-4641-95c2-591c2b5dc67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60ae1de50>]}
[0m12:52:36.744828 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 8[0m in 1.50s]
[0m12:52:36.745854 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:52:36.746610 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:52:36.747363 [info ] [Thread-1  ]: 6 of 7 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m12:52:36.748219 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m12:52:36.748819 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m12:52:36.756209 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m12:52:36.757114 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 12:52:36.749144 => 12:52:36.756801
[0m12:52:36.757596 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m12:52:36.765560 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:52:36.766150 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace  temporary view external_db.final_sales.fct_order_detail__dbt_tmp
  
   as (
    
with orders as (
    select * from external_db.final_sales.bronze_orders
   
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

products as (
    select * from external_db.final_sales.bronze_products
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_date
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m12:52:36.766780 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:52:37.326020 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:52:37.330635 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:52:37.331162 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail__dbt_tmp
[0m12:52:37.400825 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:52:37.405964 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:52:37.406467 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail
[0m12:52:37.482760 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:52:37.489115 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:52:37.489795 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_ORDER_DETAIL"
[0m12:52:37.557754 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:52:37.563088 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m12:52:37.564968 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:52:37.565484 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
-- back compat for old kwarg name
  
  begin;
[0m12:52:37.640961 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:52:37.641721 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:52:37.642442 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
merge into external_db.final_sales.fct_order_detail as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_order_detail__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")

;
[0m12:52:38.091336 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2344-0000-fb4f-0000-0001937eb665
[0m12:52:38.092125 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m12:52:38.092913 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 12:52:36.757939 => 12:52:38.092567
[0m12:52:38.093440 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m12:52:38.278255 [debug] [Thread-1  ]: Database Error in model fct_order_detail (models/sales/intermediate/fct_order_detail.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/development/models/sales/intermediate/fct_order_detail.sql
[0m12:52:38.279291 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33facbf4-2e86-4641-95c2-591c2b5dc67e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60b2e5070>]}
[0m12:52:38.280208 [error] [Thread-1  ]: 6 of 7 ERROR creating sql incremental model final_sales.fct_order_detail ....... [[31mERROR[0m in 1.53s]
[0m12:52:38.281537 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:52:38.283145 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:52:38.283885 [info ] [Thread-1  ]: 7 of 7 SKIP relation final_sales.product_sales ................................. [[33mSKIP[0m]
[0m12:52:38.284853 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:52:38.287236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:38.287806 [debug] [MainThread]: Connection 'model.development.fct_order_detail' was properly closed.
[0m12:52:38.288374 [info ] [MainThread]: 
[0m12:52:38.289506 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 12.10 seconds (12.10s).
[0m12:52:38.292316 [debug] [MainThread]: Command end result
[0m12:52:38.302883 [info ] [MainThread]: 
[0m12:52:38.303529 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:52:38.304091 [info ] [MainThread]: 
[0m12:52:38.304649 [error] [MainThread]: [33mDatabase Error in model fct_order_detail (models/sales/intermediate/fct_order_detail.sql)[0m
[0m12:52:38.305135 [error] [MainThread]:   100090 (42P18): Duplicate row detected during DML action
[0m12:52:38.305752 [error] [MainThread]:   Row Values: [redacted]
[0m12:52:38.306530 [error] [MainThread]:   compiled Code at target/run/development/models/sales/intermediate/fct_order_detail.sql
[0m12:52:38.307025 [info ] [MainThread]: 
[0m12:52:38.307851 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=1 TOTAL=7
[0m12:52:38.309343 [debug] [MainThread]: Command `dbt run` failed at 12:52:38.309122 after 12.57 seconds
[0m12:52:38.310031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa612b2a4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60bb6cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa60bb6c940>]}
[0m12:52:38.310725 [debug] [MainThread]: Flushing usage events
[0m12:53:28.318740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a58b964c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a574595e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a574591f0>]}


============================== 12:53:28.323801 | 41de0259-0cb5-4eba-899d-85520ded0481 ==============================
[0m12:53:28.323801 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:53:28.324704 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:53:28.663124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41de0259-0cb5-4eba-899d-85520ded0481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a52d78100>]}
[0m12:53:28.685921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41de0259-0cb5-4eba-899d-85520ded0481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a52d760a0>]}
[0m12:53:28.702783 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:53:28.729878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:28.730392 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:28.731343 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m12:53:28.739390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41de0259-0cb5-4eba-899d-85520ded0481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a51b4d430>]}
[0m12:53:28.748352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41de0259-0cb5-4eba-899d-85520ded0481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a51bbe2e0>]}
[0m12:53:28.748934 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:53:28.749403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41de0259-0cb5-4eba-899d-85520ded0481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a51bbe430>]}
[0m12:53:28.751319 [info ] [MainThread]: 
[0m12:53:28.752476 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:53:28.754632 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:53:28.775500 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:53:28.776123 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:53:28.776643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:29.477044 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m12:53:29.480149 [debug] [ThreadPool]: On list_external_db: Close
[0m12:53:29.593417 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now create_external_db_final_sales)
[0m12:53:29.594583 [debug] [ThreadPool]: Creating schema "database: "external_db"
schema: "final_sales"
"
[0m12:53:29.603311 [debug] [ThreadPool]: Using snowflake connection "create_external_db_final_sales"
[0m12:53:29.603781 [debug] [ThreadPool]: On create_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "create_external_db_final_sales"} */
create schema if not exists external_db.final_sales
[0m12:53:29.604202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:30.094772 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:30.096929 [debug] [ThreadPool]: On create_external_db_final_sales: Close
[0m12:53:30.205080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_external_db_final_sales, now list_external_db_final_sales)
[0m12:53:30.213669 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:53:30.214090 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:53:30.214557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:30.567754 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m12:53:30.569917 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:53:30.681586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41de0259-0cb5-4eba-899d-85520ded0481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a51b58af0>]}
[0m12:53:30.682993 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:53:30.684086 [info ] [MainThread]: 
[0m12:53:30.693287 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:53:30.694190 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:53:30.695849 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:53:30.696743 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:53:30.702235 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:53:30.703200 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:53:30.697182 => 12:53:30.702854
[0m12:53:30.703802 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:53:30.784431 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m12:53:30.786215 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:53:30.786731 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace transient table external_db.final_sales.bronze_customers
         as
        (

with customers as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
        );
[0m12:53:30.787211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:31.415670 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:53:31.426559 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:53:31.427106 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m12:53:31.483497 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:31.511573 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:53:30.704187 => 12:53:31.511189
[0m12:53:31.512284 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:53:31.605806 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41de0259-0cb5-4eba-899d-85520ded0481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a50601a90>]}
[0m12:53:31.606881 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 1[0m in 0.91s]
[0m12:53:31.608013 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:53:31.608823 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:53:31.609529 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:53:31.610779 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:53:31.611475 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:53:31.616810 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:53:31.617705 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:53:31.611812 => 12:53:31.617390
[0m12:53:31.618255 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:53:31.623517 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:53:31.624758 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:53:31.625356 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace transient table external_db.final_sales.bronze_orders
         as
        (

with orders as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
        );
[0m12:53:31.625877 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:32.266335 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:53:32.271482 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:53:32.271984 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m12:53:32.331117 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:32.334906 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:53:31.618642 => 12:53:32.334548
[0m12:53:32.335470 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:53:32.441341 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41de0259-0cb5-4eba-899d-85520ded0481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a50f7b4c0>]}
[0m12:53:32.442532 [info ] [Thread-1  ]: 2 of 7 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 1[0m in 0.83s]
[0m12:53:32.443488 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:53:32.444332 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:53:32.444973 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:53:32.445963 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:53:32.446848 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:53:32.452313 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:53:32.453325 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:53:32.447232 => 12:53:32.453002
[0m12:53:32.453898 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:53:32.460780 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:53:32.462326 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:53:32.462922 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace transient table external_db.final_sales.bronze_payments
         as
        (

with payments as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
        );
[0m12:53:32.463442 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:33.102573 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:53:33.108951 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:53:33.109661 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m12:53:33.172687 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:33.177090 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:53:32.454234 => 12:53:33.176713
[0m12:53:33.177692 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:53:33.273930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41de0259-0cb5-4eba-899d-85520ded0481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a505bafd0>]}
[0m12:53:33.275230 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 1[0m in 0.83s]
[0m12:53:33.276361 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:53:33.276955 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:53:33.277527 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:53:33.278821 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:53:33.279303 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:53:33.283750 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:53:33.284732 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:53:33.279625 => 12:53:33.284366
[0m12:53:33.285253 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:53:33.290241 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:53:33.291415 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:53:33.291913 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace transient table external_db.final_sales.bronze_products
         as
        (

with products as (
     select *, 
     to_date('2023-06-22','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
        );
[0m12:53:33.292388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:33.897873 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:53:33.903636 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:53:33.904161 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m12:53:33.967213 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:33.971524 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:53:33.285784 => 12:53:33.971207
[0m12:53:33.972301 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:53:34.081672 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41de0259-0cb5-4eba-899d-85520ded0481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5056a850>]}
[0m12:53:34.083110 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 1[0m in 0.80s]
[0m12:53:34.084335 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:53:34.085099 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:53:34.086185 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m12:53:34.087277 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m12:53:34.087845 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m12:53:34.098843 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m12:53:34.099744 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 12:53:34.088175 => 12:53:34.099446
[0m12:53:34.100204 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m12:53:34.105123 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m12:53:34.106523 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:53:34.107011 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace transient table external_db.final_sales.fct_payment_details
         as
        (

with payments as (
    select * from external_db.final_sales.bronze_payments
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
        );
[0m12:53:34.107541 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:34.790203 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:53:34.796244 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:53:34.796911 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m12:53:34.858516 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:34.863754 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 12:53:34.100523 => 12:53:34.863406
[0m12:53:34.864360 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m12:53:34.966456 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41de0259-0cb5-4eba-899d-85520ded0481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5056a700>]}
[0m12:53:34.967338 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 1[0m in 0.88s]
[0m12:53:34.968613 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:53:34.969252 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:53:34.969943 [info ] [Thread-1  ]: 6 of 7 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m12:53:34.971204 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m12:53:34.971773 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m12:53:34.980577 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m12:53:34.981536 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 12:53:34.972155 => 12:53:34.981205
[0m12:53:34.982053 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m12:53:35.042018 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m12:53:35.043832 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:53:35.044438 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace transient table external_db.final_sales.fct_order_detail
         as
        (
with orders as (
    select * from external_db.final_sales.bronze_orders
   
),

products as (
    select * from external_db.final_sales.bronze_products
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_date
    from orders
    left join products using (product_id)
)
select * from final
        );
[0m12:53:35.045073 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:36.006629 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:53:36.012419 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:53:36.013019 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m12:53:36.078772 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:36.082676 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 12:53:34.982381 => 12:53:36.082301
[0m12:53:36.083272 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m12:53:36.193719 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41de0259-0cb5-4eba-899d-85520ded0481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a50599e80>]}
[0m12:53:36.194894 [info ] [Thread-1  ]: 6 of 7 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 1[0m in 1.22s]
[0m12:53:36.195857 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:53:36.197660 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:53:36.198389 [info ] [Thread-1  ]: 7 of 7 START sql incremental model final_sales.product_sales ................... [RUN]
[0m12:53:36.199520 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m12:53:36.200112 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m12:53:36.208738 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m12:53:36.209824 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 12:53:36.200661 => 12:53:36.209425
[0m12:53:36.210425 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m12:53:36.215368 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m12:53:36.217288 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:53:36.218273 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace transient table external_db.final_sales.product_sales
         as
        (

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
        );
[0m12:53:36.218793 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:37.204548 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:53:37.210445 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:53:37.210967 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m12:53:37.276505 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:37.280109 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 12:53:36.210750 => 12:53:37.279835
[0m12:53:37.280651 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m12:53:37.385930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41de0259-0cb5-4eba-899d-85520ded0481', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a5056e310>]}
[0m12:53:37.386910 [info ] [Thread-1  ]: 7 of 7 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 1[0m in 1.19s]
[0m12:53:37.387771 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:53:37.390471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:37.390937 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m12:53:37.391489 [info ] [MainThread]: 
[0m12:53:37.392089 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 8.64 seconds (8.64s).
[0m12:53:37.394304 [debug] [MainThread]: Command end result
[0m12:53:37.403230 [info ] [MainThread]: 
[0m12:53:37.403930 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:37.404499 [info ] [MainThread]: 
[0m12:53:37.405065 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:53:37.406070 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:37.405868 after 9.11 seconds
[0m12:53:37.406595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a58b964c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a51118280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a513195b0>]}
[0m12:53:37.407303 [debug] [MainThread]: Flushing usage events
[0m12:53:44.363259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f400f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f28d35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f28d3100>]}


============================== 12:53:44.367629 | 534df973-4d34-4ca1-ad23-ac38d79e11d6 ==============================
[0m12:53:44.367629 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:53:44.368378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:53:44.695961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '534df973-4d34-4ca1-ad23-ac38d79e11d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ee1f2040>]}
[0m12:53:44.718665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '534df973-4d34-4ca1-ad23-ac38d79e11d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ee1f0070>]}
[0m12:53:44.737908 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:53:44.767655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:53:44.768244 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:53:44.769147 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.intermediate
[0m12:53:44.778204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '534df973-4d34-4ca1-ad23-ac38d79e11d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ecfcd490>]}
[0m12:53:44.787386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '534df973-4d34-4ca1-ad23-ac38d79e11d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ee0e9340>]}
[0m12:53:44.787910 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:53:44.788411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '534df973-4d34-4ca1-ad23-ac38d79e11d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ee0e9490>]}
[0m12:53:44.790283 [info ] [MainThread]: 
[0m12:53:44.791164 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:53:44.793073 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:53:44.812498 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:53:44.813024 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:53:44.813460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:45.438017 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:53:45.440690 [debug] [ThreadPool]: On list_external_db: Close
[0m12:53:45.536698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m12:53:45.548198 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:53:45.548672 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:53:45.549142 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:45.848412 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m12:53:45.850966 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:53:45.955566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '534df973-4d34-4ca1-ad23-ac38d79e11d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ee066cd0>]}
[0m12:53:45.957003 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:53:45.957569 [info ] [MainThread]: 
[0m12:53:45.964494 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:53:45.965366 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:53:45.966386 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:53:45.966959 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:53:45.972527 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:53:45.973538 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:53:45.967328 => 12:53:45.973143
[0m12:53:45.974045 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:53:46.040773 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:53:46.041582 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m12:53:46.042208 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:46.561749 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:53:46.574206 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:53:46.574773 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m12:53:46.650305 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:53:46.655654 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:53:46.656216 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m12:53:46.724467 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:53:46.735629 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:53:46.736138 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m12:53:46.816006 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:53:46.859860 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m12:53:46.862277 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:53:46.862873 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m12:53:46.943253 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:46.944180 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:53:46.944788 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m12:53:47.397426 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:53:47.398220 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:53:47.398735 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m12:53:47.617346 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:47.628642 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:53:47.629148 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m12:53:47.718106 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:47.743221 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:53:45.974366 => 12:53:47.742859
[0m12:53:47.743763 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:53:47.851918 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '534df973-4d34-4ca1-ad23-ac38d79e11d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ec27b7c0>]}
[0m12:53:47.852771 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 10[0m in 1.89s]
[0m12:53:47.853805 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:53:47.854595 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:53:47.855368 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:53:47.856245 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:53:47.856904 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:53:47.861962 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:53:47.862780 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:53:47.857273 => 12:53:47.862483
[0m12:53:47.863284 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:53:47.868030 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:53:47.868574 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
  );
[0m12:53:47.869125 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:48.275269 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:48.280414 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:53:48.281020 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m12:53:48.364347 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:53:48.369901 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:53:48.370513 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m12:53:48.439098 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:53:48.444484 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:53:48.444998 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m12:53:48.511748 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:53:48.517084 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:53:48.518968 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:53:48.519506 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m12:53:48.606227 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:48.607103 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:53:48.607767 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")

;
[0m12:53:49.027356 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:53:49.028263 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:53:49.028757 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m12:53:49.228163 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:49.233129 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:53:49.233638 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m12:53:49.320913 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:49.325363 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:53:47.863647 => 12:53:49.325034
[0m12:53:49.325950 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:53:49.441912 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '534df973-4d34-4ca1-ad23-ac38d79e11d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ec2b9fd0>]}
[0m12:53:49.442933 [info ] [Thread-1  ]: 2 of 7 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 10[0m in 1.59s]
[0m12:53:49.443870 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:53:49.444624 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:53:49.445606 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:53:49.446454 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:53:49.447022 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:53:49.452118 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:53:49.453038 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:53:49.447373 => 12:53:49.452717
[0m12:53:49.453547 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:53:49.459203 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:53:49.459813 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
  );
[0m12:53:49.460405 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:49.820452 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:49.825207 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:53:49.825729 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m12:53:49.907487 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:53:49.913330 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:53:49.913818 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m12:53:50.002221 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:53:50.072903 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:53:50.073576 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m12:53:50.137701 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:53:50.142699 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:53:50.144815 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:53:50.145349 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m12:53:50.234702 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:50.235420 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:53:50.235961 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m12:53:50.562881 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:53:50.563914 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:53:50.564552 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m12:53:50.744182 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:50.749030 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:53:50.749673 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m12:53:50.839844 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:50.843638 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:53:49.454144 => 12:53:50.843302
[0m12:53:50.844224 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:53:50.956552 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '534df973-4d34-4ca1-ad23-ac38d79e11d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ec1e1310>]}
[0m12:53:50.957882 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 10[0m in 1.51s]
[0m12:53:50.958865 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:53:50.959385 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:53:50.960249 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:53:50.961585 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:53:50.962065 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:53:50.967107 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:53:50.968783 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:53:50.962401 => 12:53:50.968249
[0m12:53:50.969312 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:53:50.974203 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:53:50.974700 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_date('2023-06-22','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
  );
[0m12:53:50.975271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:51.291939 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:51.296877 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:53:51.297426 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m12:53:51.361527 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:53:51.367032 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:53:51.367629 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m12:53:51.432410 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:53:51.438201 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:53:51.438749 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m12:53:51.499667 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:53:51.504421 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:53:51.505921 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:53:51.506400 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m12:53:51.589685 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:51.590579 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:53:51.591192 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m12:53:52.034525 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:53:52.035336 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:53:52.035843 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m12:53:52.247362 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:52.254674 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:53:52.255244 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m12:53:52.339262 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:52.343393 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:53:50.969631 => 12:53:52.343046
[0m12:53:52.343943 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:53:52.448562 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '534df973-4d34-4ca1-ad23-ac38d79e11d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ec243a60>]}
[0m12:53:52.449793 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 10[0m in 1.49s]
[0m12:53:52.450799 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:53:52.451485 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:53:52.452260 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m12:53:52.453580 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m12:53:52.454136 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m12:53:52.464691 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m12:53:52.465772 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 12:53:52.454579 => 12:53:52.465370
[0m12:53:52.466295 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m12:53:52.471606 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:53:52.472273 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
  );
[0m12:53:52.473007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:52.857026 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:52.862060 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:53:52.862633 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m12:53:52.935056 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:53:52.940555 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:53:52.941280 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m12:53:53.014712 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:53:53.019877 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:53:53.020488 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m12:53:53.098034 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:53:53.103190 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m12:53:53.104998 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:53:53.105533 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m12:53:53.181551 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:53.182178 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:53:53.182716 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")

;
[0m12:53:53.566897 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.0 seconds
[0m12:53:53.567712 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:53:53.568279 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m12:53:53.773215 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:53.778521 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:53:53.779040 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m12:53:53.874671 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:53.878559 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 12:53:52.466698 => 12:53:53.878259
[0m12:53:53.879071 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m12:53:53.993997 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '534df973-4d34-4ca1-ad23-ac38d79e11d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ec2e77c0>]}
[0m12:53:53.995116 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 8[0m in 1.54s]
[0m12:53:53.996110 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:53:53.996929 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:53:53.997810 [info ] [Thread-1  ]: 6 of 7 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m12:53:53.998909 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m12:53:53.999441 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m12:53:54.007140 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m12:53:54.008377 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 12:53:53.999781 => 12:53:54.007965
[0m12:53:54.008974 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m12:53:54.016971 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:53:54.017909 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace  temporary view external_db.final_sales.fct_order_detail__dbt_tmp
  
   as (
    
with orders as (
    select * from external_db.final_sales.bronze_orders
   
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

products as (
    select * from external_db.final_sales.bronze_products
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_date
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m12:53:54.018461 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:54.417155 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:54.421666 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:53:54.422210 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail__dbt_tmp
[0m12:53:54.628547 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:53:54.634434 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:53:54.635014 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail
[0m12:53:54.701803 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:53:54.707016 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:53:54.707715 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_ORDER_DETAIL"
[0m12:53:54.777734 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:53:54.783518 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m12:53:54.785582 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:53:54.786230 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
-- back compat for old kwarg name
  
  begin;
[0m12:53:54.876773 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:54.877474 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:53:54.878131 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
merge into external_db.final_sales.fct_order_detail as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_order_detail__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")

;
[0m12:53:55.281721 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:53:55.282540 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:53:55.283065 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
COMMIT
[0m12:53:55.509681 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:55.515117 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:53:55.515700 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m12:53:55.608473 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:53:55.613029 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 12:53:54.009348 => 12:53:55.612628
[0m12:53:55.616958 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m12:53:55.727330 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '534df973-4d34-4ca1-ad23-ac38d79e11d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ec2e77c0>]}
[0m12:53:55.728435 [info ] [Thread-1  ]: 6 of 7 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 10[0m in 1.73s]
[0m12:53:55.730185 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:53:55.732151 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:53:55.732987 [info ] [Thread-1  ]: 7 of 7 START sql incremental model final_sales.product_sales ................... [RUN]
[0m12:53:55.734438 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m12:53:55.736183 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m12:53:55.746655 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m12:53:55.747719 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 12:53:55.736683 => 12:53:55.747382
[0m12:53:55.748308 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m12:53:55.755165 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:53:55.755933 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace  temporary view external_db.final_sales.product_sales__dbt_tmp
  
   as (
    

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
        where 2023-06-22 = run_date
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
        where 2023-06-22 = run_date
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
        where 2023-06-22 = run_date
    
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m12:53:55.756751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:53:56.251443 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2345-0000-fb4f-0000-0001937eb721
[0m12:53:56.252237 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001038 (22023): SQL compilation error:
Can not convert parameter 'FCT_ORDER_DETAIL.RUN_DATE' of type [DATE] into expected type [NUMBER(6,0)]
[0m12:53:56.253331 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 12:53:55.748708 => 12:53:56.252925
[0m12:53:56.254016 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m12:53:56.355478 [debug] [Thread-1  ]: Database Error in model product_sales (models/sales/core/product_sales.sql)
  001038 (22023): SQL compilation error:
  Can not convert parameter 'FCT_ORDER_DETAIL.RUN_DATE' of type [DATE] into expected type [NUMBER(6,0)]
[0m12:53:56.356580 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '534df973-4d34-4ca1-ad23-ac38d79e11d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ec17e0a0>]}
[0m12:53:56.357578 [error] [Thread-1  ]: 7 of 7 ERROR creating sql incremental model final_sales.product_sales .......... [[31mERROR[0m in 0.62s]
[0m12:53:56.358444 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:53:56.361012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:56.361507 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m12:53:56.362007 [info ] [MainThread]: 
[0m12:53:56.363014 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 11.57 seconds (11.57s).
[0m12:53:56.365697 [debug] [MainThread]: Command end result
[0m12:53:56.377413 [info ] [MainThread]: 
[0m12:53:56.377992 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:53:56.378486 [info ] [MainThread]: 
[0m12:53:56.379254 [error] [MainThread]: [33mDatabase Error in model product_sales (models/sales/core/product_sales.sql)[0m
[0m12:53:56.379978 [error] [MainThread]:   001038 (22023): SQL compilation error:
[0m12:53:56.380672 [error] [MainThread]:   Can not convert parameter 'FCT_ORDER_DETAIL.RUN_DATE' of type [DATE] into expected type [NUMBER(6,0)]
[0m12:53:56.381178 [info ] [MainThread]: 
[0m12:53:56.381713 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m12:53:56.382770 [debug] [MainThread]: Command `dbt run` failed at 12:53:56.382592 after 12.04 seconds
[0m12:53:56.383288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0f400f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ec21cd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0ee0e9340>]}
[0m12:53:56.383792 [debug] [MainThread]: Flushing usage events
[0m12:57:41.221715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad57bd490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad409b5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad409b1f0>]}


============================== 12:57:41.225654 | 626da265-cf51-4203-8c8b-7ea5533803a4 ==============================
[0m12:57:41.225654 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:57:41.226387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:57:41.553768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '626da265-cf51-4203-8c8b-7ea5533803a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacf9bd040>]}
[0m12:57:41.576368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '626da265-cf51-4203-8c8b-7ea5533803a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacf9b7070>]}
[0m12:57:41.594849 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:57:41.623129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:57:41.623816 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/core/product_sales.sql
[0m12:57:41.653526 [debug] [MainThread]: 1603: static parser failed on sales/core/product_sales.sql
[0m12:57:41.679226 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/core/product_sales.sql
[0m12:57:41.703970 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m12:57:41.710841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '626da265-cf51-4203-8c8b-7ea5533803a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faace751880>]}
[0m12:57:41.719745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '626da265-cf51-4203-8c8b-7ea5533803a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacf8b1340>]}
[0m12:57:41.720319 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:57:41.720965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '626da265-cf51-4203-8c8b-7ea5533803a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacf8b1490>]}
[0m12:57:41.723053 [info ] [MainThread]: 
[0m12:57:41.723929 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:57:41.726128 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:57:41.750174 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:57:41.750750 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:57:41.751246 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:57:42.446803 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:57:42.449983 [debug] [ThreadPool]: On list_external_db: Close
[0m12:57:42.563642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m12:57:42.574406 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:57:42.574871 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:57:42.575358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:57:43.061199 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m12:57:43.063791 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:57:43.181718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '626da265-cf51-4203-8c8b-7ea5533803a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacf82ef40>]}
[0m12:57:43.183349 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:57:43.184087 [info ] [MainThread]: 
[0m12:57:43.188844 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:57:43.189629 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:57:43.191191 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:57:43.191923 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:57:43.197293 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:57:43.198395 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:57:43.192292 => 12:57:43.198037
[0m12:57:43.199067 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:57:43.265767 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:57:43.266455 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m12:57:43.267096 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:43.649068 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:43.661254 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:57:43.661740 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m12:57:43.754593 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:57:43.759711 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:57:43.760192 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m12:57:43.823128 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:57:43.834473 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:57:43.835088 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m12:57:43.903144 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:57:43.944521 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m12:57:43.946104 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:57:43.946630 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m12:57:44.022803 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:44.023552 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:57:44.024104 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m12:57:44.524765 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:57:44.528723 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:57:44.529198 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m12:57:44.747348 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:44.758629 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:57:44.759140 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m12:57:44.852701 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:44.879391 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:57:43.199461 => 12:57:44.878963
[0m12:57:44.880102 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:57:44.982617 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '626da265-cf51-4203-8c8b-7ea5533803a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacc21f7f0>]}
[0m12:57:44.983791 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 10[0m in 1.79s]
[0m12:57:44.984778 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:57:44.985478 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:57:44.986201 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:57:44.987210 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:57:44.987777 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:57:44.994986 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:57:44.996207 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:57:44.988457 => 12:57:44.995897
[0m12:57:44.996699 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:57:45.067925 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:57:45.068737 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
  );
[0m12:57:45.069294 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:45.474717 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:45.479232 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:57:45.479887 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m12:57:45.562937 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:57:45.568500 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:57:45.569030 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m12:57:45.641633 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:57:45.646519 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:57:45.646975 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m12:57:45.711834 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:57:45.717710 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:57:45.719552 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:57:45.720109 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m12:57:45.799630 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:45.800346 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:57:45.800972 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")

;
[0m12:57:46.404419 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m12:57:46.405360 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:57:46.405968 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m12:57:46.628441 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:46.634679 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:57:46.635174 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m12:57:46.733253 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:46.737045 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:57:44.997080 => 12:57:46.736754
[0m12:57:46.737602 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:57:46.848747 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '626da265-cf51-4203-8c8b-7ea5533803a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacc21fd90>]}
[0m12:57:46.849915 [info ] [Thread-1  ]: 2 of 7 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 10[0m in 1.86s]
[0m12:57:46.850877 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:57:46.851529 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:57:46.852234 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:57:46.853784 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:57:46.854433 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:57:46.859232 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:57:46.860167 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:57:46.854859 => 12:57:46.859843
[0m12:57:46.860658 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:57:46.865338 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:57:46.865954 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
  );
[0m12:57:46.866565 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:47.263520 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:47.268728 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:57:47.269272 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m12:57:47.342185 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:57:47.347849 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:57:47.348452 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m12:57:47.416390 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:57:47.422004 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:57:47.422528 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m12:57:47.505386 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:57:47.510425 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:57:47.512149 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:57:47.512753 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m12:57:47.596647 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:47.597395 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:57:47.597916 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m12:57:48.070524 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:57:48.071530 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:57:48.072053 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m12:57:48.291826 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:48.297492 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:57:48.298108 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m12:57:48.395032 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:48.399512 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:57:46.860955 => 12:57:48.399109
[0m12:57:48.400181 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:57:48.511817 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '626da265-cf51-4203-8c8b-7ea5533803a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faace7c3940>]}
[0m12:57:48.513269 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 10[0m in 1.66s]
[0m12:57:48.514490 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:57:48.515262 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:57:48.516379 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:57:48.517788 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:57:48.518440 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:57:48.524355 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:57:48.525374 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:57:48.518884 => 12:57:48.525037
[0m12:57:48.525969 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:57:48.531969 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:57:48.532561 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_date('2023-06-22','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
  );
[0m12:57:48.533223 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:48.932170 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:48.936734 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:57:48.937345 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m12:57:49.014261 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:57:49.019818 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:57:49.020381 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m12:57:49.080250 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:57:49.087667 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:57:49.088145 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m12:57:49.165385 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:57:49.171702 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:57:49.173263 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:57:49.173720 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m12:57:49.257401 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:49.258078 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:57:49.258714 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m12:57:49.624937 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:57:49.625885 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:57:49.626400 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m12:57:49.879057 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:49.884465 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:57:49.885073 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m12:57:49.983497 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:49.988207 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:57:48.526340 => 12:57:49.987794
[0m12:57:49.988894 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:57:50.095862 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '626da265-cf51-4203-8c8b-7ea5533803a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacc181a00>]}
[0m12:57:50.097310 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 10[0m in 1.58s]
[0m12:57:50.098525 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:57:50.099225 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:57:50.099883 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m12:57:50.101014 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m12:57:50.101917 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m12:57:50.108385 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m12:57:50.109323 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 12:57:50.102296 => 12:57:50.109010
[0m12:57:50.109943 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m12:57:50.115353 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:57:50.115951 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
  );
[0m12:57:50.116474 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:50.497575 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:50.503669 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:57:50.504220 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m12:57:50.599713 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:57:50.605392 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:57:50.606039 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m12:57:50.669095 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:57:50.675297 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:57:50.675855 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m12:57:50.757093 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:57:50.762579 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m12:57:50.764323 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:57:50.764921 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m12:57:50.841640 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:50.842448 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:57:50.843004 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")

;
[0m12:57:51.399305 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 1.0 seconds
[0m12:57:51.400150 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:57:51.400767 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m12:57:51.628786 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:51.636151 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:57:51.636773 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m12:57:51.728257 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:51.731897 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 12:57:50.110342 => 12:57:51.731468
[0m12:57:51.732786 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m12:57:51.835579 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '626da265-cf51-4203-8c8b-7ea5533803a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacc0c1eb0>]}
[0m12:57:51.836705 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 8[0m in 1.73s]
[0m12:57:51.837883 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:57:51.838505 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:57:51.839116 [info ] [Thread-1  ]: 6 of 7 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m12:57:51.840284 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m12:57:51.840827 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m12:57:51.848330 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m12:57:51.849206 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 12:57:51.841153 => 12:57:51.848888
[0m12:57:51.849710 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m12:57:51.854904 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:57:51.855416 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace  temporary view external_db.final_sales.fct_order_detail__dbt_tmp
  
   as (
    
with orders as (
    select * from external_db.final_sales.bronze_orders
   
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

products as (
    select * from external_db.final_sales.bronze_products
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_date
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m12:57:51.855926 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:52.246028 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:52.250755 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:57:52.251283 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail__dbt_tmp
[0m12:57:52.320672 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:57:52.325723 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:57:52.326359 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail
[0m12:57:52.391063 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:57:52.396440 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:57:52.397127 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_ORDER_DETAIL"
[0m12:57:52.458895 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:57:52.464460 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m12:57:52.466529 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:57:52.467087 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
-- back compat for old kwarg name
  
  begin;
[0m12:57:52.546640 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:52.547461 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:57:52.548029 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
merge into external_db.final_sales.fct_order_detail as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_order_detail__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")

;
[0m12:57:53.121889 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m12:57:53.122727 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:57:53.123296 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
COMMIT
[0m12:57:53.350851 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:53.355250 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:57:53.355710 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m12:57:53.442468 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:53.446112 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 12:57:51.850016 => 12:57:53.445776
[0m12:57:53.446589 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m12:57:53.556962 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '626da265-cf51-4203-8c8b-7ea5533803a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacf9b2400>]}
[0m12:57:53.558251 [info ] [Thread-1  ]: 6 of 7 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 10[0m in 1.72s]
[0m12:57:53.559202 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:57:53.560623 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:57:53.561414 [info ] [Thread-1  ]: 7 of 7 START sql incremental model final_sales.product_sales ................... [RUN]
[0m12:57:53.562635 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m12:57:53.563164 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m12:57:53.572218 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m12:57:53.573255 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 12:57:53.563520 => 12:57:53.572876
[0m12:57:53.573843 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m12:57:53.582075 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:57:53.582766 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace  temporary view external_db.final_sales.product_sales__dbt_tmp
  
   as (
    

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m12:57:53.583300 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:57:54.146389 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:57:54.151164 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:57:54.151700 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales__dbt_tmp
[0m12:57:54.230800 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:57:54.236137 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:57:54.236653 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales
[0m12:57:54.322583 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:57:54.327973 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:57:54.328520 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."PRODUCT_SALES"
[0m12:57:54.396839 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:57:54.402228 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m12:57:54.403805 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:57:54.404319 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
-- back compat for old kwarg name
  
  begin;
[0m12:57:54.515214 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:54.516032 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:57:54.516648 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
merge into external_db.final_sales.product_sales as DBT_INTERNAL_DEST
        using external_db.final_sales.product_sales__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","ORDER_AMOUNT" = DBT_INTERNAL_SOURCE."ORDER_AMOUNT"
    

    when not matched then insert
        ("CUSTOMER_ID", "ORDER_AMOUNT")
    values
        ("CUSTOMER_ID", "ORDER_AMOUNT")

;
[0m12:57:55.104782 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:57:55.105714 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:57:55.106297 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
COMMIT
[0m12:57:55.323600 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:55.329177 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:57:55.329816 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m12:57:55.430713 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:57:55.434568 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 12:57:53.574181 => 12:57:55.434245
[0m12:57:55.435087 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m12:57:55.558566 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '626da265-cf51-4203-8c8b-7ea5533803a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faace7c0790>]}
[0m12:57:55.559654 [info ] [Thread-1  ]: 7 of 7 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 4[0m in 2.00s]
[0m12:57:55.560754 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:57:55.563162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:57:55.563583 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m12:57:55.564397 [info ] [MainThread]: 
[0m12:57:55.565042 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 13.84 seconds (13.84s).
[0m12:57:55.567694 [debug] [MainThread]: Command end result
[0m12:57:55.577710 [info ] [MainThread]: 
[0m12:57:55.578295 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:57:55.578846 [info ] [MainThread]: 
[0m12:57:55.579431 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:57:55.580716 [debug] [MainThread]: Command `dbt run` succeeded at 12:57:55.580477 after 14.38 seconds
[0m12:57:55.581253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad57bd490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faacf97b520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faad3515d00>]}
[0m12:57:55.581743 [debug] [MainThread]: Flushing usage events
[0m12:58:01.497083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d6c995b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d555a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d555a1f0>]}


============================== 12:58:01.500770 | 541340e2-794e-4018-825e-aac684bc1942 ==============================
[0m12:58:01.500770 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:58:01.501536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:58:01.806690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '541340e2-794e-4018-825e-aac684bc1942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d0e7b0d0>]}
[0m12:58:01.827821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '541340e2-794e-4018-825e-aac684bc1942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d0e78100>]}
[0m12:58:01.843414 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m12:58:01.870908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:58:01.871346 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:58:01.872219 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m12:58:01.880280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '541340e2-794e-4018-825e-aac684bc1942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cfc8d5b0>]}
[0m12:58:01.888759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '541340e2-794e-4018-825e-aac684bc1942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cfd71460>]}
[0m12:58:01.889336 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:58:01.889876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '541340e2-794e-4018-825e-aac684bc1942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cfd715b0>]}
[0m12:58:01.891880 [info ] [MainThread]: 
[0m12:58:01.892850 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:58:01.894880 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:58:01.913077 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:58:01.913639 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:58:01.914411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:58:02.424253 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:58:02.428050 [debug] [ThreadPool]: On list_external_db: Close
[0m12:58:02.532307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m12:58:02.543620 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:58:02.544059 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:58:02.544479 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:58:03.008445 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m12:58:03.010848 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:58:03.123363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '541340e2-794e-4018-825e-aac684bc1942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cfd71580>]}
[0m12:58:03.124566 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:58:03.125267 [info ] [MainThread]: 
[0m12:58:03.130346 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:58:03.131064 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:58:03.132233 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:58:03.132829 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:58:03.138116 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:58:03.139225 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:58:03.133228 => 12:58:03.138739
[0m12:58:03.139864 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:58:03.205976 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:58:03.206691 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m12:58:03.207300 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:58:03.581809 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:03.595021 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:58:03.595630 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m12:58:03.665664 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:58:03.670391 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:58:03.671051 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m12:58:03.733910 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:58:03.746630 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:58:03.747352 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m12:58:03.806982 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:58:03.852782 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m12:58:03.854715 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:58:03.855264 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m12:58:03.942847 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:03.943583 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:58:03.944149 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m12:58:04.464639 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m12:58:04.465438 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:58:04.465904 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m12:58:04.677779 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:04.689648 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:58:04.690770 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m12:58:04.781997 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:04.813190 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:58:03.140227 => 12:58:04.812779
[0m12:58:04.813869 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:58:04.920304 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '541340e2-794e-4018-825e-aac684bc1942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cd729370>]}
[0m12:58:04.921543 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 10[0m in 1.79s]
[0m12:58:04.922629 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:58:04.923371 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:58:04.924412 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:58:04.925598 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:58:04.926229 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:58:04.931495 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:58:04.932515 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:58:04.926706 => 12:58:04.932163
[0m12:58:04.933073 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:58:04.938610 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:58:04.939246 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
  );
[0m12:58:04.939799 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:58:05.472489 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:58:05.477310 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:58:05.477908 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m12:58:05.558735 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:58:05.565215 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:58:05.565843 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m12:58:05.634854 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:58:05.641253 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:58:05.641778 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m12:58:05.704612 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:58:05.709977 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:58:05.711724 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:58:05.712246 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m12:58:05.817599 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:05.818419 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:58:05.819055 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")

;
[0m12:58:06.433999 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m12:58:06.435009 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:58:06.435586 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m12:58:06.632719 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:06.638022 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:58:06.638543 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m12:58:06.734693 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:06.738484 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:58:04.933426 => 12:58:06.738198
[0m12:58:06.739053 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:58:06.843730 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '541340e2-794e-4018-825e-aac684bc1942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cd647f10>]}
[0m12:58:06.844776 [info ] [Thread-1  ]: 2 of 7 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 10[0m in 1.92s]
[0m12:58:06.845718 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:58:06.846493 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:58:06.847469 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:58:06.848375 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:58:06.848897 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:58:06.853806 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:58:06.854931 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:58:06.849221 => 12:58:06.854586
[0m12:58:06.855505 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:58:06.860793 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:58:06.861396 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
  );
[0m12:58:06.861871 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:58:07.348816 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:07.354668 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:58:07.355325 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m12:58:07.435240 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:58:07.440880 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:58:07.441422 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m12:58:07.506833 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:58:07.573200 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:58:07.573943 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m12:58:07.643283 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:58:07.648644 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:58:07.650325 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:58:07.650933 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m12:58:07.744217 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:07.744998 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:58:07.745571 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m12:58:08.345340 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m12:58:08.346281 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:58:08.346707 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m12:58:08.544727 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:08.550180 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:58:08.550690 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m12:58:08.641299 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:08.645255 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:58:06.855907 => 12:58:08.644972
[0m12:58:08.645895 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:58:08.762080 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '541340e2-794e-4018-825e-aac684bc1942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cd617c70>]}
[0m12:58:08.763100 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 10[0m in 1.91s]
[0m12:58:08.764032 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:58:08.764830 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:58:08.765774 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:58:08.766950 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:58:08.767568 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:58:08.772732 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:58:08.773737 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:58:08.767971 => 12:58:08.773392
[0m12:58:08.774223 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:58:08.779172 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:58:08.779676 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_date('2023-06-22','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
  );
[0m12:58:08.780324 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:58:09.160133 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:09.164739 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:58:09.165193 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m12:58:09.247372 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:58:09.251801 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:58:09.252505 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m12:58:09.316744 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:58:09.322655 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:58:09.323838 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m12:58:09.388178 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:58:09.392675 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:58:09.394471 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:58:09.395030 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m12:58:09.471111 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:09.472013 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:58:09.472753 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m12:58:09.959687 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:58:09.960716 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:58:09.961260 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m12:58:10.217228 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:10.224534 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:58:10.225179 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m12:58:10.320927 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:10.325181 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:58:08.774600 => 12:58:10.324717
[0m12:58:10.325802 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:58:10.438414 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '541340e2-794e-4018-825e-aac684bc1942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cd6ed640>]}
[0m12:58:10.439605 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 10[0m in 1.67s]
[0m12:58:10.440612 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:58:10.441364 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:58:10.442110 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m12:58:10.443114 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m12:58:10.443642 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m12:58:10.454257 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m12:58:10.455309 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 12:58:10.443984 => 12:58:10.454951
[0m12:58:10.455988 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m12:58:10.461495 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:58:10.462144 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
  );
[0m12:58:10.463071 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:58:10.837583 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:10.842673 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:58:10.843233 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m12:58:10.925133 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:58:10.930819 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:58:10.931383 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m12:58:11.003845 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:58:11.010522 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:58:11.011235 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m12:58:11.078061 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:58:11.086360 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m12:58:11.088241 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:58:11.088875 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m12:58:11.172926 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:11.173663 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:58:11.174419 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")

;
[0m12:58:11.515066 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.0 seconds
[0m12:58:11.515998 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:58:11.516557 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m12:58:11.712817 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:11.718872 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:58:11.719546 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m12:58:11.810767 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:11.814582 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 12:58:10.456375 => 12:58:11.814301
[0m12:58:11.815182 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m12:58:11.915824 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '541340e2-794e-4018-825e-aac684bc1942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cf443af0>]}
[0m12:58:11.916989 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 8[0m in 1.47s]
[0m12:58:11.917938 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:58:11.918700 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:58:11.919704 [info ] [Thread-1  ]: 6 of 7 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m12:58:11.920879 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m12:58:11.921379 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m12:58:11.929557 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m12:58:11.930734 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 12:58:11.921701 => 12:58:11.930189
[0m12:58:11.931298 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m12:58:11.938432 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:58:11.938939 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace  temporary view external_db.final_sales.fct_order_detail__dbt_tmp
  
   as (
    
with orders as (
    select * from external_db.final_sales.bronze_orders
   
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

products as (
    select * from external_db.final_sales.bronze_products
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_date
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m12:58:11.939660 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:58:12.326284 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:12.330804 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:58:12.331350 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail__dbt_tmp
[0m12:58:12.404934 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:58:12.409505 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:58:12.409968 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail
[0m12:58:12.472343 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:58:12.477995 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:58:12.478483 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_ORDER_DETAIL"
[0m12:58:12.540975 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:58:12.545332 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m12:58:12.547279 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:58:12.547810 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
-- back compat for old kwarg name
  
  begin;
[0m12:58:12.678948 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:12.679722 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:58:12.680248 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
merge into external_db.final_sales.fct_order_detail as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_order_detail__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")

;
[0m12:58:13.103989 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:58:13.104808 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:58:13.105381 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
COMMIT
[0m12:58:13.317566 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:13.323770 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:58:13.324474 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m12:58:13.411014 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:13.414656 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 12:58:11.931658 => 12:58:13.414301
[0m12:58:13.415420 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m12:58:13.522556 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '541340e2-794e-4018-825e-aac684bc1942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cd7291c0>]}
[0m12:58:13.523630 [info ] [Thread-1  ]: 6 of 7 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 10[0m in 1.60s]
[0m12:58:13.524478 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:58:13.525750 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:58:13.526621 [info ] [Thread-1  ]: 7 of 7 START sql incremental model final_sales.product_sales ................... [RUN]
[0m12:58:13.527687 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m12:58:13.528248 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m12:58:13.536656 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m12:58:13.537667 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 12:58:13.528615 => 12:58:13.537299
[0m12:58:13.538214 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m12:58:13.543184 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:58:13.543777 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace  temporary view external_db.final_sales.product_sales__dbt_tmp
  
   as (
    

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m12:58:13.544312 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:58:14.069009 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:58:14.073569 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:58:14.074088 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales__dbt_tmp
[0m12:58:14.142298 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:58:14.152734 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:58:14.153275 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales
[0m12:58:14.211199 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:58:14.216344 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:58:14.216991 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."PRODUCT_SALES"
[0m12:58:14.279515 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:58:14.284382 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m12:58:14.286302 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:58:14.286857 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
-- back compat for old kwarg name
  
  begin;
[0m12:58:14.365271 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:14.365958 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:58:14.366502 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
merge into external_db.final_sales.product_sales as DBT_INTERNAL_DEST
        using external_db.final_sales.product_sales__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","ORDER_AMOUNT" = DBT_INTERNAL_SOURCE."ORDER_AMOUNT"
    

    when not matched then insert
        ("CUSTOMER_ID", "ORDER_AMOUNT")
    values
        ("CUSTOMER_ID", "ORDER_AMOUNT")

;
[0m12:58:14.821430 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:58:14.822271 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:58:14.822819 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
COMMIT
[0m12:58:15.035293 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:15.042287 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:58:15.042939 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m12:58:15.128179 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:58:15.132249 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 12:58:13.538563 => 12:58:15.131966
[0m12:58:15.132908 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m12:58:15.239429 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '541340e2-794e-4018-825e-aac684bc1942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cd6436d0>]}
[0m12:58:15.240487 [info ] [Thread-1  ]: 7 of 7 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 4[0m in 1.71s]
[0m12:58:15.241566 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:58:15.243835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:58:15.244281 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m12:58:15.244818 [info ] [MainThread]: 
[0m12:58:15.245417 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 13.35 seconds (13.35s).
[0m12:58:15.247988 [debug] [MainThread]: Command end result
[0m12:58:15.256717 [info ] [MainThread]: 
[0m12:58:15.257631 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:58:15.258111 [info ] [MainThread]: 
[0m12:58:15.258638 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:58:15.259617 [debug] [MainThread]: Command `dbt run` succeeded at 12:58:15.259419 after 13.78 seconds
[0m12:58:15.260195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d6c995b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3d0e78100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cf446c70>]}
[0m12:58:15.260749 [debug] [MainThread]: Flushing usage events
[0m12:59:28.338930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0d6544c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0bf3d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0bf3d100>]}


============================== 12:59:28.343268 | 4a6a5474-f98a-4ef2-bf7b-e9e99baaf9f8 ==============================
[0m12:59:28.343268 [info ] [MainThread]: Running with dbt=1.5.1
[0m12:59:28.344027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m12:59:28.687265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a6a5474-f98a-4ef2-bf7b-e9e99baaf9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0785e100>]}
[0m12:59:28.710763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a6a5474-f98a-4ef2-bf7b-e9e99baaf9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0785b0a0>]}
[0m12:59:28.729150 [debug] [MainThread]: checksum: 12441c2f1a48772bc61ee289f329470b36ca7db218e4227a89b76d5a1dfa46e0, vars: {'run_date': '2023-06-23'}, profile: , target: , version: 1.5.1
[0m12:59:28.740896 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:59:28.741605 [debug] [MainThread]: previous checksum: 12441c2f1a48772bc61ee289f329470b36ca7db218e4227a89b76d5a1dfa46e0, current checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c
[0m12:59:28.742171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4a6a5474-f98a-4ef2-bf7b-e9e99baaf9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b067e9dc0>]}
[0m12:59:29.706260 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_order_detail.sql
[0m12:59:29.733166 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_order_detail.sql
[0m12:59:29.736776 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_payment_details.sql
[0m12:59:29.744228 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_payment_details.sql
[0m12:59:29.747620 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m12:59:29.754222 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m12:59:29.758052 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m12:59:29.765790 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m12:59:29.768707 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m12:59:29.775530 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m12:59:29.778559 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m12:59:29.785709 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m12:59:29.793751 [debug] [MainThread]: 1603: static parser failed on sales/core/product_sales.sql
[0m12:59:29.803504 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/core/product_sales.sql
[0m12:59:29.969850 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.intermediate
[0m12:59:29.978002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a6a5474-f98a-4ef2-bf7b-e9e99baaf9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0619b400>]}
[0m12:59:29.987707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a6a5474-f98a-4ef2-bf7b-e9e99baaf9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0783ad90>]}
[0m12:59:29.988283 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m12:59:29.988876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a6a5474-f98a-4ef2-bf7b-e9e99baaf9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0d160bb0>]}
[0m12:59:29.991193 [info ] [MainThread]: 
[0m12:59:29.992243 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:59:29.994230 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m12:59:30.016712 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m12:59:30.017383 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m12:59:30.018025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:59:30.733306 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:59:30.737006 [debug] [ThreadPool]: On list_external_db: Close
[0m12:59:30.841590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m12:59:30.852864 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m12:59:30.853576 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m12:59:30.854153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:59:31.284437 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m12:59:31.287013 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m12:59:31.388299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a6a5474-f98a-4ef2-bf7b-e9e99baaf9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b06190a00>]}
[0m12:59:31.389668 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:59:31.390884 [info ] [MainThread]: 
[0m12:59:31.397172 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m12:59:31.397916 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m12:59:31.398954 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m12:59:31.399458 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m12:59:31.404523 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m12:59:31.405537 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 12:59:31.399868 => 12:59:31.405179
[0m12:59:31.406158 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m12:59:31.474440 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:59:31.475354 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date('2023-06-23', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m12:59:31.475878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:59:31.847941 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:31.862560 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:59:31.863177 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m12:59:31.935474 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:59:31.942054 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:59:31.942618 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m12:59:32.006056 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:59:32.017927 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:59:32.018443 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m12:59:32.085911 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:59:32.129895 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m12:59:32.131924 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:59:32.132441 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m12:59:32.207617 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:32.208660 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:59:32.209240 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m12:59:32.646867 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:59:32.647675 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:59:32.648126 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m12:59:32.846929 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:32.857468 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m12:59:32.858124 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m12:59:32.943685 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:32.971827 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 12:59:31.406468 => 12:59:32.971553
[0m12:59:32.972315 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m12:59:33.206529 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a6a5474-f98a-4ef2-bf7b-e9e99baaf9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b044c2b20>]}
[0m12:59:33.207772 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 10[0m in 1.81s]
[0m12:59:33.208826 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m12:59:33.209561 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m12:59:33.210254 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m12:59:33.211341 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m12:59:33.211899 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m12:59:33.216446 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m12:59:33.217431 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 12:59:33.212274 => 12:59:33.217141
[0m12:59:33.217939 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m12:59:33.222774 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:59:33.223360 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_date('2023-06-23', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
  );
[0m12:59:33.224027 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:59:33.593872 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:33.600063 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:59:33.600699 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m12:59:33.677172 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:59:33.682855 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:59:33.683315 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m12:59:33.747917 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:59:33.753001 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:59:33.753760 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m12:59:33.815130 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:59:33.820108 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m12:59:33.821882 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:59:33.822342 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m12:59:33.905279 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:33.905958 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:59:33.906463 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")

;
[0m12:59:34.379980 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:59:34.380912 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:59:34.381721 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m12:59:34.599825 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:34.604843 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m12:59:34.605363 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m12:59:34.696270 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:34.700342 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 12:59:33.218379 => 12:59:34.700034
[0m12:59:34.700933 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m12:59:34.818069 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a6a5474-f98a-4ef2-bf7b-e9e99baaf9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b04423f10>]}
[0m12:59:34.819167 [info ] [Thread-1  ]: 2 of 7 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 10[0m in 1.61s]
[0m12:59:34.820174 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m12:59:34.820882 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m12:59:34.821735 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m12:59:34.822677 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m12:59:34.823222 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m12:59:34.828451 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m12:59:34.829453 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 12:59:34.823561 => 12:59:34.829128
[0m12:59:34.829993 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m12:59:34.835826 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:59:34.836411 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_date('2023-06-23', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
  );
[0m12:59:34.836941 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:59:35.213157 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:35.217726 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:59:35.218312 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m12:59:35.297271 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:59:35.302530 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:59:35.303108 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m12:59:35.366906 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:59:35.374668 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:59:35.375239 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m12:59:35.443775 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m12:59:35.448736 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m12:59:35.450451 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:59:35.451037 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m12:59:35.531109 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:35.531993 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:59:35.532680 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m12:59:35.984878 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:59:35.985781 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:59:35.986294 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m12:59:36.187610 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:36.192642 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m12:59:36.193192 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m12:59:36.286430 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:36.291445 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 12:59:34.830348 => 12:59:36.291092
[0m12:59:36.292024 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m12:59:36.388699 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a6a5474-f98a-4ef2-bf7b-e9e99baaf9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b044c2f10>]}
[0m12:59:36.389831 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 10[0m in 1.57s]
[0m12:59:36.390775 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m12:59:36.391441 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m12:59:36.392325 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m12:59:36.393635 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m12:59:36.394187 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m12:59:36.399631 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m12:59:36.400684 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 12:59:36.394542 => 12:59:36.400274
[0m12:59:36.401242 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m12:59:36.406194 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:59:36.406817 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_date('2023-06-23','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
  );
[0m12:59:36.407503 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:59:36.773674 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:36.779703 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:59:36.780552 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m12:59:36.848399 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:59:36.854020 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:59:36.854633 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m12:59:36.912014 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:59:36.918219 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:59:36.918811 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m12:59:36.983582 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m12:59:36.988704 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m12:59:36.990613 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:59:36.991099 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m12:59:37.064569 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:37.065609 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:59:37.066185 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m12:59:37.506560 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:59:37.507495 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:59:37.508175 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m12:59:37.711765 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:37.718096 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m12:59:37.718789 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m12:59:37.798936 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:37.803808 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 12:59:36.401590 => 12:59:37.803392
[0m12:59:37.804693 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m12:59:37.909313 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a6a5474-f98a-4ef2-bf7b-e9e99baaf9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b044c2f10>]}
[0m12:59:37.910545 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 10[0m in 1.52s]
[0m12:59:37.911466 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m12:59:37.912039 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m12:59:37.913048 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m12:59:37.914163 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m12:59:37.914794 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m12:59:37.923376 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m12:59:37.924636 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 12:59:37.915266 => 12:59:37.924189
[0m12:59:37.925128 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m12:59:37.930494 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:59:37.931187 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where to_date('2023-06-23', 'YYYY-MM-DD') = run_date
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
  );
[0m12:59:37.931695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:59:38.308359 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:38.313183 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:59:38.313803 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m12:59:38.382624 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:59:38.387072 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:59:38.387702 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m12:59:38.466556 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:59:38.472062 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:59:38.472603 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m12:59:38.534289 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m12:59:38.539532 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m12:59:38.541347 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:59:38.541890 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m12:59:38.621268 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:38.621841 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:59:38.622343 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")

;
[0m12:59:39.107763 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.0 seconds
[0m12:59:39.108516 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:59:39.109056 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m12:59:39.358940 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:39.364175 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m12:59:39.364770 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m12:59:39.457779 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:39.461970 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 12:59:37.925447 => 12:59:39.461678
[0m12:59:39.462497 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m12:59:39.571274 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a6a5474-f98a-4ef2-bf7b-e9e99baaf9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b044c21f0>]}
[0m12:59:39.572352 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 8[0m in 1.66s]
[0m12:59:39.573380 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m12:59:39.573993 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m12:59:39.574755 [info ] [Thread-1  ]: 6 of 7 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m12:59:39.575772 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m12:59:39.576269 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m12:59:39.583255 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m12:59:39.584158 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 12:59:39.576620 => 12:59:39.583852
[0m12:59:39.584744 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m12:59:39.590247 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:59:39.590872 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace  temporary view external_db.final_sales.fct_order_detail__dbt_tmp
  
   as (
    
with orders as (
    select * from external_db.final_sales.bronze_orders
   
        where to_date('2023-06-23', 'YYYY-MM-DD') = run_date
    
),

products as (
    select * from external_db.final_sales.bronze_products
    
        where to_date('2023-06-23', 'YYYY-MM-DD') = run_date
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_date
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m12:59:39.591414 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:59:39.964474 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:39.970125 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:59:39.970733 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail__dbt_tmp
[0m12:59:40.049480 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:59:40.055311 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:59:40.057101 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail
[0m12:59:40.119277 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:59:40.125793 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:59:40.126370 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_ORDER_DETAIL"
[0m12:59:40.188112 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:59:40.194001 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m12:59:40.195705 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:59:40.196209 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
-- back compat for old kwarg name
  
  begin;
[0m12:59:40.275852 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:40.276611 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:59:40.277150 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
merge into external_db.final_sales.fct_order_detail as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_order_detail__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")

;
[0m12:59:40.641117 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m12:59:40.642037 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:59:40.642571 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
COMMIT
[0m12:59:40.846835 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:40.851916 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m12:59:40.852403 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m12:59:40.934858 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:40.938979 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 12:59:39.585082 => 12:59:40.938565
[0m12:59:40.939569 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m12:59:41.050105 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a6a5474-f98a-4ef2-bf7b-e9e99baaf9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b044c2820>]}
[0m12:59:41.051266 [info ] [Thread-1  ]: 6 of 7 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 10[0m in 1.47s]
[0m12:59:41.052440 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m12:59:41.054119 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m12:59:41.054864 [info ] [Thread-1  ]: 7 of 7 START sql incremental model final_sales.product_sales ................... [RUN]
[0m12:59:41.055843 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m12:59:41.056399 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m12:59:41.066287 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m12:59:41.067323 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 12:59:41.056786 => 12:59:41.066913
[0m12:59:41.068048 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m12:59:41.074147 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:59:41.074811 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace  temporary view external_db.final_sales.product_sales__dbt_tmp
  
   as (
    

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
        where to_date('2023-06-23', 'YYYY-MM-DD') = run_date
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
        where to_date('2023-06-23', 'YYYY-MM-DD') = run_date
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
        where to_date('2023-06-23', 'YYYY-MM-DD') = run_date
    
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m12:59:41.075478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:59:41.610429 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:59:41.615484 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:59:41.616037 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales__dbt_tmp
[0m12:59:41.690107 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:59:41.694912 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:59:41.695621 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales
[0m12:59:41.758398 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:59:41.767000 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:59:41.767573 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."PRODUCT_SALES"
[0m12:59:41.823619 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m12:59:41.828842 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m12:59:41.830483 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:59:41.830996 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
-- back compat for old kwarg name
  
  begin;
[0m12:59:41.906332 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:41.907037 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:59:41.907652 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
merge into external_db.final_sales.product_sales as DBT_INTERNAL_DEST
        using external_db.final_sales.product_sales__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","ORDER_AMOUNT" = DBT_INTERNAL_SOURCE."ORDER_AMOUNT"
    

    when not matched then insert
        ("CUSTOMER_ID", "ORDER_AMOUNT")
    values
        ("CUSTOMER_ID", "ORDER_AMOUNT")

;
[0m12:59:42.535408 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:59:42.536537 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:59:42.537312 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
COMMIT
[0m12:59:42.748699 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:42.754463 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m12:59:42.755222 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m12:59:42.837311 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:59:42.841224 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 12:59:41.068518 => 12:59:42.840889
[0m12:59:42.841742 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m12:59:42.961641 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a6a5474-f98a-4ef2-bf7b-e9e99baaf9f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b043d7130>]}
[0m12:59:42.962817 [info ] [Thread-1  ]: 7 of 7 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 4[0m in 1.91s]
[0m12:59:42.964058 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m12:59:42.966775 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:59:42.967191 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m12:59:42.967843 [info ] [MainThread]: 
[0m12:59:42.968638 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 12.98 seconds (12.98s).
[0m12:59:42.971362 [debug] [MainThread]: Command end result
[0m12:59:42.981864 [info ] [MainThread]: 
[0m12:59:42.982481 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:59:42.983000 [info ] [MainThread]: 
[0m12:59:42.983581 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m12:59:42.984579 [debug] [MainThread]: Command `dbt run` succeeded at 12:59:42.984424 after 14.67 seconds
[0m12:59:42.985135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0d6544c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0783a880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b0c801280>]}
[0m12:59:42.985644 [debug] [MainThread]: Flushing usage events
[0m13:05:30.465868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51f123460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51da01580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51da01100>]}


============================== 13:05:30.469765 | c39c896d-bf24-435e-8425-8b0f40a59408 ==============================
[0m13:05:30.469765 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:05:30.470481 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:05:30.803780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c39c896d-bf24-435e-8425-8b0f40a59408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc519320f70>]}
[0m13:05:30.826178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c39c896d-bf24-435e-8425-8b0f40a59408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc519320610>]}
[0m13:05:30.847285 [debug] [MainThread]: checksum: 12441c2f1a48772bc61ee289f329470b36ca7db218e4227a89b76d5a1dfa46e0, vars: {'run_date': '2023-06-23'}, profile: , target: , version: 1.5.1
[0m13:05:30.882186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:05:30.882752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:05:30.883649 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m13:05:30.893082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c39c896d-bf24-435e-8425-8b0f40a59408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51810b3d0>]}
[0m13:05:30.905775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c39c896d-bf24-435e-8425-8b0f40a59408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51817e280>]}
[0m13:05:30.906424 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:05:30.907102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c39c896d-bf24-435e-8425-8b0f40a59408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51817e3d0>]}
[0m13:05:30.909219 [info ] [MainThread]: 
[0m13:05:30.910286 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:05:30.912758 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m13:05:30.932802 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m13:05:30.933529 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m13:05:30.934058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:05:31.833375 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:05:31.837236 [debug] [ThreadPool]: On list_external_db: Close
[0m13:05:31.942617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m13:05:31.953517 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m13:05:31.954010 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m13:05:31.954432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:05:32.405090 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m13:05:32.407384 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m13:05:32.510228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c39c896d-bf24-435e-8425-8b0f40a59408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5192d6b50>]}
[0m13:05:32.511577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:05:32.512209 [info ] [MainThread]: 
[0m13:05:32.518677 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m13:05:32.519387 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m13:05:32.520406 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m13:05:32.521022 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m13:05:32.526518 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m13:05:32.527589 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 13:05:32.521369 => 13:05:32.527220
[0m13:05:32.528141 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m13:05:32.597475 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m13:05:32.598178 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date('2023-06-23', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m13:05:32.598702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:05:32.977208 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:05:32.989927 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m13:05:32.991038 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m13:05:33.062083 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:05:33.068022 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m13:05:33.068605 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m13:05:33.142076 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:05:33.154578 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m13:05:33.155242 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m13:05:33.221652 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:05:33.272716 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m13:05:33.274938 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m13:05:33.275470 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m13:05:33.351587 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:05:33.352608 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m13:05:33.353257 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m13:05:34.270301 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2351-0000-fb4f-0000-0001937eb909
[0m13:05:34.271152 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m13:05:34.271981 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 13:05:32.528478 => 13:05:34.271644
[0m13:05:34.272537 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m13:05:34.430300 [debug] [Thread-1  ]: Database Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/development/models/sales/bronze/bronze_customers.sql
[0m13:05:34.431345 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c39c896d-bf24-435e-8425-8b0f40a59408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc511b9df70>]}
[0m13:05:34.432413 [error] [Thread-1  ]: 1 of 7 ERROR creating sql incremental model final_sales.bronze_customers ....... [[31mERROR[0m in 1.91s]
[0m13:05:34.433300 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m13:05:34.434054 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m13:05:34.434773 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m13:05:34.436226 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m13:05:34.436911 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m13:05:34.442289 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m13:05:34.443168 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 13:05:34.437380 => 13:05:34.442857
[0m13:05:34.443740 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m13:05:34.449192 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m13:05:34.449817 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_date('2023-06-23', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
  );
[0m13:05:34.450389 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:05:34.816946 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:05:34.823538 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m13:05:34.824021 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m13:05:34.899706 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:05:34.904957 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m13:05:34.905539 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m13:05:34.969776 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:05:34.975335 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m13:05:34.975978 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m13:05:35.041126 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:05:35.045885 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m13:05:35.047691 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m13:05:35.048236 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m13:05:35.134664 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:05:35.135587 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m13:05:35.136163 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")

;
[0m13:05:35.948156 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m13:05:35.948993 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m13:05:35.949532 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m13:05:36.163863 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:05:36.175455 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m13:05:36.176129 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m13:05:36.269457 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:05:36.298920 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 13:05:34.444125 => 13:05:36.298571
[0m13:05:36.299508 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m13:05:36.402795 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c39c896d-bf24-435e-8425-8b0f40a59408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5180c6a90>]}
[0m13:05:36.403989 [info ] [Thread-1  ]: 2 of 7 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 10[0m in 1.97s]
[0m13:05:36.405134 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m13:05:36.406029 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m13:05:36.407100 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m13:05:36.408243 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m13:05:36.408866 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m13:05:36.414082 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m13:05:36.415170 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 13:05:36.409213 => 13:05:36.414805
[0m13:05:36.415652 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m13:05:36.420963 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m13:05:36.421580 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_date('2023-06-23', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
  );
[0m13:05:36.422441 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:05:36.784841 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:05:36.790883 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m13:05:36.791456 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m13:05:36.863252 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:05:36.869015 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m13:05:36.869512 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m13:05:36.930765 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:05:36.995562 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m13:05:36.996274 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m13:05:37.056172 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:05:37.061728 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m13:05:37.063487 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m13:05:37.063956 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m13:05:37.144042 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:05:37.144826 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m13:05:37.145402 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m13:05:37.634212 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m13:05:37.635283 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m13:05:37.636048 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m13:05:37.852084 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:05:37.857825 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m13:05:37.858363 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m13:05:37.944763 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:05:37.949468 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 13:05:36.415982 => 13:05:37.949131
[0m13:05:37.950077 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m13:05:38.043361 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c39c896d-bf24-435e-8425-8b0f40a59408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc511a2a940>]}
[0m13:05:38.044546 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 10[0m in 1.64s]
[0m13:05:38.045617 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m13:05:38.046299 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m13:05:38.047242 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m13:05:38.049024 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m13:05:38.049614 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m13:05:38.055221 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m13:05:38.056249 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 13:05:38.050290 => 13:05:38.055902
[0m13:05:38.056886 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m13:05:38.061936 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m13:05:38.062654 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_date('2023-06-23','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
  );
[0m13:05:38.063196 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:05:38.415570 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:05:38.420763 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m13:05:38.421565 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m13:05:38.500924 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m13:05:38.506235 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m13:05:38.506785 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m13:05:38.575229 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m13:05:38.581539 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m13:05:38.582147 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m13:05:38.646994 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m13:05:38.652476 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m13:05:38.654468 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m13:05:38.655026 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m13:05:38.732863 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:05:38.733659 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m13:05:38.734283 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m13:05:39.173645 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad2351-0000-fb87-0000-0001937ec935
[0m13:05:39.174459 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 100090 (42P18): Duplicate row detected during DML action
Row Values: [redacted]
[0m13:05:39.175501 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 13:05:38.057268 => 13:05:39.175092
[0m13:05:39.176287 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m13:05:39.342747 [debug] [Thread-1  ]: Database Error in model bronze_products (models/sales/bronze/bronze_products.sql)
  100090 (42P18): Duplicate row detected during DML action
  Row Values: [redacted]
  compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m13:05:39.343798 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c39c896d-bf24-435e-8425-8b0f40a59408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc511b4c9d0>]}
[0m13:05:39.344833 [error] [Thread-1  ]: 4 of 7 ERROR creating sql incremental model final_sales.bronze_products ........ [[31mERROR[0m in 1.30s]
[0m13:05:39.345761 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m13:05:39.346454 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m13:05:39.347130 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m13:05:39.348550 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m13:05:39.349353 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m13:05:39.362146 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m13:05:39.363279 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 13:05:39.349720 => 13:05:39.362881
[0m13:05:39.363805 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m13:05:39.369339 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m13:05:39.369878 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where to_date('2023-06-23', 'YYYY-MM-DD') = run_date
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
  );
[0m13:05:39.370367 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:05:39.726057 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:05:39.731016 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m13:05:39.731725 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m13:05:39.813043 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:05:39.818600 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m13:05:39.819329 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m13:05:39.884259 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:05:39.889604 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m13:05:39.890223 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m13:05:39.963333 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:05:39.968037 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m13:05:39.970035 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m13:05:39.970720 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m13:05:40.058801 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:05:40.059590 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m13:05:40.060116 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")

;
[0m13:05:40.424642 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.0 seconds
[0m13:05:40.425559 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m13:05:40.426202 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m13:05:40.654843 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:05:40.660761 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m13:05:40.661341 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m13:05:40.769059 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:05:40.773288 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 13:05:39.364156 => 13:05:40.772811
[0m13:05:40.773971 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m13:05:40.882532 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c39c896d-bf24-435e-8425-8b0f40a59408', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5133c9f40>]}
[0m13:05:40.883665 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 8[0m in 1.53s]
[0m13:05:40.884687 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m13:05:40.885497 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m13:05:40.886293 [info ] [Thread-1  ]: 6 of 7 SKIP relation final_sales.fct_order_detail .............................. [[33mSKIP[0m]
[0m13:05:40.887074 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m13:05:40.888427 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m13:05:40.889157 [info ] [Thread-1  ]: 7 of 7 SKIP relation final_sales.product_sales ................................. [[33mSKIP[0m]
[0m13:05:40.889959 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m13:05:40.892191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:05:40.892655 [debug] [MainThread]: Connection 'model.development.fct_payment_details' was properly closed.
[0m13:05:40.893303 [info ] [MainThread]: 
[0m13:05:40.894120 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 9.98 seconds (9.98s).
[0m13:05:40.896088 [debug] [MainThread]: Command end result
[0m13:05:40.905586 [info ] [MainThread]: 
[0m13:05:40.906215 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:05:40.906723 [info ] [MainThread]: 
[0m13:05:40.907281 [error] [MainThread]: [33mDatabase Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)[0m
[0m13:05:40.907964 [error] [MainThread]:   100090 (42P18): Duplicate row detected during DML action
[0m13:05:40.908492 [error] [MainThread]:   Row Values: [redacted]
[0m13:05:40.909167 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_customers.sql
[0m13:05:40.909689 [info ] [MainThread]: 
[0m13:05:40.910224 [error] [MainThread]: [33mDatabase Error in model bronze_products (models/sales/bronze/bronze_products.sql)[0m
[0m13:05:40.910708 [error] [MainThread]:   100090 (42P18): Duplicate row detected during DML action
[0m13:05:40.911225 [error] [MainThread]:   Row Values: [redacted]
[0m13:05:40.911701 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m13:05:40.912196 [info ] [MainThread]: 
[0m13:05:40.912776 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=2 TOTAL=7
[0m13:05:40.913819 [debug] [MainThread]: Command `dbt run` failed at 13:05:40.913634 after 10.47 seconds
[0m13:05:40.914354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc51f123460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5180cdf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5192d6880>]}
[0m13:05:40.914869 [debug] [MainThread]: Flushing usage events
[0m13:16:03.720416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d13d065b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d125c7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d125c73d0>]}


============================== 13:16:03.723913 | 40256fbb-be66-4b1b-9630-38215279e23d ==============================
[0m13:16:03.723913 [info ] [MainThread]: Running with dbt=1.5.1
[0m13:16:03.724812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:16:04.051337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40256fbb-be66-4b1b-9630-38215279e23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0de970a0>]}
[0m13:16:04.073703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40256fbb-be66-4b1b-9630-38215279e23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0dee0640>]}
[0m13:16:04.092003 [debug] [MainThread]: checksum: 12441c2f1a48772bc61ee289f329470b36ca7db218e4227a89b76d5a1dfa46e0, vars: {'run_date': '2023-06-23'}, profile: , target: , version: 1.5.1
[0m13:16:04.120964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:16:04.121406 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:16:04.122313 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m13:16:04.130917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40256fbb-be66-4b1b-9630-38215279e23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0cccd5b0>]}
[0m13:16:04.140204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40256fbb-be66-4b1b-9630-38215279e23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0cdad460>]}
[0m13:16:04.140872 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m13:16:04.141534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40256fbb-be66-4b1b-9630-38215279e23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0cdad5b0>]}
[0m13:16:04.143882 [info ] [MainThread]: 
[0m13:16:04.145064 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:16:04.147298 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m13:16:04.171224 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m13:16:04.171868 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m13:16:04.172423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:04.879628 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:16:04.883026 [debug] [ThreadPool]: On list_external_db: Close
[0m13:16:05.006964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m13:16:05.018151 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m13:16:05.018601 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m13:16:05.019132 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:16:05.316080 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m13:16:05.318873 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m13:16:05.425069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40256fbb-be66-4b1b-9630-38215279e23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0cdad580>]}
[0m13:16:05.426305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:05.426890 [info ] [MainThread]: 
[0m13:16:05.432203 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m13:16:05.432989 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m13:16:05.433997 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m13:16:05.434686 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m13:16:05.441030 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m13:16:05.442027 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 13:16:05.435220 => 13:16:05.441663
[0m13:16:05.442665 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m13:16:05.519103 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m13:16:05.519857 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date('2023-06-23', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m13:16:05.520403 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:16:05.935627 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:05.947861 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m13:16:05.948417 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m13:16:06.021099 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:16:06.026621 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m13:16:06.027203 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m13:16:06.090913 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:16:06.101604 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m13:16:06.102113 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m13:16:06.158135 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:16:06.202149 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m13:16:06.203968 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m13:16:06.204622 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m13:16:06.277065 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:06.277773 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m13:16:06.279318 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m13:16:07.097817 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m13:16:07.098736 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m13:16:07.099299 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m13:16:07.305393 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:07.317815 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m13:16:07.318333 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m13:16:07.425745 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:07.454197 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 13:16:05.443000 => 13:16:07.453879
[0m13:16:07.454793 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m13:16:07.560319 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40256fbb-be66-4b1b-9630-38215279e23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0674ea60>]}
[0m13:16:07.561432 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 10[0m in 2.13s]
[0m13:16:07.562428 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m13:16:07.563197 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m13:16:07.563820 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m13:16:07.565126 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m13:16:07.565610 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m13:16:07.571125 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m13:16:07.572178 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 13:16:07.566366 => 13:16:07.571818
[0m13:16:07.572799 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m13:16:07.577228 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m13:16:07.577757 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_date('2023-06-23', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
  );
[0m13:16:07.578360 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:16:07.965148 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:07.969884 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m13:16:07.970359 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m13:16:08.062299 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:16:08.068116 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m13:16:08.069027 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m13:16:08.139201 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:16:08.144861 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m13:16:08.145411 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m13:16:08.208071 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:16:08.213561 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m13:16:08.215385 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m13:16:08.215936 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m13:16:08.302889 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:08.303783 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m13:16:08.304441 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")

;
[0m13:16:09.149393 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m13:16:09.150189 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m13:16:09.150707 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m13:16:09.364394 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:09.369595 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m13:16:09.370110 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m13:16:09.461739 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:09.465505 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 13:16:07.573225 => 13:16:09.465205
[0m13:16:09.466040 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m13:16:09.577904 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40256fbb-be66-4b1b-9630-38215279e23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d07f91fa0>]}
[0m13:16:09.579074 [info ] [Thread-1  ]: 2 of 7 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 10[0m in 2.01s]
[0m13:16:09.580327 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m13:16:09.580969 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m13:16:09.581539 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m13:16:09.582486 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m13:16:09.582997 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m13:16:09.588052 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m13:16:09.589813 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 13:16:09.583343 => 13:16:09.589213
[0m13:16:09.590346 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m13:16:09.595093 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m13:16:09.595733 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_date('2023-06-23', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
  );
[0m13:16:09.596432 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:16:09.966798 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:09.971653 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m13:16:09.972154 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m13:16:10.047644 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:16:10.053056 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m13:16:10.053654 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m13:16:10.124579 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:16:10.201498 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m13:16:10.202135 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m13:16:10.266816 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:16:10.272764 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m13:16:10.274496 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m13:16:10.275014 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m13:16:10.358681 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:10.359599 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m13:16:10.360190 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m13:16:10.879527 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m13:16:10.880369 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m13:16:10.880918 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m13:16:11.101469 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:11.106921 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m13:16:11.107497 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m13:16:11.202741 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:11.207012 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 13:16:09.590728 => 13:16:11.206702
[0m13:16:11.207635 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m13:16:11.315027 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40256fbb-be66-4b1b-9630-38215279e23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d066432e0>]}
[0m13:16:11.316239 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 10[0m in 1.73s]
[0m13:16:11.317372 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m13:16:11.318066 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m13:16:11.318703 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m13:16:11.319932 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m13:16:11.320896 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m13:16:11.326099 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m13:16:11.327062 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 13:16:11.321320 => 13:16:11.326731
[0m13:16:11.327614 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m13:16:11.338076 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m13:16:11.338772 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_date('2023-06-23','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
  );
[0m13:16:11.339334 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:16:11.723216 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:11.728179 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m13:16:11.728885 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m13:16:11.799107 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m13:16:11.803912 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m13:16:11.804427 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m13:16:11.865977 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m13:16:11.871057 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m13:16:11.871609 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m13:16:11.933443 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m13:16:11.938452 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m13:16:11.940061 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m13:16:11.940532 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m13:16:12.029574 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:12.030517 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m13:16:12.031252 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m13:16:12.598929 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m13:16:12.599959 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m13:16:12.600510 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m13:16:12.831103 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:12.837778 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m13:16:12.838331 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m13:16:12.931058 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:12.934839 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 13:16:11.327981 => 13:16:12.934564
[0m13:16:12.935363 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m13:16:13.030970 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40256fbb-be66-4b1b-9630-38215279e23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d07fbdac0>]}
[0m13:16:13.032206 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 10[0m in 1.71s]
[0m13:16:13.033335 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m13:16:13.034026 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m13:16:13.034776 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m13:16:13.036146 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m13:16:13.036946 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m13:16:13.048445 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m13:16:13.049615 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 13:16:13.037339 => 13:16:13.049227
[0m13:16:13.050165 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m13:16:13.056091 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m13:16:13.056819 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where to_date('2023-06-23', 'YYYY-MM-DD') = run_date
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
  );
[0m13:16:13.057646 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:16:13.581296 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:16:13.586525 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m13:16:13.587184 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m13:16:13.669549 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:16:13.675235 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m13:16:13.675820 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m13:16:13.734014 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:16:13.738958 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m13:16:13.739497 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m13:16:13.796446 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m13:16:13.801312 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m13:16:13.803434 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m13:16:13.803989 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m13:16:13.887956 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:13.888751 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m13:16:13.889387 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")

;
[0m13:16:14.575866 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:16:14.576833 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m13:16:14.577397 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m13:16:14.799442 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:14.804346 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m13:16:14.804996 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m13:16:14.902630 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:14.906242 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 13:16:13.050536 => 13:16:14.905964
[0m13:16:14.906831 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m13:16:15.002043 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40256fbb-be66-4b1b-9630-38215279e23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d06712100>]}
[0m13:16:15.003141 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 8[0m in 1.97s]
[0m13:16:15.004171 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m13:16:15.004861 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m13:16:15.005840 [info ] [Thread-1  ]: 6 of 7 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m13:16:15.006890 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m13:16:15.007468 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m13:16:15.015126 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m13:16:15.016035 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 13:16:15.008004 => 13:16:15.015723
[0m13:16:15.016523 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m13:16:15.023947 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m13:16:15.024578 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace  temporary view external_db.final_sales.fct_order_detail__dbt_tmp
  
   as (
    
with orders as (
    select * from external_db.final_sales.bronze_orders
   
        where to_date('2023-06-23', 'YYYY-MM-DD') = run_date
    
),

products as (
    select * from external_db.final_sales.bronze_products
    
        where to_date('2023-06-23', 'YYYY-MM-DD') = run_date
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_date
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m13:16:15.025248 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:16:15.543039 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:16:15.548642 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m13:16:15.549194 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail__dbt_tmp
[0m13:16:15.635796 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m13:16:15.641219 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m13:16:15.642665 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail
[0m13:16:15.705224 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m13:16:15.711494 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m13:16:15.712115 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_ORDER_DETAIL"
[0m13:16:15.776915 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m13:16:15.782443 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m13:16:15.784452 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m13:16:15.785279 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
-- back compat for old kwarg name
  
  begin;
[0m13:16:15.864877 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:15.865791 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m13:16:15.866342 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
merge into external_db.final_sales.fct_order_detail as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_order_detail__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")

;
[0m13:16:16.322717 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m13:16:16.323600 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m13:16:16.324182 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
COMMIT
[0m13:16:16.528334 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:16.533654 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m13:16:16.534189 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m13:16:16.631954 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:16.636233 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 13:16:15.016881 => 13:16:16.635853
[0m13:16:16.636838 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m13:16:16.737628 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40256fbb-be66-4b1b-9630-38215279e23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d07fbd2e0>]}
[0m13:16:16.738791 [info ] [Thread-1  ]: 6 of 7 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 10[0m in 1.73s]
[0m13:16:16.739862 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m13:16:16.741305 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m13:16:16.742163 [info ] [Thread-1  ]: 7 of 7 START sql incremental model final_sales.product_sales ................... [RUN]
[0m13:16:16.743140 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m13:16:16.743662 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m13:16:16.751787 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m13:16:16.752940 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 13:16:16.744060 => 13:16:16.752491
[0m13:16:16.753516 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m13:16:16.759560 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m13:16:16.760195 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace  temporary view external_db.final_sales.product_sales__dbt_tmp
  
   as (
    

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
        where to_date('2023-06-23', 'YYYY-MM-DD') = run_date
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
        where to_date('2023-06-23', 'YYYY-MM-DD') = run_date
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
        where to_date('2023-06-23', 'YYYY-MM-DD') = run_date
    
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m13:16:16.760743 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:16:17.160278 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:17.165196 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m13:16:17.165729 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales__dbt_tmp
[0m13:16:17.232965 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m13:16:17.240869 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m13:16:17.241374 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales
[0m13:16:17.300264 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m13:16:17.306059 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m13:16:17.306671 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."PRODUCT_SALES"
[0m13:16:17.365589 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m13:16:17.370638 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m13:16:17.372261 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m13:16:17.372850 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
-- back compat for old kwarg name
  
  begin;
[0m13:16:17.454981 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:17.455799 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m13:16:17.456373 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
merge into external_db.final_sales.product_sales as DBT_INTERNAL_DEST
        using external_db.final_sales.product_sales__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","ORDER_AMOUNT" = DBT_INTERNAL_SOURCE."ORDER_AMOUNT"
    

    when not matched then insert
        ("CUSTOMER_ID", "ORDER_AMOUNT")
    values
        ("CUSTOMER_ID", "ORDER_AMOUNT")

;
[0m13:16:18.227044 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:16:18.228245 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m13:16:18.228818 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
COMMIT
[0m13:16:18.444117 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:18.449681 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m13:16:18.450201 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m13:16:18.536285 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:16:18.540190 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 13:16:16.753878 => 13:16:18.539888
[0m13:16:18.540736 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m13:16:18.637925 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40256fbb-be66-4b1b-9630-38215279e23d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d0668b0a0>]}
[0m13:16:18.639072 [info ] [Thread-1  ]: 7 of 7 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 4[0m in 1.89s]
[0m13:16:18.640460 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m13:16:18.643076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:18.643560 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m13:16:18.644141 [info ] [MainThread]: 
[0m13:16:18.644761 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 14.50 seconds (14.50s).
[0m13:16:18.648309 [debug] [MainThread]: Command end result
[0m13:16:18.659171 [info ] [MainThread]: 
[0m13:16:18.659786 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:16:18.660406 [info ] [MainThread]: 
[0m13:16:18.661109 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:16:18.662183 [debug] [MainThread]: Command `dbt run` succeeded at 13:16:18.661935 after 14.96 seconds
[0m13:16:18.662700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d13d065b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d07f9f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d07fa6b20>]}
[0m13:16:18.663461 [debug] [MainThread]: Flushing usage events
[0m06:49:18.296465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7276479460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7274da3040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7274da3280>]}


============================== 06:49:18.301054 | 92ae33a1-b92b-4277-8e59-aa9138448251 ==============================
[0m06:49:18.301054 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:49:18.301833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'dags/dbt', 'log_path': 'dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:49:18.646045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92ae33a1-b92b-4277-8e59-aa9138448251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7270693f70>]}
[0m06:49:18.668996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92ae33a1-b92b-4277-8e59-aa9138448251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7270693580>]}
[0m06:49:18.688819 [debug] [MainThread]: checksum: 518582be7b55697d4b7425a2eabd56b025e80bae3faea46064d56fa479f3a66b, vars: {'run_date': '2023-06-22'}, profile: , target: , version: 1.5.1
[0m06:49:18.706694 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m06:49:18.707433 [debug] [MainThread]: previous checksum: 518582be7b55697d4b7425a2eabd56b025e80bae3faea46064d56fa479f3a66b, current checksum: 12441c2f1a48772bc61ee289f329470b36ca7db218e4227a89b76d5a1dfa46e0
[0m06:49:18.707877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '92ae33a1-b92b-4277-8e59-aa9138448251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727064da30>]}
[0m06:49:19.657060 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_order_detail.sql
[0m06:49:19.683685 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_order_detail.sql
[0m06:49:19.686841 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_payment_details.sql
[0m06:49:19.693161 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_payment_details.sql
[0m06:49:19.696366 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m06:49:19.702841 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m06:49:19.705614 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m06:49:19.712503 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m06:49:19.715675 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m06:49:19.721674 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m06:49:19.724328 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m06:49:19.730848 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m06:49:19.733814 [debug] [MainThread]: 1603: static parser failed on sales/core/product_sales.sql
[0m06:49:19.742463 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/core/product_sales.sql
[0m06:49:19.921587 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m06:49:19.928894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92ae33a1-b92b-4277-8e59-aa9138448251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f726f04e520>]}
[0m06:49:19.938456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92ae33a1-b92b-4277-8e59-aa9138448251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f727066d970>]}
[0m06:49:19.939066 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m06:49:19.939580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92ae33a1-b92b-4277-8e59-aa9138448251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72738afbe0>]}
[0m06:49:19.941981 [info ] [MainThread]: 
[0m06:49:19.942959 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:49:19.944808 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m06:49:19.963596 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m06:49:19.964299 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m06:49:19.964782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:49:20.644672 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m06:49:20.648134 [debug] [ThreadPool]: On list_external_db: Close
[0m06:49:20.764941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m06:49:20.775376 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m06:49:20.775909 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m06:49:20.776436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:49:21.086697 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m06:49:21.089270 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m06:49:21.193853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92ae33a1-b92b-4277-8e59-aa9138448251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f726f008850>]}
[0m06:49:21.195158 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:49:21.196433 [info ] [MainThread]: 
[0m06:49:21.202137 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m06:49:21.202890 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m06:49:21.203897 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m06:49:21.204515 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m06:49:21.209957 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m06:49:21.211066 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 06:49:21.204955 => 06:49:21.210720
[0m06:49:21.211756 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m06:49:21.284476 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:49:21.285201 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m06:49:21.285828 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:49:21.670555 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:21.685280 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:49:21.685877 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m06:49:21.774604 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:49:21.780587 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:49:21.781131 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m06:49:21.859052 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:49:21.872067 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:49:21.872807 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m06:49:21.936430 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:49:21.984399 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m06:49:21.986426 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:49:21.987022 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m06:49:22.068954 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:22.069914 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:49:22.072338 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m06:49:22.863238 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m06:49:22.864529 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:49:22.865170 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m06:49:23.092934 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:23.104420 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:49:23.105008 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m06:49:23.193886 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:23.223433 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 06:49:21.212094 => 06:49:23.223110
[0m06:49:23.224108 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m06:49:23.326418 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ae33a1-b92b-4277-8e59-aa9138448251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f726cb03220>]}
[0m06:49:23.327449 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 10[0m in 2.12s]
[0m06:49:23.328681 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m06:49:23.329485 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m06:49:23.330154 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m06:49:23.331385 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m06:49:23.331958 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m06:49:23.337353 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m06:49:23.338496 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 06:49:23.332301 => 06:49:23.338022
[0m06:49:23.339159 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m06:49:23.345250 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:49:23.345842 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
  );
[0m06:49:23.346353 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:49:23.884240 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:49:23.891179 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:49:23.891718 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m06:49:23.963590 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:49:23.969692 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:49:23.970212 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m06:49:24.044382 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:49:24.049576 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:49:24.050229 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m06:49:24.113397 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:49:24.118099 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m06:49:24.119738 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:49:24.120457 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m06:49:24.200848 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:24.201667 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:49:24.202377 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")

;
[0m06:49:24.973946 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m06:49:24.975034 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:49:24.975542 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m06:49:25.174136 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:25.179358 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:49:25.180024 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m06:49:25.274474 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:25.278788 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 06:49:23.339539 => 06:49:25.278467
[0m06:49:25.279373 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m06:49:25.382636 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ae33a1-b92b-4277-8e59-aa9138448251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f726cac1f10>]}
[0m06:49:25.383679 [info ] [Thread-1  ]: 2 of 7 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 10[0m in 2.05s]
[0m06:49:25.384785 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m06:49:25.385454 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m06:49:25.386183 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m06:49:25.387283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m06:49:25.388062 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m06:49:25.393308 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m06:49:25.394344 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 06:49:25.388541 => 06:49:25.394000
[0m06:49:25.394859 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m06:49:25.400840 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:49:25.401429 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
  );
[0m06:49:25.402020 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:49:25.777481 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:25.783890 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:49:25.784660 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m06:49:25.865516 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:49:25.870993 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:49:25.871839 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m06:49:25.958707 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:49:25.968423 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:49:25.969277 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m06:49:26.029940 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:49:26.035317 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m06:49:26.037148 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:49:26.037777 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m06:49:26.123194 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:26.123954 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:49:26.124543 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m06:49:26.805837 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m06:49:26.806716 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:49:26.807275 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m06:49:27.011424 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:27.016971 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:49:27.017618 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m06:49:27.116972 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:27.121159 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 06:49:25.395288 => 06:49:27.120715
[0m06:49:27.121708 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m06:49:27.225470 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ae33a1-b92b-4277-8e59-aa9138448251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f726ca35b50>]}
[0m06:49:27.226609 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 10[0m in 1.84s]
[0m06:49:27.227483 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m06:49:27.228166 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m06:49:27.229739 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m06:49:27.230784 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m06:49:27.231260 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m06:49:27.240069 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m06:49:27.241652 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 06:49:27.231590 => 06:49:27.241218
[0m06:49:27.242184 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m06:49:27.247343 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:49:27.247930 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_date('2023-06-22','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
  );
[0m06:49:27.248647 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:49:27.618565 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:27.623405 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:49:27.623987 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m06:49:27.697911 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m06:49:27.703301 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:49:27.703925 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m06:49:27.767324 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m06:49:27.773111 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:49:27.773953 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m06:49:27.847821 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m06:49:27.852715 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m06:49:27.855070 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:49:27.855665 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m06:49:27.942518 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:27.943247 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:49:27.943736 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m06:49:28.636021 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m06:49:28.636961 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:49:28.637511 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m06:49:28.841444 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:28.847121 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:49:28.847682 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m06:49:28.934822 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:28.939037 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 06:49:27.242540 => 06:49:28.938715
[0m06:49:28.939578 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m06:49:29.061128 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ae33a1-b92b-4277-8e59-aa9138448251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f726e34d910>]}
[0m06:49:29.064430 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 10[0m in 1.83s]
[0m06:49:29.065572 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m06:49:29.066365 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m06:49:29.067283 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m06:49:29.068422 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m06:49:29.069083 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m06:49:29.076782 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m06:49:29.077816 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 06:49:29.069440 => 06:49:29.077403
[0m06:49:29.078358 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m06:49:29.084046 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:49:29.084589 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
  );
[0m06:49:29.085126 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:49:29.467580 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:29.472473 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:49:29.473138 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m06:49:29.549507 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:49:29.555336 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:49:29.556365 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m06:49:29.629818 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:49:29.635822 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:49:29.636395 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m06:49:29.700361 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:49:29.705769 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m06:49:29.707672 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:49:29.708282 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m06:49:29.786746 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:29.787520 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:49:29.788251 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")

;
[0m06:49:30.243710 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 0.0 seconds
[0m06:49:30.244694 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:49:30.245399 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m06:49:30.467882 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:30.473562 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:49:30.474134 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m06:49:30.557336 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:30.561533 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 06:49:29.078677 => 06:49:30.561170
[0m06:49:30.562150 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m06:49:30.659573 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ae33a1-b92b-4277-8e59-aa9138448251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f726cade040>]}
[0m06:49:30.660592 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 8[0m in 1.59s]
[0m06:49:30.661652 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m06:49:30.662305 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m06:49:30.662935 [info ] [Thread-1  ]: 6 of 7 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m06:49:30.663940 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m06:49:30.664612 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m06:49:30.675406 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m06:49:30.676580 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 06:49:30.665181 => 06:49:30.676207
[0m06:49:30.677214 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m06:49:30.683411 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:49:30.684051 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace  temporary view external_db.final_sales.fct_order_detail__dbt_tmp
  
   as (
    
with orders as (
    select * from external_db.final_sales.bronze_orders
   
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

products as (
    select * from external_db.final_sales.bronze_products
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_date
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m06:49:30.684682 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:49:31.116474 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:31.121454 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:49:31.122049 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail__dbt_tmp
[0m06:49:31.197633 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:49:31.203684 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:49:31.204338 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail
[0m06:49:31.282358 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:49:31.287977 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:49:31.288499 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_ORDER_DETAIL"
[0m06:49:31.347280 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:49:31.352973 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m06:49:31.354726 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:49:31.355245 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
-- back compat for old kwarg name
  
  begin;
[0m06:49:31.435587 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:31.436389 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:49:31.437005 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
merge into external_db.final_sales.fct_order_detail as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_order_detail__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")

;
[0m06:49:31.934068 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:49:31.935039 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:49:31.935696 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
COMMIT
[0m06:49:32.142864 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:32.148524 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:49:32.149129 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m06:49:32.242065 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:32.245806 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 06:49:30.677597 => 06:49:32.245506
[0m06:49:32.246321 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m06:49:32.355797 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ae33a1-b92b-4277-8e59-aa9138448251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f726ca418e0>]}
[0m06:49:32.357084 [info ] [Thread-1  ]: 6 of 7 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 10[0m in 1.69s]
[0m06:49:32.358182 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m06:49:32.359832 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m06:49:32.360562 [info ] [Thread-1  ]: 7 of 7 START sql incremental model final_sales.product_sales ................... [RUN]
[0m06:49:32.361601 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m06:49:32.362235 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m06:49:32.371035 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m06:49:32.372003 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 06:49:32.362750 => 06:49:32.371650
[0m06:49:32.372624 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m06:49:32.378415 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:49:32.379015 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace  temporary view external_db.final_sales.product_sales__dbt_tmp
  
   as (
    

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m06:49:32.379832 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:49:32.789210 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:32.795161 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:49:32.795969 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales__dbt_tmp
[0m06:49:32.872790 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:49:32.878116 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:49:32.878736 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales
[0m06:49:32.959960 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:49:32.969322 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:49:32.969873 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."PRODUCT_SALES"
[0m06:49:33.042658 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:49:33.048124 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m06:49:33.050034 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:49:33.050661 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
-- back compat for old kwarg name
  
  begin;
[0m06:49:33.134842 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:33.135835 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:49:33.139114 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
merge into external_db.final_sales.product_sales as DBT_INTERNAL_DEST
        using external_db.final_sales.product_sales__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","ORDER_AMOUNT" = DBT_INTERNAL_SOURCE."ORDER_AMOUNT"
    

    when not matched then insert
        ("CUSTOMER_ID", "ORDER_AMOUNT")
    values
        ("CUSTOMER_ID", "ORDER_AMOUNT")

;
[0m06:49:33.701490 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:49:33.702372 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:49:33.702999 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
COMMIT
[0m06:49:33.894538 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:33.900848 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:49:33.901407 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m06:49:34.003115 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:49:34.007576 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 06:49:32.373029 => 06:49:34.007263
[0m06:49:34.008122 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m06:49:34.119671 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92ae33a1-b92b-4277-8e59-aa9138448251', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f726ca830a0>]}
[0m06:49:34.120956 [info ] [Thread-1  ]: 7 of 7 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 1[0m in 1.76s]
[0m06:49:34.122086 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m06:49:34.124569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:49:34.125143 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m06:49:34.125699 [info ] [MainThread]: 
[0m06:49:34.126295 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 14.18 seconds (14.18s).
[0m06:49:34.128590 [debug] [MainThread]: Command end result
[0m06:49:34.138588 [info ] [MainThread]: 
[0m06:49:34.139392 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:49:34.139956 [info ] [MainThread]: 
[0m06:49:34.140542 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m06:49:34.141881 [debug] [MainThread]: Command `dbt run` succeeded at 06:49:34.141672 after 15.87 seconds
[0m06:49:34.142500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7276479460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7270693f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7275fca7f0>]}
[0m06:49:34.143028 [debug] [MainThread]: Flushing usage events
[0m06:51:15.577477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2034725580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2033027040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20330274c0>]}


============================== 06:51:15.581791 | 9e1094db-f77d-4ef1-a21f-aecbc8978ca0 ==============================
[0m06:51:15.581791 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:51:15.582713 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dags/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:51:15.950919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e1094db-f77d-4ef1-a21f-aecbc8978ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202e90d0a0>]}
[0m06:51:15.975287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e1094db-f77d-4ef1-a21f-aecbc8978ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202e912070>]}
[0m06:51:15.993557 [debug] [MainThread]: checksum: 518582be7b55697d4b7425a2eabd56b025e80bae3faea46064d56fa479f3a66b, vars: {'run_date': '2023-06-22'}, profile: , target: , version: 1.5.1
[0m06:51:16.024585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:51:16.025235 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:51:16.026148 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.intermediate
[0m06:51:16.035743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e1094db-f77d-4ef1-a21f-aecbc8978ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202d70d4f0>]}
[0m06:51:16.047743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e1094db-f77d-4ef1-a21f-aecbc8978ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202d77d3a0>]}
[0m06:51:16.050862 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m06:51:16.051481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e1094db-f77d-4ef1-a21f-aecbc8978ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202d77d4f0>]}
[0m06:51:16.053675 [info ] [MainThread]: 
[0m06:51:16.054758 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:51:16.056568 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m06:51:16.081110 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m06:51:16.081874 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m06:51:16.082403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:51:16.852444 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m06:51:16.856281 [debug] [ThreadPool]: On list_external_db: Close
[0m06:51:16.968720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m06:51:16.980200 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m06:51:16.980827 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m06:51:16.981470 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:51:17.451054 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m06:51:17.453662 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m06:51:17.556080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e1094db-f77d-4ef1-a21f-aecbc8978ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202d76de20>]}
[0m06:51:17.557510 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:51:17.558138 [info ] [MainThread]: 
[0m06:51:17.565216 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m06:51:17.567887 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m06:51:17.569624 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m06:51:17.570254 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m06:51:17.576087 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m06:51:17.577605 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 06:51:17.570764 => 06:51:17.577233
[0m06:51:17.578259 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m06:51:17.651066 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:51:17.651907 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m06:51:17.652462 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:51:18.017644 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:18.031733 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:51:18.032529 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m06:51:18.133703 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:51:18.139448 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:51:18.140127 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m06:51:18.204934 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:51:18.218090 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:51:18.218825 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m06:51:18.422730 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:51:18.472489 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m06:51:18.474624 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:51:18.475221 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m06:51:18.561609 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:18.562441 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:51:18.563056 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m06:51:19.071647 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m06:51:19.072581 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:51:19.074492 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m06:51:19.293456 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:19.306856 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:51:19.307448 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m06:51:19.388932 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:19.420402 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 06:51:17.578715 => 06:51:19.420056
[0m06:51:19.421077 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m06:51:19.525538 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1094db-f77d-4ef1-a21f-aecbc8978ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202c1ad7c0>]}
[0m06:51:19.526597 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 10[0m in 1.96s]
[0m06:51:19.527637 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m06:51:19.528410 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m06:51:19.529024 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m06:51:19.530093 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m06:51:19.530622 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m06:51:19.535339 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m06:51:19.536480 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 06:51:19.530945 => 06:51:19.536059
[0m06:51:19.537230 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m06:51:19.542164 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:51:19.542982 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
  );
[0m06:51:19.543569 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:51:19.922044 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:19.926524 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:51:19.927145 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m06:51:20.006788 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:51:20.012487 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:51:20.013245 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m06:51:20.071207 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:51:20.076918 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:51:20.082171 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m06:51:20.145087 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:51:20.150181 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m06:51:20.151922 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:51:20.152429 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m06:51:20.237300 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:20.238091 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:51:20.238616 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")

;
[0m06:51:20.731068 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:51:20.731982 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:51:20.732496 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m06:51:20.941768 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:20.947026 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:51:20.947587 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m06:51:21.032178 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:21.036189 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 06:51:19.537631 => 06:51:21.035881
[0m06:51:21.036727 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m06:51:21.146305 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1094db-f77d-4ef1-a21f-aecbc8978ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202c9eeeb0>]}
[0m06:51:21.147394 [info ] [Thread-1  ]: 2 of 7 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 10[0m in 1.62s]
[0m06:51:21.148427 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m06:51:21.149098 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m06:51:21.149980 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m06:51:21.151000 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m06:51:21.151690 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m06:51:21.157870 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m06:51:21.158928 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 06:51:21.152544 => 06:51:21.158562
[0m06:51:21.159452 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m06:51:21.164513 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:51:21.165173 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
  );
[0m06:51:21.165783 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:51:21.553146 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:21.557829 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:51:21.558448 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m06:51:21.638907 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:51:21.644573 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:51:21.645176 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m06:51:21.715803 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:51:21.795808 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:51:21.796435 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m06:51:21.858636 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:51:21.864073 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m06:51:21.865788 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:51:21.866397 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m06:51:21.944345 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:21.945319 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:51:21.945911 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m06:51:22.387377 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:51:22.388214 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:51:22.388697 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m06:51:22.595170 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:22.600418 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:51:22.600971 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m06:51:22.690898 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:22.696556 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 06:51:21.159820 => 06:51:22.696195
[0m06:51:22.697306 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m06:51:22.805897 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1094db-f77d-4ef1-a21f-aecbc8978ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202c111d90>]}
[0m06:51:22.807143 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 10[0m in 1.66s]
[0m06:51:22.812599 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m06:51:22.813350 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m06:51:22.814071 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m06:51:22.815165 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m06:51:22.815738 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m06:51:22.821162 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m06:51:22.822085 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 06:51:22.816440 => 06:51:22.821768
[0m06:51:22.822571 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m06:51:22.828028 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:51:22.828549 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_date('2023-06-22','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
  );
[0m06:51:22.829170 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:51:23.244849 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:23.249605 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:51:23.250320 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m06:51:23.332304 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m06:51:23.337448 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:51:23.337913 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m06:51:23.421452 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m06:51:23.427091 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:51:23.427620 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m06:51:23.491165 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m06:51:23.495719 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m06:51:23.497372 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:51:23.497998 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m06:51:23.587314 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:23.588111 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:51:23.588596 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m06:51:24.094752 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m06:51:24.095595 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:51:24.096359 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m06:51:24.292346 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:24.299357 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:51:24.300028 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m06:51:24.400188 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:24.404420 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 06:51:22.822894 => 06:51:24.404123
[0m06:51:24.404961 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m06:51:24.522796 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1094db-f77d-4ef1-a21f-aecbc8978ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202ca19040>]}
[0m06:51:24.523778 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 10[0m in 1.71s]
[0m06:51:24.524670 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m06:51:24.525333 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m06:51:24.525925 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m06:51:24.527555 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m06:51:24.528106 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m06:51:24.538897 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m06:51:24.539904 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 06:51:24.528893 => 06:51:24.539597
[0m06:51:24.540474 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m06:51:24.546660 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:51:24.547395 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
  );
[0m06:51:24.548254 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:51:24.940659 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:24.945693 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:51:24.946164 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m06:51:25.022587 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:51:25.028623 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:51:25.029342 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m06:51:25.098394 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:51:25.103748 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:51:25.104281 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m06:51:25.168434 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:51:25.175299 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m06:51:25.177211 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:51:25.178205 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m06:51:25.260602 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:25.261340 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:51:25.261873 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")

;
[0m06:51:25.887778 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 1.0 seconds
[0m06:51:25.888712 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:51:25.889520 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m06:51:26.101643 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:26.106667 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:51:26.107154 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m06:51:26.197021 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:26.201069 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 06:51:24.540858 => 06:51:26.200627
[0m06:51:26.201647 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m06:51:26.311192 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1094db-f77d-4ef1-a21f-aecbc8978ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202c18b0d0>]}
[0m06:51:26.312658 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 8[0m in 1.78s]
[0m06:51:26.313875 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m06:51:26.315635 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m06:51:26.316512 [info ] [Thread-1  ]: 6 of 7 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m06:51:26.317530 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m06:51:26.318024 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m06:51:26.325317 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m06:51:26.326331 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 06:51:26.318367 => 06:51:26.326003
[0m06:51:26.326812 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m06:51:26.334646 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:51:26.335173 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace  temporary view external_db.final_sales.fct_order_detail__dbt_tmp
  
   as (
    
with orders as (
    select * from external_db.final_sales.bronze_orders
   
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

products as (
    select * from external_db.final_sales.bronze_products
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_date
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m06:51:26.335820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:51:26.723304 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:26.728034 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:51:26.728604 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail__dbt_tmp
[0m06:51:26.801506 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:51:26.806959 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:51:26.807453 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail
[0m06:51:26.871290 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:51:26.876751 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:51:26.877500 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_ORDER_DETAIL"
[0m06:51:26.942823 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:51:26.950753 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m06:51:26.952557 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:51:26.953341 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
-- back compat for old kwarg name
  
  begin;
[0m06:51:27.028043 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:27.028952 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:51:27.029520 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
merge into external_db.final_sales.fct_order_detail as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_order_detail__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")

;
[0m06:51:27.454166 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m06:51:27.454988 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:51:27.455476 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
COMMIT
[0m06:51:27.654028 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:27.660292 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:51:27.660947 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m06:51:27.751814 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:27.755893 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 06:51:26.327130 => 06:51:27.755553
[0m06:51:27.756494 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m06:51:27.854575 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1094db-f77d-4ef1-a21f-aecbc8978ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202ca1d490>]}
[0m06:51:27.855745 [info ] [Thread-1  ]: 6 of 7 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 10[0m in 1.54s]
[0m06:51:27.856828 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m06:51:27.858142 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m06:51:27.858936 [info ] [Thread-1  ]: 7 of 7 START sql incremental model final_sales.product_sales ................... [RUN]
[0m06:51:27.859976 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m06:51:27.860514 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m06:51:27.869242 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m06:51:27.870519 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 06:51:27.861037 => 06:51:27.870064
[0m06:51:27.871129 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m06:51:27.877432 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:51:27.878019 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace  temporary view external_db.final_sales.product_sales__dbt_tmp
  
   as (
    

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m06:51:27.878562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:51:28.441659 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:51:28.446269 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:51:28.446777 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales__dbt_tmp
[0m06:51:28.542387 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:51:28.550373 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:51:28.551032 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales
[0m06:51:28.628714 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:51:28.637851 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:51:28.638415 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."PRODUCT_SALES"
[0m06:51:28.704992 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:51:28.709937 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m06:51:28.711682 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:51:28.712274 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
-- back compat for old kwarg name
  
  begin;
[0m06:51:28.795821 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:28.796508 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:51:28.797048 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
merge into external_db.final_sales.product_sales as DBT_INTERNAL_DEST
        using external_db.final_sales.product_sales__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","ORDER_AMOUNT" = DBT_INTERNAL_SOURCE."ORDER_AMOUNT"
    

    when not matched then insert
        ("CUSTOMER_ID", "ORDER_AMOUNT")
    values
        ("CUSTOMER_ID", "ORDER_AMOUNT")

;
[0m06:51:29.340942 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:51:29.341760 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:51:29.342356 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
COMMIT
[0m06:51:29.556632 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:29.562625 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:51:29.563184 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m06:51:29.662296 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:51:29.666173 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 06:51:27.871847 => 06:51:29.665807
[0m06:51:29.666770 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m06:51:29.775697 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e1094db-f77d-4ef1-a21f-aecbc8978ca0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202c0f49d0>]}
[0m06:51:29.776925 [info ] [Thread-1  ]: 7 of 7 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 1[0m in 1.92s]
[0m06:51:29.778942 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m06:51:29.782017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:51:29.782594 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m06:51:29.783659 [info ] [MainThread]: 
[0m06:51:29.784451 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 13.73 seconds (13.73s).
[0m06:51:29.788318 [debug] [MainThread]: Command end result
[0m06:51:29.800126 [info ] [MainThread]: 
[0m06:51:29.800992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:51:29.801701 [info ] [MainThread]: 
[0m06:51:29.802561 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m06:51:29.803829 [debug] [MainThread]: Command `dbt run` succeeded at 06:51:29.803632 after 14.25 seconds
[0m06:51:29.804551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2034725580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202e912070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202c0efdc0>]}
[0m06:51:29.805279 [debug] [MainThread]: Flushing usage events
[0m07:00:57.945561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e6021430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e4924550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e4924160>]}


============================== 07:00:57.949380 | e2f351e7-3b03-4455-b896-233a5255e756 ==============================
[0m07:00:57.949380 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:00:57.950322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:00:58.285928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2f351e7-3b03-4455-b896-233a5255e756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48df1f9d90>]}
[0m07:00:58.309651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2f351e7-3b03-4455-b896-233a5255e756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48df1f95e0>]}
[0m07:00:58.330076 [debug] [MainThread]: checksum: 071c9ca3a2d2a01a721f4df37b2be932639ff42e7cb54c813a84a00679464ae6, vars: {'run_date': '2023-06-20'}, profile: , target: , version: 1.5.1
[0m07:00:58.340609 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m07:00:58.341329 [debug] [MainThread]: previous checksum: 071c9ca3a2d2a01a721f4df37b2be932639ff42e7cb54c813a84a00679464ae6, current checksum: 518582be7b55697d4b7425a2eabd56b025e80bae3faea46064d56fa479f3a66b
[0m07:00:58.341776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e2f351e7-3b03-4455-b896-233a5255e756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48df1b1af0>]}
[0m07:00:59.300878 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_order_detail.sql
[0m07:00:59.328331 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_order_detail.sql
[0m07:00:59.331877 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_payment_details.sql
[0m07:00:59.339493 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_payment_details.sql
[0m07:00:59.342907 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m07:00:59.352091 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m07:00:59.355110 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m07:00:59.362962 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m07:00:59.363418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'e2f351e7-3b03-4455-b896-233a5255e756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48debc63a0>]}
[0m07:00:59.366381 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m07:00:59.373171 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m07:00:59.376284 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m07:00:59.383153 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m07:00:59.386142 [debug] [MainThread]: 1603: static parser failed on sales/core/product_sales.sql
[0m07:00:59.395354 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/core/product_sales.sql
[0m07:00:59.569268 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m07:00:59.576682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2f351e7-3b03-4455-b896-233a5255e756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48debb5220>]}
[0m07:00:59.586293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2f351e7-3b03-4455-b896-233a5255e756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48df1d3550>]}
[0m07:00:59.586897 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m07:00:59.587449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2f351e7-3b03-4455-b896-233a5255e756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48df1d3e50>]}
[0m07:00:59.589538 [info ] [MainThread]: 
[0m07:00:59.590538 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:00:59.592429 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m07:00:59.610798 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m07:00:59.611330 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m07:00:59.611871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:01:00.380975 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m07:01:00.384011 [debug] [ThreadPool]: On list_external_db: Close
[0m07:01:00.500463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m07:01:00.511235 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m07:01:00.511771 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m07:01:00.512349 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:01:00.968650 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m07:01:00.971196 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m07:01:01.066790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2f351e7-3b03-4455-b896-233a5255e756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48debcc280>]}
[0m07:01:01.068225 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:01:01.068911 [info ] [MainThread]: 
[0m07:01:01.076312 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m07:01:01.077160 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m07:01:01.089758 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m07:01:01.090405 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m07:01:01.095916 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m07:01:01.097065 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 07:01:01.090775 => 07:01:01.096603
[0m07:01:01.097581 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m07:01:01.168063 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:01:01.168864 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date('2023-06-20', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m07:01:01.169556 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:01:01.580506 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:01.596488 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:01:01.598577 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m07:01:01.669995 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:01:01.676025 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:01:01.676621 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m07:01:01.745316 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:01:01.757579 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:01:01.758207 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m07:01:01.827733 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:01:01.875588 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m07:01:01.877483 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:01:01.878065 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m07:01:01.980580 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:01.981384 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:01:01.981936 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m07:01:02.756007 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m07:01:02.757139 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:01:02.757670 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m07:01:02.970247 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:02.982033 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:01:02.982630 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m07:01:03.083591 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:03.113403 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 07:01:01.097915 => 07:01:03.113009
[0m07:01:03.114125 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m07:01:03.223574 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f351e7-3b03-4455-b896-233a5255e756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc643160>]}
[0m07:01:03.229702 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 10[0m in 2.15s]
[0m07:01:03.232429 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m07:01:03.234414 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m07:01:03.235530 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m07:01:03.236674 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m07:01:03.237305 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m07:01:03.243617 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m07:01:03.244812 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 07:01:03.237793 => 07:01:03.244385
[0m07:01:03.245694 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m07:01:03.251670 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:01:03.252331 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_date('2023-06-20', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
  );
[0m07:01:03.252957 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:01:03.654378 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:03.660647 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:01:03.661247 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m07:01:03.729399 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:01:03.734927 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:01:03.735506 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m07:01:03.801856 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:01:03.807660 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:01:03.808514 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m07:01:03.871377 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:01:03.876624 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m07:01:03.878579 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:01:03.879239 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m07:01:03.965952 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:03.966761 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:01:03.967440 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")

;
[0m07:01:04.622079 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m07:01:04.623165 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:01:04.623705 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m07:01:04.812121 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:04.817361 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:01:04.818006 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m07:01:04.908031 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:04.913652 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 07:01:03.246044 => 07:01:04.913281
[0m07:01:04.914331 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m07:01:05.012899 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f351e7-3b03-4455-b896-233a5255e756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc643a00>]}
[0m07:01:05.014026 [info ] [Thread-1  ]: 2 of 7 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 10[0m in 1.78s]
[0m07:01:05.015187 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m07:01:05.015929 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m07:01:05.016629 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m07:01:05.017776 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m07:01:05.018359 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m07:01:05.033768 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m07:01:05.034983 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 07:01:05.018947 => 07:01:05.034604
[0m07:01:05.035597 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m07:01:05.041262 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:01:05.041850 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_date('2023-06-20', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
  );
[0m07:01:05.042667 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:01:05.429236 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:05.433939 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:01:05.434522 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m07:01:05.502841 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:01:05.508441 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:01:05.509056 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m07:01:05.573257 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:01:05.583005 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:01:05.583744 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m07:01:05.649196 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:01:05.654381 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m07:01:05.656149 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:01:05.656694 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m07:01:05.737470 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:05.738259 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:01:05.738928 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m07:01:06.240234 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m07:01:06.241064 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:01:06.241842 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m07:01:06.448991 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:06.454314 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:01:06.454921 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m07:01:06.542194 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:06.546652 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 07:01:05.035926 => 07:01:06.546316
[0m07:01:06.547274 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m07:01:06.646045 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f351e7-3b03-4455-b896-233a5255e756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc5b5df0>]}
[0m07:01:06.649020 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 10[0m in 1.63s]
[0m07:01:06.650101 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m07:01:06.650736 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m07:01:06.651716 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m07:01:06.652717 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m07:01:06.654816 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m07:01:06.660556 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m07:01:06.661546 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 07:01:06.655227 => 07:01:06.661208
[0m07:01:06.662115 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m07:01:06.667424 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:01:06.668265 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_date('2023-06-20','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
  );
[0m07:01:06.668864 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:01:07.024297 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:07.028983 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:01:07.029608 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m07:01:07.110441 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m07:01:07.115979 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:01:07.116515 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m07:01:07.177361 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m07:01:07.183238 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:01:07.183797 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m07:01:07.246702 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m07:01:07.251985 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m07:01:07.254136 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:01:07.255028 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m07:01:07.342807 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:07.343567 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:01:07.344202 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m07:01:07.915320 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m07:01:07.916146 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:01:07.916686 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m07:01:08.131361 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:08.137217 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:01:08.137872 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m07:01:08.259401 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:08.264396 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 07:01:06.662498 => 07:01:08.264075
[0m07:01:08.265021 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m07:01:08.378467 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f351e7-3b03-4455-b896-233a5255e756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48ddecf910>]}
[0m07:01:08.379651 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 10[0m in 1.73s]
[0m07:01:08.380850 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m07:01:08.381514 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m07:01:08.382130 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m07:01:08.383036 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m07:01:08.383888 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m07:01:08.392212 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m07:01:08.393228 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 07:01:08.384483 => 07:01:08.392837
[0m07:01:08.394047 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m07:01:08.399970 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:01:08.400598 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where to_date('2023-06-20', 'YYYY-MM-DD') = run_date
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
  );
[0m07:01:08.401230 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:01:08.755255 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:08.760359 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:01:08.761088 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m07:01:08.829995 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:01:08.835563 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:01:08.836168 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m07:01:08.899312 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:01:08.905548 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:01:08.906546 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m07:01:08.980646 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:01:08.985918 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m07:01:08.987806 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:01:08.988358 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m07:01:09.078225 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:09.078980 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:01:09.079590 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")

;
[0m07:01:09.602296 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 1.0 seconds
[0m07:01:09.603168 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:01:09.603757 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m07:01:09.796381 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:09.801946 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:01:09.802607 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m07:01:09.895330 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:09.899527 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 07:01:08.394467 => 07:01:09.899166
[0m07:01:09.900182 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m07:01:09.994522 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f351e7-3b03-4455-b896-233a5255e756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48ddf97df0>]}
[0m07:01:09.995971 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 8[0m in 1.61s]
[0m07:01:09.997707 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m07:01:09.998423 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m07:01:09.999488 [info ] [Thread-1  ]: 6 of 7 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m07:01:10.000585 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m07:01:10.001141 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m07:01:10.008921 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m07:01:10.010020 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 07:01:10.001544 => 07:01:10.009572
[0m07:01:10.010580 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m07:01:10.018617 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:01:10.019298 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace  temporary view external_db.final_sales.fct_order_detail__dbt_tmp
  
   as (
    
with orders as (
    select * from external_db.final_sales.bronze_orders
   
        where run_date = to_date('2023-06-20', 'YYYY-MM-DD')
    
),

products as (
    select * from external_db.final_sales.bronze_products
    
        where run_date = to_date('2023-06-20', 'YYYY-MM-DD')
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_date
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m07:01:10.019985 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:01:10.407104 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:10.414316 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:01:10.415067 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail__dbt_tmp
[0m07:01:10.490815 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:01:10.496326 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:01:10.496897 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail
[0m07:01:10.556734 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:01:10.562328 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:01:10.562979 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_ORDER_DETAIL"
[0m07:01:10.629318 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:01:10.634756 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m07:01:10.636609 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:01:10.637172 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
-- back compat for old kwarg name
  
  begin;
[0m07:01:10.722368 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:10.723177 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:01:10.723713 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
merge into external_db.final_sales.fct_order_detail as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_order_detail__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")

;
[0m07:01:11.431207 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m07:01:11.432021 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:01:11.432491 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
COMMIT
[0m07:01:11.654333 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:11.659562 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:01:11.660162 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m07:01:11.748629 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:11.752663 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 07:01:10.011010 => 07:01:11.752366
[0m07:01:11.753353 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m07:01:11.855606 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f351e7-3b03-4455-b896-233a5255e756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc56f1c0>]}
[0m07:01:11.856935 [info ] [Thread-1  ]: 6 of 7 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 10[0m in 1.85s]
[0m07:01:11.858037 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m07:01:11.859398 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m07:01:11.860268 [info ] [Thread-1  ]: 7 of 7 START sql incremental model final_sales.product_sales ................... [RUN]
[0m07:01:11.861348 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m07:01:11.861903 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m07:01:11.870794 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m07:01:11.871825 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 07:01:11.862259 => 07:01:11.871489
[0m07:01:11.872403 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m07:01:11.878445 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:01:11.879019 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace  temporary view external_db.final_sales.product_sales__dbt_tmp
  
   as (
    

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
        where to_date('2023-06-20', 'YYYY-MM-DD') = run_date
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
        where to_date('2023-06-20', 'YYYY-MM-DD') = run_date
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
        where to_date('2023-06-20', 'YYYY-MM-DD') = run_date
    
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m07:01:11.879615 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:01:12.434777 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:01:12.439429 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:01:12.439952 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales__dbt_tmp
[0m07:01:12.513344 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m07:01:12.519299 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:01:12.519873 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales
[0m07:01:12.580608 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m07:01:12.588392 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:01:12.589006 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."PRODUCT_SALES"
[0m07:01:12.651179 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m07:01:12.660932 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m07:01:12.662755 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:01:12.663297 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
-- back compat for old kwarg name
  
  begin;
[0m07:01:12.738966 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:12.739893 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:01:12.740571 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
merge into external_db.final_sales.product_sales as DBT_INTERNAL_DEST
        using external_db.final_sales.product_sales__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","ORDER_AMOUNT" = DBT_INTERNAL_SOURCE."ORDER_AMOUNT"
    

    when not matched then insert
        ("CUSTOMER_ID", "ORDER_AMOUNT")
    values
        ("CUSTOMER_ID", "ORDER_AMOUNT")

;
[0m07:01:13.548308 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:01:13.549189 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:01:13.549750 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
COMMIT
[0m07:01:13.737852 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:13.744526 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:01:13.745216 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m07:01:13.827174 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:01:13.830894 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 07:01:11.872747 => 07:01:13.830607
[0m07:01:13.831424 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m07:01:13.931996 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2f351e7-3b03-4455-b896-233a5255e756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48dc5d6880>]}
[0m07:01:13.933051 [info ] [Thread-1  ]: 7 of 7 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 1[0m in 2.07s]
[0m07:01:13.934086 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m07:01:13.936273 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:01:13.936700 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m07:01:13.937256 [info ] [MainThread]: 
[0m07:01:13.937845 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 14.35 seconds (14.35s).
[0m07:01:13.941748 [debug] [MainThread]: Command end result
[0m07:01:13.952120 [info ] [MainThread]: 
[0m07:01:13.952926 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:01:13.953481 [info ] [MainThread]: 
[0m07:01:13.954100 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m07:01:13.955184 [debug] [MainThread]: Command `dbt run` succeeded at 07:01:13.954986 after 16.03 seconds
[0m07:01:13.955743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48e6021430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48df1f9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48df1835b0>]}
[0m07:01:13.956390 [debug] [MainThread]: Flushing usage events
[0m14:52:18.300994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc20ac2f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2094f0670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2094f0070>]}


============================== 14:52:18.305948 | c24760f2-cd5f-4591-9472-ac86864bb165 ==============================
[0m14:52:18.305948 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:52:18.307863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:52:19.347631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c24760f2-cd5f-4591-9472-ac86864bb165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc203dcb880>]}
[0m14:52:19.369256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c24760f2-cd5f-4591-9472-ac86864bb165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc203df7040>]}
[0m14:52:19.387641 [debug] [MainThread]: checksum: 106cecc696d8692618f466fb5b0c5ae9fd73433d21c5679fe6b84da7254d4067, vars: {0: None,
 6: None,
 23: None,
 'run_time_stamp': 'DateTime(2023',
 'tzinfo=Timezone(Etc/UTC))': None}, profile: , target: , version: 1.5.1
[0m14:52:19.405031 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m14:52:19.406533 [debug] [MainThread]: previous checksum: 106cecc696d8692618f466fb5b0c5ae9fd73433d21c5679fe6b84da7254d4067, current checksum: 071c9ca3a2d2a01a721f4df37b2be932639ff42e7cb54c813a84a00679464ae6
[0m14:52:19.407073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c24760f2-cd5f-4591-9472-ac86864bb165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc203dabee0>]}
[0m14:52:20.370729 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_order_detail.sql
[0m14:52:20.398276 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_order_detail.sql
[0m14:52:20.401663 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_payment_details.sql
[0m14:52:20.409517 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_payment_details.sql
[0m14:52:20.412564 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m14:52:20.418954 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m14:52:20.421916 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m14:52:20.431861 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m14:52:20.434910 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m14:52:20.441886 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m14:52:20.444730 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m14:52:20.451240 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m14:52:20.454554 [debug] [MainThread]: 1603: static parser failed on sales/core/product_sales.sql
[0m14:52:20.464970 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/core/product_sales.sql
[0m14:52:20.641495 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m14:52:20.651336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c24760f2-cd5f-4591-9472-ac86864bb165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc2037ad280>]}
[0m14:52:20.662233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c24760f2-cd5f-4591-9472-ac86864bb165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc203dd4b50>]}
[0m14:52:20.662947 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:52:20.664263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c24760f2-cd5f-4591-9472-ac86864bb165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc208003a00>]}
[0m14:52:20.666949 [info ] [MainThread]: 
[0m14:52:20.669283 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:52:20.670950 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m14:52:20.695927 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m14:52:20.696783 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m14:52:20.697912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:21.746903 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:52:21.750505 [debug] [ThreadPool]: On list_external_db: Close
[0m14:52:21.860065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m14:52:21.870135 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m14:52:21.870587 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m14:52:21.871053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:22.488157 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:52:22.490948 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m14:52:22.604736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c24760f2-cd5f-4591-9472-ac86864bb165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc203dd4550>]}
[0m14:52:22.608659 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:52:22.609555 [info ] [MainThread]: 
[0m14:52:22.619063 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m14:52:22.619893 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m14:52:22.621052 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_orders)
[0m14:52:22.621779 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m14:52:22.627090 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m14:52:22.628122 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 14:52:22.622232 => 14:52:22.627756
[0m14:52:22.628685 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m14:52:22.698658 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m14:52:22.699367 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
  );
[0m14:52:22.699891 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:52:23.135188 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:23.149172 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m14:52:23.149726 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m14:52:23.237566 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:52:23.243708 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m14:52:23.244245 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m14:52:23.318520 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:52:23.330413 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m14:52:23.330999 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m14:52:23.407704 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:52:23.451419 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m14:52:23.453048 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m14:52:23.453620 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m14:52:23.549912 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:23.550971 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m14:52:23.551769 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")

;
[0m14:52:24.992858 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m14:52:24.993828 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m14:52:24.994327 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m14:52:25.251940 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:25.263459 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m14:52:25.264119 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m14:52:25.368789 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:25.410497 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 14:52:22.629048 => 14:52:25.410168
[0m14:52:25.411152 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m14:52:25.516117 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c24760f2-cd5f-4591-9472-ac86864bb165', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc201263a30>]}
[0m14:52:25.517396 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 10[0m in 2.90s]
[0m14:52:25.518601 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m14:52:25.521391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:25.521877 [debug] [MainThread]: Connection 'model.development.bronze_orders' was properly closed.
[0m14:52:25.522571 [info ] [MainThread]: 
[0m14:52:25.523151 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.85 seconds (4.85s).
[0m14:52:25.524194 [debug] [MainThread]: Command end result
[0m14:52:25.533775 [info ] [MainThread]: 
[0m14:52:25.534351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:25.534880 [info ] [MainThread]: 
[0m14:52:25.535398 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:52:25.536839 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:25.536671 after 7.26 seconds
[0m14:52:25.537371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc20ac2f5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc208003b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc209dd3370>]}
[0m14:52:25.537871 [debug] [MainThread]: Flushing usage events
[0m14:52:32.774092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5299e45b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5282a5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5282a5070>]}


============================== 14:52:32.777921 | 3e667c4a-c219-4e6d-8776-02fb99fd1a15 ==============================
[0m14:52:32.777921 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:52:32.778702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:52:33.111705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e667c4a-c219-4e6d-8776-02fb99fd1a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb523b95bb0>]}
[0m14:52:33.133177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e667c4a-c219-4e6d-8776-02fb99fd1a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb523bc3040>]}
[0m14:52:33.150970 [debug] [MainThread]: checksum: 106cecc696d8692618f466fb5b0c5ae9fd73433d21c5679fe6b84da7254d4067, vars: {0: None,
 6: None,
 23: None,
 'run_time_stamp': 'DateTime(2023',
 'tzinfo=Timezone(Etc/UTC))': None}, profile: , target: , version: 1.5.1
[0m14:52:33.181982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:33.182523 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:33.183543 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m14:52:33.192036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e667c4a-c219-4e6d-8776-02fb99fd1a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5229ce580>]}
[0m14:52:33.201669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e667c4a-c219-4e6d-8776-02fb99fd1a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb523ac2400>]}
[0m14:52:33.202452 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:52:33.203115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e667c4a-c219-4e6d-8776-02fb99fd1a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb523ac24f0>]}
[0m14:52:33.205926 [info ] [MainThread]: 
[0m14:52:33.206924 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:52:33.208539 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m14:52:33.227883 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m14:52:33.228529 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m14:52:33.229015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:33.421937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a709e0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a6f2c95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a6f2c9160>]}


============================== 14:52:33.426103 | 60303933-b8b2-4837-918f-b6f414f7ad5a ==============================
[0m14:52:33.426103 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:52:33.427592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:52:33.751278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60303933-b8b2-4837-918f-b6f414f7ad5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a6ab98070>]}
[0m14:52:33.773194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60303933-b8b2-4837-918f-b6f414f7ad5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a6abe50a0>]}
[0m14:52:33.790798 [debug] [MainThread]: checksum: 106cecc696d8692618f466fb5b0c5ae9fd73433d21c5679fe6b84da7254d4067, vars: {0: None,
 6: None,
 23: None,
 'run_time_stamp': 'DateTime(2023',
 'tzinfo=Timezone(Etc/UTC))': None}, profile: , target: , version: 1.5.1
[0m14:52:33.821443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:33.821949 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:33.823048 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.intermediate
[0m14:52:33.832611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60303933-b8b2-4837-918f-b6f414f7ad5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a699d0580>]}
[0m14:52:33.841910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60303933-b8b2-4837-918f-b6f414f7ad5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a6aad8430>]}
[0m14:52:33.842611 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:52:33.843249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60303933-b8b2-4837-918f-b6f414f7ad5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a6aad8580>]}
[0m14:52:33.844614 [info ] [MainThread]: 
[0m14:52:33.845523 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:52:33.846843 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m14:52:33.865852 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m14:52:33.866289 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m14:52:33.866682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:33.894089 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:52:33.898414 [debug] [ThreadPool]: On list_external_db: Close
[0m14:52:34.009947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m14:52:34.020433 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m14:52:34.020947 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m14:52:34.021439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:34.378708 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:52:34.381940 [debug] [ThreadPool]: On list_external_db: Close
[0m14:52:34.495181 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:52:34.497653 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m14:52:34.504415 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m14:52:34.515933 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m14:52:34.516541 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m14:52:34.516974 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:34.607687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e667c4a-c219-4e6d-8776-02fb99fd1a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb523a3cf10>]}
[0m14:52:34.609028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:52:34.610016 [info ] [MainThread]: 
[0m14:52:34.615857 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m14:52:34.616800 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m14:52:34.617698 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_orders)
[0m14:52:34.618282 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m14:52:34.623383 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m14:52:34.624432 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 14:52:34.618694 => 14:52:34.624053
[0m14:52:34.624891 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m14:52:34.707572 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m14:52:34.708196 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.orders
)

select * from orders
  );
[0m14:52:34.708644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:52:34.857158 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:52:34.860188 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m14:52:34.972881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60303933-b8b2-4837-918f-b6f414f7ad5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a6aad81f0>]}
[0m14:52:34.974077 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:52:34.974615 [info ] [MainThread]: 
[0m14:52:34.980136 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m14:52:34.980963 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m14:52:34.982120 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_payments)
[0m14:52:34.982682 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m14:52:34.989980 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m14:52:34.991364 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 14:52:34.983043 => 14:52:34.990905
[0m14:52:34.991951 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m14:52:35.060126 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m14:52:35.060951 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
  );
[0m14:52:35.061586 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:52:35.142253 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:35.154795 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m14:52:35.155441 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m14:52:35.234859 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:52:35.241225 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m14:52:35.241796 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m14:52:35.313158 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:52:35.325473 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m14:52:35.326024 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m14:52:35.388564 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:52:35.437774 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m14:52:35.439586 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m14:52:35.440147 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m14:52:35.440904 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:35.452964 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m14:52:35.453576 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m14:52:35.531477 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:35.530744 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:52:35.532648 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m14:52:35.533572 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")

;
[0m14:52:35.538229 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m14:52:35.538981 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m14:52:35.613787 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:52:35.624568 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m14:52:35.625160 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m14:52:35.689668 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:52:35.732607 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m14:52:35.734357 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m14:52:35.734819 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m14:52:35.818344 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:35.819028 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m14:52:35.819790 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m14:52:35.980775 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m14:52:35.981632 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m14:52:35.982253 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m14:52:36.213838 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:36.224499 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m14:52:36.224991 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m14:52:36.320147 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:36.348779 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 14:52:34.625211 => 14:52:36.348448
[0m14:52:36.349399 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m14:52:36.449743 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e667c4a-c219-4e6d-8776-02fb99fd1a15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb520446880>]}
[0m14:52:36.451101 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 10[0m in 1.83s]
[0m14:52:36.452864 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m14:52:36.454882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:36.455274 [debug] [MainThread]: Connection 'model.development.bronze_orders' was properly closed.
[0m14:52:36.455874 [info ] [MainThread]: 
[0m14:52:36.457698 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m14:52:36.459381 [debug] [MainThread]: Command end result
[0m14:52:36.471961 [info ] [MainThread]: 
[0m14:52:36.474207 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:36.475431 [info ] [MainThread]: 
[0m14:52:36.476680 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:52:36.478269 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:36.478083 after 3.73 seconds
[0m14:52:36.478898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5299e45b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb523bc3040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb523ac2460>]}
[0m14:52:36.479645 [debug] [MainThread]: Flushing usage events
[0m14:52:37.613827 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 2.0 seconds
[0m14:52:37.614946 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m14:52:37.615560 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m14:52:37.828609 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:37.839412 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m14:52:37.840026 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m14:52:37.935013 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:37.971195 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 14:52:34.992279 => 14:52:37.970850
[0m14:52:37.972809 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m14:52:38.089749 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '60303933-b8b2-4837-918f-b6f414f7ad5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a6846c820>]}
[0m14:52:38.090931 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 10[0m in 3.11s]
[0m14:52:38.092483 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m14:52:38.094814 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:38.095237 [debug] [MainThread]: Connection 'model.development.bronze_payments' was properly closed.
[0m14:52:38.095689 [info ] [MainThread]: 
[0m14:52:38.096495 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 4.25 seconds (4.25s).
[0m14:52:38.097691 [debug] [MainThread]: Command end result
[0m14:52:38.108434 [info ] [MainThread]: 
[0m14:52:38.109468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:38.110470 [info ] [MainThread]: 
[0m14:52:38.111720 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:52:38.113537 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:38.113292 after 4.71 seconds
[0m14:52:38.114195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a709e0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a6abe50a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a6ab96400>]}
[0m14:52:38.115073 [debug] [MainThread]: Flushing usage events
[0m14:52:45.411229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c98c95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c818a670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c818a070>]}


============================== 14:52:45.415177 | 3b90849c-b558-4732-a92d-14ae9d070f67 ==============================
[0m14:52:45.415177 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:52:45.416364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:52:45.753622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b90849c-b558-4732-a92d-14ae9d070f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c3a7dbb0>]}
[0m14:52:45.759190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a04955b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659ed7a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659ed7a640>]}


============================== 14:52:45.763553 | 37420f0f-aab0-4964-95af-2d0d21aba2c8 ==============================
[0m14:52:45.763553 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:52:45.765630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:52:45.776634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b90849c-b558-4732-a92d-14ae9d070f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c3aa6040>]}
[0m14:52:45.795204 [debug] [MainThread]: checksum: 106cecc696d8692618f466fb5b0c5ae9fd73433d21c5679fe6b84da7254d4067, vars: {0: None,
 6: None,
 23: None,
 'run_time_stamp': 'DateTime(2023',
 'tzinfo=Timezone(Etc/UTC))': None}, profile: , target: , version: 1.5.1
[0m14:52:45.824617 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:45.825215 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:45.826272 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m14:52:45.838915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b90849c-b558-4732-a92d-14ae9d070f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c288d610>]}
[0m14:52:45.849588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b90849c-b558-4732-a92d-14ae9d070f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c2972490>]}
[0m14:52:45.850241 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:52:45.851110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b90849c-b558-4732-a92d-14ae9d070f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c2972580>]}
[0m14:52:45.852819 [info ] [MainThread]: 
[0m14:52:45.854074 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:52:45.855709 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m14:52:45.874778 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m14:52:45.875375 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m14:52:45.875811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:46.103920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37420f0f-aab0-4964-95af-2d0d21aba2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659a677ca0>]}
[0m14:52:46.126811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37420f0f-aab0-4964-95af-2d0d21aba2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659a6998b0>]}
[0m14:52:46.146676 [debug] [MainThread]: checksum: 106cecc696d8692618f466fb5b0c5ae9fd73433d21c5679fe6b84da7254d4067, vars: {0: None,
 6: None,
 23: None,
 'run_time_stamp': 'DateTime(2023',
 'tzinfo=Timezone(Etc/UTC))': None}, profile: , target: , version: 1.5.1
[0m14:52:46.181606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:46.182363 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:46.183399 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.staging
- models.development.intermediate
[0m14:52:46.194086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37420f0f-aab0-4964-95af-2d0d21aba2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659948e5b0>]}
[0m14:52:46.203387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37420f0f-aab0-4964-95af-2d0d21aba2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6599578460>]}
[0m14:52:46.213987 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:52:46.215272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37420f0f-aab0-4964-95af-2d0d21aba2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65995785b0>]}
[0m14:52:46.217031 [info ] [MainThread]: 
[0m14:52:46.218708 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:52:46.228735 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m14:52:46.250744 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m14:52:46.251451 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m14:52:46.251944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:46.603380 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:52:46.606211 [debug] [ThreadPool]: On list_external_db: Close
[0m14:52:46.728938 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m14:52:46.740134 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m14:52:46.740653 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m14:52:46.741100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:46.918502 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:52:46.921464 [debug] [ThreadPool]: On list_external_db: Close
[0m14:52:47.038594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m14:52:47.051344 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m14:52:47.052035 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m14:52:47.052493 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:47.063745 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:52:47.067038 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m14:52:47.179288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b90849c-b558-4732-a92d-14ae9d070f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c3a59970>]}
[0m14:52:47.180688 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:52:47.182575 [info ] [MainThread]: 
[0m14:52:47.188148 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m14:52:47.188893 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m14:52:47.189935 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_payments)
[0m14:52:47.190483 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m14:52:47.196045 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m14:52:47.197147 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 14:52:47.190850 => 14:52:47.196663
[0m14:52:47.197737 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m14:52:47.271435 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m14:52:47.272316 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date from external_db.stage.payments
)

select * from payments
  );
[0m14:52:47.272945 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:52:47.363316 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:52:47.365657 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m14:52:47.473813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37420f0f-aab0-4964-95af-2d0d21aba2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65994eff40>]}
[0m14:52:47.475431 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:52:47.476048 [info ] [MainThread]: 
[0m14:52:47.483076 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m14:52:47.483833 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m14:52:47.484809 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_products)
[0m14:52:47.485349 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m14:52:47.490226 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m14:52:47.491519 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 14:52:47.485668 => 14:52:47.491044
[0m14:52:47.492682 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m14:52:47.580805 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m14:52:47.581665 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_date('2023-06-22','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
  );
[0m14:52:47.582377 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:52:47.652861 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:47.668378 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m14:52:47.668917 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m14:52:47.753925 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:52:47.760075 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m14:52:47.760553 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m14:52:47.825844 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:52:47.837452 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m14:52:47.838069 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m14:52:47.906955 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:52:47.955460 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m14:52:47.957605 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m14:52:47.958222 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m14:52:47.975350 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:47.988319 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m14:52:47.988876 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m14:52:48.052405 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:48.053077 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m14:52:48.053601 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m14:52:48.063061 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m14:52:48.068796 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m14:52:48.069351 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m14:52:48.150333 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m14:52:48.161996 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m14:52:48.162508 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m14:52:48.238226 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m14:52:48.290338 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m14:52:48.292218 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m14:52:48.292849 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m14:52:48.387285 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:48.388137 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m14:52:48.388714 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m14:52:48.746332 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m14:52:48.747125 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m14:52:48.747597 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m14:52:48.923041 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m14:52:48.923895 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m14:52:48.924479 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m14:52:48.978203 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:48.988781 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m14:52:48.989372 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m14:52:49.086957 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:49.117922 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 14:52:47.198081 => 14:52:49.117578
[0m14:52:49.119053 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m14:52:49.134512 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:49.145093 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m14:52:49.145677 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m14:52:49.229959 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b90849c-b558-4732-a92d-14ae9d070f67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c0330820>]}
[0m14:52:49.231027 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 10[0m in 2.04s]
[0m14:52:49.231974 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m14:52:49.234056 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:49.234476 [debug] [MainThread]: Connection 'model.development.bronze_payments' was properly closed.
[0m14:52:49.234955 [info ] [MainThread]: 
[0m14:52:49.235594 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m14:52:49.236554 [debug] [MainThread]: Command end result
[0m14:52:49.239052 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:49.254340 [info ] [MainThread]: 
[0m14:52:49.255106 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:49.255666 [info ] [MainThread]: 
[0m14:52:49.256209 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:52:49.257254 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:49.257087 after 3.87 seconds
[0m14:52:49.257837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c98c95b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c3aa6040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2c0313bb0>]}
[0m14:52:49.258446 [debug] [MainThread]: Flushing usage events
[0m14:52:49.271924 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 14:52:47.493132 => 14:52:49.271611
[0m14:52:49.272640 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m14:52:49.407841 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37420f0f-aab0-4964-95af-2d0d21aba2c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659871e940>]}
[0m14:52:49.409406 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 10[0m in 1.92s]
[0m14:52:49.410469 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m14:52:49.412598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:49.413146 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m14:52:49.413774 [info ] [MainThread]: 
[0m14:52:49.414413 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m14:52:49.415353 [debug] [MainThread]: Command end result
[0m14:52:49.426038 [info ] [MainThread]: 
[0m14:52:49.426611 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:49.427114 [info ] [MainThread]: 
[0m14:52:49.427834 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:52:49.428841 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:49.428673 after 3.69 seconds
[0m14:52:49.429473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a04955b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659a6998b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6598702dc0>]}
[0m14:52:49.429979 [debug] [MainThread]: Flushing usage events
[0m14:52:57.586560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea3db475e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea3c439700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea3c439160>]}


============================== 14:52:57.591013 | b2adf4e4-2dd5-46af-ac95-6b2b92285842 ==============================
[0m14:52:57.591013 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:52:57.592545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:52:57.588543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f5e9f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f4787640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f47870a0>]}


============================== 14:52:57.594705 | 5123ed5c-573c-4846-a834-938ef43677e0 ==============================
[0m14:52:57.594705 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:52:57.596369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:52:57.959399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5123ed5c-573c-4846-a834-938ef43677e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f0060190>]}
[0m14:52:57.967307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2adf4e4-2dd5-46af-ac95-6b2b92285842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea37d34c70>]}
[0m14:52:57.981473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5123ed5c-573c-4846-a834-938ef43677e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f00a6160>]}
[0m14:52:57.988635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2adf4e4-2dd5-46af-ac95-6b2b92285842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea37ce2f40>]}
[0m14:52:57.999696 [debug] [MainThread]: checksum: 106cecc696d8692618f466fb5b0c5ae9fd73433d21c5679fe6b84da7254d4067, vars: {0: None,
 6: None,
 23: None,
 'run_time_stamp': 'DateTime(2023',
 'tzinfo=Timezone(Etc/UTC))': None}, profile: , target: , version: 1.5.1
[0m14:52:58.006661 [debug] [MainThread]: checksum: 106cecc696d8692618f466fb5b0c5ae9fd73433d21c5679fe6b84da7254d4067, vars: {0: None,
 6: None,
 23: None,
 'run_time_stamp': 'DateTime(2023',
 'tzinfo=Timezone(Etc/UTC))': None}, profile: , target: , version: 1.5.1
[0m14:52:58.030417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:58.031023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:58.032084 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m14:52:58.035840 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:58.036383 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:58.037433 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.intermediate
[0m14:52:58.046545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5123ed5c-573c-4846-a834-938ef43677e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7eee8e5b0>]}
[0m14:52:58.051043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2adf4e4-2dd5-46af-ac95-6b2b92285842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea36b4f670>]}
[0m14:52:58.057045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5123ed5c-573c-4846-a834-938ef43677e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7eef71460>]}
[0m14:52:58.057769 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:52:58.059149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5123ed5c-573c-4846-a834-938ef43677e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7eef715b0>]}
[0m14:52:58.061094 [info ] [MainThread]: 
[0m14:52:58.062669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2adf4e4-2dd5-46af-ac95-6b2b92285842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea37c50520>]}
[0m14:52:58.063427 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:52:58.063364 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:52:58.064556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2adf4e4-2dd5-46af-ac95-6b2b92285842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea37c50670>]}
[0m14:52:58.065561 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m14:52:58.066158 [info ] [MainThread]: 
[0m14:52:58.067546 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:52:58.068892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m14:52:58.087083 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m14:52:58.087906 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m14:52:58.088516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:58.089553 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m14:52:58.090067 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m14:52:58.090484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:58.732220 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:52:58.735319 [debug] [ThreadPool]: On list_external_db: Close
[0m14:52:58.755426 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:52:58.758683 [debug] [ThreadPool]: On list_external_db: Close
[0m14:52:58.836760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m14:52:58.847329 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m14:52:58.847817 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m14:52:58.848235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:58.886066 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m14:52:58.898937 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m14:52:58.899790 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m14:52:58.900427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:59.157732 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:52:59.160403 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m14:52:59.237906 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:52:59.241135 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m14:52:59.275218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5123ed5c-573c-4846-a834-938ef43677e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7eeef1f40>]}
[0m14:52:59.276440 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:52:59.277033 [info ] [MainThread]: 
[0m14:52:59.282009 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m14:52:59.282842 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m14:52:59.283787 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m14:52:59.284297 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m14:52:59.290357 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m14:52:59.291377 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 14:52:59.284610 => 14:52:59.290994
[0m14:52:59.291897 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m14:52:59.367874 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m14:52:59.367972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2adf4e4-2dd5-46af-ac95-6b2b92285842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea37d09c10>]}
[0m14:52:59.368549 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m14:52:59.369042 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:52:59.369284 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:52:59.370638 [info ] [MainThread]: 
[0m14:52:59.377137 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m14:52:59.377871 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m14:52:59.378781 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_products)
[0m14:52:59.379339 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m14:52:59.385394 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m14:52:59.386439 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 14:52:59.379814 => 14:52:59.386094
[0m14:52:59.386932 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m14:52:59.467130 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m14:52:59.467895 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_date('2023-06-22','YYYY-MM-DD') as run_date from external_db.stage.products
)

select * from products
  );
[0m14:52:59.468430 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:52:59.756532 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:59.769710 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m14:52:59.770304 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m14:52:59.844026 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:52:59.849814 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m14:52:59.850515 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m14:52:59.883202 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:52:59.900323 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m14:52:59.901227 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m14:52:59.927351 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:52:59.941106 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m14:52:59.941900 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m14:52:59.982627 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m14:52:59.987691 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m14:52:59.988187 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m14:53:00.007987 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:53:00.053175 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m14:53:00.055690 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m14:53:00.056186 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m14:53:00.062860 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m14:53:00.074636 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m14:53:00.075216 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m14:53:00.133038 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:00.134312 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m14:53:00.135225 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m14:53:00.143113 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m14:53:00.187518 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m14:53:00.189083 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m14:53:00.189600 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m14:53:00.288411 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:00.289217 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m14:53:00.289962 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m14:53:00.636937 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 0.0 seconds
[0m14:53:00.637797 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m14:53:00.638265 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m14:53:00.699796 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m14:53:00.700615 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m14:53:00.701135 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m14:53:00.839368 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:00.850896 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m14:53:00.851414 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m14:53:00.882504 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:00.894448 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m14:53:00.895014 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m14:53:00.946235 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:00.976098 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:00.977803 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 14:52:59.387261 => 14:53:00.977481
[0m14:53:00.978429 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m14:53:01.019620 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 14:52:59.292420 => 14:53:01.019120
[0m14:53:01.020306 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m14:53:01.095827 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2adf4e4-2dd5-46af-ac95-6b2b92285842', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea345da580>]}
[0m14:53:01.096978 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 10[0m in 1.72s]
[0m14:53:01.098009 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m14:53:01.100177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:01.100612 [debug] [MainThread]: Connection 'list_external_db' was properly closed.
[0m14:53:01.100996 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m14:53:01.101460 [info ] [MainThread]: 
[0m14:53:01.102030 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m14:53:01.103044 [debug] [MainThread]: Command end result
[0m14:53:01.113119 [info ] [MainThread]: 
[0m14:53:01.113891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:01.114549 [info ] [MainThread]: 
[0m14:53:01.115188 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:53:01.116453 [debug] [MainThread]: Command `dbt run` succeeded at 14:53:01.116180 after 3.55 seconds
[0m14:53:01.117008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea3db475e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea37ce2f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea37d09d30>]}
[0m14:53:01.117611 [debug] [MainThread]: Flushing usage events
[0m14:53:01.127586 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5123ed5c-573c-4846-a834-938ef43677e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ec92b670>]}
[0m14:53:01.128584 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 10[0m in 1.84s]
[0m14:53:01.129540 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m14:53:01.132019 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:01.132495 [debug] [MainThread]: Connection 'model.development.bronze_customers' was properly closed.
[0m14:53:01.132974 [info ] [MainThread]: 
[0m14:53:01.133606 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m14:53:01.134665 [debug] [MainThread]: Command end result
[0m14:53:01.145684 [info ] [MainThread]: 
[0m14:53:01.146362 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:01.147361 [info ] [MainThread]: 
[0m14:53:01.147995 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:53:01.149435 [debug] [MainThread]: Command `dbt run` succeeded at 14:53:01.149136 after 3.61 seconds
[0m14:53:01.150066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f5e9f550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f00a6160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7eef714c0>]}
[0m14:53:01.150617 [debug] [MainThread]: Flushing usage events
[0m14:53:08.784404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7626068550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f762492a610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f762492a0a0>]}


============================== 14:53:08.788539 | dc480d31-48e9-4145-9597-eaaf4eca4c68 ==============================
[0m14:53:08.788539 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:53:08.789394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:53:09.173259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc480d31-48e9-4145-9597-eaaf4eca4c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761f1f3130>]}
[0m14:53:09.198565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc480d31-48e9-4145-9597-eaaf4eca4c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7620242640>]}
[0m14:53:09.217133 [debug] [MainThread]: checksum: 106cecc696d8692618f466fb5b0c5ae9fd73433d21c5679fe6b84da7254d4067, vars: {0: None,
 6: None,
 23: None,
 'run_time_stamp': 'DateTime(2023',
 'tzinfo=Timezone(Etc/UTC))': None}, profile: , target: , version: 1.5.1
[0m14:53:09.249822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:53:09.250585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:53:09.251699 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.intermediate
- models.development.bronze
[0m14:53:09.261277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc480d31-48e9-4145-9597-eaaf4eca4c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761f04f520>]}
[0m14:53:09.270863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc480d31-48e9-4145-9597-eaaf4eca4c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761f1353d0>]}
[0m14:53:09.271525 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:53:09.285718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc480d31-48e9-4145-9597-eaaf4eca4c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761f135520>]}
[0m14:53:09.287467 [info ] [MainThread]: 
[0m14:53:09.288673 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:53:09.293974 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m14:53:09.323797 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m14:53:09.324412 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m14:53:09.324847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:09.715819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2c181e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2c01085b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2c01080a0>]}


============================== 14:53:09.719500 | 8a53d880-e1ff-428c-a2be-6e6e74fa6eed ==============================
[0m14:53:09.719500 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:53:09.720555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:53:10.030128 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:53:10.033544 [debug] [ThreadPool]: On list_external_db: Close
[0m14:53:10.059990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a53d880-e1ff-428c-a2be-6e6e74fa6eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2ba9b3130>]}
[0m14:53:10.084005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a53d880-e1ff-428c-a2be-6e6e74fa6eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2ba9fb0d0>]}
[0m14:53:10.110924 [debug] [MainThread]: checksum: 106cecc696d8692618f466fb5b0c5ae9fd73433d21c5679fe6b84da7254d4067, vars: {0: None,
 6: None,
 23: None,
 'run_time_stamp': 'DateTime(2023',
 'tzinfo=Timezone(Etc/UTC))': None}, profile: , target: , version: 1.5.1
[0m14:53:10.142408 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:53:10.142936 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:53:10.143832 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m14:53:10.155517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a53d880-e1ff-428c-a2be-6e6e74fa6eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2ba80e490>]}
[0m14:53:10.163694 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m14:53:10.175874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a53d880-e1ff-428c-a2be-6e6e74fa6eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2ba8f2340>]}
[0m14:53:10.185500 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m14:53:10.176657 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:53:10.186189 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m14:53:10.186737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:10.186714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a53d880-e1ff-428c-a2be-6e6e74fa6eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2ba8f2490>]}
[0m14:53:10.188738 [info ] [MainThread]: 
[0m14:53:10.190959 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:53:10.192453 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m14:53:10.212697 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m14:53:10.213396 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m14:53:10.213819 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:10.638235 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:53:10.641068 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m14:53:10.682161 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:53:10.686446 [debug] [ThreadPool]: On list_external_db: Close
[0m14:53:10.745848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc480d31-48e9-4145-9597-eaaf4eca4c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761f135160>]}
[0m14:53:10.747091 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:10.747761 [info ] [MainThread]: 
[0m14:53:10.752349 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m14:53:10.753209 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m14:53:10.754154 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.fct_payment_details)
[0m14:53:10.754835 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m14:53:10.768180 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m14:53:10.769430 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 14:53:10.755193 => 14:53:10.768953
[0m14:53:10.770021 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m14:53:10.798446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m14:53:10.809116 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m14:53:10.809839 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m14:53:10.810345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:10.848359 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m14:53:10.849116 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
  );
[0m14:53:10.849694 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:53:11.131233 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:53:11.134156 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m14:53:11.225135 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:11.239187 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m14:53:11.239839 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m14:53:11.246722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a53d880-e1ff-428c-a2be-6e6e74fa6eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2ba86f910>]}
[0m14:53:11.248157 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:11.248927 [info ] [MainThread]: 
[0m14:53:11.253710 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m14:53:11.254451 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m14:53:11.255381 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.fct_order_detail)
[0m14:53:11.255910 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m14:53:11.272994 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m14:53:11.274265 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 14:53:11.256295 => 14:53:11.273898
[0m14:53:11.274816 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m14:53:11.318409 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:53:11.325234 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m14:53:11.325873 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m14:53:11.342985 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m14:53:11.343653 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace  temporary view external_db.final_sales.fct_order_detail__dbt_tmp
  
   as (
    
with orders as (
    select * from external_db.final_sales.bronze_orders
   
        where run_date = to_date('2023-06-22', 'YYYY-MM-DD')
    
),

products as (
    select * from external_db.final_sales.bronze_products
    
        where run_date = to_date('2023-06-22', 'YYYY-MM-DD')
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_date
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m14:53:11.344225 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:53:11.437577 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:53:11.449297 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m14:53:11.449864 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m14:53:11.539131 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:53:11.586300 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m14:53:11.588601 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m14:53:11.589129 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m14:53:11.679396 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:11.680543 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m14:53:11.681357 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_DATE")

;
[0m14:53:11.742430 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:11.754720 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m14:53:11.755216 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail__dbt_tmp
[0m14:53:11.836398 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:53:11.842259 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m14:53:11.842810 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail
[0m14:53:11.915537 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:53:11.929295 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m14:53:11.930061 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_ORDER_DETAIL"
[0m14:53:12.007703 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m14:53:12.055070 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m14:53:12.057058 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m14:53:12.057715 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
-- back compat for old kwarg name
  
  begin;
[0m14:53:12.183796 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:12.184511 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m14:53:12.185025 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
merge into external_db.final_sales.fct_order_detail as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_order_detail__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_DATE")

;
[0m14:53:12.351891 [debug] [Thread-1  ]: SQL status: SUCCESS 8 in 1.0 seconds
[0m14:53:12.352639 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m14:53:12.353291 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m14:53:12.594350 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:12.605006 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m14:53:12.605566 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m14:53:12.706122 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:12.739442 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 14:53:10.770386 => 14:53:12.739106
[0m14:53:12.740176 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m14:53:12.855442 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc480d31-48e9-4145-9597-eaaf4eca4c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761cacdd30>]}
[0m14:53:12.856535 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 8[0m in 2.10s]
[0m14:53:12.857679 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m14:53:12.860070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:12.860607 [debug] [MainThread]: Connection 'list_external_db' was properly closed.
[0m14:53:12.861070 [debug] [MainThread]: Connection 'model.development.fct_payment_details' was properly closed.
[0m14:53:12.861628 [info ] [MainThread]: 
[0m14:53:12.862343 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m14:53:12.863457 [debug] [MainThread]: Command end result
[0m14:53:12.874997 [info ] [MainThread]: 
[0m14:53:12.878193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:12.878778 [info ] [MainThread]: 
[0m14:53:12.879352 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:53:12.880451 [debug] [MainThread]: Command `dbt run` succeeded at 14:53:12.880256 after 4.12 seconds
[0m14:53:12.881190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7626068550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7620242640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f761ca54070>]}
[0m14:53:12.881826 [debug] [MainThread]: Flushing usage events
[0m14:53:13.058077 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m14:53:13.058954 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m14:53:13.059529 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
COMMIT
[0m14:53:13.275530 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:13.286404 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m14:53:13.287136 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m14:53:13.382052 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:13.410955 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 14:53:11.275183 => 14:53:13.410588
[0m14:53:13.411676 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m14:53:13.522435 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a53d880-e1ff-428c-a2be-6e6e74fa6eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2b82b6640>]}
[0m14:53:13.523805 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 10[0m in 2.27s]
[0m14:53:13.524748 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m14:53:13.527028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:13.527494 [debug] [MainThread]: Connection 'list_external_db' was properly closed.
[0m14:53:13.527884 [debug] [MainThread]: Connection 'model.development.fct_order_detail' was properly closed.
[0m14:53:13.528465 [info ] [MainThread]: 
[0m14:53:13.529120 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m14:53:13.530321 [debug] [MainThread]: Command end result
[0m14:53:13.540812 [info ] [MainThread]: 
[0m14:53:13.541491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:13.542062 [info ] [MainThread]: 
[0m14:53:13.542791 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:53:13.543970 [debug] [MainThread]: Command `dbt run` succeeded at 14:53:13.543797 after 3.85 seconds
[0m14:53:13.544614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2c181e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2ba9fb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2ba8f2400>]}
[0m14:53:13.545293 [debug] [MainThread]: Flushing usage events
[0m14:53:20.879422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf81175b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf69d86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf69d83d0>]}


============================== 14:53:20.883597 | 95094fb3-99e0-4fb8-b9ba-7e6eb3ee47d9 ==============================
[0m14:53:20.883597 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:53:20.885156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:53:21.231367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95094fb3-99e0-4fb8-b9ba-7e6eb3ee47d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf22f6d60>]}
[0m14:53:21.258179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95094fb3-99e0-4fb8-b9ba-7e6eb3ee47d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf22f6760>]}
[0m14:53:21.283666 [debug] [MainThread]: checksum: 106cecc696d8692618f466fb5b0c5ae9fd73433d21c5679fe6b84da7254d4067, vars: {0: None,
 6: None,
 23: None,
 'run_time_stamp': 'DateTime(2023',
 'tzinfo=Timezone(Etc/UTC))': None}, profile: , target: , version: 1.5.1
[0m14:53:21.316439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:53:21.317125 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:53:21.318325 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.intermediate
- models.development.staging
- models.development.bronze
[0m14:53:21.328653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95094fb3-99e0-4fb8-b9ba-7e6eb3ee47d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf10ce610>]}
[0m14:53:21.339849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95094fb3-99e0-4fb8-b9ba-7e6eb3ee47d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf11ae4c0>]}
[0m14:53:21.340639 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:53:21.341799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95094fb3-99e0-4fb8-b9ba-7e6eb3ee47d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf11ae610>]}
[0m14:53:21.343880 [info ] [MainThread]: 
[0m14:53:21.346069 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:53:21.350132 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m14:53:21.369932 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m14:53:21.370499 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m14:53:21.370915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:22.042193 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:53:22.045639 [debug] [ThreadPool]: On list_external_db: Close
[0m14:53:22.156334 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m14:53:22.168358 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m14:53:22.169156 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m14:53:22.170074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:22.635178 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:53:22.637588 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m14:53:22.748250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95094fb3-99e0-4fb8-b9ba-7e6eb3ee47d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf22aba30>]}
[0m14:53:22.751200 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:22.752023 [info ] [MainThread]: 
[0m14:53:22.757881 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m14:53:22.758647 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m14:53:22.759880 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m14:53:22.760526 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m14:53:22.766440 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m14:53:22.767458 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 14:53:22.760868 => 14:53:22.767068
[0m14:53:22.768130 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m14:53:22.838988 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m14:53:22.839660 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_date('2023-06-22', 'YYYY-MM-DD') as run_date  from external_db.stage.customers
)

select * from customers
  );
[0m14:53:22.840321 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:53:23.233094 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:23.245867 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m14:53:23.246561 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m14:53:23.340399 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:53:23.351227 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m14:53:23.352054 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m14:53:23.421490 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:53:23.436687 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m14:53:23.437668 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m14:53:23.518353 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m14:53:23.564578 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m14:53:23.566379 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m14:53:23.566861 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m14:53:23.649221 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:23.650105 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m14:53:23.650681 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m14:53:24.344379 [debug] [Thread-1  ]: SQL status: SUCCESS 10 in 1.0 seconds
[0m14:53:24.345362 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m14:53:24.346031 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m14:53:24.579649 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:24.590910 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m14:53:24.591685 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m14:53:24.693908 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:24.721739 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 14:53:22.768543 => 14:53:24.721430
[0m14:53:24.722281 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m14:53:24.846467 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95094fb3-99e0-4fb8-b9ba-7e6eb3ee47d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf037b580>]}
[0m14:53:24.847650 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 10[0m in 2.09s]
[0m14:53:24.849647 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m14:53:24.852971 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:24.853567 [debug] [MainThread]: Connection 'list_external_db' was properly closed.
[0m14:53:24.853936 [debug] [MainThread]: Connection 'model.development.bronze_customers' was properly closed.
[0m14:53:24.854352 [info ] [MainThread]: 
[0m14:53:24.855117 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m14:53:24.856262 [debug] [MainThread]: Command end result
[0m14:53:24.866398 [info ] [MainThread]: 
[0m14:53:24.867297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:24.867987 [info ] [MainThread]: 
[0m14:53:24.868797 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:53:24.870353 [debug] [MainThread]: Command `dbt run` succeeded at 14:53:24.870131 after 4.01 seconds
[0m14:53:24.870952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf81175b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf22f6760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bf0360b20>]}
[0m14:53:24.871469 [debug] [MainThread]: Flushing usage events
[0m14:53:31.834946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dab91e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4daa1e06a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4daa1e0160>]}


============================== 14:53:31.841097 | 49d6f500-7ce0-4110-a607-ab645d350076 ==============================
[0m14:53:31.841097 [info ] [MainThread]: Running with dbt=1.5.1
[0m14:53:31.842483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/airflow/dags/dbt/logs', 'profiles_dir': '/home/satyam/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:53:32.182623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49d6f500-7ce0-4110-a607-ab645d350076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da5ad0be0>]}
[0m14:53:32.205545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49d6f500-7ce0-4110-a607-ab645d350076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da5afb9a0>]}
[0m14:53:32.224971 [debug] [MainThread]: checksum: 106cecc696d8692618f466fb5b0c5ae9fd73433d21c5679fe6b84da7254d4067, vars: {0: None,
 6: None,
 23: None,
 'run_time_stamp': 'DateTime(2023',
 'tzinfo=Timezone(Etc/UTC))': None}, profile: , target: , version: 1.5.1
[0m14:53:32.253771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:53:32.254317 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:53:32.255233 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.staging
- models.development.intermediate
- models.development.bronze
[0m14:53:32.264925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49d6f500-7ce0-4110-a607-ab645d350076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da490f580>]}
[0m14:53:32.274049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49d6f500-7ce0-4110-a607-ab645d350076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da49f6400>]}
[0m14:53:32.274671 [info ] [MainThread]: Found 7 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m14:53:32.275352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49d6f500-7ce0-4110-a607-ab645d350076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da49f64f0>]}
[0m14:53:32.279180 [info ] [MainThread]: 
[0m14:53:32.280279 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:53:32.282069 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m14:53:32.302126 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m14:53:32.302619 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m14:53:32.303162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:33.112151 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:53:33.115120 [debug] [ThreadPool]: On list_external_db: Close
[0m14:53:33.227286 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m14:53:33.239109 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m14:53:33.239733 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m14:53:33.240196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:33.714937 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m14:53:33.718041 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m14:53:33.822349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49d6f500-7ce0-4110-a607-ab645d350076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da496ff10>]}
[0m14:53:33.823846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:33.824873 [info ] [MainThread]: 
[0m14:53:33.830316 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m14:53:33.831093 [info ] [Thread-1  ]: 1 of 1 START sql incremental model final_sales.product_sales ................... [RUN]
[0m14:53:33.832243 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.development.product_sales'
[0m14:53:33.832775 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m14:53:33.849104 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m14:53:33.850262 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 14:53:33.833136 => 14:53:33.849743
[0m14:53:33.850784 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m14:53:33.918802 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m14:53:33.919898 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace  temporary view external_db.final_sales.product_sales__dbt_tmp
  
   as (
    

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
        where to_date('2023-06-22', 'YYYY-MM-DD') = run_date
    
),

final as (

    select
        customer.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m14:53:33.920570 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m14:53:34.347518 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:34.359670 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m14:53:34.360175 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales__dbt_tmp
[0m14:53:34.447713 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m14:53:34.453887 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m14:53:34.454754 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales
[0m14:53:34.548100 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m14:53:34.560092 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m14:53:34.560740 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."PRODUCT_SALES"
[0m14:53:34.638652 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m14:53:34.688832 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m14:53:34.690687 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m14:53:34.691194 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
-- back compat for old kwarg name
  
  begin;
[0m14:53:34.797692 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:34.798394 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m14:53:34.799108 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
merge into external_db.final_sales.product_sales as DBT_INTERNAL_DEST
        using external_db.final_sales.product_sales__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","ORDER_AMOUNT" = DBT_INTERNAL_SOURCE."ORDER_AMOUNT"
    

    when not matched then insert
        ("CUSTOMER_ID", "ORDER_AMOUNT")
    values
        ("CUSTOMER_ID", "ORDER_AMOUNT")

;
[0m14:53:35.696504 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:53:35.697633 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m14:53:35.698272 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
COMMIT
[0m14:53:35.934019 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:35.945684 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m14:53:35.946266 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m14:53:36.043147 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:53:36.074544 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 14:53:33.851111 => 14:53:36.074224
[0m14:53:36.075149 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m14:53:36.190387 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d6f500-7ce0-4110-a607-ab645d350076', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4d9e3815b0>]}
[0m14:53:36.191584 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 1[0m in 2.36s]
[0m14:53:36.193381 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m14:53:36.195420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:36.195832 [debug] [MainThread]: Connection 'list_external_db_final_sales' was properly closed.
[0m14:53:36.196246 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m14:53:36.196833 [info ] [MainThread]: 
[0m14:53:36.198139 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m14:53:36.200018 [debug] [MainThread]: Command end result
[0m14:53:36.212539 [info ] [MainThread]: 
[0m14:53:36.213955 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:36.215057 [info ] [MainThread]: 
[0m14:53:36.216100 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:53:36.217797 [debug] [MainThread]: Command `dbt run` succeeded at 14:53:36.217601 after 4.40 seconds
[0m14:53:36.218422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dab91e5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da5afb9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da5ab1340>]}
[0m14:53:36.219118 [debug] [MainThread]: Flushing usage events
[0m15:28:09.648654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0e18550d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0e01639d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0e01631c0>]}


============================== 15:28:09.652093 | 7976d622-4988-4e91-93b8-64573c7ee724 ==============================
[0m15:28:09.652093 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:28:09.652728 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'airflow/dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': 'airflow/dags/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:28:09.940831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7976d622-4988-4e91-93b8-64573c7ee724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0da9a5550>]}
[0m15:28:09.958738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7976d622-4988-4e91-93b8-64573c7ee724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0da986ca0>]}
[0m15:28:09.973811 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m15:28:09.987500 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m15:28:09.988132 [debug] [MainThread]: previous checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, current checksum: 106cecc696d8692618f466fb5b0c5ae9fd73433d21c5679fe6b84da7254d4067
[0m15:28:09.988440 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:28:09.988811 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:28:09.989207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7976d622-4988-4e91-93b8-64573c7ee724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0dba47400>]}
[0m15:28:10.704164 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_order_detail.sql
[0m15:28:10.726450 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_order_detail.sql
[0m15:28:10.729079 [debug] [MainThread]: 1603: static parser failed on sales/intermediate/fct_payment_details.sql
[0m15:28:10.734896 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/intermediate/fct_payment_details.sql
[0m15:28:10.737645 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m15:28:10.743060 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m15:28:10.745455 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m15:28:10.751390 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m15:28:10.753721 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m15:28:10.759040 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m15:28:10.761387 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m15:28:10.766548 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m15:28:10.768722 [debug] [MainThread]: 1699: static parser successfully parsed sales/test/first_model.sql
[0m15:28:10.772914 [debug] [MainThread]: 1603: static parser failed on sales/core/product_sales.sql
[0m15:28:10.780220 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/core/product_sales.sql
[0m15:28:10.930748 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.development.bronze
- models.development.intermediate
- models.development.staging
[0m15:28:10.937283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7976d622-4988-4e91-93b8-64573c7ee724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0da3c1f40>]}
[0m15:28:10.939489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7976d622-4988-4e91-93b8-64573c7ee724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0da3c11c0>]}
[0m15:28:10.940044 [info ] [MainThread]: Found 8 models, 0 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m15:28:10.940480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7976d622-4988-4e91-93b8-64573c7ee724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0da3c1520>]}
[0m15:28:10.942298 [info ] [MainThread]: 
[0m15:28:10.943130 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:28:10.944679 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m15:28:10.960067 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m15:28:10.960616 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m15:28:10.961043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:12.214778 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m15:28:12.220340 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m15:28:12.350831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7976d622-4988-4e91-93b8-64573c7ee724', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0da3c11f0>]}
[0m15:28:12.352159 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:28:12.352866 [info ] [MainThread]: 
[0m15:28:12.357907 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m15:28:12.358944 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m15:28:12.359417 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m15:28:12.364367 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m15:28:12.365178 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 15:28:12.359698 => 15:28:12.364870
[0m15:28:12.365594 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m15:28:12.366125 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 15:28:12.365859 => 15:28:12.365894
[0m15:28:12.367099 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m15:28:12.367573 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m15:28:12.368447 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m15:28:12.368998 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m15:28:12.372978 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m15:28:12.373687 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 15:28:12.369281 => 15:28:12.373436
[0m15:28:12.374103 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m15:28:12.374580 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 15:28:12.374357 => 15:28:12.374367
[0m15:28:12.375491 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m15:28:12.375988 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m15:28:12.376791 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m15:28:12.377201 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m15:28:12.381017 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m15:28:12.381717 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 15:28:12.377453 => 15:28:12.381442
[0m15:28:12.382107 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m15:28:12.382567 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 15:28:12.382347 => 15:28:12.382356
[0m15:28:12.383462 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m15:28:12.384118 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m15:28:12.384735 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m15:28:12.385138 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m15:28:12.390426 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m15:28:12.391571 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 15:28:12.385379 => 15:28:12.391266
[0m15:28:12.392012 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m15:28:12.392512 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 15:28:12.392281 => 15:28:12.392291
[0m15:28:12.393463 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m15:28:12.393941 [debug] [Thread-1  ]: Began running node model.development.first_model
[0m15:28:12.394766 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.first_model)
[0m15:28:12.395181 [debug] [Thread-1  ]: Began compiling node model.development.first_model
[0m15:28:12.397214 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.first_model"
[0m15:28:12.397931 [debug] [Thread-1  ]: Timing info for model.development.first_model (compile): 15:28:12.395437 => 15:28:12.397681
[0m15:28:12.398312 [debug] [Thread-1  ]: Began executing node model.development.first_model
[0m15:28:12.398826 [debug] [Thread-1  ]: Timing info for model.development.first_model (execute): 15:28:12.398559 => 15:28:12.398567
[0m15:28:12.399739 [debug] [Thread-1  ]: Finished running node model.development.first_model
[0m15:28:12.400234 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m15:28:12.400932 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.first_model, now model.development.fct_payment_details)
[0m15:28:12.401342 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m15:28:12.408190 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m15:28:12.408925 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 15:28:12.401591 => 15:28:12.408663
[0m15:28:12.409364 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m15:28:12.409854 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 15:28:12.409624 => 15:28:12.409634
[0m15:28:12.410771 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m15:28:12.411254 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m15:28:12.411987 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m15:28:12.412404 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m15:28:12.417844 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m15:28:12.418573 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 15:28:12.412657 => 15:28:12.418315
[0m15:28:12.419003 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m15:28:12.419523 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 15:28:12.419257 => 15:28:12.419269
[0m15:28:12.420483 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m15:28:12.421436 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m15:28:12.422088 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m15:28:12.422497 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m15:28:12.429045 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m15:28:12.429792 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 15:28:12.422758 => 15:28:12.429516
[0m15:28:12.430196 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m15:28:12.430680 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 15:28:12.430451 => 15:28:12.430461
[0m15:28:12.431594 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m15:28:12.432702 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:12.433038 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m15:28:12.434752 [debug] [MainThread]: Command end result
[0m15:28:12.472751 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m15:28:12.473284 [info ] [MainThread]: Building catalog
[0m15:28:12.476064 [debug] [ThreadPool]: Acquiring new snowflake connection 'external_db.information_schema'
[0m15:28:12.486194 [debug] [ThreadPool]: Using snowflake connection "external_db.information_schema"
[0m15:28:12.486797 [debug] [ThreadPool]: On external_db.information_schema: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "external_db.information_schema"} */
with tables as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",
              table_type as "table_type",
              comment as "table_comment",

              -- note: this is the _role_ that owns the table
              table_owner as "table_owner",

              'Clustering Key' as "stats:clustering_key:label",
              clustering_key as "stats:clustering_key:value",
              'The key used to cluster this table' as "stats:clustering_key:description",
              (clustering_key is not null) as "stats:clustering_key:include",

              'Row Count' as "stats:row_count:label",
              row_count as "stats:row_count:value",
              'An approximate count of rows in this table' as "stats:row_count:description",
              (row_count is not null) as "stats:row_count:include",

              'Approximate Size' as "stats:bytes:label",
              bytes as "stats:bytes:value",
              'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
              (bytes is not null) as "stats:bytes:include",

              'Last Modified' as "stats:last_modified:label",
              to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
              'The timestamp for last update/change' as "stats:last_modified:description",
              (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"

          from external_db.INFORMATION_SCHEMA.tables

      ),

      columns as (

          select
              table_catalog as "table_database",
              table_schema as "table_schema",
              table_name as "table_name",

              column_name as "column_name",
              ordinal_position as "column_index",
              data_type as "column_type",
              comment as "column_comment"

          from external_db.INFORMATION_SCHEMA.columns
      )

      select *
      from tables
      join columns using ("table_database", "table_schema", "table_name")
      where (upper("table_schema") = upper('stage') or upper("table_schema") = upper('final_sales'))
      order by "column_index"
[0m15:28:12.487337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:15.203867 [debug] [ThreadPool]: SQL status: SUCCESS 42 in 3.0 seconds
[0m15:28:15.229698 [debug] [ThreadPool]: On external_db.information_schema: Close
[0m15:28:15.349358 [info ] [MainThread]: Catalog written to /home/satyam/dbt_project/dbt_core/target/catalog.json
[0m15:28:15.350690 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:28:15.350502 after 5.72 seconds
[0m15:28:15.351141 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:28:15.351472 [debug] [MainThread]: Connection 'external_db.information_schema' was properly closed.
[0m15:28:15.352040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0e18550d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0da986ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0da42abb0>]}
[0m15:28:15.352517 [debug] [MainThread]: Flushing usage events
[0m15:28:33.268326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a9eac040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a87c28e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a87c2100>]}


============================== 15:28:33.271584 | 70590d86-64f4-4f2a-ae3b-bf8163c6316f ==============================
[0m15:28:33.271584 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:28:33.272232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'airflow/dags/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'airflow/dags/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:28:33.545615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70590d86-64f4-4f2a-ae3b-bf8163c6316f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a402bd60>]}
[0m15:28:33.563179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70590d86-64f4-4f2a-ae3b-bf8163c6316f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a401d700>]}
[0m15:28:33.818147 [error] [MainThread]: Encountered an error:
[Errno 98] Address already in use
[0m15:28:33.825539 [error] [MainThread]: Traceback (most recent call last):
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 86, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 71, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 142, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 168, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/requires.py", line 215, in wrapper
    return func(*args, **kwargs)
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/cli/main.py", line 299, in docs_serve
    results = task.run()
  File "/home/satyam/.local/lib/python3.8/site-packages/dbt/task/serve.py", line 23, in run
    with socketserver.TCPServer(("", port), SimpleHTTPRequestHandler) as httpd:
  File "/usr/lib/python3.8/socketserver.py", line 452, in __init__
    self.server_bind()
  File "/usr/lib/python3.8/socketserver.py", line 466, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 98] Address already in use

[0m15:28:33.827037 [debug] [MainThread]: Command `dbt docs serve` failed at 15:28:33.826815 after 0.58 seconds
[0m15:28:33.827627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a9eac040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a4030130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82a4030250>]}
[0m15:28:33.828314 [debug] [MainThread]: Flushing usage events
[0m15:29:31.500938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f2b198100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f29aa4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f29aa4520>]}


============================== 15:29:31.504115 | b9156b24-d6c0-47ab-8eb9-36b79ad6e688 ==============================
[0m15:29:31.504115 [info ] [MainThread]: Running with dbt=1.5.1
[0m15:29:31.504979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': 'airflow/dags/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:29:31.786847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9156b24-d6c0-47ab-8eb9-36b79ad6e688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f25305070>]}
[0m15:29:31.804602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9156b24-d6c0-47ab-8eb9-36b79ad6e688', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f253006a0>]}
[0m06:57:11.305568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd69ee030a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd69d70f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd69d70f730>]}


============================== 06:57:11.309119 | e4bf6520-7bbe-46b1-8d99-9ea53e0b26c8 ==============================
[0m06:57:11.309119 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:57:11.309737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'airflow/dags/dbt/', 'log_path': 'airflow/dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:57:11.626895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4bf6520-7bbe-46b1-8d99-9ea53e0b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd697fc2eb0>]}
[0m06:57:11.646831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4bf6520-7bbe-46b1-8d99-9ea53e0b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd697fc6820>]}
[0m06:57:11.664236 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:57:11.673783 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m06:57:11.674753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e4bf6520-7bbe-46b1-8d99-9ea53e0b26c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd697f96040>]}
[0m06:57:11.680171 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading development: schema.yml - Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |         description: primary key for the customer dimension
    10 |         tests:
    11 |           - unique
    12 |             config:
    13 |                 severity: warn
    14 |                 warn_if: ">10"
    15 |           - not_null
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 12, column 19
[0m06:57:11.681051 [debug] [MainThread]: Command `dbt build` failed at 06:57:11.680895 after 0.39 seconds
[0m06:57:11.681474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd69ee030a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd697e3ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd697e3f610>]}
[0m06:57:11.681900 [debug] [MainThread]: Flushing usage events
[0m07:01:33.125157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b528e2160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b511f0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b511f0160>]}


============================== 07:01:33.137231 | 5dc5eb14-a950-416d-91cf-6e4c055cd9bd ==============================
[0m07:01:33.137231 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:01:33.138065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'airflow/dags/dbt/', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:01:33.527434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dc5eb14-a950-416d-91cf-6e4c055cd9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b4cae4a60>]}
[0m07:01:33.545339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dc5eb14-a950-416d-91cf-6e4c055cd9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b4cacbc70>]}
[0m07:01:33.560682 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:01:33.570004 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:01:33.571256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5dc5eb14-a950-416d-91cf-6e4c055cd9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b4ca99070>]}
[0m07:01:33.576116 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading development: schema.yml - Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |         description: primary key for the customer dimension
    10 |         tests:
    11 |           - unique
    12 |             config:
    13 |               severity: warn
    14 |               warn_if: ">10"
    15 |           - not_null
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 12, column 19
[0m07:01:33.578587 [debug] [MainThread]: Command `dbt build` failed at 07:01:33.578417 after 0.49 seconds
[0m07:01:33.579148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b528e2160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b4b9bef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b4b9be640>]}
[0m07:01:33.579782 [debug] [MainThread]: Flushing usage events
[0m07:04:16.072487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729a5f0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7298efe940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7298efe8b0>]}


============================== 07:04:16.075965 | eb87c8aa-30a0-4b35-a1f8-78da6c77630e ==============================
[0m07:04:16.075965 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:04:16.076606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'airflow/dags/dbt/', 'debug': 'False', 'warn_error': 'None', 'log_path': 'airflow/dags/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:04:16.360510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb87c8aa-30a0-4b35-a1f8-78da6c77630e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72937c7d60>]}
[0m07:04:16.378375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb87c8aa-30a0-4b35-a1f8-78da6c77630e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72937d0b20>]}
[0m07:04:16.393972 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:04:16.403091 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:04:16.403783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb87c8aa-30a0-4b35-a1f8-78da6c77630e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7293796f40>]}
[0m07:04:16.408385 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading development: schema.yml - Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |         description: primary key for the customer dimension
    10 |         tests:
    11 |           - unique
    12 |               config:
    13 |                 severity: warn
    14 |                 warn_if: ">10"
    15 |           - not_null
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 12, column 21
[0m07:04:16.409262 [debug] [MainThread]: Command `dbt build` failed at 07:04:16.409105 after 0.35 seconds
[0m07:04:16.409705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729a5f0160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729363ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f729363f640>]}
[0m07:04:16.410146 [debug] [MainThread]: Flushing usage events
[0m07:05:08.718847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33e021d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33deb2a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33deb2a550>]}


============================== 07:05:08.722608 | f508d839-457d-45b5-b580-a13afbf06979 ==============================
[0m07:05:08.722608 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:05:08.723419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'airflow/dags/dbt/logs', 'debug': 'False', 'profiles_dir': 'airflow/dags/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:05:09.006397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f508d839-457d-45b5-b580-a13afbf06979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33d93dafa0>]}
[0m07:05:09.024246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f508d839-457d-45b5-b580-a13afbf06979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33d93c6b20>]}
[0m07:05:09.039091 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:05:09.047689 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:05:09.048268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f508d839-457d-45b5-b580-a13afbf06979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33d9396f40>]}
[0m07:05:09.052544 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading development: schema.yml - Runtime Error
    Syntax error near line 12
    ------------------------------
    9  |         description: primary key for the customer dimension
    10 |         tests:
    11 |           - unique
    12 |               config:
    13 |                 severity: warn
    14 |                 warn_if: ">10"
    15 |           - not_null
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 12, column 21
[0m07:05:09.053337 [debug] [MainThread]: Command `dbt build` failed at 07:05:09.053196 after 0.35 seconds
[0m07:05:09.053740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33e021d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33d923ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33d923f640>]}
[0m07:05:09.054148 [debug] [MainThread]: Flushing usage events
[0m07:05:56.431477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bd1e3100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bbaf1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bbaf14f0>]}


============================== 07:05:56.435314 | 94b085c5-8018-4a9a-8c7d-9a15c127def4 ==============================
[0m07:05:56.435314 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:05:56.436536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'airflow/dags/dbt/', 'debug': 'False', 'version_check': 'True', 'log_path': 'airflow/dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:05:56.730094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94b085c5-8018-4a9a-8c7d-9a15c127def4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b63c7d00>]}
[0m07:05:56.748022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94b085c5-8018-4a9a-8c7d-9a15c127def4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b63d0b50>]}
[0m07:05:56.763429 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:05:56.772304 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:05:56.773063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '94b085c5-8018-4a9a-8c7d-9a15c127def4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b63e7ac0>]}
[0m07:05:56.777651 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading development: schema.yml - Runtime Error
    Syntax error near line 13
    ------------------------------
    10 |         tests:
    11 |           - unique
    12 |               config
    13 |                 severity: warn
    14 |                 warn_if: ">10"
    15 |           - not_null
    16 |         
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 13, column 25
[0m07:05:56.778577 [debug] [MainThread]: Command `dbt build` failed at 07:05:56.778425 after 0.36 seconds
[0m07:05:56.779097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22bd1e3100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b623ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b623f610>]}
[0m07:05:56.779600 [debug] [MainThread]: Flushing usage events
[0m07:08:12.054451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4826f7d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482588e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482588e100>]}


============================== 07:08:12.057947 | 86b4a144-c909-4238-9ad6-fb0b2f0320c6 ==============================
[0m07:08:12.057947 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:08:12.058593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'airflow/dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': 'airflow/dags/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:08:12.348307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86b4a144-c909-4238-9ad6-fb0b2f0320c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4821183f70>]}
[0m07:08:12.365989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86b4a144-c909-4238-9ad6-fb0b2f0320c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482116eb80>]}
[0m07:08:12.381260 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:08:12.390180 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:08:12.390871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '86b4a144-c909-4238-9ad6-fb0b2f0320c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482118cac0>]}
[0m07:08:13.119751 [debug] [MainThread]: 1603: static parser failed on sales/silver/fct_order_detail.sql
[0m07:08:13.141426 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/silver/fct_order_detail.sql
[0m07:08:13.144043 [debug] [MainThread]: 1603: static parser failed on sales/silver/fct_payment_details.sql
[0m07:08:13.149886 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/silver/fct_payment_details.sql
[0m07:08:13.152731 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m07:08:13.158945 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m07:08:13.161348 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m07:08:13.166706 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m07:08:13.169118 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m07:08:13.174567 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m07:08:13.177091 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m07:08:13.182407 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m07:08:13.184604 [debug] [MainThread]: 1699: static parser successfully parsed sales/test/first_model.sql
[0m07:08:13.188759 [debug] [MainThread]: 1603: static parser failed on sales/gold/product_sales.sql
[0m07:08:13.196404 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/gold/product_sales.sql
[0m07:08:13.392006 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['debit', 'credit', 'upi', 'cash'])] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...[])
[0m07:08:13.392983 [debug] [MainThread]: Command `dbt build` failed at 07:08:13.392806 after 1.36 seconds
[0m07:08:13.393432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4826f7d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f481fb48af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48211c30a0>]}
[0m07:08:13.393901 [debug] [MainThread]: Flushing usage events
[0m07:09:06.684125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c34890100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c3319d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c3319d100>]}


============================== 07:09:06.687878 | f63ac80c-3543-42f5-93ff-6f586de4aad5 ==============================
[0m07:09:06.687878 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:09:06.688542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': 'airflow/dags/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:09:06.987971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f63ac80c-3543-42f5-93ff-6f586de4aad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2ea78f70>]}
[0m07:09:07.006407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f63ac80c-3543-42f5-93ff-6f586de4aad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2ea80910>]}
[0m07:09:07.022513 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:09:07.031658 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:09:07.032341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f63ac80c-3543-42f5-93ff-6f586de4aad5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2ea9bac0>]}
[0m07:09:07.763391 [debug] [MainThread]: 1603: static parser failed on sales/silver/fct_order_detail.sql
[0m07:09:07.786809 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/silver/fct_order_detail.sql
[0m07:09:07.789688 [debug] [MainThread]: 1603: static parser failed on sales/silver/fct_payment_details.sql
[0m07:09:07.796021 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/silver/fct_payment_details.sql
[0m07:09:07.799154 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m07:09:07.806251 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m07:09:07.808871 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m07:09:07.814738 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m07:09:07.817257 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m07:09:07.823123 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m07:09:07.825798 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m07:09:07.831895 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m07:09:07.834559 [debug] [MainThread]: 1699: static parser successfully parsed sales/test/first_model.sql
[0m07:09:07.839342 [debug] [MainThread]: 1603: static parser failed on sales/gold/product_sales.sql
[0m07:09:07.850297 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/gold/product_sales.sql
[0m07:09:08.071707 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['debit', 'credit', 'upi', 'cash'])] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...[])
[0m07:09:08.072882 [debug] [MainThread]: Command `dbt build` failed at 07:09:08.072684 after 1.41 seconds
[0m07:09:08.073459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c34890100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2d448f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c2ead1910>]}
[0m07:09:08.074035 [debug] [MainThread]: Flushing usage events
[0m07:10:16.539664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8e8e80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8d1fd8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8d1fd490>]}


============================== 07:10:16.543433 | 5bd15687-0033-4a31-8b9a-a5901b97a4f0 ==============================
[0m07:10:16.543433 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:10:16.544076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'airflow/dags/dbt/', 'log_path': 'airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:10:16.851662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bd15687-0033-4a31-8b9a-a5901b97a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c88ad2ee0>]}
[0m07:10:16.870167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bd15687-0033-4a31-8b9a-a5901b97a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c88adeb80>]}
[0m07:10:16.886782 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:10:16.896383 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m07:10:16.897088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5bd15687-0033-4a31-8b9a-a5901b97a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c88aa7e80>]}
[0m07:10:17.628689 [debug] [MainThread]: 1603: static parser failed on sales/silver/fct_order_detail.sql
[0m07:10:17.652747 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/silver/fct_order_detail.sql
[0m07:10:17.655689 [debug] [MainThread]: 1603: static parser failed on sales/silver/fct_payment_details.sql
[0m07:10:17.662811 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/silver/fct_payment_details.sql
[0m07:10:17.666273 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m07:10:17.674047 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m07:10:17.676921 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m07:10:17.683393 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m07:10:17.686104 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m07:10:17.692689 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m07:10:17.695811 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m07:10:17.702341 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m07:10:17.704936 [debug] [MainThread]: 1699: static parser successfully parsed sales/test/first_model.sql
[0m07:10:17.709727 [debug] [MainThread]: 1603: static parser failed on sales/gold/product_sales.sql
[0m07:10:17.718647 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/gold/product_sales.sql
[0m07:10:18.072853 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.development.bronze
- models.development.gold
- models.development.silver
- models.development.staging
[0m07:10:18.080923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bd15687-0033-4a31-8b9a-a5901b97a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c88a70880>]}
[0m07:10:18.096352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bd15687-0033-4a31-8b9a-a5901b97a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c879be280>]}
[0m07:10:18.097214 [info ] [MainThread]: Found 8 models, 32 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m07:10:18.101024 [info ] [MainThread]: 
[0m07:10:18.102196 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:10:18.104262 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m07:10:18.121696 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m07:10:18.122466 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m07:10:18.122992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:10:18.978260 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m07:10:18.981762 [debug] [ThreadPool]: On list_external_db: Close
[0m07:10:19.080560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m07:10:19.091680 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m07:10:19.092317 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m07:10:19.092708 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:10:19.563312 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m07:10:19.566711 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m07:10:19.674482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bd15687-0033-4a31-8b9a-a5901b97a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c879a7340>]}
[0m07:10:19.676015 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:10:19.676689 [info ] [MainThread]: 
[0m07:10:19.681512 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m07:10:19.682372 [info ] [Thread-1  ]: 1 of 40 START sql incremental model final_sales.bronze_customers ............... [RUN]
[0m07:10:19.683406 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m07:10:19.683900 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m07:10:19.689046 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m07:10:19.690065 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 07:10:19.684192 => 07:10:19.689693
[0m07:10:19.690527 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m07:10:19.750967 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:10:19.751644 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_timestamp('2023-06-22') as run_ts  from external_db.stage.customers
)

select * from customers
  );
[0m07:10:19.752084 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:10:20.123883 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:10:20.135717 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:10:20.136425 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m07:10:20.206620 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:10:20.212179 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:10:20.212872 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m07:10:20.286169 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:10:20.298277 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:10:20.298975 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m07:10:20.367939 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:10:20.435968 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m07:10:20.438529 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:10:20.439259 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m07:10:20.518134 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:10:20.519085 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:10:20.519920 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m07:10:20.605483 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad4eee-0000-fb87-0001-937e000190aa
[0m07:10:20.606248 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 51
invalid identifier 'RUN_DATE'
[0m07:10:20.607090 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 07:10:19.690834 => 07:10:20.606767
[0m07:10:20.607586 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m07:10:20.765080 [debug] [Thread-1  ]: Database Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)
  000904 (42000): SQL compilation error: error line 15 at position 51
  invalid identifier 'RUN_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_customers.sql
[0m07:10:20.766103 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bd15687-0033-4a31-8b9a-a5901b97a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c84e96790>]}
[0m07:10:20.767128 [error] [Thread-1  ]: 1 of 40 ERROR creating sql incremental model final_sales.bronze_customers ...... [[31mERROR[0m in 1.08s]
[0m07:10:20.767913 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m07:10:20.769185 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m07:10:20.770379 [info ] [Thread-1  ]: 2 of 40 START sql incremental model final_sales.bronze_orders .................. [RUN]
[0m07:10:20.772456 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m07:10:20.773019 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m07:10:20.778763 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m07:10:20.780069 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 07:10:20.773328 => 07:10:20.779620
[0m07:10:20.780565 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m07:10:20.785853 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:10:20.786393 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.orders
)

select * from orders
  );
[0m07:10:20.786836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:10:21.185740 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:10:21.190157 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:10:21.190876 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m07:10:21.271869 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:10:21.276980 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:10:21.277620 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m07:10:21.342573 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:10:21.348004 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:10:21.348643 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m07:10:21.414850 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:10:21.421471 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m07:10:21.423734 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:10:21.424383 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m07:10:21.513307 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:10:21.514004 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:10:21.514476 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")

;
[0m07:10:21.614347 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad4eee-0000-fb4f-0001-937e00018eb2
[0m07:10:21.615200 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 64
invalid identifier 'RUN_DATE'
[0m07:10:21.616026 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 07:10:20.780840 => 07:10:21.615738
[0m07:10:21.616844 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m07:10:21.762378 [debug] [Thread-1  ]: Database Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)
  000904 (42000): SQL compilation error: error line 15 at position 64
  invalid identifier 'RUN_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m07:10:21.763450 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bd15687-0033-4a31-8b9a-a5901b97a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c84e84520>]}
[0m07:10:21.764381 [error] [Thread-1  ]: 2 of 40 ERROR creating sql incremental model final_sales.bronze_orders ......... [[31mERROR[0m in 0.99s]
[0m07:10:21.765050 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m07:10:21.765598 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m07:10:21.766519 [info ] [Thread-1  ]: 3 of 40 START sql incremental model final_sales.bronze_payments ................ [RUN]
[0m07:10:21.767998 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m07:10:21.768558 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m07:10:21.775558 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m07:10:21.776602 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 07:10:21.768953 => 07:10:21.776241
[0m07:10:21.777077 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m07:10:21.781811 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:10:21.782340 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.payments
)

select * from payments
  );
[0m07:10:21.782769 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:10:22.162153 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:10:22.166827 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:10:22.167682 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m07:10:22.290004 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:10:22.295410 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:10:22.296141 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m07:10:22.361261 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:10:22.366359 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:10:22.367002 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m07:10:22.429724 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:10:22.434026 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m07:10:22.435897 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:10:22.436438 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m07:10:22.519499 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:10:22.520290 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:10:22.520827 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m07:10:22.616350 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad4eee-0000-fb87-0001-937e000190c2
[0m07:10:22.617058 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 63
invalid identifier 'RUN_DATE'
[0m07:10:22.617828 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 07:10:21.777341 => 07:10:22.617519
[0m07:10:22.618338 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m07:10:22.784060 [debug] [Thread-1  ]: Database Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)
  000904 (42000): SQL compilation error: error line 15 at position 63
  invalid identifier 'RUN_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m07:10:22.784944 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bd15687-0033-4a31-8b9a-a5901b97a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c84e84520>]}
[0m07:10:22.785808 [error] [Thread-1  ]: 3 of 40 ERROR creating sql incremental model final_sales.bronze_payments ....... [[31mERROR[0m in 1.02s]
[0m07:10:22.786860 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m07:10:22.787441 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m07:10:22.788358 [info ] [Thread-1  ]: 4 of 40 START sql incremental model final_sales.bronze_products ................ [RUN]
[0m07:10:22.789993 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m07:10:22.790570 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m07:10:22.795354 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m07:10:22.796206 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 07:10:22.790878 => 07:10:22.795913
[0m07:10:22.796662 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m07:10:22.801338 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:10:22.801820 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.products
)

select * from products
  );
[0m07:10:22.802220 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:10:23.176592 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:10:23.180984 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:10:23.181641 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m07:10:23.266543 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:10:23.273268 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:10:23.273901 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m07:10:23.339957 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m07:10:23.345417 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:10:23.346077 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m07:10:23.406369 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m07:10:23.410691 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m07:10:23.412354 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:10:23.412847 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m07:10:23.499764 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:10:23.500501 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:10:23.501109 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m07:10:23.575376 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad4eee-0000-fb87-0001-937e000190ce
[0m07:10:23.576088 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 32
invalid identifier 'RUN_DATE'
[0m07:10:23.576860 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 07:10:22.796922 => 07:10:23.576546
[0m07:10:23.577364 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m07:10:23.721789 [debug] [Thread-1  ]: Database Error in model bronze_products (models/sales/bronze/bronze_products.sql)
  000904 (42000): SQL compilation error: error line 15 at position 32
  invalid identifier 'RUN_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m07:10:23.723532 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bd15687-0033-4a31-8b9a-a5901b97a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c84e9b220>]}
[0m07:10:23.724536 [error] [Thread-1  ]: 4 of 40 ERROR creating sql incremental model final_sales.bronze_products ....... [[31mERROR[0m in 0.93s]
[0m07:10:23.725346 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m07:10:23.725983 [debug] [Thread-1  ]: Began running node model.development.first_model
[0m07:10:23.727175 [info ] [Thread-1  ]: 5 of 40 START sql view model final_sales.first_model ........................... [RUN]
[0m07:10:23.728364 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.first_model)
[0m07:10:23.728838 [debug] [Thread-1  ]: Began compiling node model.development.first_model
[0m07:10:23.731679 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.first_model"
[0m07:10:23.734752 [debug] [Thread-1  ]: Timing info for model.development.first_model (compile): 07:10:23.729122 => 07:10:23.734361
[0m07:10:23.735247 [debug] [Thread-1  ]: Began executing node model.development.first_model
[0m07:10:23.767356 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.first_model"
[0m07:10:23.770023 [debug] [Thread-1  ]: Using snowflake connection "model.development.first_model"
[0m07:10:23.770603 [debug] [Thread-1  ]: On model.development.first_model: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.first_model"} */
create or replace   view external_db.final_sales.first_model
  
   as (
    SELECT * from insight_dev.ins_bkp.ext_stg_pos_trmnl
  );
[0m07:10:23.771853 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:10:24.052955 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad4eee-0000-fb4f-0001-937e00018ed2
[0m07:10:24.053985 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'INSIGHT_DEV' does not exist or not authorized.
[0m07:10:24.055005 [debug] [Thread-1  ]: Timing info for model.development.first_model (execute): 07:10:23.737270 => 07:10:24.054646
[0m07:10:24.055576 [debug] [Thread-1  ]: On model.development.first_model: Close
[0m07:10:24.153633 [debug] [Thread-1  ]: Database Error in model first_model (models/sales/test/first_model.sql)
  002003 (02000): SQL compilation error:
  Database 'INSIGHT_DEV' does not exist or not authorized.
  compiled Code at target/run/development/models/sales/test/first_model.sql
[0m07:10:24.154516 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bd15687-0033-4a31-8b9a-a5901b97a4f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c866d44f0>]}
[0m07:10:24.155389 [error] [Thread-1  ]: 5 of 40 ERROR creating sql view model final_sales.first_model .................. [[31mERROR[0m in 0.43s]
[0m07:10:24.156057 [debug] [Thread-1  ]: Finished running node model.development.first_model
[0m07:10:24.156632 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:10:24.157346 [info ] [Thread-1  ]: 6 of 40 SKIP test not_null_bronze_customers_customer_id ........................ [[33mSKIP[0m]
[0m07:10:24.158047 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:10:24.158567 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:10:24.159308 [info ] [Thread-1  ]: 7 of 40 SKIP test not_null_bronze_customers_first_name ......................... [[33mSKIP[0m]
[0m07:10:24.159892 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:10:24.160389 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:10:24.160946 [info ] [Thread-1  ]: 8 of 40 SKIP test unique_bronze_customers_customer_id .......................... [[33mSKIP[0m]
[0m07:10:24.161500 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:10:24.161974 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:10:24.162521 [info ] [Thread-1  ]: 9 of 40 SKIP test not_null_bronze_orders_customer_id ........................... [[33mSKIP[0m]
[0m07:10:24.163103 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:10:24.163592 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:10:24.164147 [info ] [Thread-1  ]: 10 of 40 SKIP test not_null_bronze_orders_order_date ........................... [[33mSKIP[0m]
[0m07:10:24.164709 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:10:24.165189 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:10:24.165733 [info ] [Thread-1  ]: 11 of 40 SKIP test not_null_bronze_orders_order_id ............................. [[33mSKIP[0m]
[0m07:10:24.166287 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:10:24.166784 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:10:24.167325 [info ] [Thread-1  ]: 12 of 40 SKIP test not_null_bronze_orders_product_id ........................... [[33mSKIP[0m]
[0m07:10:24.167878 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:10:24.168352 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:10:24.168891 [info ] [Thread-1  ]: 13 of 40 SKIP test unique_bronze_orders_order_id ............................... [[33mSKIP[0m]
[0m07:10:24.169442 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:10:24.169975 [debug] [Thread-1  ]: Began running node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:10:24.170538 [info ] [Thread-1  ]: 14 of 40 SKIP test accepted_values_bronze_payments_payment_method__debit__credit__upi__cash  [[33mSKIP[0m]
[0m07:10:24.171116 [debug] [Thread-1  ]: Finished running node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:10:24.171600 [debug] [Thread-1  ]: Began running node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:10:24.172150 [info ] [Thread-1  ]: 15 of 40 SKIP test accepted_values_bronze_payments_status__fail__success ....... [[33mSKIP[0m]
[0m07:10:24.172694 [debug] [Thread-1  ]: Finished running node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:10:24.173169 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:10:24.173711 [info ] [Thread-1  ]: 16 of 40 SKIP test not_null_bronze_payments_order_id ........................... [[33mSKIP[0m]
[0m07:10:24.174251 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:10:24.174744 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:10:24.175288 [info ] [Thread-1  ]: 17 of 40 SKIP test not_null_bronze_payments_payment_id ......................... [[33mSKIP[0m]
[0m07:10:24.175828 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:10:24.176297 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:10:24.176834 [info ] [Thread-1  ]: 18 of 40 SKIP test not_null_bronze_payments_payment_method ..................... [[33mSKIP[0m]
[0m07:10:24.177377 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:10:24.177849 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:10:24.178383 [info ] [Thread-1  ]: 19 of 40 SKIP test not_null_bronze_payments_status ............................. [[33mSKIP[0m]
[0m07:10:24.178956 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:10:24.179430 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:10:24.179971 [info ] [Thread-1  ]: 20 of 40 SKIP test unique_bronze_payments_payment_id ........................... [[33mSKIP[0m]
[0m07:10:24.180507 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:10:24.180976 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_products_price.e208481306
[0m07:10:24.181536 [info ] [Thread-1  ]: 21 of 40 SKIP test not_null_bronze_products_price .............................. [[33mSKIP[0m]
[0m07:10:24.182431 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_products_price.e208481306
[0m07:10:24.182952 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:10:24.183500 [info ] [Thread-1  ]: 22 of 40 SKIP test not_null_bronze_products_product_id ......................... [[33mSKIP[0m]
[0m07:10:24.184039 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:10:24.184537 [debug] [Thread-1  ]: Began running node test.development.products_price_lower_than_threshold
[0m07:10:24.184979 [info ] [Thread-1  ]: 23 of 40 SKIP test products_price_lower_than_threshold ......................... [[33mSKIP[0m]
[0m07:10:24.185519 [debug] [Thread-1  ]: Finished running node test.development.products_price_lower_than_threshold
[0m07:10:24.185973 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:10:24.186408 [info ] [Thread-1  ]: 24 of 40 SKIP test unique_bronze_products_product_id ........................... [[33mSKIP[0m]
[0m07:10:24.187346 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:10:24.187837 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m07:10:24.188417 [info ] [Thread-1  ]: 25 of 40 SKIP relation final_sales.fct_payment_details ......................... [[33mSKIP[0m]
[0m07:10:24.189109 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m07:10:24.189597 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m07:10:24.190146 [info ] [Thread-1  ]: 26 of 40 SKIP relation final_sales.fct_order_detail ............................ [[33mSKIP[0m]
[0m07:10:24.190907 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m07:10:24.191389 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:10:24.191959 [info ] [Thread-1  ]: 27 of 40 SKIP test not_null_fct_payment_details_order_id ....................... [[33mSKIP[0m]
[0m07:10:24.192726 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:10:24.193240 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:10:24.193773 [info ] [Thread-1  ]: 28 of 40 SKIP test not_null_fct_payment_details_payment_id ..................... [[33mSKIP[0m]
[0m07:10:24.194309 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:10:24.194796 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:10:24.195327 [info ] [Thread-1  ]: 29 of 40 SKIP test not_null_fct_payment_details_payment_method ................. [[33mSKIP[0m]
[0m07:10:24.195862 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:10:24.196327 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:10:24.196853 [info ] [Thread-1  ]: 30 of 40 SKIP test not_null_fct_order_detail_customer_id ....................... [[33mSKIP[0m]
[0m07:10:24.197389 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:10:24.197853 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:10:24.198374 [info ] [Thread-1  ]: 31 of 40 SKIP test not_null_fct_order_detail_order_date ........................ [[33mSKIP[0m]
[0m07:10:24.198937 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:10:24.199404 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:10:24.199931 [info ] [Thread-1  ]: 32 of 40 SKIP test not_null_fct_order_detail_order_id .......................... [[33mSKIP[0m]
[0m07:10:24.200474 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:10:24.200943 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:10:24.201470 [info ] [Thread-1  ]: 33 of 40 SKIP test not_null_fct_order_detail_price ............................. [[33mSKIP[0m]
[0m07:10:24.202005 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:10:24.202470 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:10:24.203023 [info ] [Thread-1  ]: 34 of 40 SKIP test not_null_fct_order_detail_product_id ........................ [[33mSKIP[0m]
[0m07:10:24.203566 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:10:24.204031 [debug] [Thread-1  ]: Began running node test.development.positive_values_fct_order_detail_price.88617de77a
[0m07:10:24.204559 [info ] [Thread-1  ]: 35 of 40 SKIP test positive_values_fct_order_detail_price ...................... [[33mSKIP[0m]
[0m07:10:24.205091 [debug] [Thread-1  ]: Finished running node test.development.positive_values_fct_order_detail_price.88617de77a
[0m07:10:24.205560 [debug] [Thread-1  ]: Began running node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:10:24.206091 [info ] [Thread-1  ]: 36 of 40 SKIP test unique_fct_order_detail_order_id ............................ [[33mSKIP[0m]
[0m07:10:24.206623 [debug] [Thread-1  ]: Finished running node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:10:24.207672 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m07:10:24.208146 [info ] [Thread-1  ]: 37 of 40 SKIP relation final_sales.product_sales ............................... [[33mSKIP[0m]
[0m07:10:24.208679 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m07:10:24.209640 [debug] [Thread-1  ]: Began running node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m07:10:24.210112 [info ] [Thread-1  ]: 38 of 40 SKIP test not_null_product_sales_customer_id .......................... [[33mSKIP[0m]
[0m07:10:24.210646 [debug] [Thread-1  ]: Finished running node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m07:10:24.211141 [debug] [Thread-1  ]: Began running node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m07:10:24.211676 [info ] [Thread-1  ]: 39 of 40 SKIP test not_null_product_sales_order_amount ......................... [[33mSKIP[0m]
[0m07:10:24.212218 [debug] [Thread-1  ]: Finished running node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m07:10:24.212678 [debug] [Thread-1  ]: Began running node test.development.positive_values_product_sales_order_amount.81cc55494d
[0m07:10:24.213207 [info ] [Thread-1  ]: 40 of 40 SKIP test positive_values_product_sales_order_amount .................. [[33mSKIP[0m]
[0m07:10:24.213744 [debug] [Thread-1  ]: Finished running node test.development.positive_values_product_sales_order_amount.81cc55494d
[0m07:10:24.215711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:10:24.216068 [debug] [MainThread]: Connection 'model.development.first_model' was properly closed.
[0m07:10:24.216514 [info ] [MainThread]: 
[0m07:10:24.217024 [info ] [MainThread]: Finished running 7 incremental models, 1 view model, 32 tests in 0 hours 0 minutes and 6.11 seconds (6.11s).
[0m07:10:24.218805 [debug] [MainThread]: Command end result
[0m07:10:24.230213 [info ] [MainThread]: 
[0m07:10:24.230985 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m07:10:24.231432 [info ] [MainThread]: 
[0m07:10:24.231867 [error] [MainThread]: [33mDatabase Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)[0m
[0m07:10:24.232356 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 15 at position 51
[0m07:10:24.232762 [error] [MainThread]:   invalid identifier 'RUN_DATE'
[0m07:10:24.233216 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_customers.sql
[0m07:10:24.233663 [info ] [MainThread]: 
[0m07:10:24.234059 [error] [MainThread]: [33mDatabase Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)[0m
[0m07:10:24.234430 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 15 at position 64
[0m07:10:24.234850 [error] [MainThread]:   invalid identifier 'RUN_DATE'
[0m07:10:24.235264 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m07:10:24.235632 [info ] [MainThread]: 
[0m07:10:24.236085 [error] [MainThread]: [33mDatabase Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)[0m
[0m07:10:24.236455 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 15 at position 63
[0m07:10:24.236811 [error] [MainThread]:   invalid identifier 'RUN_DATE'
[0m07:10:24.237223 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m07:10:24.237626 [info ] [MainThread]: 
[0m07:10:24.238051 [error] [MainThread]: [33mDatabase Error in model bronze_products (models/sales/bronze/bronze_products.sql)[0m
[0m07:10:24.238418 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 15 at position 32
[0m07:10:24.238849 [error] [MainThread]:   invalid identifier 'RUN_DATE'
[0m07:10:24.239258 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m07:10:24.239662 [info ] [MainThread]: 
[0m07:10:24.240347 [error] [MainThread]: [33mDatabase Error in model first_model (models/sales/test/first_model.sql)[0m
[0m07:10:24.240730 [error] [MainThread]:   002003 (02000): SQL compilation error:
[0m07:10:24.241173 [error] [MainThread]:   Database 'INSIGHT_DEV' does not exist or not authorized.
[0m07:10:24.241555 [error] [MainThread]:   compiled Code at target/run/development/models/sales/test/first_model.sql
[0m07:10:24.242041 [info ] [MainThread]: 
[0m07:10:24.242498 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=35 TOTAL=40
[0m07:10:24.243474 [debug] [MainThread]: Command `dbt build` failed at 07:10:24.243318 after 7.72 seconds
[0m07:10:24.243967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8e8e80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c88adeb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c866c7df0>]}
[0m07:10:24.244437 [debug] [MainThread]: Flushing usage events
[0m07:11:24.439490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe95dac70d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe95c3d98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe95c3d9850>]}


============================== 07:11:24.443032 | 132be922-bbdb-4869-9bff-e18aa84a3e79 ==============================
[0m07:11:24.443032 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:11:24.443683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'airflow/dags/dbt/logs', 'profiles_dir': 'airflow/dags/dbt/', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:11:24.735063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '132be922-bbdb-4869-9bff-e18aa84a3e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe957cb6ee0>]}
[0m07:11:24.753050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '132be922-bbdb-4869-9bff-e18aa84a3e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe957cbf2e0>]}
[0m07:11:24.768528 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:11:24.794434 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m07:11:24.795250 [debug] [MainThread]: Partial parsing: deleted file: development://models/sales/test/first_model.sql
[0m07:11:24.802838 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.development.silver
- models.development.bronze
- models.development.staging
- models.development.gold
[0m07:11:24.810483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '132be922-bbdb-4869-9bff-e18aa84a3e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe956a9c5e0>]}
[0m07:11:24.822796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '132be922-bbdb-4869-9bff-e18aa84a3e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe956bb5790>]}
[0m07:11:24.823459 [info ] [MainThread]: Found 7 models, 32 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m07:11:24.826789 [info ] [MainThread]: 
[0m07:11:24.827741 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:11:24.831340 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m07:11:24.849764 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m07:11:24.850553 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m07:11:24.851087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:11:25.572281 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m07:11:25.575391 [debug] [ThreadPool]: On list_external_db: Close
[0m07:11:25.682517 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m07:11:25.691669 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m07:11:25.692215 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m07:11:25.692588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:11:26.120020 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m07:11:26.122462 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m07:11:26.220548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '132be922-bbdb-4869-9bff-e18aa84a3e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe957cbf220>]}
[0m07:11:26.221913 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:11:26.223222 [info ] [MainThread]: 
[0m07:11:26.228501 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m07:11:26.229255 [info ] [Thread-1  ]: 1 of 39 START sql incremental model final_sales.bronze_customers ............... [RUN]
[0m07:11:26.230132 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m07:11:26.230578 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m07:11:26.235394 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m07:11:26.236492 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 07:11:26.230879 => 07:11:26.235922
[0m07:11:26.236929 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m07:11:26.294332 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:11:26.295019 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_timestamp('2023-06-22') as run_ts  from external_db.stage.customers
)

select * from customers
  );
[0m07:11:26.295453 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:11:26.663092 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:11:26.674153 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:11:26.674750 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m07:11:26.751233 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:11:26.756234 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:11:26.756768 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m07:11:26.818643 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:11:26.829303 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:11:26.829902 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m07:11:26.896152 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:11:26.933584 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m07:11:26.935473 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:11:26.936024 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m07:11:27.011632 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:11:27.012343 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:11:27.012818 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")
    values
        ("CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_DATE")

;
[0m07:11:27.109305 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad4eef-0000-fb4f-0001-937e00018ee2
[0m07:11:27.109972 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 51
invalid identifier 'RUN_DATE'
[0m07:11:27.110702 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 07:11:26.237189 => 07:11:27.110398
[0m07:11:27.111155 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m07:11:27.263538 [debug] [Thread-1  ]: Database Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)
  000904 (42000): SQL compilation error: error line 15 at position 51
  invalid identifier 'RUN_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_customers.sql
[0m07:11:27.264358 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '132be922-bbdb-4869-9bff-e18aa84a3e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe954528fd0>]}
[0m07:11:27.265150 [error] [Thread-1  ]: 1 of 39 ERROR creating sql incremental model final_sales.bronze_customers ...... [[31mERROR[0m in 1.03s]
[0m07:11:27.265815 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m07:11:27.266359 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m07:11:27.267225 [info ] [Thread-1  ]: 2 of 39 START sql incremental model final_sales.bronze_orders .................. [RUN]
[0m07:11:27.268395 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m07:11:27.268927 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m07:11:27.273864 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m07:11:27.274691 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 07:11:27.269334 => 07:11:27.274382
[0m07:11:27.275119 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m07:11:27.279563 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:11:27.280021 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.orders
)

select * from orders
  );
[0m07:11:27.280416 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:11:27.632326 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:11:27.638882 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:11:27.639639 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m07:11:27.715931 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:11:27.801824 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:11:27.802441 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m07:11:27.871213 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:11:27.876486 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:11:27.877094 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m07:11:27.937923 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:11:27.942524 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m07:11:27.944243 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:11:27.944733 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m07:11:28.045311 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:11:28.046093 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:11:28.046623 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_DATE")

;
[0m07:11:28.125642 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad4eef-0000-fb4f-0001-937e00018ef6
[0m07:11:28.126277 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 64
invalid identifier 'RUN_DATE'
[0m07:11:28.126996 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 07:11:27.275383 => 07:11:28.126715
[0m07:11:28.127685 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m07:11:28.280554 [debug] [Thread-1  ]: Database Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)
  000904 (42000): SQL compilation error: error line 15 at position 64
  invalid identifier 'RUN_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m07:11:28.281412 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '132be922-bbdb-4869-9bff-e18aa84a3e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe954547be0>]}
[0m07:11:28.282246 [error] [Thread-1  ]: 2 of 39 ERROR creating sql incremental model final_sales.bronze_orders ......... [[31mERROR[0m in 1.01s]
[0m07:11:28.282929 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m07:11:28.283485 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m07:11:28.284583 [info ] [Thread-1  ]: 3 of 39 START sql incremental model final_sales.bronze_payments ................ [RUN]
[0m07:11:28.285585 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m07:11:28.286116 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m07:11:28.290766 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m07:11:28.291609 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 07:11:28.286466 => 07:11:28.291329
[0m07:11:28.292055 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m07:11:28.296571 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:11:28.297030 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.payments
)

select * from payments
  );
[0m07:11:28.297417 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:11:28.648248 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:11:28.652249 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:11:28.652786 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m07:11:28.728647 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:11:28.733740 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:11:28.734333 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m07:11:28.798219 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:11:28.803659 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:11:28.804302 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m07:11:28.872513 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:11:28.876946 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m07:11:28.878952 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:11:28.879520 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m07:11:28.955024 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:11:28.955846 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:11:28.956352 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")
    values
        ("PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_DATE")

;
[0m07:11:29.042890 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad4eef-0000-fb4f-0001-937e00018f06
[0m07:11:29.043658 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 63
invalid identifier 'RUN_DATE'
[0m07:11:29.044464 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 07:11:28.292320 => 07:11:29.044176
[0m07:11:29.044996 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m07:11:29.200067 [debug] [Thread-1  ]: Database Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)
  000904 (42000): SQL compilation error: error line 15 at position 63
  invalid identifier 'RUN_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m07:11:29.200980 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '132be922-bbdb-4869-9bff-e18aa84a3e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9543aab20>]}
[0m07:11:29.201859 [error] [Thread-1  ]: 3 of 39 ERROR creating sql incremental model final_sales.bronze_payments ....... [[31mERROR[0m in 0.92s]
[0m07:11:29.202864 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m07:11:29.203501 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m07:11:29.204256 [info ] [Thread-1  ]: 4 of 39 START sql incremental model final_sales.bronze_products ................ [RUN]
[0m07:11:29.205788 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m07:11:29.206386 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m07:11:29.210816 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m07:11:29.211638 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 07:11:29.206728 => 07:11:29.211332
[0m07:11:29.212055 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m07:11:29.216459 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:11:29.216942 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.products
)

select * from products
  );
[0m07:11:29.217337 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:11:29.552213 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:11:29.556323 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:11:29.556995 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m07:11:29.627114 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:11:29.631783 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:11:29.632341 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m07:11:29.699132 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m07:11:29.703924 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:11:29.704519 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m07:11:29.768434 [debug] [Thread-1  ]: SQL status: SUCCESS 3 in 0.0 seconds
[0m07:11:29.772554 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m07:11:29.774083 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:11:29.774524 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m07:11:29.859220 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:11:29.859961 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:11:29.860468 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_DATE" = DBT_INTERNAL_SOURCE."RUN_DATE"
    

    when not matched then insert
        ("PRODUCT_ID", "PRICE", "RUN_DATE")
    values
        ("PRODUCT_ID", "PRICE", "RUN_DATE")

;
[0m07:11:29.954940 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad4eef-0000-fb87-0001-937e000190f2
[0m07:11:29.955732 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 32
invalid identifier 'RUN_DATE'
[0m07:11:29.956550 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 07:11:29.212314 => 07:11:29.956268
[0m07:11:29.957098 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m07:11:30.104969 [debug] [Thread-1  ]: Database Error in model bronze_products (models/sales/bronze/bronze_products.sql)
  000904 (42000): SQL compilation error: error line 15 at position 32
  invalid identifier 'RUN_DATE'
  compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m07:11:30.105841 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '132be922-bbdb-4869-9bff-e18aa84a3e79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe954508e20>]}
[0m07:11:30.106727 [error] [Thread-1  ]: 4 of 39 ERROR creating sql incremental model final_sales.bronze_products ....... [[31mERROR[0m in 0.90s]
[0m07:11:30.107707 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m07:11:30.108369 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:11:30.108949 [info ] [Thread-1  ]: 5 of 39 SKIP test not_null_bronze_customers_customer_id ........................ [[33mSKIP[0m]
[0m07:11:30.110096 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:11:30.110612 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:11:30.111226 [info ] [Thread-1  ]: 6 of 39 SKIP test not_null_bronze_customers_first_name ......................... [[33mSKIP[0m]
[0m07:11:30.111786 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:11:30.112277 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:11:30.112838 [info ] [Thread-1  ]: 7 of 39 SKIP test unique_bronze_customers_customer_id .......................... [[33mSKIP[0m]
[0m07:11:30.113382 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:11:30.113860 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:11:30.114396 [info ] [Thread-1  ]: 8 of 39 SKIP test not_null_bronze_orders_customer_id ........................... [[33mSKIP[0m]
[0m07:11:30.114956 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:11:30.115423 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:11:30.115956 [info ] [Thread-1  ]: 9 of 39 SKIP test not_null_bronze_orders_order_date ............................ [[33mSKIP[0m]
[0m07:11:30.116499 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:11:30.116968 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:11:30.117514 [info ] [Thread-1  ]: 10 of 39 SKIP test not_null_bronze_orders_order_id ............................. [[33mSKIP[0m]
[0m07:11:30.118061 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:11:30.118540 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:11:30.119097 [info ] [Thread-1  ]: 11 of 39 SKIP test not_null_bronze_orders_product_id ........................... [[33mSKIP[0m]
[0m07:11:30.119637 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:11:30.120092 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:11:30.120616 [info ] [Thread-1  ]: 12 of 39 SKIP test unique_bronze_orders_order_id ............................... [[33mSKIP[0m]
[0m07:11:30.121160 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:11:30.121680 [debug] [Thread-1  ]: Began running node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:11:30.122240 [info ] [Thread-1  ]: 13 of 39 SKIP test accepted_values_bronze_payments_payment_method__debit__credit__upi__cash  [[33mSKIP[0m]
[0m07:11:30.122810 [debug] [Thread-1  ]: Finished running node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:11:30.123278 [debug] [Thread-1  ]: Began running node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:11:30.123815 [info ] [Thread-1  ]: 14 of 39 SKIP test accepted_values_bronze_payments_status__fail__success ....... [[33mSKIP[0m]
[0m07:11:30.124357 [debug] [Thread-1  ]: Finished running node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:11:30.124813 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:11:30.125348 [info ] [Thread-1  ]: 15 of 39 SKIP test not_null_bronze_payments_order_id ........................... [[33mSKIP[0m]
[0m07:11:30.126370 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:11:30.126864 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:11:30.127415 [info ] [Thread-1  ]: 16 of 39 SKIP test not_null_bronze_payments_payment_id ......................... [[33mSKIP[0m]
[0m07:11:30.127982 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:11:30.128449 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:11:30.128984 [info ] [Thread-1  ]: 17 of 39 SKIP test not_null_bronze_payments_payment_method ..................... [[33mSKIP[0m]
[0m07:11:30.129524 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:11:30.129980 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:11:30.130420 [info ] [Thread-1  ]: 18 of 39 SKIP test not_null_bronze_payments_status ............................. [[33mSKIP[0m]
[0m07:11:30.131091 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:11:30.131554 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:11:30.132093 [info ] [Thread-1  ]: 19 of 39 SKIP test unique_bronze_payments_payment_id ........................... [[33mSKIP[0m]
[0m07:11:30.132633 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:11:30.133089 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_products_price.e208481306
[0m07:11:30.133641 [info ] [Thread-1  ]: 20 of 39 SKIP test not_null_bronze_products_price .............................. [[33mSKIP[0m]
[0m07:11:30.134371 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_products_price.e208481306
[0m07:11:30.134863 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:11:30.135404 [info ] [Thread-1  ]: 21 of 39 SKIP test not_null_bronze_products_product_id ......................... [[33mSKIP[0m]
[0m07:11:30.135943 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:11:30.136415 [debug] [Thread-1  ]: Began running node test.development.products_price_lower_than_threshold
[0m07:11:30.136951 [info ] [Thread-1  ]: 22 of 39 SKIP test products_price_lower_than_threshold ......................... [[33mSKIP[0m]
[0m07:11:30.137487 [debug] [Thread-1  ]: Finished running node test.development.products_price_lower_than_threshold
[0m07:11:30.137942 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:11:30.138477 [info ] [Thread-1  ]: 23 of 39 SKIP test unique_bronze_products_product_id ........................... [[33mSKIP[0m]
[0m07:11:30.139031 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:11:30.139494 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m07:11:30.140036 [info ] [Thread-1  ]: 24 of 39 SKIP relation final_sales.fct_payment_details ......................... [[33mSKIP[0m]
[0m07:11:30.140751 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m07:11:30.141226 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m07:11:30.141775 [info ] [Thread-1  ]: 25 of 39 SKIP relation final_sales.fct_order_detail ............................ [[33mSKIP[0m]
[0m07:11:30.142485 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m07:11:30.142996 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:11:30.143554 [info ] [Thread-1  ]: 26 of 39 SKIP test not_null_fct_payment_details_order_id ....................... [[33mSKIP[0m]
[0m07:11:30.144327 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:11:30.144801 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:11:30.145330 [info ] [Thread-1  ]: 27 of 39 SKIP test not_null_fct_payment_details_payment_id ..................... [[33mSKIP[0m]
[0m07:11:30.145863 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:11:30.146319 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:11:30.146864 [info ] [Thread-1  ]: 28 of 39 SKIP test not_null_fct_payment_details_payment_method ................. [[33mSKIP[0m]
[0m07:11:30.147407 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:11:30.147874 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:11:30.148400 [info ] [Thread-1  ]: 29 of 39 SKIP test not_null_fct_order_detail_customer_id ....................... [[33mSKIP[0m]
[0m07:11:30.148934 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:11:30.149394 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:11:30.149927 [info ] [Thread-1  ]: 30 of 39 SKIP test not_null_fct_order_detail_order_date ........................ [[33mSKIP[0m]
[0m07:11:30.150465 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:11:30.150949 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:11:30.151483 [info ] [Thread-1  ]: 31 of 39 SKIP test not_null_fct_order_detail_order_id .......................... [[33mSKIP[0m]
[0m07:11:30.152024 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:11:30.152479 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:11:30.153004 [info ] [Thread-1  ]: 32 of 39 SKIP test not_null_fct_order_detail_price ............................. [[33mSKIP[0m]
[0m07:11:30.153536 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:11:30.153994 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:11:30.154527 [info ] [Thread-1  ]: 33 of 39 SKIP test not_null_fct_order_detail_product_id ........................ [[33mSKIP[0m]
[0m07:11:30.155087 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:11:30.155549 [debug] [Thread-1  ]: Began running node test.development.positive_values_fct_order_detail_price.88617de77a
[0m07:11:30.156090 [info ] [Thread-1  ]: 34 of 39 SKIP test positive_values_fct_order_detail_price ...................... [[33mSKIP[0m]
[0m07:11:30.156633 [debug] [Thread-1  ]: Finished running node test.development.positive_values_fct_order_detail_price.88617de77a
[0m07:11:30.157097 [debug] [Thread-1  ]: Began running node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:11:30.157625 [info ] [Thread-1  ]: 35 of 39 SKIP test unique_fct_order_detail_order_id ............................ [[33mSKIP[0m]
[0m07:11:30.158164 [debug] [Thread-1  ]: Finished running node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:11:30.159224 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m07:11:30.159718 [info ] [Thread-1  ]: 36 of 39 SKIP relation final_sales.product_sales ............................... [[33mSKIP[0m]
[0m07:11:30.160271 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m07:11:30.161425 [debug] [Thread-1  ]: Began running node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m07:11:30.161900 [info ] [Thread-1  ]: 37 of 39 SKIP test not_null_product_sales_customer_id .......................... [[33mSKIP[0m]
[0m07:11:30.162443 [debug] [Thread-1  ]: Finished running node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m07:11:30.162980 [debug] [Thread-1  ]: Began running node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m07:11:30.163522 [info ] [Thread-1  ]: 38 of 39 SKIP test not_null_product_sales_order_amount ......................... [[33mSKIP[0m]
[0m07:11:30.164069 [debug] [Thread-1  ]: Finished running node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m07:11:30.164538 [debug] [Thread-1  ]: Began running node test.development.positive_values_product_sales_order_amount.81cc55494d
[0m07:11:30.165076 [info ] [Thread-1  ]: 39 of 39 SKIP test positive_values_product_sales_order_amount .................. [[33mSKIP[0m]
[0m07:11:30.165621 [debug] [Thread-1  ]: Finished running node test.development.positive_values_product_sales_order_amount.81cc55494d
[0m07:11:30.167715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:11:30.168078 [debug] [MainThread]: Connection 'list_external_db' was properly closed.
[0m07:11:30.168373 [debug] [MainThread]: Connection 'model.development.bronze_products' was properly closed.
[0m07:11:30.168836 [info ] [MainThread]: 
[0m07:11:30.169313 [info ] [MainThread]: Finished running 7 incremental models, 32 tests in 0 hours 0 minutes and 5.34 seconds (5.34s).
[0m07:11:30.171061 [debug] [MainThread]: Command end result
[0m07:11:30.183291 [info ] [MainThread]: 
[0m07:11:30.184014 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m07:11:30.184434 [info ] [MainThread]: 
[0m07:11:30.184863 [error] [MainThread]: [33mDatabase Error in model bronze_customers (models/sales/bronze/bronze_customers.sql)[0m
[0m07:11:30.185273 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 15 at position 51
[0m07:11:30.185683 [error] [MainThread]:   invalid identifier 'RUN_DATE'
[0m07:11:30.186159 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_customers.sql
[0m07:11:30.186543 [info ] [MainThread]: 
[0m07:11:30.187002 [error] [MainThread]: [33mDatabase Error in model bronze_orders (models/sales/bronze/bronze_orders.sql)[0m
[0m07:11:30.187388 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 15 at position 64
[0m07:11:30.187743 [error] [MainThread]:   invalid identifier 'RUN_DATE'
[0m07:11:30.188093 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_orders.sql
[0m07:11:30.188457 [info ] [MainThread]: 
[0m07:11:30.188833 [error] [MainThread]: [33mDatabase Error in model bronze_payments (models/sales/bronze/bronze_payments.sql)[0m
[0m07:11:30.189311 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 15 at position 63
[0m07:11:30.189674 [error] [MainThread]:   invalid identifier 'RUN_DATE'
[0m07:11:30.190072 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_payments.sql
[0m07:11:30.190438 [info ] [MainThread]: 
[0m07:11:30.190921 [error] [MainThread]: [33mDatabase Error in model bronze_products (models/sales/bronze/bronze_products.sql)[0m
[0m07:11:30.191319 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 15 at position 32
[0m07:11:30.191709 [error] [MainThread]:   invalid identifier 'RUN_DATE'
[0m07:11:30.192076 [error] [MainThread]:   compiled Code at target/run/development/models/sales/bronze/bronze_products.sql
[0m07:11:30.192490 [info ] [MainThread]: 
[0m07:11:30.192968 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=35 TOTAL=39
[0m07:11:30.193887 [debug] [MainThread]: Command `dbt build` failed at 07:11:30.193733 after 5.77 seconds
[0m07:11:30.194375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe95dac70d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe956ae3b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe956ad1520>]}
[0m07:11:30.194914 [debug] [MainThread]: Flushing usage events
[0m07:14:18.739488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce429ed100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce412fb910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce412fb100>]}


============================== 07:14:18.742738 | c68092db-5637-4ddd-983c-51475d099ff0 ==============================
[0m07:14:18.742738 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:14:18.743336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'airflow/dags/dbt/', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'airflow/dags/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:14:19.018620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c68092db-5637-4ddd-983c-51475d099ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3bbe1f70>]}
[0m07:14:19.036249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c68092db-5637-4ddd-983c-51475d099ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3bbceaf0>]}
[0m07:14:19.050843 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:14:19.075878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:14:19.076346 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:14:19.077170 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.development.bronze
- models.development.gold
- models.development.silver
- models.development.staging
[0m07:14:19.084623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c68092db-5637-4ddd-983c-51475d099ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3ba3d430>]}
[0m07:14:19.096421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c68092db-5637-4ddd-983c-51475d099ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3baf2430>]}
[0m07:14:19.097015 [info ] [MainThread]: Found 7 models, 32 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m07:14:19.100251 [info ] [MainThread]: 
[0m07:14:19.101153 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:14:19.102809 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m07:14:19.119245 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m07:14:19.119836 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m07:14:19.120273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:14:19.832957 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m07:14:19.836118 [debug] [ThreadPool]: On list_external_db: Close
[0m07:14:19.939904 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now create_external_db_final_sales)
[0m07:14:19.941080 [debug] [ThreadPool]: Creating schema "database: "external_db"
schema: "final_sales"
"
[0m07:14:19.948276 [debug] [ThreadPool]: Using snowflake connection "create_external_db_final_sales"
[0m07:14:19.948752 [debug] [ThreadPool]: On create_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "create_external_db_final_sales"} */
create schema if not exists external_db.final_sales
[0m07:14:19.949113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:14:20.253318 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:20.254914 [debug] [ThreadPool]: On create_external_db_final_sales: Close
[0m07:14:20.363103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_external_db_final_sales, now list_external_db_final_sales)
[0m07:14:20.372978 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m07:14:20.373677 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m07:14:20.374162 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:14:20.692486 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m07:14:20.694417 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m07:14:20.799080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c68092db-5637-4ddd-983c-51475d099ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3bbe3670>]}
[0m07:14:20.800424 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:14:20.801023 [info ] [MainThread]: 
[0m07:14:20.804797 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m07:14:20.805481 [info ] [Thread-1  ]: 1 of 39 START sql incremental model final_sales.bronze_customers ............... [RUN]
[0m07:14:20.806776 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m07:14:20.807238 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m07:14:20.811992 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m07:14:20.812790 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 07:14:20.807625 => 07:14:20.812497
[0m07:14:20.813247 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m07:14:20.878392 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m07:14:20.879778 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:14:20.880270 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace transient table external_db.final_sales.bronze_customers
         as
        (

with customers as (
     select *, 
     to_timestamp('2023-06-22') as run_ts  from external_db.stage.customers
)

select * from customers
        );
[0m07:14:20.880671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:22.789758 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m07:14:22.799889 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:14:22.800450 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m07:14:22.858799 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:22.883716 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 07:14:20.813529 => 07:14:22.883438
[0m07:14:22.884298 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m07:14:22.988153 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c68092db-5637-4ddd-983c-51475d099ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce39452be0>]}
[0m07:14:22.989221 [info ] [Thread-1  ]: 1 of 39 OK created sql incremental model final_sales.bronze_customers .......... [[32mSUCCESS 1[0m in 2.18s]
[0m07:14:22.990074 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m07:14:22.990599 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m07:14:22.991396 [info ] [Thread-1  ]: 2 of 39 START sql incremental model final_sales.bronze_orders .................. [RUN]
[0m07:14:22.992661 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m07:14:22.993208 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m07:14:22.997581 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m07:14:22.998388 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 07:14:22.993487 => 07:14:22.998095
[0m07:14:22.998836 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m07:14:23.004505 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m07:14:23.005589 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:14:23.006023 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace transient table external_db.final_sales.bronze_orders
         as
        (

with orders as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.orders
)

select * from orders
        );
[0m07:14:23.006413 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:24.583311 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m07:14:24.588175 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:14:24.588707 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m07:14:24.655750 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:24.659499 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 07:14:22.999106 => 07:14:24.659183
[0m07:14:24.660062 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m07:14:24.758236 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c68092db-5637-4ddd-983c-51475d099ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3ad7b550>]}
[0m07:14:24.759359 [info ] [Thread-1  ]: 2 of 39 OK created sql incremental model final_sales.bronze_orders ............. [[32mSUCCESS 1[0m in 1.77s]
[0m07:14:24.760282 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m07:14:24.760849 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m07:14:24.761419 [info ] [Thread-1  ]: 3 of 39 START sql incremental model final_sales.bronze_payments ................ [RUN]
[0m07:14:24.762404 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m07:14:24.763131 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m07:14:24.767986 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m07:14:24.768811 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 07:14:24.763683 => 07:14:24.768507
[0m07:14:24.769232 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m07:14:24.773560 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m07:14:24.774624 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:14:24.775087 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace transient table external_db.final_sales.bronze_payments
         as
        (

with payments as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.payments
)

select * from payments
        );
[0m07:14:24.775478 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:25.685585 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:14:25.690393 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:14:25.690976 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m07:14:25.760039 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:25.763410 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 07:14:24.769493 => 07:14:25.763158
[0m07:14:25.763901 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m07:14:25.866315 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c68092db-5637-4ddd-983c-51475d099ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3ad37310>]}
[0m07:14:25.867432 [info ] [Thread-1  ]: 3 of 39 OK created sql incremental model final_sales.bronze_payments ........... [[32mSUCCESS 1[0m in 1.10s]
[0m07:14:25.868344 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m07:14:25.868927 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m07:14:25.870021 [info ] [Thread-1  ]: 4 of 39 START sql incremental model final_sales.bronze_products ................ [RUN]
[0m07:14:25.871119 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m07:14:25.871603 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m07:14:25.876345 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m07:14:25.877146 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 07:14:25.871902 => 07:14:25.876849
[0m07:14:25.877567 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m07:14:25.882003 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m07:14:25.883114 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:14:25.883557 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace transient table external_db.final_sales.bronze_products
         as
        (

with products as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.products
)

select * from products
        );
[0m07:14:25.883963 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:26.764602 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:14:26.771203 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:14:26.771797 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m07:14:26.834847 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:26.838552 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 07:14:25.877835 => 07:14:26.838125
[0m07:14:26.839151 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m07:14:26.931845 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c68092db-5637-4ddd-983c-51475d099ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce39375220>]}
[0m07:14:26.933031 [info ] [Thread-1  ]: 4 of 39 OK created sql incremental model final_sales.bronze_products ........... [[32mSUCCESS 1[0m in 1.06s]
[0m07:14:26.933901 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m07:14:26.934476 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:14:26.935175 [info ] [Thread-1  ]: 5 of 39 START test not_null_bronze_customers_customer_id ....................... [RUN]
[0m07:14:26.936694 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now test.development.not_null_bronze_customers_customer_id.254c74eb6e)
[0m07:14:26.937124 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:14:27.031469 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_customers_customer_id.254c74eb6e"
[0m07:14:27.032573 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_customer_id.254c74eb6e (compile): 07:14:26.937396 => 07:14:27.032224
[0m07:14:27.033072 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:14:27.050714 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_customers_customer_id.254c74eb6e"
[0m07:14:27.052015 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_customers_customer_id.254c74eb6e"
[0m07:14:27.052507 [debug] [Thread-1  ]: On test.development.not_null_bronze_customers_customer_id.254c74eb6e: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_customers_customer_id.254c74eb6e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from external_db.final_sales.bronze_customers
where customer_id is null



      
    ) dbt_internal_test
[0m07:14:27.052926 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:27.539617 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:27.544754 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_customer_id.254c74eb6e (execute): 07:14:27.033356 => 07:14:27.544191
[0m07:14:27.546119 [debug] [Thread-1  ]: On test.development.not_null_bronze_customers_customer_id.254c74eb6e: Close
[0m07:14:27.645325 [info ] [Thread-1  ]: 5 of 39 PASS not_null_bronze_customers_customer_id ............................. [[32mPASS[0m in 0.71s]
[0m07:14:27.647282 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:14:27.648007 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:14:27.648677 [info ] [Thread-1  ]: 6 of 39 START test not_null_bronze_customers_first_name ........................ [RUN]
[0m07:14:27.649940 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_customers_customer_id.254c74eb6e, now test.development.not_null_bronze_customers_first_name.22deabc315)
[0m07:14:27.650474 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:14:27.658993 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_customers_first_name.22deabc315"
[0m07:14:27.660058 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_first_name.22deabc315 (compile): 07:14:27.651006 => 07:14:27.659748
[0m07:14:27.660517 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:14:27.663861 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_customers_first_name.22deabc315"
[0m07:14:27.665078 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_customers_first_name.22deabc315"
[0m07:14:27.665522 [debug] [Thread-1  ]: On test.development.not_null_bronze_customers_first_name.22deabc315: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_customers_first_name.22deabc315"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_name
from external_db.final_sales.bronze_customers
where first_name is null



      
    ) dbt_internal_test
[0m07:14:27.665929 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:27.990226 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:27.993594 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_first_name.22deabc315 (execute): 07:14:27.660799 => 07:14:27.993194
[0m07:14:27.994246 [debug] [Thread-1  ]: On test.development.not_null_bronze_customers_first_name.22deabc315: Close
[0m07:14:28.095937 [info ] [Thread-1  ]: 6 of 39 PASS not_null_bronze_customers_first_name .............................. [[32mPASS[0m in 0.45s]
[0m07:14:28.097720 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:14:28.098787 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:14:28.099424 [info ] [Thread-1  ]: 7 of 39 START test unique_bronze_customers_customer_id ......................... [RUN]
[0m07:14:28.100790 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_customers_first_name.22deabc315, now test.development.unique_bronze_customers_customer_id.f8660c11fe)
[0m07:14:28.101616 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:14:28.110955 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_customers_customer_id.f8660c11fe"
[0m07:14:28.111936 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_customers_customer_id.f8660c11fe (compile): 07:14:28.102077 => 07:14:28.111596
[0m07:14:28.112417 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:14:28.115833 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_bronze_customers_customer_id.f8660c11fe"
[0m07:14:28.117027 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_bronze_customers_customer_id.f8660c11fe"
[0m07:14:28.117488 [debug] [Thread-1  ]: On test.development.unique_bronze_customers_customer_id.f8660c11fe: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_bronze_customers_customer_id.f8660c11fe"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from external_db.final_sales.bronze_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:14:28.117916 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:28.817238 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:14:28.820744 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_customers_customer_id.f8660c11fe (execute): 07:14:28.112693 => 07:14:28.820301
[0m07:14:28.821327 [debug] [Thread-1  ]: On test.development.unique_bronze_customers_customer_id.f8660c11fe: Close
[0m07:14:28.918023 [info ] [Thread-1  ]: 7 of 39 PASS unique_bronze_customers_customer_id ............................... [[32mPASS[0m in 0.82s]
[0m07:14:28.919080 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:14:28.919640 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:14:28.920285 [info ] [Thread-1  ]: 8 of 39 START test not_null_bronze_orders_customer_id .......................... [RUN]
[0m07:14:28.921173 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_customers_customer_id.f8660c11fe, now test.development.not_null_bronze_orders_customer_id.660ce070b4)
[0m07:14:28.921616 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:14:28.927290 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_customer_id.660ce070b4"
[0m07:14:28.928059 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_customer_id.660ce070b4 (compile): 07:14:28.921888 => 07:14:28.927775
[0m07:14:28.928476 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:14:28.933264 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_orders_customer_id.660ce070b4"
[0m07:14:28.934298 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_orders_customer_id.660ce070b4"
[0m07:14:28.934773 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_customer_id.660ce070b4: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_orders_customer_id.660ce070b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from external_db.final_sales.bronze_orders
where customer_id is null



      
    ) dbt_internal_test
[0m07:14:28.935184 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:29.303452 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:29.306756 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_customer_id.660ce070b4 (execute): 07:14:28.928743 => 07:14:29.306368
[0m07:14:29.307326 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_customer_id.660ce070b4: Close
[0m07:14:29.408779 [info ] [Thread-1  ]: 8 of 39 PASS not_null_bronze_orders_customer_id ................................ [[32mPASS[0m in 0.49s]
[0m07:14:29.409916 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:14:29.410523 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:14:29.411242 [info ] [Thread-1  ]: 9 of 39 START test not_null_bronze_orders_order_date ........................... [RUN]
[0m07:14:29.412266 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_customer_id.660ce070b4, now test.development.not_null_bronze_orders_order_date.d63cfe6df9)
[0m07:14:29.412703 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:14:29.418343 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_order_date.d63cfe6df9"
[0m07:14:29.419105 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_date.d63cfe6df9 (compile): 07:14:29.412973 => 07:14:29.418839
[0m07:14:29.419519 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:14:29.423504 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_orders_order_date.d63cfe6df9"
[0m07:14:29.424495 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_orders_order_date.d63cfe6df9"
[0m07:14:29.424933 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_order_date.d63cfe6df9: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_orders_order_date.d63cfe6df9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from external_db.final_sales.bronze_orders
where order_date is null



      
    ) dbt_internal_test
[0m07:14:29.425340 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:29.782369 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:29.785608 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_date.d63cfe6df9 (execute): 07:14:29.419787 => 07:14:29.785261
[0m07:14:29.786127 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_order_date.d63cfe6df9: Close
[0m07:14:29.881116 [info ] [Thread-1  ]: 9 of 39 PASS not_null_bronze_orders_order_date ................................. [[32mPASS[0m in 0.47s]
[0m07:14:29.882358 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:14:29.882958 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:14:29.883670 [info ] [Thread-1  ]: 10 of 39 START test not_null_bronze_orders_order_id ............................ [RUN]
[0m07:14:29.884662 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_order_date.d63cfe6df9, now test.development.not_null_bronze_orders_order_id.24f68d0dd3)
[0m07:14:29.885110 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:14:29.890828 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_order_id.24f68d0dd3"
[0m07:14:29.891609 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_id.24f68d0dd3 (compile): 07:14:29.885379 => 07:14:29.891328
[0m07:14:29.892038 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:14:29.896115 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_orders_order_id.24f68d0dd3"
[0m07:14:29.897118 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_orders_order_id.24f68d0dd3"
[0m07:14:29.897550 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_order_id.24f68d0dd3: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_orders_order_id.24f68d0dd3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from external_db.final_sales.bronze_orders
where order_id is null



      
    ) dbt_internal_test
[0m07:14:29.897951 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:30.219379 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:30.222865 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_id.24f68d0dd3 (execute): 07:14:29.892305 => 07:14:30.222426
[0m07:14:30.223525 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_order_id.24f68d0dd3: Close
[0m07:14:30.321727 [info ] [Thread-1  ]: 10 of 39 PASS not_null_bronze_orders_order_id .................................. [[32mPASS[0m in 0.44s]
[0m07:14:30.322901 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:14:30.323475 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:14:30.324251 [info ] [Thread-1  ]: 11 of 39 START test not_null_bronze_orders_product_id .......................... [RUN]
[0m07:14:30.325296 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_order_id.24f68d0dd3, now test.development.not_null_bronze_orders_product_id.354934acfc)
[0m07:14:30.325766 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:14:30.333101 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_product_id.354934acfc"
[0m07:14:30.334056 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_product_id.354934acfc (compile): 07:14:30.326043 => 07:14:30.333698
[0m07:14:30.334646 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:14:30.338594 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_orders_product_id.354934acfc"
[0m07:14:30.339906 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_orders_product_id.354934acfc"
[0m07:14:30.340549 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_product_id.354934acfc: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_orders_product_id.354934acfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from external_db.final_sales.bronze_orders
where product_id is null



      
    ) dbt_internal_test
[0m07:14:30.341030 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:30.809876 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:30.813294 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_product_id.354934acfc (execute): 07:14:30.335004 => 07:14:30.812946
[0m07:14:30.813846 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_product_id.354934acfc: Close
[0m07:14:30.907255 [info ] [Thread-1  ]: 11 of 39 PASS not_null_bronze_orders_product_id ................................ [[32mPASS[0m in 0.58s]
[0m07:14:30.908282 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:14:30.908832 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:14:30.909586 [info ] [Thread-1  ]: 12 of 39 START test unique_bronze_orders_order_id .............................. [RUN]
[0m07:14:30.910558 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_product_id.354934acfc, now test.development.unique_bronze_orders_order_id.eec6e86d13)
[0m07:14:30.911016 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:14:30.916976 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_orders_order_id.eec6e86d13"
[0m07:14:30.917782 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_orders_order_id.eec6e86d13 (compile): 07:14:30.911281 => 07:14:30.917496
[0m07:14:30.918214 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:14:30.923208 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_bronze_orders_order_id.eec6e86d13"
[0m07:14:30.924301 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_bronze_orders_order_id.eec6e86d13"
[0m07:14:30.924841 [debug] [Thread-1  ]: On test.development.unique_bronze_orders_order_id.eec6e86d13: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_bronze_orders_order_id.eec6e86d13"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from external_db.final_sales.bronze_orders
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:14:30.925255 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:31.357850 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:31.361235 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_orders_order_id.eec6e86d13 (execute): 07:14:30.918474 => 07:14:31.360867
[0m07:14:31.361801 [debug] [Thread-1  ]: On test.development.unique_bronze_orders_order_id.eec6e86d13: Close
[0m07:14:31.452906 [info ] [Thread-1  ]: 12 of 39 PASS unique_bronze_orders_order_id .................................... [[32mPASS[0m in 0.54s]
[0m07:14:31.454044 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:14:31.454698 [debug] [Thread-1  ]: Began running node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:14:31.455349 [info ] [Thread-1  ]: 13 of 39 START test accepted_values_bronze_payments_payment_method__debit__credit__upi__cash  [RUN]
[0m07:14:31.456295 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_orders_order_id.eec6e86d13, now test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8)
[0m07:14:31.456783 [debug] [Thread-1  ]: Began compiling node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:14:31.469325 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"
[0m07:14:31.470216 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8 (compile): 07:14:31.457083 => 07:14:31.469907
[0m07:14:31.470694 [debug] [Thread-1  ]: Began executing node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:14:31.473984 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"
[0m07:14:31.475194 [debug] [Thread-1  ]: Using snowflake connection "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"
[0m07:14:31.475650 [debug] [Thread-1  ]: On test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from external_db.final_sales.bronze_payments
    group by payment_method

)

select *
from all_values
where value_field not in (
    'debit','credit','upi','cash'
)



      
    ) dbt_internal_test
[0m07:14:31.476062 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:31.895685 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:31.899045 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8 (execute): 07:14:31.470984 => 07:14:31.898622
[0m07:14:31.899668 [debug] [Thread-1  ]: On test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8: Close
[0m07:14:31.992661 [info ] [Thread-1  ]: 13 of 39 PASS accepted_values_bronze_payments_payment_method__debit__credit__upi__cash  [[32mPASS[0m in 0.54s]
[0m07:14:31.993692 [debug] [Thread-1  ]: Finished running node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:14:31.994246 [debug] [Thread-1  ]: Began running node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:14:31.994877 [info ] [Thread-1  ]: 14 of 39 START test accepted_values_bronze_payments_status__fail__success ...... [RUN]
[0m07:14:31.995869 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8, now test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f)
[0m07:14:31.996314 [debug] [Thread-1  ]: Began compiling node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:14:32.003049 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"
[0m07:14:32.003836 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f (compile): 07:14:31.996587 => 07:14:32.003558
[0m07:14:32.004258 [debug] [Thread-1  ]: Began executing node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:14:32.007478 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"
[0m07:14:32.008649 [debug] [Thread-1  ]: Using snowflake connection "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"
[0m07:14:32.009097 [debug] [Thread-1  ]: On test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from external_db.final_sales.bronze_payments
    group by status

)

select *
from all_values
where value_field not in (
    'fail','success'
)



      
    ) dbt_internal_test
[0m07:14:32.009506 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:32.634979 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:14:32.638521 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f (execute): 07:14:32.004527 => 07:14:32.638142
[0m07:14:32.639119 [debug] [Thread-1  ]: On test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f: Close
[0m07:14:32.736483 [info ] [Thread-1  ]: 14 of 39 PASS accepted_values_bronze_payments_status__fail__success ............ [[32mPASS[0m in 0.74s]
[0m07:14:32.737604 [debug] [Thread-1  ]: Finished running node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:14:32.738212 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:14:32.739104 [info ] [Thread-1  ]: 15 of 39 START test not_null_bronze_payments_order_id .......................... [RUN]
[0m07:14:32.740181 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f, now test.development.not_null_bronze_payments_order_id.50ed7cbd9a)
[0m07:14:32.740691 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:14:32.746552 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"
[0m07:14:32.747359 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_order_id.50ed7cbd9a (compile): 07:14:32.741072 => 07:14:32.747083
[0m07:14:32.747772 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:14:32.750969 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"
[0m07:14:32.751969 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"
[0m07:14:32.752406 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_order_id.50ed7cbd9a: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from external_db.final_sales.bronze_payments
where order_id is null



      
    ) dbt_internal_test
[0m07:14:32.752804 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:33.090823 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:33.094239 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_order_id.50ed7cbd9a (execute): 07:14:32.748038 => 07:14:33.093888
[0m07:14:33.094788 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_order_id.50ed7cbd9a: Close
[0m07:14:33.197022 [info ] [Thread-1  ]: 15 of 39 PASS not_null_bronze_payments_order_id ................................ [[32mPASS[0m in 0.46s]
[0m07:14:33.198109 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:14:33.198683 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:14:33.199327 [info ] [Thread-1  ]: 16 of 39 START test not_null_bronze_payments_payment_id ........................ [RUN]
[0m07:14:33.200472 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_order_id.50ed7cbd9a, now test.development.not_null_bronze_payments_payment_id.3473ab0f1f)
[0m07:14:33.200926 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:14:33.206904 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"
[0m07:14:33.207725 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_id.3473ab0f1f (compile): 07:14:33.201203 => 07:14:33.207432
[0m07:14:33.208156 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:14:33.213202 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"
[0m07:14:33.214266 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"
[0m07:14:33.214728 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_payment_id.3473ab0f1f: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from external_db.final_sales.bronze_payments
where payment_id is null



      
    ) dbt_internal_test
[0m07:14:33.215137 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:33.566649 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:33.570484 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_id.3473ab0f1f (execute): 07:14:33.208424 => 07:14:33.570118
[0m07:14:33.571088 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_payment_id.3473ab0f1f: Close
[0m07:14:33.669991 [info ] [Thread-1  ]: 16 of 39 PASS not_null_bronze_payments_payment_id .............................. [[32mPASS[0m in 0.47s]
[0m07:14:33.671773 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:14:33.672788 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:14:33.673494 [info ] [Thread-1  ]: 17 of 39 START test not_null_bronze_payments_payment_method .................... [RUN]
[0m07:14:33.675058 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_payment_id.3473ab0f1f, now test.development.not_null_bronze_payments_payment_method.e5fe6e820b)
[0m07:14:33.675912 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:14:33.682560 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"
[0m07:14:33.683931 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_method.e5fe6e820b (compile): 07:14:33.676405 => 07:14:33.683539
[0m07:14:33.684583 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:14:33.688788 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"
[0m07:14:33.690196 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"
[0m07:14:33.690753 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_payment_method.e5fe6e820b: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_method
from external_db.final_sales.bronze_payments
where payment_method is null



      
    ) dbt_internal_test
[0m07:14:33.691247 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:34.048374 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:34.052010 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_method.e5fe6e820b (execute): 07:14:33.685237 => 07:14:34.051627
[0m07:14:34.052564 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_payment_method.e5fe6e820b: Close
[0m07:14:34.153679 [info ] [Thread-1  ]: 17 of 39 PASS not_null_bronze_payments_payment_method .......................... [[32mPASS[0m in 0.48s]
[0m07:14:34.155064 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:14:34.155691 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:14:34.156157 [info ] [Thread-1  ]: 18 of 39 START test not_null_bronze_payments_status ............................ [RUN]
[0m07:14:34.157278 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_payment_method.e5fe6e820b, now test.development.not_null_bronze_payments_status.4258d38f0c)
[0m07:14:34.157709 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:14:34.163446 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_status.4258d38f0c"
[0m07:14:34.164225 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_status.4258d38f0c (compile): 07:14:34.157973 => 07:14:34.163948
[0m07:14:34.164654 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:14:34.167828 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_payments_status.4258d38f0c"
[0m07:14:34.168806 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_payments_status.4258d38f0c"
[0m07:14:34.169237 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_status.4258d38f0c: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_payments_status.4258d38f0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select status
from external_db.final_sales.bronze_payments
where status is null



      
    ) dbt_internal_test
[0m07:14:34.169629 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:34.488624 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:34.492051 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_status.4258d38f0c (execute): 07:14:34.164923 => 07:14:34.491664
[0m07:14:34.492649 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_status.4258d38f0c: Close
[0m07:14:34.597698 [info ] [Thread-1  ]: 18 of 39 PASS not_null_bronze_payments_status .................................. [[32mPASS[0m in 0.44s]
[0m07:14:34.598763 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:14:34.599327 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:14:34.600061 [info ] [Thread-1  ]: 19 of 39 START test unique_bronze_payments_payment_id .......................... [RUN]
[0m07:14:34.600920 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_status.4258d38f0c, now test.development.unique_bronze_payments_payment_id.537151412e)
[0m07:14:34.601354 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:14:34.607277 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_payments_payment_id.537151412e"
[0m07:14:34.608045 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_payments_payment_id.537151412e (compile): 07:14:34.601623 => 07:14:34.607772
[0m07:14:34.608462 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:14:34.611615 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_bronze_payments_payment_id.537151412e"
[0m07:14:34.612688 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_bronze_payments_payment_id.537151412e"
[0m07:14:34.613118 [debug] [Thread-1  ]: On test.development.unique_bronze_payments_payment_id.537151412e: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_bronze_payments_payment_id.537151412e"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from external_db.final_sales.bronze_payments
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:14:34.613514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:34.994584 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:34.998123 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_payments_payment_id.537151412e (execute): 07:14:34.608727 => 07:14:34.997740
[0m07:14:34.998737 [debug] [Thread-1  ]: On test.development.unique_bronze_payments_payment_id.537151412e: Close
[0m07:14:35.091961 [info ] [Thread-1  ]: 19 of 39 PASS unique_bronze_payments_payment_id ................................ [[32mPASS[0m in 0.49s]
[0m07:14:35.093285 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:14:35.093901 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_products_price.e208481306
[0m07:14:35.094407 [info ] [Thread-1  ]: 20 of 39 START test not_null_bronze_products_price ............................. [RUN]
[0m07:14:35.095822 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_payments_payment_id.537151412e, now test.development.not_null_bronze_products_price.e208481306)
[0m07:14:35.096334 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_products_price.e208481306
[0m07:14:35.102339 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_products_price.e208481306"
[0m07:14:35.103184 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_price.e208481306 (compile): 07:14:35.096641 => 07:14:35.102900
[0m07:14:35.103613 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_products_price.e208481306
[0m07:14:35.108948 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_products_price.e208481306"
[0m07:14:35.110054 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_products_price.e208481306"
[0m07:14:35.110519 [debug] [Thread-1  ]: On test.development.not_null_bronze_products_price.e208481306: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_products_price.e208481306"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from external_db.final_sales.bronze_products
where price is null



      
    ) dbt_internal_test
[0m07:14:35.110946 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:35.454824 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:35.458006 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_price.e208481306 (execute): 07:14:35.103882 => 07:14:35.457681
[0m07:14:35.458501 [debug] [Thread-1  ]: On test.development.not_null_bronze_products_price.e208481306: Close
[0m07:14:35.556090 [info ] [Thread-1  ]: 20 of 39 PASS not_null_bronze_products_price ................................... [[32mPASS[0m in 0.46s]
[0m07:14:35.557787 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_products_price.e208481306
[0m07:14:35.558815 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:14:35.559518 [info ] [Thread-1  ]: 21 of 39 START test not_null_bronze_products_product_id ........................ [RUN]
[0m07:14:35.560951 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_products_price.e208481306, now test.development.not_null_bronze_products_product_id.0e447b9d33)
[0m07:14:35.561754 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:14:35.567827 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_products_product_id.0e447b9d33"
[0m07:14:35.568912 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_product_id.0e447b9d33 (compile): 07:14:35.562120 => 07:14:35.568637
[0m07:14:35.569411 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:14:35.572644 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_products_product_id.0e447b9d33"
[0m07:14:35.573945 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_products_product_id.0e447b9d33"
[0m07:14:35.574475 [debug] [Thread-1  ]: On test.development.not_null_bronze_products_product_id.0e447b9d33: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_products_product_id.0e447b9d33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from external_db.final_sales.bronze_products
where product_id is null



      
    ) dbt_internal_test
[0m07:14:35.575011 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:35.895741 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:35.899185 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_product_id.0e447b9d33 (execute): 07:14:35.569767 => 07:14:35.898832
[0m07:14:35.899754 [debug] [Thread-1  ]: On test.development.not_null_bronze_products_product_id.0e447b9d33: Close
[0m07:14:36.000007 [info ] [Thread-1  ]: 21 of 39 PASS not_null_bronze_products_product_id .............................. [[32mPASS[0m in 0.44s]
[0m07:14:36.001084 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:14:36.001656 [debug] [Thread-1  ]: Began running node test.development.products_price_lower_than_threshold
[0m07:14:36.002293 [info ] [Thread-1  ]: 22 of 39 START test products_price_lower_than_threshold ........................ [RUN]
[0m07:14:36.003296 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_products_product_id.0e447b9d33, now test.development.products_price_lower_than_threshold)
[0m07:14:36.003739 [debug] [Thread-1  ]: Began compiling node test.development.products_price_lower_than_threshold
[0m07:14:36.007703 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.products_price_lower_than_threshold"
[0m07:14:36.008532 [debug] [Thread-1  ]: Timing info for test.development.products_price_lower_than_threshold (compile): 07:14:36.004011 => 07:14:36.008257
[0m07:14:36.008957 [debug] [Thread-1  ]: Began executing node test.development.products_price_lower_than_threshold
[0m07:14:36.012231 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.products_price_lower_than_threshold"
[0m07:14:36.013292 [debug] [Thread-1  ]: Using snowflake connection "test.development.products_price_lower_than_threshold"
[0m07:14:36.013723 [debug] [Thread-1  ]: On test.development.products_price_lower_than_threshold: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.products_price_lower_than_threshold"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
*
FROM
external_db.final_sales.bronze_products
WHERE price < 10
      
    ) dbt_internal_test
[0m07:14:36.014120 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:36.337097 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:36.340454 [debug] [Thread-1  ]: Timing info for test.development.products_price_lower_than_threshold (execute): 07:14:36.009228 => 07:14:36.340108
[0m07:14:36.341020 [debug] [Thread-1  ]: On test.development.products_price_lower_than_threshold: Close
[0m07:14:36.447046 [info ] [Thread-1  ]: 22 of 39 PASS products_price_lower_than_threshold .............................. [[32mPASS[0m in 0.44s]
[0m07:14:36.448480 [debug] [Thread-1  ]: Finished running node test.development.products_price_lower_than_threshold
[0m07:14:36.449252 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:14:36.449935 [info ] [Thread-1  ]: 23 of 39 START test unique_bronze_products_product_id .......................... [RUN]
[0m07:14:36.450983 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.products_price_lower_than_threshold, now test.development.unique_bronze_products_product_id.c17035ba1c)
[0m07:14:36.451446 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:14:36.457721 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_products_product_id.c17035ba1c"
[0m07:14:36.458568 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_products_product_id.c17035ba1c (compile): 07:14:36.451710 => 07:14:36.458272
[0m07:14:36.459046 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:14:36.462252 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_bronze_products_product_id.c17035ba1c"
[0m07:14:36.463381 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_bronze_products_product_id.c17035ba1c"
[0m07:14:36.463820 [debug] [Thread-1  ]: On test.development.unique_bronze_products_product_id.c17035ba1c: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_bronze_products_product_id.c17035ba1c"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from external_db.final_sales.bronze_products
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:14:36.464223 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:36.831638 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:14:36.834833 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_products_product_id.c17035ba1c (execute): 07:14:36.459316 => 07:14:36.834450
[0m07:14:36.835384 [debug] [Thread-1  ]: On test.development.unique_bronze_products_product_id.c17035ba1c: Close
[0m07:14:36.928197 [info ] [Thread-1  ]: 23 of 39 PASS unique_bronze_products_product_id ................................ [[32mPASS[0m in 0.48s]
[0m07:14:36.929215 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:14:36.929781 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m07:14:36.930657 [info ] [Thread-1  ]: 24 of 39 START sql incremental model final_sales.fct_payment_details ........... [RUN]
[0m07:14:36.931946 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_products_product_id.c17035ba1c, now model.development.fct_payment_details)
[0m07:14:36.932388 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m07:14:36.941616 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m07:14:36.942538 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 07:14:36.932653 => 07:14:36.942238
[0m07:14:36.943014 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m07:14:36.949138 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m07:14:36.950383 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:14:36.950847 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace transient table external_db.final_sales.fct_payment_details
         as
        (

with payments as (
    select * from external_db.final_sales.bronze_payments
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_date

    from payments where status = 'success'
)

select * from final
        );
[0m07:14:36.951251 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:37.249030 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad4ef2-0000-fb4f-0001-937e00018f7a
[0m07:14:37.249841 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 15 at position 4
invalid identifier 'RUN_DATE'
[0m07:14:37.250773 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 07:14:36.943283 => 07:14:37.250371
[0m07:14:37.251258 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m07:14:37.353600 [debug] [Thread-1  ]: Database Error in model fct_payment_details (models/sales/silver/fct_payment_details.sql)
  000904 (42000): SQL compilation error: error line 15 at position 4
  invalid identifier 'RUN_DATE'
  compiled Code at target/run/development/models/sales/silver/fct_payment_details.sql
[0m07:14:37.354469 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c68092db-5637-4ddd-983c-51475d099ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3937d550>]}
[0m07:14:37.355307 [error] [Thread-1  ]: 24 of 39 ERROR creating sql incremental model final_sales.fct_payment_details .. [[31mERROR[0m in 0.42s]
[0m07:14:37.355965 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m07:14:37.356503 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m07:14:37.357407 [info ] [Thread-1  ]: 25 of 39 START sql incremental model final_sales.fct_order_detail .............. [RUN]
[0m07:14:37.358614 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m07:14:37.359078 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m07:14:37.365417 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m07:14:37.366212 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 07:14:37.359349 => 07:14:37.365922
[0m07:14:37.366635 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m07:14:37.371024 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m07:14:37.372437 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:14:37.372888 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace transient table external_db.final_sales.fct_order_detail
         as
        (
with orders as (
    select * from external_db.final_sales.bronze_orders
   
),

products as (
    select * from external_db.final_sales.bronze_products
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_date
    from orders
    left join products using (product_id)
)
select * from final
        );
[0m07:14:37.373300 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:14:37.648088 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad4ef2-0000-fb87-0001-937e00019162
[0m07:14:37.648789 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 21 at position 8
invalid identifier 'PRODUCTS.RUN_DATE'
[0m07:14:37.649499 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 07:14:37.366922 => 07:14:37.649223
[0m07:14:37.650589 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m07:14:37.749156 [debug] [Thread-1  ]: Database Error in model fct_order_detail (models/sales/silver/fct_order_detail.sql)
  000904 (42000): SQL compilation error: error line 21 at position 8
  invalid identifier 'PRODUCTS.RUN_DATE'
  compiled Code at target/run/development/models/sales/silver/fct_order_detail.sql
[0m07:14:37.750121 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c68092db-5637-4ddd-983c-51475d099ff0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce393cdb50>]}
[0m07:14:37.751072 [error] [Thread-1  ]: 25 of 39 ERROR creating sql incremental model final_sales.fct_order_detail ..... [[31mERROR[0m in 0.39s]
[0m07:14:37.752354 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m07:14:37.753422 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:14:37.754421 [info ] [Thread-1  ]: 26 of 39 SKIP test not_null_fct_payment_details_order_id ....................... [[33mSKIP[0m]
[0m07:14:37.755461 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:14:37.756055 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:14:37.757070 [info ] [Thread-1  ]: 27 of 39 SKIP test not_null_fct_payment_details_payment_id ..................... [[33mSKIP[0m]
[0m07:14:37.758192 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:14:37.758707 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:14:37.759276 [info ] [Thread-1  ]: 28 of 39 SKIP test not_null_fct_payment_details_payment_method ................. [[33mSKIP[0m]
[0m07:14:37.759832 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:14:37.760310 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:14:37.760864 [info ] [Thread-1  ]: 29 of 39 SKIP test not_null_fct_order_detail_customer_id ....................... [[33mSKIP[0m]
[0m07:14:37.761430 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:14:37.761881 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:14:37.762305 [info ] [Thread-1  ]: 30 of 39 SKIP test not_null_fct_order_detail_order_date ........................ [[33mSKIP[0m]
[0m07:14:37.762865 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:14:37.763320 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:14:37.763742 [info ] [Thread-1  ]: 31 of 39 SKIP test not_null_fct_order_detail_order_id .......................... [[33mSKIP[0m]
[0m07:14:37.764269 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:14:37.767148 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:14:37.767759 [info ] [Thread-1  ]: 32 of 39 SKIP test not_null_fct_order_detail_price ............................. [[33mSKIP[0m]
[0m07:14:37.768801 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:14:37.769666 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:14:37.770299 [info ] [Thread-1  ]: 33 of 39 SKIP test not_null_fct_order_detail_product_id ........................ [[33mSKIP[0m]
[0m07:14:37.771418 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:14:37.771971 [debug] [Thread-1  ]: Began running node test.development.positive_values_fct_order_detail_price.88617de77a
[0m07:14:37.772835 [info ] [Thread-1  ]: 34 of 39 SKIP test positive_values_fct_order_detail_price ...................... [[33mSKIP[0m]
[0m07:14:37.773823 [debug] [Thread-1  ]: Finished running node test.development.positive_values_fct_order_detail_price.88617de77a
[0m07:14:37.774374 [debug] [Thread-1  ]: Began running node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:14:37.775258 [info ] [Thread-1  ]: 35 of 39 SKIP test unique_fct_order_detail_order_id ............................ [[33mSKIP[0m]
[0m07:14:37.776280 [debug] [Thread-1  ]: Finished running node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:14:37.777529 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m07:14:37.778071 [info ] [Thread-1  ]: 36 of 39 SKIP relation final_sales.product_sales ............................... [[33mSKIP[0m]
[0m07:14:37.779298 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m07:14:37.780309 [debug] [Thread-1  ]: Began running node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m07:14:37.780930 [info ] [Thread-1  ]: 37 of 39 SKIP test not_null_product_sales_customer_id .......................... [[33mSKIP[0m]
[0m07:14:37.781559 [debug] [Thread-1  ]: Finished running node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m07:14:37.782054 [debug] [Thread-1  ]: Began running node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m07:14:37.782753 [info ] [Thread-1  ]: 38 of 39 SKIP test not_null_product_sales_order_amount ......................... [[33mSKIP[0m]
[0m07:14:37.783314 [debug] [Thread-1  ]: Finished running node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m07:14:37.783787 [debug] [Thread-1  ]: Began running node test.development.positive_values_product_sales_order_amount.81cc55494d
[0m07:14:37.784322 [info ] [Thread-1  ]: 39 of 39 SKIP test positive_values_product_sales_order_amount .................. [[33mSKIP[0m]
[0m07:14:37.784869 [debug] [Thread-1  ]: Finished running node test.development.positive_values_product_sales_order_amount.81cc55494d
[0m07:14:37.786727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:14:37.787080 [debug] [MainThread]: Connection 'model.development.fct_order_detail' was properly closed.
[0m07:14:37.787516 [info ] [MainThread]: 
[0m07:14:37.787956 [info ] [MainThread]: Finished running 7 incremental models, 32 tests in 0 hours 0 minutes and 18.69 seconds (18.69s).
[0m07:14:37.792679 [debug] [MainThread]: Command end result
[0m07:14:37.803857 [info ] [MainThread]: 
[0m07:14:37.804543 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m07:14:37.804971 [info ] [MainThread]: 
[0m07:14:37.805364 [error] [MainThread]: [33mDatabase Error in model fct_payment_details (models/sales/silver/fct_payment_details.sql)[0m
[0m07:14:37.805747 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 15 at position 4
[0m07:14:37.806113 [error] [MainThread]:   invalid identifier 'RUN_DATE'
[0m07:14:37.806470 [error] [MainThread]:   compiled Code at target/run/development/models/sales/silver/fct_payment_details.sql
[0m07:14:37.806876 [info ] [MainThread]: 
[0m07:14:37.807261 [error] [MainThread]: [33mDatabase Error in model fct_order_detail (models/sales/silver/fct_order_detail.sql)[0m
[0m07:14:37.807626 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 21 at position 8
[0m07:14:37.807987 [error] [MainThread]:   invalid identifier 'PRODUCTS.RUN_DATE'
[0m07:14:37.808342 [error] [MainThread]:   compiled Code at target/run/development/models/sales/silver/fct_order_detail.sql
[0m07:14:37.808763 [info ] [MainThread]: 
[0m07:14:37.809186 [info ] [MainThread]: Done. PASS=23 WARN=0 ERROR=2 SKIP=14 TOTAL=39
[0m07:14:37.812235 [debug] [MainThread]: Command `dbt build` failed at 07:14:37.812064 after 19.09 seconds
[0m07:14:37.812719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce429ed100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce3bbe3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce393c8e20>]}
[0m07:14:37.813187 [debug] [MainThread]: Flushing usage events
[0m07:15:22.946706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3632def100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36316fd910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36316fd850>]}


============================== 07:15:22.950265 | a83c0506-1135-4198-b61f-07f1f313f6ba ==============================
[0m07:15:22.950265 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:15:22.950945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'airflow/dags/dbt/logs', 'profiles_dir': 'airflow/dags/dbt/', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:15:23.231398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a83c0506-1135-4198-b61f-07f1f313f6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362bfc7f70>]}
[0m07:15:23.249542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a83c0506-1135-4198-b61f-07f1f313f6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362bfd2790>]}
[0m07:15:23.264763 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:15:23.290317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m07:15:23.291287 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/silver/fct_order_detail.sql
[0m07:15:23.291854 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/silver/fct_payment_details.sql
[0m07:15:23.317618 [debug] [MainThread]: 1603: static parser failed on sales/silver/fct_order_detail.sql
[0m07:15:23.340508 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/silver/fct_order_detail.sql
[0m07:15:23.343251 [debug] [MainThread]: 1603: static parser failed on sales/silver/fct_payment_details.sql
[0m07:15:23.349681 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/silver/fct_payment_details.sql
[0m07:15:23.433965 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.development.gold
- models.development.bronze
- models.development.silver
- models.development.staging
[0m07:15:23.441263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a83c0506-1135-4198-b61f-07f1f313f6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362bdd00d0>]}
[0m07:15:23.453994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a83c0506-1135-4198-b61f-07f1f313f6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362bef9430>]}
[0m07:15:23.454724 [info ] [MainThread]: Found 7 models, 32 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m07:15:23.458047 [info ] [MainThread]: 
[0m07:15:23.459045 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:15:23.460761 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m07:15:23.479150 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m07:15:23.479805 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m07:15:23.480263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:15:24.128558 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m07:15:24.131482 [debug] [ThreadPool]: On list_external_db: Close
[0m07:15:24.240899 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m07:15:24.250809 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m07:15:24.251369 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m07:15:24.251739 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:15:24.704748 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:15:24.706952 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m07:15:24.812001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a83c0506-1135-4198-b61f-07f1f313f6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362bfd21c0>]}
[0m07:15:24.813256 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:15:24.814416 [info ] [MainThread]: 
[0m07:15:24.819256 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m07:15:24.819994 [info ] [Thread-1  ]: 1 of 39 START sql incremental model final_sales.bronze_customers ............... [RUN]
[0m07:15:24.820988 [debug] [Thread-1  ]: Acquiring new snowflake connection 'model.development.bronze_customers'
[0m07:15:24.821427 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m07:15:24.827565 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m07:15:24.828753 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 07:15:24.821709 => 07:15:24.828447
[0m07:15:24.829277 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m07:15:24.971706 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:15:24.972376 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_timestamp('2023-06-22') as run_ts  from external_db.stage.customers
)

select * from customers
  );
[0m07:15:24.972801 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m07:15:25.351565 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:25.363235 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:15:25.363889 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m07:15:25.434028 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:15:25.439568 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:15:25.440175 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m07:15:25.500473 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:15:25.510682 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:15:25.511347 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m07:15:25.579030 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:15:25.620217 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m07:15:25.623055 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:15:25.623619 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m07:15:25.714472 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:25.715227 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:15:25.715714 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_TS")
    values
        ("VALUE", "CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_TS")

;
[0m07:15:26.450786 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m07:15:26.453410 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:15:26.454435 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m07:15:26.649337 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:26.661626 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:15:26.662282 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m07:15:26.750436 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:26.776302 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 07:15:24.829634 => 07:15:26.776028
[0m07:15:26.776890 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m07:15:26.881563 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a83c0506-1135-4198-b61f-07f1f313f6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362b024f70>]}
[0m07:15:26.883723 [info ] [Thread-1  ]: 1 of 39 OK created sql incremental model final_sales.bronze_customers .......... [[32mSUCCESS 50[0m in 2.06s]
[0m07:15:26.885464 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m07:15:26.889664 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m07:15:26.890637 [info ] [Thread-1  ]: 2 of 39 START sql incremental model final_sales.bronze_orders .................. [RUN]
[0m07:15:26.892107 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m07:15:26.892673 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m07:15:26.897430 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m07:15:26.898447 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 07:15:26.893012 => 07:15:26.898131
[0m07:15:26.898924 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m07:15:26.903548 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:15:26.904044 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.orders
)

select * from orders
  );
[0m07:15:26.904439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:27.304630 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:27.309471 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:15:27.310149 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m07:15:27.402244 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:15:27.407477 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:15:27.408219 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m07:15:27.481498 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:15:27.486817 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:15:27.487575 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m07:15:27.549058 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:15:27.553560 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m07:15:27.555676 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:15:27.556185 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m07:15:27.636971 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:27.637696 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:15:27.638181 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_TS")
    values
        ("VALUE", "ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_TS")

;
[0m07:15:28.384562 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m07:15:28.385683 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:15:28.386310 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m07:15:28.584986 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:28.589701 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:15:28.590199 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m07:15:28.682125 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:28.686106 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 07:15:26.899192 => 07:15:28.685811
[0m07:15:28.686886 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m07:15:28.800264 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a83c0506-1135-4198-b61f-07f1f313f6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362977ad30>]}
[0m07:15:28.801350 [info ] [Thread-1  ]: 2 of 39 OK created sql incremental model final_sales.bronze_orders ............. [[32mSUCCESS 50[0m in 1.91s]
[0m07:15:28.802343 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m07:15:28.802940 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m07:15:28.803963 [info ] [Thread-1  ]: 3 of 39 START sql incremental model final_sales.bronze_payments ................ [RUN]
[0m07:15:28.804957 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m07:15:28.805398 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m07:15:28.810172 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m07:15:28.811323 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 07:15:28.805672 => 07:15:28.811034
[0m07:15:28.811820 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m07:15:28.818497 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:15:28.819085 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.payments
)

select * from payments
  );
[0m07:15:28.819494 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:29.178697 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:29.183277 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:15:29.183901 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m07:15:29.255741 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:15:29.261608 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:15:29.262201 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m07:15:29.355156 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:15:29.360606 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:15:29.361201 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m07:15:29.431600 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:15:29.436088 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m07:15:29.437845 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:15:29.438306 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m07:15:29.528774 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:29.529511 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:15:29.530026 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_TS")
    values
        ("VALUE", "PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_TS")

;
[0m07:15:30.242767 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m07:15:30.243881 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:15:30.244480 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m07:15:30.443972 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:30.448811 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:15:30.449399 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m07:15:30.541527 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:30.545186 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 07:15:28.812175 => 07:15:30.544901
[0m07:15:30.545725 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m07:15:30.648197 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a83c0506-1135-4198-b61f-07f1f313f6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362b024f70>]}
[0m07:15:30.649363 [info ] [Thread-1  ]: 3 of 39 OK created sql incremental model final_sales.bronze_payments ........... [[32mSUCCESS 50[0m in 1.84s]
[0m07:15:30.650298 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m07:15:30.650914 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m07:15:30.651957 [info ] [Thread-1  ]: 4 of 39 START sql incremental model final_sales.bronze_products ................ [RUN]
[0m07:15:30.653364 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m07:15:30.653905 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m07:15:30.658374 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m07:15:30.659204 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 07:15:30.654254 => 07:15:30.658915
[0m07:15:30.659614 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m07:15:30.663926 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:15:30.664377 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.products
)

select * from products
  );
[0m07:15:30.664767 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:31.037622 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:31.041979 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:15:31.042599 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m07:15:31.114563 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:15:31.121106 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:15:31.121664 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m07:15:31.182786 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:15:31.188743 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:15:31.189323 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m07:15:31.272033 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:15:31.276175 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m07:15:31.277754 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:15:31.278325 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m07:15:31.357228 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:31.358017 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:15:31.358545 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "PRODUCT_ID", "PRICE", "RUN_TS")
    values
        ("VALUE", "PRODUCT_ID", "PRICE", "RUN_TS")

;
[0m07:15:32.024909 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m07:15:32.025690 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:15:32.026145 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m07:15:32.287365 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:32.292184 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:15:32.292706 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m07:15:32.385726 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:32.389074 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 07:15:30.659870 => 07:15:32.388824
[0m07:15:32.389553 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m07:15:32.502548 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a83c0506-1135-4198-b61f-07f1f313f6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362b024f70>]}
[0m07:15:32.503610 [info ] [Thread-1  ]: 4 of 39 OK created sql incremental model final_sales.bronze_products ........... [[32mSUCCESS 50[0m in 1.85s]
[0m07:15:32.504452 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m07:15:32.505013 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:15:32.505473 [info ] [Thread-1  ]: 5 of 39 START test not_null_bronze_customers_customer_id ....................... [RUN]
[0m07:15:32.506427 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now test.development.not_null_bronze_customers_customer_id.254c74eb6e)
[0m07:15:32.506910 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:15:32.518350 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_customers_customer_id.254c74eb6e"
[0m07:15:32.519551 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_customer_id.254c74eb6e (compile): 07:15:32.507177 => 07:15:32.519214
[0m07:15:32.519988 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:15:32.537899 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_customers_customer_id.254c74eb6e"
[0m07:15:32.539238 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_customers_customer_id.254c74eb6e"
[0m07:15:32.539778 [debug] [Thread-1  ]: On test.development.not_null_bronze_customers_customer_id.254c74eb6e: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_customers_customer_id.254c74eb6e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from external_db.final_sales.bronze_customers
where customer_id is null



      
    ) dbt_internal_test
[0m07:15:32.540185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:32.850729 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:32.855813 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_customer_id.254c74eb6e (execute): 07:15:32.520252 => 07:15:32.855390
[0m07:15:32.856489 [debug] [Thread-1  ]: On test.development.not_null_bronze_customers_customer_id.254c74eb6e: Close
[0m07:15:32.956420 [info ] [Thread-1  ]: 5 of 39 PASS not_null_bronze_customers_customer_id ............................. [[32mPASS[0m in 0.45s]
[0m07:15:32.957485 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:15:32.958042 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:15:32.958801 [info ] [Thread-1  ]: 6 of 39 START test not_null_bronze_customers_first_name ........................ [RUN]
[0m07:15:32.959821 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_customers_customer_id.254c74eb6e, now test.development.not_null_bronze_customers_first_name.22deabc315)
[0m07:15:32.960257 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:15:32.966205 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_customers_first_name.22deabc315"
[0m07:15:32.967160 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_first_name.22deabc315 (compile): 07:15:32.960521 => 07:15:32.966832
[0m07:15:32.967601 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:15:32.970978 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_customers_first_name.22deabc315"
[0m07:15:32.972046 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_customers_first_name.22deabc315"
[0m07:15:32.972485 [debug] [Thread-1  ]: On test.development.not_null_bronze_customers_first_name.22deabc315: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_customers_first_name.22deabc315"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_name
from external_db.final_sales.bronze_customers
where first_name is null



      
    ) dbt_internal_test
[0m07:15:32.972886 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:33.276453 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:33.279949 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_first_name.22deabc315 (execute): 07:15:32.967863 => 07:15:33.279546
[0m07:15:33.280586 [debug] [Thread-1  ]: On test.development.not_null_bronze_customers_first_name.22deabc315: Close
[0m07:15:33.392392 [info ] [Thread-1  ]: 6 of 39 PASS not_null_bronze_customers_first_name .............................. [[32mPASS[0m in 0.43s]
[0m07:15:33.393388 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:15:33.393927 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:15:33.394536 [info ] [Thread-1  ]: 7 of 39 START test unique_bronze_customers_customer_id ......................... [RUN]
[0m07:15:33.395369 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_customers_first_name.22deabc315, now test.development.unique_bronze_customers_customer_id.f8660c11fe)
[0m07:15:33.395803 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:15:33.406226 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_customers_customer_id.f8660c11fe"
[0m07:15:33.407174 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_customers_customer_id.f8660c11fe (compile): 07:15:33.396062 => 07:15:33.406849
[0m07:15:33.407625 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:15:33.410921 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_bronze_customers_customer_id.f8660c11fe"
[0m07:15:33.412102 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_bronze_customers_customer_id.f8660c11fe"
[0m07:15:33.412541 [debug] [Thread-1  ]: On test.development.unique_bronze_customers_customer_id.f8660c11fe: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_bronze_customers_customer_id.f8660c11fe"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from external_db.final_sales.bronze_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:15:33.412941 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:33.763839 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:33.767561 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_customers_customer_id.f8660c11fe (execute): 07:15:33.407902 => 07:15:33.767156
[0m07:15:33.768445 [debug] [Thread-1  ]: On test.development.unique_bronze_customers_customer_id.f8660c11fe: Close
[0m07:15:33.891841 [info ] [Thread-1  ]: 7 of 39 PASS unique_bronze_customers_customer_id ............................... [[32mPASS[0m in 0.50s]
[0m07:15:33.893990 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:15:33.895485 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:15:33.896497 [info ] [Thread-1  ]: 8 of 39 START test not_null_bronze_orders_customer_id .......................... [RUN]
[0m07:15:33.897877 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_customers_customer_id.f8660c11fe, now test.development.not_null_bronze_orders_customer_id.660ce070b4)
[0m07:15:33.898698 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:15:33.904915 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_customer_id.660ce070b4"
[0m07:15:33.905806 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_customer_id.660ce070b4 (compile): 07:15:33.898995 => 07:15:33.905480
[0m07:15:33.906236 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:15:33.910339 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_orders_customer_id.660ce070b4"
[0m07:15:33.911406 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_orders_customer_id.660ce070b4"
[0m07:15:33.911844 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_customer_id.660ce070b4: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_orders_customer_id.660ce070b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from external_db.final_sales.bronze_orders
where customer_id is null



      
    ) dbt_internal_test
[0m07:15:33.912239 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:34.375672 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:34.379895 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_customer_id.660ce070b4 (execute): 07:15:33.906499 => 07:15:34.379512
[0m07:15:34.380495 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_customer_id.660ce070b4: Close
[0m07:15:34.473047 [info ] [Thread-1  ]: 8 of 39 PASS not_null_bronze_orders_customer_id ................................ [[32mPASS[0m in 0.58s]
[0m07:15:34.474120 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:15:34.474717 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:15:34.475472 [info ] [Thread-1  ]: 9 of 39 START test not_null_bronze_orders_order_date ........................... [RUN]
[0m07:15:34.476455 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_customer_id.660ce070b4, now test.development.not_null_bronze_orders_order_date.d63cfe6df9)
[0m07:15:34.476898 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:15:34.482713 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_order_date.d63cfe6df9"
[0m07:15:34.483538 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_date.d63cfe6df9 (compile): 07:15:34.477165 => 07:15:34.483253
[0m07:15:34.483957 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:15:34.487227 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_orders_order_date.d63cfe6df9"
[0m07:15:34.488307 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_orders_order_date.d63cfe6df9"
[0m07:15:34.488746 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_order_date.d63cfe6df9: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_orders_order_date.d63cfe6df9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from external_db.final_sales.bronze_orders
where order_date is null



      
    ) dbt_internal_test
[0m07:15:34.489140 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:34.920912 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:34.924385 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_date.d63cfe6df9 (execute): 07:15:34.484221 => 07:15:34.923987
[0m07:15:34.924964 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_order_date.d63cfe6df9: Close
[0m07:15:35.027255 [info ] [Thread-1  ]: 9 of 39 PASS not_null_bronze_orders_order_date ................................. [[32mPASS[0m in 0.55s]
[0m07:15:35.028590 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:15:35.030171 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:15:35.031002 [info ] [Thread-1  ]: 10 of 39 START test not_null_bronze_orders_order_id ............................ [RUN]
[0m07:15:35.031999 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_order_date.d63cfe6df9, now test.development.not_null_bronze_orders_order_id.24f68d0dd3)
[0m07:15:35.032441 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:15:35.039112 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_order_id.24f68d0dd3"
[0m07:15:35.040079 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_id.24f68d0dd3 (compile): 07:15:35.032708 => 07:15:35.039750
[0m07:15:35.040517 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:15:35.043924 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_orders_order_id.24f68d0dd3"
[0m07:15:35.044955 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_orders_order_id.24f68d0dd3"
[0m07:15:35.045386 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_order_id.24f68d0dd3: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_orders_order_id.24f68d0dd3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from external_db.final_sales.bronze_orders
where order_id is null



      
    ) dbt_internal_test
[0m07:15:35.045786 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:35.352862 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:35.356043 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_id.24f68d0dd3 (execute): 07:15:35.040803 => 07:15:35.355675
[0m07:15:35.356598 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_order_id.24f68d0dd3: Close
[0m07:15:35.461641 [info ] [Thread-1  ]: 10 of 39 PASS not_null_bronze_orders_order_id .................................. [[32mPASS[0m in 0.43s]
[0m07:15:35.462762 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:15:35.463359 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:15:35.463992 [info ] [Thread-1  ]: 11 of 39 START test not_null_bronze_orders_product_id .......................... [RUN]
[0m07:15:35.464907 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_order_id.24f68d0dd3, now test.development.not_null_bronze_orders_product_id.354934acfc)
[0m07:15:35.465349 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:15:35.473139 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_product_id.354934acfc"
[0m07:15:35.474052 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_product_id.354934acfc (compile): 07:15:35.465619 => 07:15:35.473758
[0m07:15:35.474486 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:15:35.477688 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_orders_product_id.354934acfc"
[0m07:15:35.478744 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_orders_product_id.354934acfc"
[0m07:15:35.479177 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_product_id.354934acfc: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_orders_product_id.354934acfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from external_db.final_sales.bronze_orders
where product_id is null



      
    ) dbt_internal_test
[0m07:15:35.479565 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:35.759292 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:35.762640 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_product_id.354934acfc (execute): 07:15:35.474785 => 07:15:35.762289
[0m07:15:35.763210 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_product_id.354934acfc: Close
[0m07:15:35.854160 [info ] [Thread-1  ]: 11 of 39 PASS not_null_bronze_orders_product_id ................................ [[32mPASS[0m in 0.39s]
[0m07:15:35.856089 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:15:35.857112 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:15:35.857832 [info ] [Thread-1  ]: 12 of 39 START test unique_bronze_orders_order_id .............................. [RUN]
[0m07:15:35.859254 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_product_id.354934acfc, now test.development.unique_bronze_orders_order_id.eec6e86d13)
[0m07:15:35.860214 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:15:35.866969 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_orders_order_id.eec6e86d13"
[0m07:15:35.868027 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_orders_order_id.eec6e86d13 (compile): 07:15:35.860638 => 07:15:35.867667
[0m07:15:35.868596 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:15:35.872572 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_bronze_orders_order_id.eec6e86d13"
[0m07:15:35.874288 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_bronze_orders_order_id.eec6e86d13"
[0m07:15:35.874800 [debug] [Thread-1  ]: On test.development.unique_bronze_orders_order_id.eec6e86d13: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_bronze_orders_order_id.eec6e86d13"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from external_db.final_sales.bronze_orders
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:15:35.875242 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:36.229260 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:36.232499 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_orders_order_id.eec6e86d13 (execute): 07:15:35.868986 => 07:15:36.232147
[0m07:15:36.233038 [debug] [Thread-1  ]: On test.development.unique_bronze_orders_order_id.eec6e86d13: Close
[0m07:15:36.331780 [info ] [Thread-1  ]: 12 of 39 PASS unique_bronze_orders_order_id .................................... [[32mPASS[0m in 0.47s]
[0m07:15:36.332803 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:15:36.333355 [debug] [Thread-1  ]: Began running node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:15:36.333987 [info ] [Thread-1  ]: 13 of 39 START test accepted_values_bronze_payments_payment_method__debit__credit__upi__cash  [RUN]
[0m07:15:36.334920 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_orders_order_id.eec6e86d13, now test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8)
[0m07:15:36.335378 [debug] [Thread-1  ]: Began compiling node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:15:36.347761 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"
[0m07:15:36.348781 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8 (compile): 07:15:36.335651 => 07:15:36.348436
[0m07:15:36.349253 [debug] [Thread-1  ]: Began executing node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:15:36.352813 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"
[0m07:15:36.354069 [debug] [Thread-1  ]: Using snowflake connection "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"
[0m07:15:36.354525 [debug] [Thread-1  ]: On test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from external_db.final_sales.bronze_payments
    group by payment_method

)

select *
from all_values
where value_field not in (
    'debit','credit','upi','cash'
)



      
    ) dbt_internal_test
[0m07:15:36.354985 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:36.709779 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:36.713431 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8 (execute): 07:15:36.349528 => 07:15:36.713084
[0m07:15:36.714119 [debug] [Thread-1  ]: On test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8: Close
[0m07:15:36.819786 [info ] [Thread-1  ]: 13 of 39 PASS accepted_values_bronze_payments_payment_method__debit__credit__upi__cash  [[32mPASS[0m in 0.48s]
[0m07:15:36.822496 [debug] [Thread-1  ]: Finished running node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:15:36.823311 [debug] [Thread-1  ]: Began running node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:15:36.824031 [info ] [Thread-1  ]: 14 of 39 START test accepted_values_bronze_payments_status__fail__success ...... [RUN]
[0m07:15:36.825179 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8, now test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f)
[0m07:15:36.825788 [debug] [Thread-1  ]: Began compiling node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:15:36.834688 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"
[0m07:15:36.835639 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f (compile): 07:15:36.826649 => 07:15:36.835326
[0m07:15:36.836078 [debug] [Thread-1  ]: Began executing node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:15:36.839349 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"
[0m07:15:36.840532 [debug] [Thread-1  ]: Using snowflake connection "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"
[0m07:15:36.841000 [debug] [Thread-1  ]: On test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from external_db.final_sales.bronze_payments
    group by status

)

select *
from all_values
where value_field not in (
    'fail','success'
)



      
    ) dbt_internal_test
[0m07:15:36.841414 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:37.200078 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:37.203418 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f (execute): 07:15:36.836345 => 07:15:37.203031
[0m07:15:37.204018 [debug] [Thread-1  ]: On test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f: Close
[0m07:15:37.308838 [info ] [Thread-1  ]: 14 of 39 PASS accepted_values_bronze_payments_status__fail__success ............ [[32mPASS[0m in 0.48s]
[0m07:15:37.310020 [debug] [Thread-1  ]: Finished running node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:15:37.310761 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:15:37.311454 [info ] [Thread-1  ]: 15 of 39 START test not_null_bronze_payments_order_id .......................... [RUN]
[0m07:15:37.312444 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f, now test.development.not_null_bronze_payments_order_id.50ed7cbd9a)
[0m07:15:37.312894 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:15:37.321733 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"
[0m07:15:37.322615 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_order_id.50ed7cbd9a (compile): 07:15:37.313170 => 07:15:37.322303
[0m07:15:37.323075 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:15:37.326232 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"
[0m07:15:37.327299 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"
[0m07:15:37.327753 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_order_id.50ed7cbd9a: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from external_db.final_sales.bronze_payments
where order_id is null



      
    ) dbt_internal_test
[0m07:15:37.328150 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:37.620760 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:37.624056 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_order_id.50ed7cbd9a (execute): 07:15:37.323337 => 07:15:37.623684
[0m07:15:37.624601 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_order_id.50ed7cbd9a: Close
[0m07:15:37.724631 [info ] [Thread-1  ]: 15 of 39 PASS not_null_bronze_payments_order_id ................................ [[32mPASS[0m in 0.41s]
[0m07:15:37.725782 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:15:37.726415 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:15:37.727401 [info ] [Thread-1  ]: 16 of 39 START test not_null_bronze_payments_payment_id ........................ [RUN]
[0m07:15:37.728495 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_order_id.50ed7cbd9a, now test.development.not_null_bronze_payments_payment_id.3473ab0f1f)
[0m07:15:37.729014 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:15:37.736285 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"
[0m07:15:37.737586 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_id.3473ab0f1f (compile): 07:15:37.729661 => 07:15:37.737239
[0m07:15:37.738110 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:15:37.741532 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"
[0m07:15:37.742931 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"
[0m07:15:37.743443 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_payment_id.3473ab0f1f: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from external_db.final_sales.bronze_payments
where payment_id is null



      
    ) dbt_internal_test
[0m07:15:37.744007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:38.027693 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:38.030940 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_id.3473ab0f1f (execute): 07:15:37.738460 => 07:15:38.030559
[0m07:15:38.031480 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_payment_id.3473ab0f1f: Close
[0m07:15:38.128017 [info ] [Thread-1  ]: 16 of 39 PASS not_null_bronze_payments_payment_id .............................. [[32mPASS[0m in 0.40s]
[0m07:15:38.129372 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:15:38.130015 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:15:38.130620 [info ] [Thread-1  ]: 17 of 39 START test not_null_bronze_payments_payment_method .................... [RUN]
[0m07:15:38.131550 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_payment_id.3473ab0f1f, now test.development.not_null_bronze_payments_payment_method.e5fe6e820b)
[0m07:15:38.131994 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:15:38.137749 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"
[0m07:15:38.138650 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_method.e5fe6e820b (compile): 07:15:38.132262 => 07:15:38.138326
[0m07:15:38.139109 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:15:38.142380 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"
[0m07:15:38.143512 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"
[0m07:15:38.143948 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_payment_method.e5fe6e820b: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_method
from external_db.final_sales.bronze_payments
where payment_method is null



      
    ) dbt_internal_test
[0m07:15:38.144420 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:38.425556 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:38.428978 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_method.e5fe6e820b (execute): 07:15:38.139371 => 07:15:38.428595
[0m07:15:38.429554 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_payment_method.e5fe6e820b: Close
[0m07:15:38.525116 [info ] [Thread-1  ]: 17 of 39 PASS not_null_bronze_payments_payment_method .......................... [[32mPASS[0m in 0.39s]
[0m07:15:38.526220 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:15:38.526872 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:15:38.527749 [info ] [Thread-1  ]: 18 of 39 START test not_null_bronze_payments_status ............................ [RUN]
[0m07:15:38.528687 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_payment_method.e5fe6e820b, now test.development.not_null_bronze_payments_status.4258d38f0c)
[0m07:15:38.529166 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:15:38.535194 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_status.4258d38f0c"
[0m07:15:38.536041 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_status.4258d38f0c (compile): 07:15:38.529461 => 07:15:38.535738
[0m07:15:38.536459 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:15:38.539600 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_payments_status.4258d38f0c"
[0m07:15:38.540604 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_payments_status.4258d38f0c"
[0m07:15:38.541029 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_status.4258d38f0c: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_payments_status.4258d38f0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select status
from external_db.final_sales.bronze_payments
where status is null



      
    ) dbt_internal_test
[0m07:15:38.541414 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:38.825617 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:38.828712 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_status.4258d38f0c (execute): 07:15:38.536720 => 07:15:38.828391
[0m07:15:38.829208 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_status.4258d38f0c: Close
[0m07:15:38.921570 [info ] [Thread-1  ]: 18 of 39 PASS not_null_bronze_payments_status .................................. [[32mPASS[0m in 0.39s]
[0m07:15:38.922613 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:15:38.923210 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:15:38.923835 [info ] [Thread-1  ]: 19 of 39 START test unique_bronze_payments_payment_id .......................... [RUN]
[0m07:15:38.924828 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_status.4258d38f0c, now test.development.unique_bronze_payments_payment_id.537151412e)
[0m07:15:38.925263 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:15:38.933185 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_payments_payment_id.537151412e"
[0m07:15:38.934114 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_payments_payment_id.537151412e (compile): 07:15:38.925531 => 07:15:38.933785
[0m07:15:38.934548 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:15:38.937705 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_bronze_payments_payment_id.537151412e"
[0m07:15:38.938857 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_bronze_payments_payment_id.537151412e"
[0m07:15:38.939296 [debug] [Thread-1  ]: On test.development.unique_bronze_payments_payment_id.537151412e: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_bronze_payments_payment_id.537151412e"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from external_db.final_sales.bronze_payments
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:15:38.939707 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:39.283139 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:39.286526 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_payments_payment_id.537151412e (execute): 07:15:38.934839 => 07:15:39.286140
[0m07:15:39.287118 [debug] [Thread-1  ]: On test.development.unique_bronze_payments_payment_id.537151412e: Close
[0m07:15:39.384763 [info ] [Thread-1  ]: 19 of 39 PASS unique_bronze_payments_payment_id ................................ [[32mPASS[0m in 0.46s]
[0m07:15:39.386715 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:15:39.387702 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_products_price.e208481306
[0m07:15:39.388466 [info ] [Thread-1  ]: 20 of 39 START test not_null_bronze_products_price ............................. [RUN]
[0m07:15:39.389935 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_payments_payment_id.537151412e, now test.development.not_null_bronze_products_price.e208481306)
[0m07:15:39.390846 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_products_price.e208481306
[0m07:15:39.396870 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_products_price.e208481306"
[0m07:15:39.397753 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_price.e208481306 (compile): 07:15:39.391138 => 07:15:39.397444
[0m07:15:39.398231 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_products_price.e208481306
[0m07:15:39.401488 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_products_price.e208481306"
[0m07:15:39.402544 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_products_price.e208481306"
[0m07:15:39.403008 [debug] [Thread-1  ]: On test.development.not_null_bronze_products_price.e208481306: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_products_price.e208481306"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from external_db.final_sales.bronze_products
where price is null



      
    ) dbt_internal_test
[0m07:15:39.403423 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:39.751160 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:39.756373 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_price.e208481306 (execute): 07:15:39.398505 => 07:15:39.755896
[0m07:15:39.757075 [debug] [Thread-1  ]: On test.development.not_null_bronze_products_price.e208481306: Close
[0m07:15:39.853807 [info ] [Thread-1  ]: 20 of 39 PASS not_null_bronze_products_price ................................... [[32mPASS[0m in 0.46s]
[0m07:15:39.855350 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_products_price.e208481306
[0m07:15:39.855988 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:15:39.856685 [info ] [Thread-1  ]: 21 of 39 START test not_null_bronze_products_product_id ........................ [RUN]
[0m07:15:39.857655 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_products_price.e208481306, now test.development.not_null_bronze_products_product_id.0e447b9d33)
[0m07:15:39.858143 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:15:39.863925 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_products_product_id.0e447b9d33"
[0m07:15:39.864755 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_product_id.0e447b9d33 (compile): 07:15:39.858422 => 07:15:39.864468
[0m07:15:39.865172 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:15:39.868347 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_products_product_id.0e447b9d33"
[0m07:15:39.869358 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_products_product_id.0e447b9d33"
[0m07:15:39.869795 [debug] [Thread-1  ]: On test.development.not_null_bronze_products_product_id.0e447b9d33: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_products_product_id.0e447b9d33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from external_db.final_sales.bronze_products
where product_id is null



      
    ) dbt_internal_test
[0m07:15:39.870185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:40.168650 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:40.171938 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_product_id.0e447b9d33 (execute): 07:15:39.865434 => 07:15:40.171572
[0m07:15:40.172494 [debug] [Thread-1  ]: On test.development.not_null_bronze_products_product_id.0e447b9d33: Close
[0m07:15:40.264863 [info ] [Thread-1  ]: 21 of 39 PASS not_null_bronze_products_product_id .............................. [[32mPASS[0m in 0.41s]
[0m07:15:40.266003 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:15:40.266635 [debug] [Thread-1  ]: Began running node test.development.products_price_lower_than_threshold
[0m07:15:40.267491 [info ] [Thread-1  ]: 22 of 39 START test products_price_lower_than_threshold ........................ [RUN]
[0m07:15:40.268550 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_products_product_id.0e447b9d33, now test.development.products_price_lower_than_threshold)
[0m07:15:40.269045 [debug] [Thread-1  ]: Began compiling node test.development.products_price_lower_than_threshold
[0m07:15:40.273211 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.products_price_lower_than_threshold"
[0m07:15:40.273996 [debug] [Thread-1  ]: Timing info for test.development.products_price_lower_than_threshold (compile): 07:15:40.269346 => 07:15:40.273725
[0m07:15:40.274406 [debug] [Thread-1  ]: Began executing node test.development.products_price_lower_than_threshold
[0m07:15:40.277556 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.products_price_lower_than_threshold"
[0m07:15:40.278556 [debug] [Thread-1  ]: Using snowflake connection "test.development.products_price_lower_than_threshold"
[0m07:15:40.279022 [debug] [Thread-1  ]: On test.development.products_price_lower_than_threshold: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.products_price_lower_than_threshold"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
*
FROM
external_db.final_sales.bronze_products
WHERE price < 10
      
    ) dbt_internal_test
[0m07:15:40.279416 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:40.576652 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:40.580103 [debug] [Thread-1  ]: Timing info for test.development.products_price_lower_than_threshold (execute): 07:15:40.274690 => 07:15:40.579764
[0m07:15:40.580721 [debug] [Thread-1  ]: On test.development.products_price_lower_than_threshold: Close
[0m07:15:40.679331 [info ] [Thread-1  ]: 22 of 39 PASS products_price_lower_than_threshold .............................. [[32mPASS[0m in 0.41s]
[0m07:15:40.680395 [debug] [Thread-1  ]: Finished running node test.development.products_price_lower_than_threshold
[0m07:15:40.681324 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:15:40.681782 [info ] [Thread-1  ]: 23 of 39 START test unique_bronze_products_product_id .......................... [RUN]
[0m07:15:40.682878 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.products_price_lower_than_threshold, now test.development.unique_bronze_products_product_id.c17035ba1c)
[0m07:15:40.683319 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:15:40.692532 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_products_product_id.c17035ba1c"
[0m07:15:40.693381 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_products_product_id.c17035ba1c (compile): 07:15:40.683583 => 07:15:40.693092
[0m07:15:40.693805 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:15:40.696930 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_bronze_products_product_id.c17035ba1c"
[0m07:15:40.698044 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_bronze_products_product_id.c17035ba1c"
[0m07:15:40.698498 [debug] [Thread-1  ]: On test.development.unique_bronze_products_product_id.c17035ba1c: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_bronze_products_product_id.c17035ba1c"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from external_db.final_sales.bronze_products
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:15:40.698931 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:41.035079 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:41.038501 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_products_product_id.c17035ba1c (execute): 07:15:40.694074 => 07:15:41.038105
[0m07:15:41.039125 [debug] [Thread-1  ]: On test.development.unique_bronze_products_product_id.c17035ba1c: Close
[0m07:15:41.140980 [info ] [Thread-1  ]: 23 of 39 PASS unique_bronze_products_product_id ................................ [[32mPASS[0m in 0.46s]
[0m07:15:41.142109 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:15:41.142766 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m07:15:41.143794 [info ] [Thread-1  ]: 24 of 39 START sql incremental model final_sales.fct_payment_details ........... [RUN]
[0m07:15:41.144740 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_products_product_id.c17035ba1c, now model.development.fct_payment_details)
[0m07:15:41.145181 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m07:15:41.150271 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m07:15:41.151110 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 07:15:41.145444 => 07:15:41.150815
[0m07:15:41.151526 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m07:15:41.170059 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m07:15:41.171589 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:15:41.172103 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace transient table external_db.final_sales.fct_payment_details
         as
        (

with payments as (
    select * from external_db.final_sales.bronze_payments
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_ts

    from payments where status = 'success'
)

select * from final
        );
[0m07:15:41.172509 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:41.811982 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:15:41.817259 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:15:41.817975 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m07:15:41.886335 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:41.890870 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 07:15:41.151783 => 07:15:41.890569
[0m07:15:41.891397 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m07:15:41.995763 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a83c0506-1135-4198-b61f-07f1f313f6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362be3c610>]}
[0m07:15:41.996826 [info ] [Thread-1  ]: 24 of 39 OK created sql incremental model final_sales.fct_payment_details ...... [[32mSUCCESS 1[0m in 0.85s]
[0m07:15:41.997956 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m07:15:41.998544 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m07:15:41.999446 [info ] [Thread-1  ]: 25 of 39 START sql incremental model final_sales.fct_order_detail .............. [RUN]
[0m07:15:42.000329 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m07:15:42.000769 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m07:15:42.006857 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m07:15:42.007692 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 07:15:42.001033 => 07:15:42.007410
[0m07:15:42.008114 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m07:15:42.012483 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m07:15:42.013842 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:15:42.014286 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace transient table external_db.final_sales.fct_order_detail
         as
        (
with orders as (
    select * from external_db.final_sales.bronze_orders
   
),

products as (
    select * from external_db.final_sales.bronze_products
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_ts
    from orders
    left join products using (product_id)
)
select * from final
        );
[0m07:15:42.014715 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:42.656121 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:15:42.660660 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:15:42.661166 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m07:15:42.720241 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:42.723959 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 07:15:42.008374 => 07:15:42.723669
[0m07:15:42.724521 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m07:15:42.835553 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a83c0506-1135-4198-b61f-07f1f313f6ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362bd869a0>]}
[0m07:15:42.836588 [info ] [Thread-1  ]: 25 of 39 OK created sql incremental model final_sales.fct_order_detail ......... [[32mSUCCESS 1[0m in 0.84s]
[0m07:15:42.837848 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m07:15:42.838420 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:15:42.839524 [info ] [Thread-1  ]: 26 of 39 START test not_null_fct_payment_details_order_id ...................... [RUN]
[0m07:15:42.840880 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now test.development.not_null_fct_payment_details_order_id.7bb58db616)
[0m07:15:42.841507 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:15:42.849155 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_payment_details_order_id.7bb58db616"
[0m07:15:42.850083 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_order_id.7bb58db616 (compile): 07:15:42.841792 => 07:15:42.849770
[0m07:15:42.850532 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:15:42.853985 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_payment_details_order_id.7bb58db616"
[0m07:15:42.855067 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_payment_details_order_id.7bb58db616"
[0m07:15:42.855532 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_order_id.7bb58db616: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_payment_details_order_id.7bb58db616"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from external_db.final_sales.fct_payment_details
where order_id is null



      
    ) dbt_internal_test
[0m07:15:42.855933 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:43.211256 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:43.214445 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_order_id.7bb58db616 (execute): 07:15:42.850816 => 07:15:43.214089
[0m07:15:43.215032 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_order_id.7bb58db616: Close
[0m07:15:43.312366 [info ] [Thread-1  ]: 26 of 39 PASS not_null_fct_payment_details_order_id ............................ [[32mPASS[0m in 0.47s]
[0m07:15:43.313698 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:15:43.314334 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:15:43.314975 [info ] [Thread-1  ]: 27 of 39 START test not_null_fct_payment_details_payment_id .................... [RUN]
[0m07:15:43.315856 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_payment_details_order_id.7bb58db616, now test.development.not_null_fct_payment_details_payment_id.d55bc575d7)
[0m07:15:43.316309 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:15:43.322070 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_payment_details_payment_id.d55bc575d7"
[0m07:15:43.322900 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_id.d55bc575d7 (compile): 07:15:43.316581 => 07:15:43.322591
[0m07:15:43.323339 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:15:43.326766 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_payment_details_payment_id.d55bc575d7"
[0m07:15:43.327801 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_payment_details_payment_id.d55bc575d7"
[0m07:15:43.328237 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_payment_id.d55bc575d7: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_payment_details_payment_id.d55bc575d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from external_db.final_sales.fct_payment_details
where payment_id is null



      
    ) dbt_internal_test
[0m07:15:43.328634 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:43.690408 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:43.694159 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_id.d55bc575d7 (execute): 07:15:43.323615 => 07:15:43.693772
[0m07:15:43.694793 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_payment_id.d55bc575d7: Close
[0m07:15:43.801097 [info ] [Thread-1  ]: 27 of 39 PASS not_null_fct_payment_details_payment_id .......................... [[32mPASS[0m in 0.49s]
[0m07:15:43.802359 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:15:43.802996 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:15:43.803970 [info ] [Thread-1  ]: 28 of 39 START test not_null_fct_payment_details_payment_method ................ [RUN]
[0m07:15:43.805042 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_payment_details_payment_id.d55bc575d7, now test.development.not_null_fct_payment_details_payment_method.62d221c77e)
[0m07:15:43.805494 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:15:43.811573 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_payment_details_payment_method.62d221c77e"
[0m07:15:43.812469 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_method.62d221c77e (compile): 07:15:43.806115 => 07:15:43.812078
[0m07:15:43.812880 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:15:43.816105 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_payment_details_payment_method.62d221c77e"
[0m07:15:43.817125 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_payment_details_payment_method.62d221c77e"
[0m07:15:43.817562 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_payment_method.62d221c77e: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_payment_details_payment_method.62d221c77e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_method
from external_db.final_sales.fct_payment_details
where payment_method is null



      
    ) dbt_internal_test
[0m07:15:43.818144 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:44.141871 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:44.145237 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_method.62d221c77e (execute): 07:15:43.813151 => 07:15:44.144877
[0m07:15:44.145789 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_payment_method.62d221c77e: Close
[0m07:15:44.247428 [info ] [Thread-1  ]: 28 of 39 PASS not_null_fct_payment_details_payment_method ...................... [[32mPASS[0m in 0.44s]
[0m07:15:44.248544 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:15:44.249141 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:15:44.249643 [info ] [Thread-1  ]: 29 of 39 START test not_null_fct_order_detail_customer_id ...................... [RUN]
[0m07:15:44.250562 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_payment_details_payment_method.62d221c77e, now test.development.not_null_fct_order_detail_customer_id.44d928392b)
[0m07:15:44.251251 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:15:44.256894 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_customer_id.44d928392b"
[0m07:15:44.257630 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_customer_id.44d928392b (compile): 07:15:44.251574 => 07:15:44.257372
[0m07:15:44.258035 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:15:44.261135 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_order_detail_customer_id.44d928392b"
[0m07:15:44.262099 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_order_detail_customer_id.44d928392b"
[0m07:15:44.262522 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_customer_id.44d928392b: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_order_detail_customer_id.44d928392b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from external_db.final_sales.fct_order_detail
where customer_id is null



      
    ) dbt_internal_test
[0m07:15:44.262940 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:44.637615 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:44.640994 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_customer_id.44d928392b (execute): 07:15:44.258294 => 07:15:44.640625
[0m07:15:44.641515 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_customer_id.44d928392b: Close
[0m07:15:44.746722 [info ] [Thread-1  ]: 29 of 39 PASS not_null_fct_order_detail_customer_id ............................ [[32mPASS[0m in 0.50s]
[0m07:15:44.748099 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:15:44.748647 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:15:44.749081 [info ] [Thread-1  ]: 30 of 39 START test not_null_fct_order_detail_order_date ....................... [RUN]
[0m07:15:44.750199 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_customer_id.44d928392b, now test.development.not_null_fct_order_detail_order_date.c6f89a052d)
[0m07:15:44.750640 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:15:44.758103 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_order_date.c6f89a052d"
[0m07:15:44.758921 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_date.c6f89a052d (compile): 07:15:44.750941 => 07:15:44.758613
[0m07:15:44.759339 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:15:44.762424 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_order_detail_order_date.c6f89a052d"
[0m07:15:44.763427 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_order_detail_order_date.c6f89a052d"
[0m07:15:44.763853 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_order_date.c6f89a052d: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_order_detail_order_date.c6f89a052d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from external_db.final_sales.fct_order_detail
where order_date is null



      
    ) dbt_internal_test
[0m07:15:44.764243 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:45.228044 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:45.231499 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_date.c6f89a052d (execute): 07:15:44.759600 => 07:15:45.231111
[0m07:15:45.232094 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_order_date.c6f89a052d: Close
[0m07:15:45.334427 [info ] [Thread-1  ]: 30 of 39 PASS not_null_fct_order_detail_order_date ............................. [[32mPASS[0m in 0.58s]
[0m07:15:45.335597 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:15:45.336193 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:15:45.336960 [info ] [Thread-1  ]: 31 of 39 START test not_null_fct_order_detail_order_id ......................... [RUN]
[0m07:15:45.338000 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_order_date.c6f89a052d, now test.development.not_null_fct_order_detail_order_id.47ace119a7)
[0m07:15:45.338483 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:15:45.344075 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_order_id.47ace119a7"
[0m07:15:45.344811 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_id.47ace119a7 (compile): 07:15:45.338806 => 07:15:45.344551
[0m07:15:45.345210 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:15:45.348265 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_order_detail_order_id.47ace119a7"
[0m07:15:45.349230 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_order_detail_order_id.47ace119a7"
[0m07:15:45.349651 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_order_id.47ace119a7: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_order_detail_order_id.47ace119a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from external_db.final_sales.fct_order_detail
where order_id is null



      
    ) dbt_internal_test
[0m07:15:45.350039 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:45.815341 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:45.818748 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_id.47ace119a7 (execute): 07:15:45.345467 => 07:15:45.818357
[0m07:15:45.819308 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_order_id.47ace119a7: Close
[0m07:15:45.915717 [info ] [Thread-1  ]: 31 of 39 PASS not_null_fct_order_detail_order_id ............................... [[32mPASS[0m in 0.58s]
[0m07:15:45.916710 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:15:45.917238 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:15:45.917660 [info ] [Thread-1  ]: 32 of 39 START test not_null_fct_order_detail_price ............................ [RUN]
[0m07:15:45.918447 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_order_id.47ace119a7, now test.development.not_null_fct_order_detail_price.c149ee0e5c)
[0m07:15:45.918877 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:15:45.924592 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_price.c149ee0e5c"
[0m07:15:45.925323 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_price.c149ee0e5c (compile): 07:15:45.919141 => 07:15:45.925062
[0m07:15:45.925726 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:15:45.928809 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_order_detail_price.c149ee0e5c"
[0m07:15:45.929754 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_order_detail_price.c149ee0e5c"
[0m07:15:45.930173 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_price.c149ee0e5c: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_order_detail_price.c149ee0e5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from external_db.final_sales.fct_order_detail
where price is null



      
    ) dbt_internal_test
[0m07:15:45.930558 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:46.294149 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:46.297392 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_price.c149ee0e5c (execute): 07:15:45.925984 => 07:15:46.297040
[0m07:15:46.297924 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_price.c149ee0e5c: Close
[0m07:15:46.399887 [info ] [Thread-1  ]: 32 of 39 PASS not_null_fct_order_detail_price .................................. [[32mPASS[0m in 0.48s]
[0m07:15:46.401001 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:15:46.401603 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:15:46.402290 [info ] [Thread-1  ]: 33 of 39 START test not_null_fct_order_detail_product_id ....................... [RUN]
[0m07:15:46.403350 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_price.c149ee0e5c, now test.development.not_null_fct_order_detail_product_id.73135971e6)
[0m07:15:46.403858 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:15:46.409875 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_product_id.73135971e6"
[0m07:15:46.410610 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_product_id.73135971e6 (compile): 07:15:46.404248 => 07:15:46.410347
[0m07:15:46.411045 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:15:46.414105 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_order_detail_product_id.73135971e6"
[0m07:15:46.415074 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_order_detail_product_id.73135971e6"
[0m07:15:46.415496 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_product_id.73135971e6: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_order_detail_product_id.73135971e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from external_db.final_sales.fct_order_detail
where product_id is null



      
    ) dbt_internal_test
[0m07:15:46.415883 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:46.737925 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:46.741128 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_product_id.73135971e6 (execute): 07:15:46.411317 => 07:15:46.740771
[0m07:15:46.741657 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_product_id.73135971e6: Close
[0m07:15:46.842255 [info ] [Thread-1  ]: 33 of 39 PASS not_null_fct_order_detail_product_id ............................. [[32mPASS[0m in 0.44s]
[0m07:15:46.843316 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:15:46.844191 [debug] [Thread-1  ]: Began running node test.development.positive_values_fct_order_detail_price.88617de77a
[0m07:15:46.844888 [info ] [Thread-1  ]: 34 of 39 START test positive_values_fct_order_detail_price ..................... [RUN]
[0m07:15:46.845940 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_product_id.73135971e6, now test.development.positive_values_fct_order_detail_price.88617de77a)
[0m07:15:46.846428 [debug] [Thread-1  ]: Began compiling node test.development.positive_values_fct_order_detail_price.88617de77a
[0m07:15:46.855201 [debug] [Thread-1  ]: Timing info for test.development.positive_values_fct_order_detail_price.88617de77a (compile): 07:15:46.846744 => 07:15:46.854907
[0m07:15:46.863633 [debug] [Thread-1  ]: Compilation Error in test positive_values_fct_order_detail_price (models/schema.yml)
  'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:15:46.864247 [error] [Thread-1  ]: 34 of 39 ERROR positive_values_fct_order_detail_price .......................... [[31mERROR[0m in 0.02s]
[0m07:15:46.864849 [debug] [Thread-1  ]: Finished running node test.development.positive_values_fct_order_detail_price.88617de77a
[0m07:15:46.865339 [debug] [Thread-1  ]: Began running node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:15:46.865947 [info ] [Thread-1  ]: 35 of 39 START test unique_fct_order_detail_order_id ........................... [RUN]
[0m07:15:46.866723 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.positive_values_fct_order_detail_price.88617de77a, now test.development.unique_fct_order_detail_order_id.256da980ed)
[0m07:15:46.867138 [debug] [Thread-1  ]: Began compiling node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:15:46.872851 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_fct_order_detail_order_id.256da980ed"
[0m07:15:46.873549 [debug] [Thread-1  ]: Timing info for test.development.unique_fct_order_detail_order_id.256da980ed (compile): 07:15:46.867393 => 07:15:46.873294
[0m07:15:46.873939 [debug] [Thread-1  ]: Began executing node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:15:46.876979 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_fct_order_detail_order_id.256da980ed"
[0m07:15:46.878041 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_fct_order_detail_order_id.256da980ed"
[0m07:15:46.878462 [debug] [Thread-1  ]: On test.development.unique_fct_order_detail_order_id.256da980ed: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_fct_order_detail_order_id.256da980ed"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from external_db.final_sales.fct_order_detail
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:15:46.878878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:15:47.249358 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:15:47.252659 [debug] [Thread-1  ]: Timing info for test.development.unique_fct_order_detail_order_id.256da980ed (execute): 07:15:46.874187 => 07:15:47.252298
[0m07:15:47.253203 [debug] [Thread-1  ]: On test.development.unique_fct_order_detail_order_id.256da980ed: Close
[0m07:15:47.346554 [info ] [Thread-1  ]: 35 of 39 PASS unique_fct_order_detail_order_id ................................. [[32mPASS[0m in 0.48s]
[0m07:15:47.348045 [debug] [Thread-1  ]: Finished running node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:15:47.349360 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m07:15:47.350063 [info ] [Thread-1  ]: 36 of 39 SKIP relation final_sales.product_sales ............................... [[33mSKIP[0m]
[0m07:15:47.350890 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m07:15:47.354153 [debug] [Thread-1  ]: Began running node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m07:15:47.354704 [info ] [Thread-1  ]: 37 of 39 SKIP test not_null_product_sales_customer_id .......................... [[33mSKIP[0m]
[0m07:15:47.355285 [debug] [Thread-1  ]: Finished running node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m07:15:47.355766 [debug] [Thread-1  ]: Began running node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m07:15:47.356323 [info ] [Thread-1  ]: 38 of 39 SKIP test not_null_product_sales_order_amount ......................... [[33mSKIP[0m]
[0m07:15:47.356891 [debug] [Thread-1  ]: Finished running node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m07:15:47.357360 [debug] [Thread-1  ]: Began running node test.development.positive_values_product_sales_order_amount.81cc55494d
[0m07:15:47.357900 [info ] [Thread-1  ]: 39 of 39 SKIP test positive_values_product_sales_order_amount .................. [[33mSKIP[0m]
[0m07:15:47.358463 [debug] [Thread-1  ]: Finished running node test.development.positive_values_product_sales_order_amount.81cc55494d
[0m07:15:47.360449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:15:47.360809 [debug] [MainThread]: Connection 'list_external_db_final_sales' was properly closed.
[0m07:15:47.361105 [debug] [MainThread]: Connection 'test.development.unique_fct_order_detail_order_id.256da980ed' was properly closed.
[0m07:15:47.361583 [info ] [MainThread]: 
[0m07:15:47.362031 [info ] [MainThread]: Finished running 7 incremental models, 32 tests in 0 hours 0 minutes and 23.90 seconds (23.90s).
[0m07:15:47.368474 [debug] [MainThread]: Command end result
[0m07:15:47.380009 [info ] [MainThread]: 
[0m07:15:47.380619 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:15:47.381021 [info ] [MainThread]: 
[0m07:15:47.381520 [error] [MainThread]: [33mCompilation Error in test positive_values_fct_order_detail_price (models/schema.yml)[0m
[0m07:15:47.381906 [error] [MainThread]:   'test_positive_values' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m07:15:47.382411 [info ] [MainThread]: 
[0m07:15:47.382876 [info ] [MainThread]: Done. PASS=34 WARN=0 ERROR=1 SKIP=4 TOTAL=39
[0m07:15:47.383817 [debug] [MainThread]: Command `dbt build` failed at 07:15:47.383673 after 24.45 seconds
[0m07:15:47.384279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3632def100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362bfd2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f362bd86970>]}
[0m07:15:47.384804 [debug] [MainThread]: Flushing usage events
[0m07:17:24.760200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a18927040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a17238910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a172382b0>]}


============================== 07:17:24.763814 | 6f5030c2-cde2-466f-9897-388ad3561df0 ==============================
[0m07:17:24.763814 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:17:24.764494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'airflow/dags/dbt/logs', 'debug': 'False', 'profiles_dir': 'airflow/dags/dbt/', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:17:25.062032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f5030c2-cde2-466f-9897-388ad3561df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12b15e80>]}
[0m07:17:25.080156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f5030c2-cde2-466f-9897-388ad3561df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12b1eb20>]}
[0m07:17:25.095805 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:17:25.124062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:17:25.125528 [debug] [MainThread]: Partial parsing: updated file: development://models/schema.yml
[0m07:17:25.152177 [debug] [MainThread]: 1603: static parser failed on sales/gold/product_sales.sql
[0m07:17:25.176828 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/gold/product_sales.sql
[0m07:17:25.179734 [debug] [MainThread]: 1603: static parser failed on sales/silver/fct_order_detail.sql
[0m07:17:25.188290 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/silver/fct_order_detail.sql
[0m07:17:25.260934 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.development.bronze
- models.development.silver
- models.development.staging
- models.development.gold
[0m07:17:25.268104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f5030c2-cde2-466f-9897-388ad3561df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a118ef700>]}
[0m07:17:25.281023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f5030c2-cde2-466f-9897-388ad3561df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12a96610>]}
[0m07:17:25.281810 [info ] [MainThread]: Found 7 models, 30 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m07:17:25.285216 [info ] [MainThread]: 
[0m07:17:25.286247 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:17:25.288083 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m07:17:25.304579 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m07:17:25.305328 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m07:17:25.305801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:17:26.088069 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m07:17:26.090825 [debug] [ThreadPool]: On list_external_db: Close
[0m07:17:26.194838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m07:17:26.204412 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m07:17:26.205004 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m07:17:26.205396 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:17:26.506444 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:17:26.509008 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m07:17:26.610528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f5030c2-cde2-466f-9897-388ad3561df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a11981370>]}
[0m07:17:26.611846 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:17:26.612658 [info ] [MainThread]: 
[0m07:17:26.618796 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m07:17:26.619521 [info ] [Thread-1  ]: 1 of 37 START sql incremental model final_sales.bronze_customers ............... [RUN]
[0m07:17:26.620396 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m07:17:26.620856 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m07:17:26.625934 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m07:17:26.626900 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 07:17:26.621258 => 07:17:26.626558
[0m07:17:26.627450 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m07:17:26.778566 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:17:26.779275 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_timestamp('2023-06-22') as run_ts  from external_db.stage.customers
)

select * from customers
  );
[0m07:17:26.779719 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:27.159141 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:27.169848 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:17:27.170498 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m07:17:27.240444 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:17:27.245454 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:17:27.246107 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m07:17:27.313199 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:17:27.323110 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:17:27.323706 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m07:17:27.383407 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:17:27.420396 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m07:17:27.422139 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:17:27.422643 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m07:17:27.514034 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:27.514829 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:17:27.515372 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_TS")
    values
        ("VALUE", "CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_TS")

;
[0m07:17:28.244998 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m07:17:28.246040 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:17:28.246612 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m07:17:28.433814 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:28.444999 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:17:28.445745 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m07:17:28.550533 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:28.574777 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 07:17:26.627715 => 07:17:28.574483
[0m07:17:28.575357 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m07:17:28.676779 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5030c2-cde2-466f-9897-388ad3561df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a11853f40>]}
[0m07:17:28.677856 [info ] [Thread-1  ]: 1 of 37 OK created sql incremental model final_sales.bronze_customers .......... [[32mSUCCESS 50[0m in 2.06s]
[0m07:17:28.679200 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m07:17:28.679779 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m07:17:28.680770 [info ] [Thread-1  ]: 2 of 37 START sql incremental model final_sales.bronze_orders .................. [RUN]
[0m07:17:28.681867 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m07:17:28.682321 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m07:17:28.687196 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m07:17:28.688273 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 07:17:28.682697 => 07:17:28.687983
[0m07:17:28.688780 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m07:17:28.694948 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:17:28.695527 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.orders
)

select * from orders
  );
[0m07:17:28.696025 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:29.230450 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:17:29.234685 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:17:29.235241 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m07:17:29.308977 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:17:29.313788 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:17:29.314334 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m07:17:29.384406 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:17:29.389544 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:17:29.390194 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m07:17:29.460112 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:17:29.464892 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m07:17:29.466802 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:17:29.467326 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m07:17:29.554163 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:29.554897 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:17:29.555389 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_TS")
    values
        ("VALUE", "ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_TS")

;
[0m07:17:30.254891 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m07:17:30.256057 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:17:30.256725 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m07:17:30.473587 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:30.478268 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:17:30.478781 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m07:17:30.567729 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:30.571366 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 07:17:28.689127 => 07:17:30.571079
[0m07:17:30.571912 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m07:17:30.676887 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5030c2-cde2-466f-9897-388ad3561df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a102e5a60>]}
[0m07:17:30.677988 [info ] [Thread-1  ]: 2 of 37 OK created sql incremental model final_sales.bronze_orders ............. [[32mSUCCESS 50[0m in 2.00s]
[0m07:17:30.678940 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m07:17:30.679519 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m07:17:30.680619 [info ] [Thread-1  ]: 3 of 37 START sql incremental model final_sales.bronze_payments ................ [RUN]
[0m07:17:30.681472 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m07:17:30.681906 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m07:17:30.686408 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m07:17:30.687226 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 07:17:30.682173 => 07:17:30.686950
[0m07:17:30.687644 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m07:17:30.692098 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:17:30.692548 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.payments
)

select * from payments
  );
[0m07:17:30.692941 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:31.064338 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:31.068987 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:17:31.069639 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m07:17:31.154134 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:17:31.161320 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:17:31.161923 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m07:17:31.234991 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:17:31.239840 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:17:31.240348 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m07:17:31.302642 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:17:31.308289 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m07:17:31.309949 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:17:31.310404 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m07:17:31.393204 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:31.394001 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:17:31.394591 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_TS")
    values
        ("VALUE", "PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_TS")

;
[0m07:17:32.080362 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m07:17:32.081193 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:17:32.081706 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m07:17:32.279146 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:32.284209 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:17:32.284818 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m07:17:32.369119 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:32.372865 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 07:17:30.687910 => 07:17:32.372568
[0m07:17:32.373462 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m07:17:32.475563 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5030c2-cde2-466f-9897-388ad3561df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a11902520>]}
[0m07:17:32.476713 [info ] [Thread-1  ]: 3 of 37 OK created sql incremental model final_sales.bronze_payments ........... [[32mSUCCESS 50[0m in 1.79s]
[0m07:17:32.478493 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m07:17:32.479587 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m07:17:32.480666 [info ] [Thread-1  ]: 4 of 37 START sql incremental model final_sales.bronze_products ................ [RUN]
[0m07:17:32.482187 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m07:17:32.483095 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m07:17:32.487951 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m07:17:32.489084 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 07:17:32.483453 => 07:17:32.488754
[0m07:17:32.489588 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m07:17:32.494210 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:17:32.494765 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.products
)

select * from products
  );
[0m07:17:32.495262 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:32.853813 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:32.857892 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:17:32.858476 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m07:17:32.941109 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:17:32.946341 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:17:32.946988 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m07:17:33.013032 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:17:33.018498 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:17:33.019317 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m07:17:33.086505 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:17:33.090680 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m07:17:33.092311 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:17:33.092766 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m07:17:33.172863 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:33.173621 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:17:33.174136 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "PRODUCT_ID", "PRICE", "RUN_TS")
    values
        ("VALUE", "PRODUCT_ID", "PRICE", "RUN_TS")

;
[0m07:17:33.729400 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m07:17:33.730574 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:17:33.731282 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m07:17:33.937888 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:33.942888 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:17:33.943609 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m07:17:34.038258 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:34.041861 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 07:17:32.489931 => 07:17:34.041597
[0m07:17:34.042490 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m07:17:34.149556 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5030c2-cde2-466f-9897-388ad3561df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a11870730>]}
[0m07:17:34.150627 [info ] [Thread-1  ]: 4 of 37 OK created sql incremental model final_sales.bronze_products ........... [[32mSUCCESS 50[0m in 1.67s]
[0m07:17:34.151522 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m07:17:34.152083 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:17:34.152768 [info ] [Thread-1  ]: 5 of 37 START test not_null_bronze_customers_customer_id ....................... [RUN]
[0m07:17:34.154038 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now test.development.not_null_bronze_customers_customer_id.254c74eb6e)
[0m07:17:34.154481 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:17:34.169750 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_customers_customer_id.254c74eb6e"
[0m07:17:34.170765 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_customer_id.254c74eb6e (compile): 07:17:34.154779 => 07:17:34.170402
[0m07:17:34.171251 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:17:34.189187 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_customers_customer_id.254c74eb6e"
[0m07:17:34.190467 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_customers_customer_id.254c74eb6e"
[0m07:17:34.190989 [debug] [Thread-1  ]: On test.development.not_null_bronze_customers_customer_id.254c74eb6e: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_customers_customer_id.254c74eb6e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from external_db.final_sales.bronze_customers
where customer_id is null



      
    ) dbt_internal_test
[0m07:17:34.191410 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:34.491440 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:34.496150 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_customer_id.254c74eb6e (execute): 07:17:34.171540 => 07:17:34.495744
[0m07:17:34.496757 [debug] [Thread-1  ]: On test.development.not_null_bronze_customers_customer_id.254c74eb6e: Close
[0m07:17:34.595459 [info ] [Thread-1  ]: 5 of 37 PASS not_null_bronze_customers_customer_id ............................. [[32mPASS[0m in 0.44s]
[0m07:17:34.597944 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:17:34.598566 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:17:34.599271 [info ] [Thread-1  ]: 6 of 37 START test not_null_bronze_customers_first_name ........................ [RUN]
[0m07:17:34.600524 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_customers_customer_id.254c74eb6e, now test.development.not_null_bronze_customers_first_name.22deabc315)
[0m07:17:34.601080 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:17:34.611160 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_customers_first_name.22deabc315"
[0m07:17:34.612188 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_first_name.22deabc315 (compile): 07:17:34.604578 => 07:17:34.611856
[0m07:17:34.612661 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:17:34.616308 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_customers_first_name.22deabc315"
[0m07:17:34.617473 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_customers_first_name.22deabc315"
[0m07:17:34.617938 [debug] [Thread-1  ]: On test.development.not_null_bronze_customers_first_name.22deabc315: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_customers_first_name.22deabc315"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_name
from external_db.final_sales.bronze_customers
where first_name is null



      
    ) dbt_internal_test
[0m07:17:34.618340 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:34.923456 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:34.927025 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_first_name.22deabc315 (execute): 07:17:34.612938 => 07:17:34.926630
[0m07:17:34.927595 [debug] [Thread-1  ]: On test.development.not_null_bronze_customers_first_name.22deabc315: Close
[0m07:17:35.031670 [info ] [Thread-1  ]: 6 of 37 PASS not_null_bronze_customers_first_name .............................. [[32mPASS[0m in 0.43s]
[0m07:17:35.032743 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:17:35.033316 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:17:35.033954 [info ] [Thread-1  ]: 7 of 37 START test unique_bronze_customers_customer_id ......................... [RUN]
[0m07:17:35.034887 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_customers_first_name.22deabc315, now test.development.unique_bronze_customers_customer_id.f8660c11fe)
[0m07:17:35.035361 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:17:35.044300 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_customers_customer_id.f8660c11fe"
[0m07:17:35.045219 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_customers_customer_id.f8660c11fe (compile): 07:17:35.035638 => 07:17:35.044909
[0m07:17:35.045660 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:17:35.048975 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_bronze_customers_customer_id.f8660c11fe"
[0m07:17:35.050171 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_bronze_customers_customer_id.f8660c11fe"
[0m07:17:35.050723 [debug] [Thread-1  ]: On test.development.unique_bronze_customers_customer_id.f8660c11fe: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_bronze_customers_customer_id.f8660c11fe"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from external_db.final_sales.bronze_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:17:35.051153 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:35.379485 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:35.383026 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_customers_customer_id.f8660c11fe (execute): 07:17:35.045930 => 07:17:35.382618
[0m07:17:35.383594 [debug] [Thread-1  ]: On test.development.unique_bronze_customers_customer_id.f8660c11fe: Close
[0m07:17:35.478969 [info ] [Thread-1  ]: 7 of 37 PASS unique_bronze_customers_customer_id ............................... [[32mPASS[0m in 0.44s]
[0m07:17:35.480090 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:17:35.480713 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:17:35.481316 [info ] [Thread-1  ]: 8 of 37 START test not_null_bronze_orders_customer_id .......................... [RUN]
[0m07:17:35.482175 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_customers_customer_id.f8660c11fe, now test.development.not_null_bronze_orders_customer_id.660ce070b4)
[0m07:17:35.482611 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:17:35.488677 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_customer_id.660ce070b4"
[0m07:17:35.489521 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_customer_id.660ce070b4 (compile): 07:17:35.482902 => 07:17:35.489214
[0m07:17:35.489944 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:17:35.493258 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_orders_customer_id.660ce070b4"
[0m07:17:35.494355 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_orders_customer_id.660ce070b4"
[0m07:17:35.494810 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_customer_id.660ce070b4: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_orders_customer_id.660ce070b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from external_db.final_sales.bronze_orders
where customer_id is null



      
    ) dbt_internal_test
[0m07:17:35.495230 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:35.804019 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:35.807348 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_customer_id.660ce070b4 (execute): 07:17:35.490209 => 07:17:35.806990
[0m07:17:35.807868 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_customer_id.660ce070b4: Close
[0m07:17:35.910352 [info ] [Thread-1  ]: 8 of 37 PASS not_null_bronze_orders_customer_id ................................ [[32mPASS[0m in 0.43s]
[0m07:17:35.911406 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:17:35.911950 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:17:35.912582 [info ] [Thread-1  ]: 9 of 37 START test not_null_bronze_orders_order_date ........................... [RUN]
[0m07:17:35.913452 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_customer_id.660ce070b4, now test.development.not_null_bronze_orders_order_date.d63cfe6df9)
[0m07:17:35.913885 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:17:35.919638 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_order_date.d63cfe6df9"
[0m07:17:35.920477 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_date.d63cfe6df9 (compile): 07:17:35.914159 => 07:17:35.920173
[0m07:17:35.920896 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:17:35.924097 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_orders_order_date.d63cfe6df9"
[0m07:17:35.925153 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_orders_order_date.d63cfe6df9"
[0m07:17:35.925583 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_order_date.d63cfe6df9: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_orders_order_date.d63cfe6df9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from external_db.final_sales.bronze_orders
where order_date is null



      
    ) dbt_internal_test
[0m07:17:35.925976 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:36.378902 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:36.382350 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_date.d63cfe6df9 (execute): 07:17:35.921158 => 07:17:36.381996
[0m07:17:36.382901 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_order_date.d63cfe6df9: Close
[0m07:17:36.483820 [info ] [Thread-1  ]: 9 of 37 PASS not_null_bronze_orders_order_date ................................. [[32mPASS[0m in 0.57s]
[0m07:17:36.484926 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:17:36.485464 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:17:36.486075 [info ] [Thread-1  ]: 10 of 37 START test not_null_bronze_orders_order_id ............................ [RUN]
[0m07:17:36.486965 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_order_date.d63cfe6df9, now test.development.not_null_bronze_orders_order_id.24f68d0dd3)
[0m07:17:36.487404 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:17:36.493081 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_order_id.24f68d0dd3"
[0m07:17:36.493922 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_id.24f68d0dd3 (compile): 07:17:36.487685 => 07:17:36.493619
[0m07:17:36.494339 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:17:36.497480 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_orders_order_id.24f68d0dd3"
[0m07:17:36.498534 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_orders_order_id.24f68d0dd3"
[0m07:17:36.498990 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_order_id.24f68d0dd3: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_orders_order_id.24f68d0dd3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from external_db.final_sales.bronze_orders
where order_id is null



      
    ) dbt_internal_test
[0m07:17:36.499386 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:36.786445 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:36.789902 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_id.24f68d0dd3 (execute): 07:17:36.494600 => 07:17:36.789511
[0m07:17:36.790490 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_order_id.24f68d0dd3: Close
[0m07:17:36.884234 [info ] [Thread-1  ]: 10 of 37 PASS not_null_bronze_orders_order_id .................................. [[32mPASS[0m in 0.40s]
[0m07:17:36.885287 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:17:36.885841 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:17:36.886607 [info ] [Thread-1  ]: 11 of 37 START test not_null_bronze_orders_product_id .......................... [RUN]
[0m07:17:36.887556 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_order_id.24f68d0dd3, now test.development.not_null_bronze_orders_product_id.354934acfc)
[0m07:17:36.887997 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:17:36.893726 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_product_id.354934acfc"
[0m07:17:36.894572 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_product_id.354934acfc (compile): 07:17:36.888268 => 07:17:36.894266
[0m07:17:36.895018 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:17:36.898158 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_orders_product_id.354934acfc"
[0m07:17:36.899200 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_orders_product_id.354934acfc"
[0m07:17:36.899633 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_product_id.354934acfc: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_orders_product_id.354934acfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from external_db.final_sales.bronze_orders
where product_id is null



      
    ) dbt_internal_test
[0m07:17:36.900025 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:37.184001 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:37.187532 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_product_id.354934acfc (execute): 07:17:36.895281 => 07:17:37.187115
[0m07:17:37.188173 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_product_id.354934acfc: Close
[0m07:17:37.283949 [info ] [Thread-1  ]: 11 of 37 PASS not_null_bronze_orders_product_id ................................ [[32mPASS[0m in 0.40s]
[0m07:17:37.284968 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:17:37.285512 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:17:37.286448 [info ] [Thread-1  ]: 12 of 37 START test unique_bronze_orders_order_id .............................. [RUN]
[0m07:17:37.287531 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_product_id.354934acfc, now test.development.unique_bronze_orders_order_id.eec6e86d13)
[0m07:17:37.287974 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:17:37.294263 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_orders_order_id.eec6e86d13"
[0m07:17:37.295118 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_orders_order_id.eec6e86d13 (compile): 07:17:37.288550 => 07:17:37.294808
[0m07:17:37.295539 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:17:37.298707 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_bronze_orders_order_id.eec6e86d13"
[0m07:17:37.299847 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_bronze_orders_order_id.eec6e86d13"
[0m07:17:37.300284 [debug] [Thread-1  ]: On test.development.unique_bronze_orders_order_id.eec6e86d13: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_bronze_orders_order_id.eec6e86d13"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from external_db.final_sales.bronze_orders
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:17:37.300775 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:37.669574 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:37.673127 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_orders_order_id.eec6e86d13 (execute): 07:17:37.295803 => 07:17:37.672782
[0m07:17:37.673649 [debug] [Thread-1  ]: On test.development.unique_bronze_orders_order_id.eec6e86d13: Close
[0m07:17:37.779602 [info ] [Thread-1  ]: 12 of 37 PASS unique_bronze_orders_order_id .................................... [[32mPASS[0m in 0.49s]
[0m07:17:37.780731 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:17:37.781273 [debug] [Thread-1  ]: Began running node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:17:37.781896 [info ] [Thread-1  ]: 13 of 37 START test accepted_values_bronze_payments_payment_method__debit__credit__upi__cash  [RUN]
[0m07:17:37.782864 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_orders_order_id.eec6e86d13, now test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8)
[0m07:17:37.783311 [debug] [Thread-1  ]: Began compiling node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:17:37.795534 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"
[0m07:17:37.796458 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8 (compile): 07:17:37.783582 => 07:17:37.796130
[0m07:17:37.796904 [debug] [Thread-1  ]: Began executing node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:17:37.800192 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"
[0m07:17:37.801467 [debug] [Thread-1  ]: Using snowflake connection "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"
[0m07:17:37.801927 [debug] [Thread-1  ]: On test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from external_db.final_sales.bronze_payments
    group by payment_method

)

select *
from all_values
where value_field not in (
    'debit','credit','upi','cash'
)



      
    ) dbt_internal_test
[0m07:17:37.802342 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:38.172500 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:38.175698 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8 (execute): 07:17:37.797184 => 07:17:38.175345
[0m07:17:38.176248 [debug] [Thread-1  ]: On test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8: Close
[0m07:17:38.276766 [info ] [Thread-1  ]: 13 of 37 PASS accepted_values_bronze_payments_payment_method__debit__credit__upi__cash  [[32mPASS[0m in 0.49s]
[0m07:17:38.278555 [debug] [Thread-1  ]: Finished running node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:17:38.279580 [debug] [Thread-1  ]: Began running node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:17:38.280318 [info ] [Thread-1  ]: 14 of 37 START test accepted_values_bronze_payments_status__fail__success ...... [RUN]
[0m07:17:38.281786 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8, now test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f)
[0m07:17:38.283090 [debug] [Thread-1  ]: Began compiling node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:17:38.290353 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"
[0m07:17:38.291576 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f (compile): 07:17:38.283457 => 07:17:38.291260
[0m07:17:38.292088 [debug] [Thread-1  ]: Began executing node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:17:38.295772 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"
[0m07:17:38.297344 [debug] [Thread-1  ]: Using snowflake connection "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"
[0m07:17:38.297867 [debug] [Thread-1  ]: On test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from external_db.final_sales.bronze_payments
    group by status

)

select *
from all_values
where value_field not in (
    'fail','success'
)



      
    ) dbt_internal_test
[0m07:17:38.298404 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:38.632626 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:38.635904 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f (execute): 07:17:38.292432 => 07:17:38.635524
[0m07:17:38.636469 [debug] [Thread-1  ]: On test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f: Close
[0m07:17:38.727490 [info ] [Thread-1  ]: 14 of 37 PASS accepted_values_bronze_payments_status__fail__success ............ [[32mPASS[0m in 0.45s]
[0m07:17:38.728848 [debug] [Thread-1  ]: Finished running node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:17:38.729489 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:17:38.730104 [info ] [Thread-1  ]: 15 of 37 START test not_null_bronze_payments_order_id .......................... [RUN]
[0m07:17:38.730971 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f, now test.development.not_null_bronze_payments_order_id.50ed7cbd9a)
[0m07:17:38.731410 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:17:38.737130 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"
[0m07:17:38.737928 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_order_id.50ed7cbd9a (compile): 07:17:38.731680 => 07:17:38.737649
[0m07:17:38.738345 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:17:38.741508 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"
[0m07:17:38.742514 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"
[0m07:17:38.742984 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_order_id.50ed7cbd9a: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from external_db.final_sales.bronze_payments
where order_id is null



      
    ) dbt_internal_test
[0m07:17:38.743382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:39.050935 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:39.054316 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_order_id.50ed7cbd9a (execute): 07:17:38.738609 => 07:17:39.053913
[0m07:17:39.054963 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_order_id.50ed7cbd9a: Close
[0m07:17:39.159390 [info ] [Thread-1  ]: 15 of 37 PASS not_null_bronze_payments_order_id ................................ [[32mPASS[0m in 0.43s]
[0m07:17:39.160445 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:17:39.161272 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:17:39.161815 [info ] [Thread-1  ]: 16 of 37 START test not_null_bronze_payments_payment_id ........................ [RUN]
[0m07:17:39.163415 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_order_id.50ed7cbd9a, now test.development.not_null_bronze_payments_payment_id.3473ab0f1f)
[0m07:17:39.163919 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:17:39.169842 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"
[0m07:17:39.170697 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_id.3473ab0f1f (compile): 07:17:39.164198 => 07:17:39.170383
[0m07:17:39.171130 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:17:39.174297 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"
[0m07:17:39.175355 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"
[0m07:17:39.175784 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_payment_id.3473ab0f1f: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from external_db.final_sales.bronze_payments
where payment_id is null



      
    ) dbt_internal_test
[0m07:17:39.176175 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:39.470842 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:39.474283 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_id.3473ab0f1f (execute): 07:17:39.171409 => 07:17:39.473815
[0m07:17:39.474943 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_payment_id.3473ab0f1f: Close
[0m07:17:39.581177 [info ] [Thread-1  ]: 16 of 37 PASS not_null_bronze_payments_payment_id .............................. [[32mPASS[0m in 0.42s]
[0m07:17:39.582725 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:17:39.583868 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:17:39.584615 [info ] [Thread-1  ]: 17 of 37 START test not_null_bronze_payments_payment_method .................... [RUN]
[0m07:17:39.585783 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_payment_id.3473ab0f1f, now test.development.not_null_bronze_payments_payment_method.e5fe6e820b)
[0m07:17:39.586554 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:17:39.592498 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"
[0m07:17:39.593684 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_method.e5fe6e820b (compile): 07:17:39.586986 => 07:17:39.593364
[0m07:17:39.594195 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:17:39.597481 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"
[0m07:17:39.598867 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"
[0m07:17:39.599380 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_payment_method.e5fe6e820b: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_method
from external_db.final_sales.bronze_payments
where payment_method is null



      
    ) dbt_internal_test
[0m07:17:39.599864 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:39.881928 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:39.885117 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_method.e5fe6e820b (execute): 07:17:39.594540 => 07:17:39.884758
[0m07:17:39.885659 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_payment_method.e5fe6e820b: Close
[0m07:17:39.983136 [info ] [Thread-1  ]: 17 of 37 PASS not_null_bronze_payments_payment_method .......................... [[32mPASS[0m in 0.40s]
[0m07:17:39.984161 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:17:39.984694 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:17:39.985331 [info ] [Thread-1  ]: 18 of 37 START test not_null_bronze_payments_status ............................ [RUN]
[0m07:17:39.986240 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_payment_method.e5fe6e820b, now test.development.not_null_bronze_payments_status.4258d38f0c)
[0m07:17:39.986691 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:17:39.993234 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_status.4258d38f0c"
[0m07:17:39.994049 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_status.4258d38f0c (compile): 07:17:39.987267 => 07:17:39.993773
[0m07:17:39.994478 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:17:39.997678 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_payments_status.4258d38f0c"
[0m07:17:39.998688 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_payments_status.4258d38f0c"
[0m07:17:39.999124 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_status.4258d38f0c: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_payments_status.4258d38f0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select status
from external_db.final_sales.bronze_payments
where status is null



      
    ) dbt_internal_test
[0m07:17:39.999514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:40.446459 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:40.450001 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_status.4258d38f0c (execute): 07:17:39.994781 => 07:17:40.449644
[0m07:17:40.450553 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_status.4258d38f0c: Close
[0m07:17:40.563805 [info ] [Thread-1  ]: 18 of 37 PASS not_null_bronze_payments_status .................................. [[32mPASS[0m in 0.58s]
[0m07:17:40.564897 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:17:40.565460 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:17:40.566325 [info ] [Thread-1  ]: 19 of 37 START test unique_bronze_payments_payment_id .......................... [RUN]
[0m07:17:40.567199 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_status.4258d38f0c, now test.development.unique_bronze_payments_payment_id.537151412e)
[0m07:17:40.567637 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:17:40.573640 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_payments_payment_id.537151412e"
[0m07:17:40.574445 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_payments_payment_id.537151412e (compile): 07:17:40.567905 => 07:17:40.574150
[0m07:17:40.574900 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:17:40.578081 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_bronze_payments_payment_id.537151412e"
[0m07:17:40.579197 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_bronze_payments_payment_id.537151412e"
[0m07:17:40.579645 [debug] [Thread-1  ]: On test.development.unique_bronze_payments_payment_id.537151412e: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_bronze_payments_payment_id.537151412e"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from external_db.final_sales.bronze_payments
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:17:40.580046 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:40.947254 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:40.950632 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_payments_payment_id.537151412e (execute): 07:17:40.575170 => 07:17:40.950286
[0m07:17:40.951187 [debug] [Thread-1  ]: On test.development.unique_bronze_payments_payment_id.537151412e: Close
[0m07:17:41.051077 [info ] [Thread-1  ]: 19 of 37 PASS unique_bronze_payments_payment_id ................................ [[32mPASS[0m in 0.48s]
[0m07:17:41.052609 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:17:41.053215 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_products_price.e208481306
[0m07:17:41.053826 [info ] [Thread-1  ]: 20 of 37 START test not_null_bronze_products_price ............................. [RUN]
[0m07:17:41.055091 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_payments_payment_id.537151412e, now test.development.not_null_bronze_products_price.e208481306)
[0m07:17:41.055551 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_products_price.e208481306
[0m07:17:41.062038 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_products_price.e208481306"
[0m07:17:41.063138 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_price.e208481306 (compile): 07:17:41.056002 => 07:17:41.062812
[0m07:17:41.063603 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_products_price.e208481306
[0m07:17:41.067032 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_products_price.e208481306"
[0m07:17:41.068194 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_products_price.e208481306"
[0m07:17:41.068832 [debug] [Thread-1  ]: On test.development.not_null_bronze_products_price.e208481306: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_products_price.e208481306"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from external_db.final_sales.bronze_products
where price is null



      
    ) dbt_internal_test
[0m07:17:41.069256 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:41.365156 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:41.368583 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_price.e208481306 (execute): 07:17:41.063873 => 07:17:41.368192
[0m07:17:41.369174 [debug] [Thread-1  ]: On test.development.not_null_bronze_products_price.e208481306: Close
[0m07:17:41.471204 [info ] [Thread-1  ]: 20 of 37 PASS not_null_bronze_products_price ................................... [[32mPASS[0m in 0.42s]
[0m07:17:41.472634 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_products_price.e208481306
[0m07:17:41.473431 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:17:41.473957 [info ] [Thread-1  ]: 21 of 37 START test not_null_bronze_products_product_id ........................ [RUN]
[0m07:17:41.475193 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_products_price.e208481306, now test.development.not_null_bronze_products_product_id.0e447b9d33)
[0m07:17:41.475667 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:17:41.481599 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_products_product_id.0e447b9d33"
[0m07:17:41.482436 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_product_id.0e447b9d33 (compile): 07:17:41.475939 => 07:17:41.482148
[0m07:17:41.482914 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:17:41.486078 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_products_product_id.0e447b9d33"
[0m07:17:41.487153 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_products_product_id.0e447b9d33"
[0m07:17:41.487593 [debug] [Thread-1  ]: On test.development.not_null_bronze_products_product_id.0e447b9d33: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_products_product_id.0e447b9d33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from external_db.final_sales.bronze_products
where product_id is null



      
    ) dbt_internal_test
[0m07:17:41.487990 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:41.783797 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:41.787364 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_product_id.0e447b9d33 (execute): 07:17:41.483188 => 07:17:41.786939
[0m07:17:41.788010 [debug] [Thread-1  ]: On test.development.not_null_bronze_products_product_id.0e447b9d33: Close
[0m07:17:41.890438 [info ] [Thread-1  ]: 21 of 37 PASS not_null_bronze_products_product_id .............................. [[32mPASS[0m in 0.42s]
[0m07:17:41.891898 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:17:41.892601 [debug] [Thread-1  ]: Began running node test.development.products_price_lower_than_threshold
[0m07:17:41.893307 [info ] [Thread-1  ]: 22 of 37 START test products_price_lower_than_threshold ........................ [RUN]
[0m07:17:41.894313 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_products_product_id.0e447b9d33, now test.development.products_price_lower_than_threshold)
[0m07:17:41.894769 [debug] [Thread-1  ]: Began compiling node test.development.products_price_lower_than_threshold
[0m07:17:41.898752 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.products_price_lower_than_threshold"
[0m07:17:41.900520 [debug] [Thread-1  ]: Timing info for test.development.products_price_lower_than_threshold (compile): 07:17:41.895044 => 07:17:41.900212
[0m07:17:41.900937 [debug] [Thread-1  ]: Began executing node test.development.products_price_lower_than_threshold
[0m07:17:41.904217 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.products_price_lower_than_threshold"
[0m07:17:41.905269 [debug] [Thread-1  ]: Using snowflake connection "test.development.products_price_lower_than_threshold"
[0m07:17:41.905706 [debug] [Thread-1  ]: On test.development.products_price_lower_than_threshold: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.products_price_lower_than_threshold"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
*
FROM
external_db.final_sales.bronze_products
WHERE price < 10
      
    ) dbt_internal_test
[0m07:17:41.906111 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:42.175256 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:42.180688 [debug] [Thread-1  ]: Timing info for test.development.products_price_lower_than_threshold (execute): 07:17:41.901194 => 07:17:42.180274
[0m07:17:42.181300 [debug] [Thread-1  ]: On test.development.products_price_lower_than_threshold: Close
[0m07:17:42.275812 [info ] [Thread-1  ]: 22 of 37 PASS products_price_lower_than_threshold .............................. [[32mPASS[0m in 0.38s]
[0m07:17:42.277976 [debug] [Thread-1  ]: Finished running node test.development.products_price_lower_than_threshold
[0m07:17:42.278872 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:17:42.279473 [info ] [Thread-1  ]: 23 of 37 START test unique_bronze_products_product_id .......................... [RUN]
[0m07:17:42.280625 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.products_price_lower_than_threshold, now test.development.unique_bronze_products_product_id.c17035ba1c)
[0m07:17:42.281189 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:17:42.287750 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_products_product_id.c17035ba1c"
[0m07:17:42.288666 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_products_product_id.c17035ba1c (compile): 07:17:42.281669 => 07:17:42.288359
[0m07:17:42.289114 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:17:42.292508 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_bronze_products_product_id.c17035ba1c"
[0m07:17:42.293742 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_bronze_products_product_id.c17035ba1c"
[0m07:17:42.294216 [debug] [Thread-1  ]: On test.development.unique_bronze_products_product_id.c17035ba1c: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_bronze_products_product_id.c17035ba1c"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from external_db.final_sales.bronze_products
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:17:42.294628 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:42.626857 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:42.630059 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_products_product_id.c17035ba1c (execute): 07:17:42.289388 => 07:17:42.629677
[0m07:17:42.630619 [debug] [Thread-1  ]: On test.development.unique_bronze_products_product_id.c17035ba1c: Close
[0m07:17:42.727276 [info ] [Thread-1  ]: 23 of 37 PASS unique_bronze_products_product_id ................................ [[32mPASS[0m in 0.45s]
[0m07:17:42.728673 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:17:42.729333 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m07:17:42.729969 [info ] [Thread-1  ]: 24 of 37 START sql incremental model final_sales.fct_payment_details ........... [RUN]
[0m07:17:42.730851 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_products_product_id.c17035ba1c, now model.development.fct_payment_details)
[0m07:17:42.731466 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m07:17:42.736964 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m07:17:42.738136 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 07:17:42.731959 => 07:17:42.737818
[0m07:17:42.738646 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m07:17:42.743472 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:17:42.744052 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_ts

    from payments where status = 'success'
)

select * from final
  );
[0m07:17:42.744476 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:43.103570 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:43.107802 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:17:43.108449 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m07:17:43.197837 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:17:43.202586 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:17:43.203204 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m07:17:43.270211 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:17:43.279376 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:17:43.280156 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m07:17:43.357389 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:17:43.361962 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m07:17:43.363758 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:17:43.364276 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m07:17:43.442000 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:43.442788 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:17:43.443338 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_TS")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_TS")

;
[0m07:17:43.743637 [debug] [Thread-1  ]: SQL status: SUCCESS 36 in 0.0 seconds
[0m07:17:43.744450 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:17:43.744881 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m07:17:43.948327 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:43.952952 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:17:43.953483 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m07:17:44.045406 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:44.049623 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 07:17:42.739028 => 07:17:44.049317
[0m07:17:44.050377 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m07:17:44.147944 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5030c2-cde2-466f-9897-388ad3561df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a10b0c250>]}
[0m07:17:44.149065 [info ] [Thread-1  ]: 24 of 37 OK created sql incremental model final_sales.fct_payment_details ...... [[32mSUCCESS 36[0m in 1.42s]
[0m07:17:44.150302 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m07:17:44.150953 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m07:17:44.151616 [info ] [Thread-1  ]: 25 of 37 START sql incremental model final_sales.fct_order_detail .............. [RUN]
[0m07:17:44.153005 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m07:17:44.153520 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m07:17:44.160130 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m07:17:44.161066 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 07:17:44.153844 => 07:17:44.160735
[0m07:17:44.161509 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m07:17:44.168590 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:17:44.169118 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace  temporary view external_db.final_sales.fct_order_detail__dbt_tmp
  
   as (
    
with orders as (
    select * from external_db.final_sales.bronze_orders
   
        where run_ts = to_timestamp('2023-06-22')
    
),

products as (
    select * from external_db.final_sales.bronze_products
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_ts
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m07:17:44.169546 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:44.530341 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:44.534833 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:17:44.535345 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail__dbt_tmp
[0m07:17:44.603070 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:17:44.608247 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:17:44.608876 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail
[0m07:17:44.684299 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:17:44.689995 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:17:44.690651 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_ORDER_DETAIL"
[0m07:17:44.763905 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:17:44.768290 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m07:17:44.769932 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:17:44.770372 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
-- back compat for old kwarg name
  
  begin;
[0m07:17:44.847328 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:44.848058 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:17:44.848570 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
merge into external_db.final_sales.fct_order_detail as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_order_detail__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_TS")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_TS")

;
[0m07:17:45.328785 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 0.0 seconds
[0m07:17:45.329753 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:17:45.330364 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
COMMIT
[0m07:17:45.540465 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:45.545828 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:17:45.546428 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m07:17:45.632230 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:45.635969 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 07:17:44.161774 => 07:17:45.635673
[0m07:17:45.636560 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m07:17:45.741534 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5030c2-cde2-466f-9897-388ad3561df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a101fe2e0>]}
[0m07:17:45.742650 [info ] [Thread-1  ]: 25 of 37 OK created sql incremental model final_sales.fct_order_detail ......... [[32mSUCCESS 50[0m in 1.59s]
[0m07:17:45.743536 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m07:17:45.744084 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:17:45.744926 [info ] [Thread-1  ]: 26 of 37 START test not_null_fct_payment_details_order_id ...................... [RUN]
[0m07:17:45.746153 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now test.development.not_null_fct_payment_details_order_id.7bb58db616)
[0m07:17:45.746716 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:17:45.752535 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_payment_details_order_id.7bb58db616"
[0m07:17:45.753395 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_order_id.7bb58db616 (compile): 07:17:45.747072 => 07:17:45.753083
[0m07:17:45.753824 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:17:45.757281 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_payment_details_order_id.7bb58db616"
[0m07:17:45.758362 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_payment_details_order_id.7bb58db616"
[0m07:17:45.758819 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_order_id.7bb58db616: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_payment_details_order_id.7bb58db616"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from external_db.final_sales.fct_payment_details
where order_id is null



      
    ) dbt_internal_test
[0m07:17:45.759212 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:46.251136 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:46.254498 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_order_id.7bb58db616 (execute): 07:17:45.754087 => 07:17:46.254157
[0m07:17:46.255041 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_order_id.7bb58db616: Close
[0m07:17:46.351220 [info ] [Thread-1  ]: 26 of 37 PASS not_null_fct_payment_details_order_id ............................ [[32mPASS[0m in 0.61s]
[0m07:17:46.352578 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:17:46.353221 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:17:46.353696 [info ] [Thread-1  ]: 27 of 37 START test not_null_fct_payment_details_payment_id .................... [RUN]
[0m07:17:46.354550 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_payment_details_order_id.7bb58db616, now test.development.not_null_fct_payment_details_payment_id.d55bc575d7)
[0m07:17:46.355189 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:17:46.360998 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_payment_details_payment_id.d55bc575d7"
[0m07:17:46.361843 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_id.d55bc575d7 (compile): 07:17:46.355557 => 07:17:46.361539
[0m07:17:46.362257 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:17:46.365439 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_payment_details_payment_id.d55bc575d7"
[0m07:17:46.366470 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_payment_details_payment_id.d55bc575d7"
[0m07:17:46.366919 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_payment_id.d55bc575d7: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_payment_details_payment_id.d55bc575d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from external_db.final_sales.fct_payment_details
where payment_id is null



      
    ) dbt_internal_test
[0m07:17:46.367316 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:46.650896 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:46.654092 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_id.d55bc575d7 (execute): 07:17:46.362521 => 07:17:46.653735
[0m07:17:46.654624 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_payment_id.d55bc575d7: Close
[0m07:17:46.750843 [info ] [Thread-1  ]: 27 of 37 PASS not_null_fct_payment_details_payment_id .......................... [[32mPASS[0m in 0.40s]
[0m07:17:46.752355 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:17:46.753131 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:17:46.753837 [info ] [Thread-1  ]: 28 of 37 START test not_null_fct_payment_details_payment_method ................ [RUN]
[0m07:17:46.755003 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_payment_details_payment_id.d55bc575d7, now test.development.not_null_fct_payment_details_payment_method.62d221c77e)
[0m07:17:46.755670 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:17:46.761281 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_payment_details_payment_method.62d221c77e"
[0m07:17:46.762097 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_method.62d221c77e (compile): 07:17:46.755965 => 07:17:46.761802
[0m07:17:46.762502 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:17:46.765640 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_payment_details_payment_method.62d221c77e"
[0m07:17:46.766709 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_payment_details_payment_method.62d221c77e"
[0m07:17:46.767144 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_payment_method.62d221c77e: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_payment_details_payment_method.62d221c77e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_method
from external_db.final_sales.fct_payment_details
where payment_method is null



      
    ) dbt_internal_test
[0m07:17:46.767535 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:47.046418 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:47.049815 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_method.62d221c77e (execute): 07:17:46.762802 => 07:17:47.049438
[0m07:17:47.050407 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_payment_method.62d221c77e: Close
[0m07:17:47.146112 [info ] [Thread-1  ]: 28 of 37 PASS not_null_fct_payment_details_payment_method ...................... [[32mPASS[0m in 0.39s]
[0m07:17:47.147516 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:17:47.148162 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:17:47.148810 [info ] [Thread-1  ]: 29 of 37 START test not_null_fct_order_detail_customer_id ...................... [RUN]
[0m07:17:47.149761 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_payment_details_payment_method.62d221c77e, now test.development.not_null_fct_order_detail_customer_id.44d928392b)
[0m07:17:47.150198 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:17:47.156268 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_customer_id.44d928392b"
[0m07:17:47.157150 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_customer_id.44d928392b (compile): 07:17:47.150461 => 07:17:47.156840
[0m07:17:47.157577 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:17:47.160769 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_order_detail_customer_id.44d928392b"
[0m07:17:47.161819 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_order_detail_customer_id.44d928392b"
[0m07:17:47.162251 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_customer_id.44d928392b: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_order_detail_customer_id.44d928392b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from external_db.final_sales.fct_order_detail
where customer_id is null



      
    ) dbt_internal_test
[0m07:17:47.162651 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:47.457661 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:47.461129 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_customer_id.44d928392b (execute): 07:17:47.157841 => 07:17:47.460744
[0m07:17:47.461715 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_customer_id.44d928392b: Close
[0m07:17:47.556118 [info ] [Thread-1  ]: 29 of 37 PASS not_null_fct_order_detail_customer_id ............................ [[32mPASS[0m in 0.41s]
[0m07:17:47.557118 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:17:47.557652 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:17:47.558276 [info ] [Thread-1  ]: 30 of 37 START test not_null_fct_order_detail_order_date ....................... [RUN]
[0m07:17:47.559246 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_customer_id.44d928392b, now test.development.not_null_fct_order_detail_order_date.c6f89a052d)
[0m07:17:47.559691 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:17:47.565459 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_order_date.c6f89a052d"
[0m07:17:47.566268 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_date.c6f89a052d (compile): 07:17:47.559965 => 07:17:47.565969
[0m07:17:47.566716 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:17:47.569773 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_order_detail_order_date.c6f89a052d"
[0m07:17:47.570808 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_order_detail_order_date.c6f89a052d"
[0m07:17:47.571238 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_order_date.c6f89a052d: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_order_detail_order_date.c6f89a052d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from external_db.final_sales.fct_order_detail
where order_date is null



      
    ) dbt_internal_test
[0m07:17:47.571629 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:47.856092 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:47.859276 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_date.c6f89a052d (execute): 07:17:47.566985 => 07:17:47.858922
[0m07:17:47.859957 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_order_date.c6f89a052d: Close
[0m07:17:47.961600 [info ] [Thread-1  ]: 30 of 37 PASS not_null_fct_order_detail_order_date ............................. [[32mPASS[0m in 0.40s]
[0m07:17:47.962909 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:17:47.963546 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:17:47.964040 [info ] [Thread-1  ]: 31 of 37 START test not_null_fct_order_detail_order_id ......................... [RUN]
[0m07:17:47.964949 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_order_date.c6f89a052d, now test.development.not_null_fct_order_detail_order_id.47ace119a7)
[0m07:17:47.965615 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:17:47.971590 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_order_id.47ace119a7"
[0m07:17:47.972444 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_id.47ace119a7 (compile): 07:17:47.965934 => 07:17:47.972139
[0m07:17:47.972862 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:17:47.976166 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_order_detail_order_id.47ace119a7"
[0m07:17:47.977190 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_order_detail_order_id.47ace119a7"
[0m07:17:47.977617 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_order_id.47ace119a7: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_order_detail_order_id.47ace119a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from external_db.final_sales.fct_order_detail
where order_id is null



      
    ) dbt_internal_test
[0m07:17:47.978008 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:48.433856 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:48.437194 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_id.47ace119a7 (execute): 07:17:47.973126 => 07:17:48.436820
[0m07:17:48.437774 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_order_id.47ace119a7: Close
[0m07:17:48.539487 [info ] [Thread-1  ]: 31 of 37 PASS not_null_fct_order_detail_order_id ............................... [[32mPASS[0m in 0.57s]
[0m07:17:48.541014 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:17:48.541648 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:17:48.542295 [info ] [Thread-1  ]: 32 of 37 START test not_null_fct_order_detail_price ............................ [RUN]
[0m07:17:48.543154 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_order_id.47ace119a7, now test.development.not_null_fct_order_detail_price.c149ee0e5c)
[0m07:17:48.543591 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:17:48.549239 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_price.c149ee0e5c"
[0m07:17:48.550151 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_price.c149ee0e5c (compile): 07:17:48.543859 => 07:17:48.549868
[0m07:17:48.550648 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:17:48.553826 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_order_detail_price.c149ee0e5c"
[0m07:17:48.554862 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_order_detail_price.c149ee0e5c"
[0m07:17:48.555299 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_price.c149ee0e5c: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_order_detail_price.c149ee0e5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from external_db.final_sales.fct_order_detail
where price is null



      
    ) dbt_internal_test
[0m07:17:48.555693 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:48.860253 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:48.863830 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_price.c149ee0e5c (execute): 07:17:48.550932 => 07:17:48.863458
[0m07:17:48.864395 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_price.c149ee0e5c: Close
[0m07:17:48.962703 [info ] [Thread-1  ]: 32 of 37 PASS not_null_fct_order_detail_price .................................. [[32mPASS[0m in 0.42s]
[0m07:17:48.965385 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:17:48.966230 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:17:48.966928 [info ] [Thread-1  ]: 33 of 37 START test not_null_fct_order_detail_product_id ....................... [RUN]
[0m07:17:48.968707 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_price.c149ee0e5c, now test.development.not_null_fct_order_detail_product_id.73135971e6)
[0m07:17:48.969251 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:17:48.975196 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_product_id.73135971e6"
[0m07:17:48.976394 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_product_id.73135971e6 (compile): 07:17:48.969603 => 07:17:48.976065
[0m07:17:48.976902 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:17:48.980207 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_order_detail_product_id.73135971e6"
[0m07:17:48.981607 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_order_detail_product_id.73135971e6"
[0m07:17:48.982144 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_product_id.73135971e6: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_order_detail_product_id.73135971e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from external_db.final_sales.fct_order_detail
where product_id is null



      
    ) dbt_internal_test
[0m07:17:48.982639 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:49.276207 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:49.279833 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_product_id.73135971e6 (execute): 07:17:48.977251 => 07:17:49.279435
[0m07:17:49.280536 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_product_id.73135971e6: Close
[0m07:17:49.383112 [info ] [Thread-1  ]: 33 of 37 PASS not_null_fct_order_detail_product_id ............................. [[32mPASS[0m in 0.41s]
[0m07:17:49.384579 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:17:49.385396 [debug] [Thread-1  ]: Began running node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:17:49.386062 [info ] [Thread-1  ]: 34 of 37 START test unique_fct_order_detail_order_id ........................... [RUN]
[0m07:17:49.387037 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_product_id.73135971e6, now test.development.unique_fct_order_detail_order_id.256da980ed)
[0m07:17:49.387529 [debug] [Thread-1  ]: Began compiling node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:17:49.393656 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_fct_order_detail_order_id.256da980ed"
[0m07:17:49.394484 [debug] [Thread-1  ]: Timing info for test.development.unique_fct_order_detail_order_id.256da980ed (compile): 07:17:49.387928 => 07:17:49.394199
[0m07:17:49.394950 [debug] [Thread-1  ]: Began executing node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:17:49.398154 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_fct_order_detail_order_id.256da980ed"
[0m07:17:49.399329 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_fct_order_detail_order_id.256da980ed"
[0m07:17:49.399769 [debug] [Thread-1  ]: On test.development.unique_fct_order_detail_order_id.256da980ed: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_fct_order_detail_order_id.256da980ed"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from external_db.final_sales.fct_order_detail
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:17:49.400174 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:49.728639 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:49.732159 [debug] [Thread-1  ]: Timing info for test.development.unique_fct_order_detail_order_id.256da980ed (execute): 07:17:49.395227 => 07:17:49.731778
[0m07:17:49.732744 [debug] [Thread-1  ]: On test.development.unique_fct_order_detail_order_id.256da980ed: Close
[0m07:17:49.829966 [info ] [Thread-1  ]: 34 of 37 PASS unique_fct_order_detail_order_id ................................. [[32mPASS[0m in 0.44s]
[0m07:17:49.831447 [debug] [Thread-1  ]: Finished running node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:17:49.832589 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m07:17:49.833238 [info ] [Thread-1  ]: 35 of 37 START sql incremental model final_sales.product_sales ................. [RUN]
[0m07:17:49.834250 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_fct_order_detail_order_id.256da980ed, now model.development.product_sales)
[0m07:17:49.834718 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m07:17:49.841584 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m07:17:49.842490 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 07:17:49.835010 => 07:17:49.842200
[0m07:17:49.842944 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m07:17:49.863258 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m07:17:49.864912 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:17:49.865398 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace transient table external_db.final_sales.product_sales
         as
        (

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
),

final as (

    select
        order_details.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
        );
[0m07:17:49.865810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:50.552491 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:17:50.557952 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:17:50.558537 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m07:17:50.622483 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:50.626123 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 07:17:49.843210 => 07:17:50.625838
[0m07:17:50.626681 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m07:17:50.722797 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f5030c2-cde2-466f-9897-388ad3561df0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a101e2850>]}
[0m07:17:50.723814 [info ] [Thread-1  ]: 35 of 37 OK created sql incremental model final_sales.product_sales ............ [[32mSUCCESS 1[0m in 0.89s]
[0m07:17:50.724896 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m07:17:50.726047 [debug] [Thread-1  ]: Began running node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m07:17:50.726505 [info ] [Thread-1  ]: 36 of 37 START test not_null_product_sales_customer_id ......................... [RUN]
[0m07:17:50.727357 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.product_sales, now test.development.not_null_product_sales_customer_id.acc9e6dd8e)
[0m07:17:50.727793 [debug] [Thread-1  ]: Began compiling node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m07:17:50.733435 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_product_sales_customer_id.acc9e6dd8e"
[0m07:17:50.734171 [debug] [Thread-1  ]: Timing info for test.development.not_null_product_sales_customer_id.acc9e6dd8e (compile): 07:17:50.728061 => 07:17:50.733907
[0m07:17:50.734580 [debug] [Thread-1  ]: Began executing node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m07:17:50.737714 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_product_sales_customer_id.acc9e6dd8e"
[0m07:17:50.738738 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_product_sales_customer_id.acc9e6dd8e"
[0m07:17:50.739168 [debug] [Thread-1  ]: On test.development.not_null_product_sales_customer_id.acc9e6dd8e: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_product_sales_customer_id.acc9e6dd8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from external_db.final_sales.product_sales
where customer_id is null



      
    ) dbt_internal_test
[0m07:17:50.739562 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:51.244707 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:17:51.248019 [debug] [Thread-1  ]: Timing info for test.development.not_null_product_sales_customer_id.acc9e6dd8e (execute): 07:17:50.734872 => 07:17:51.247648
[0m07:17:51.248586 [debug] [Thread-1  ]: On test.development.not_null_product_sales_customer_id.acc9e6dd8e: Close
[0m07:17:51.343863 [info ] [Thread-1  ]: 36 of 37 PASS not_null_product_sales_customer_id ............................... [[32mPASS[0m in 0.62s]
[0m07:17:51.345029 [debug] [Thread-1  ]: Finished running node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m07:17:51.345649 [debug] [Thread-1  ]: Began running node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m07:17:51.346101 [info ] [Thread-1  ]: 37 of 37 START test not_null_product_sales_order_amount ........................ [RUN]
[0m07:17:51.346969 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_product_sales_customer_id.acc9e6dd8e, now test.development.not_null_product_sales_order_amount.b9ffa2ea2b)
[0m07:17:51.347422 [debug] [Thread-1  ]: Began compiling node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m07:17:51.353536 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_product_sales_order_amount.b9ffa2ea2b"
[0m07:17:51.354307 [debug] [Thread-1  ]: Timing info for test.development.not_null_product_sales_order_amount.b9ffa2ea2b (compile): 07:17:51.347971 => 07:17:51.354030
[0m07:17:51.354748 [debug] [Thread-1  ]: Began executing node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m07:17:51.357929 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_product_sales_order_amount.b9ffa2ea2b"
[0m07:17:51.358933 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_product_sales_order_amount.b9ffa2ea2b"
[0m07:17:51.359367 [debug] [Thread-1  ]: On test.development.not_null_product_sales_order_amount.b9ffa2ea2b: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_product_sales_order_amount.b9ffa2ea2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_amount
from external_db.final_sales.product_sales
where order_amount is null



      
    ) dbt_internal_test
[0m07:17:51.359759 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:17:51.729171 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:17:51.732623 [debug] [Thread-1  ]: Timing info for test.development.not_null_product_sales_order_amount.b9ffa2ea2b (execute): 07:17:51.355022 => 07:17:51.732243
[0m07:17:51.733192 [debug] [Thread-1  ]: On test.development.not_null_product_sales_order_amount.b9ffa2ea2b: Close
[0m07:17:51.821149 [info ] [Thread-1  ]: 37 of 37 PASS not_null_product_sales_order_amount .............................. [[32mPASS[0m in 0.47s]
[0m07:17:51.822186 [debug] [Thread-1  ]: Finished running node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m07:17:51.824680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:17:51.825100 [debug] [MainThread]: Connection 'test.development.not_null_product_sales_order_amount.b9ffa2ea2b' was properly closed.
[0m07:17:51.825574 [info ] [MainThread]: 
[0m07:17:51.826030 [info ] [MainThread]: Finished running 7 incremental models, 30 tests in 0 hours 0 minutes and 26.54 seconds (26.54s).
[0m07:17:51.832514 [debug] [MainThread]: Command end result
[0m07:17:51.846839 [info ] [MainThread]: 
[0m07:17:51.847515 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:17:51.847992 [info ] [MainThread]: 
[0m07:17:51.848500 [info ] [MainThread]: Done. PASS=37 WARN=0 ERROR=0 SKIP=0 TOTAL=37
[0m07:17:51.849382 [debug] [MainThread]: Command `dbt build` succeeded at 07:17:51.849228 after 27.11 seconds
[0m07:17:51.849828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a18927040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a12b1eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a11963d00>]}
[0m07:17:51.850283 [debug] [MainThread]: Flushing usage events
[0m07:25:51.283863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb40574d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4040628b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4040620a0>]}


============================== 07:25:51.287468 | 388961f3-e5ed-49c6-be44-5d17d8973591 ==============================
[0m07:25:51.287468 [info ] [MainThread]: Running with dbt=1.5.1
[0m07:25:51.288119 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'airflow/dags/dbt/', 'log_path': 'airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m07:25:51.587580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '388961f3-e5ed-49c6-be44-5d17d8973591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ff938eb0>]}
[0m07:25:51.605531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '388961f3-e5ed-49c6-be44-5d17d8973591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ff9457f0>]}
[0m07:25:51.621150 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m07:25:51.621923 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:25:51.622410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '388961f3-e5ed-49c6-be44-5d17d8973591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ff90dc40>]}
[0m07:25:52.345450 [debug] [MainThread]: 1603: static parser failed on sales/silver/fct_order_detail.sql
[0m07:25:52.368927 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/silver/fct_order_detail.sql
[0m07:25:52.371671 [debug] [MainThread]: 1603: static parser failed on sales/silver/fct_payment_details.sql
[0m07:25:52.377770 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/silver/fct_payment_details.sql
[0m07:25:52.380840 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_orders.sql
[0m07:25:52.386421 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_orders.sql
[0m07:25:52.388939 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_payments.sql
[0m07:25:52.394565 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_payments.sql
[0m07:25:52.396932 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_customers.sql
[0m07:25:52.402605 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_customers.sql
[0m07:25:52.404936 [debug] [MainThread]: 1603: static parser failed on sales/bronze/bronze_products.sql
[0m07:25:52.410273 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/bronze/bronze_products.sql
[0m07:25:52.412572 [debug] [MainThread]: 1603: static parser failed on sales/gold/product_sales.sql
[0m07:25:52.420330 [debug] [MainThread]: 1602: parser fallback to jinja rendering on sales/gold/product_sales.sql
[0m07:25:52.732330 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.silver
- models.development.gold
[0m07:25:52.739505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '388961f3-e5ed-49c6-be44-5d17d8973591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fe2a62e0>]}
[0m07:25:52.752528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '388961f3-e5ed-49c6-be44-5d17d8973591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ff9451f0>]}
[0m07:25:52.753267 [info ] [MainThread]: Found 7 models, 30 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m07:25:52.756605 [info ] [MainThread]: 
[0m07:25:52.757600 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:25:52.759340 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m07:25:52.775435 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m07:25:52.776132 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m07:25:52.776612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:25:53.676850 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m07:25:53.679710 [debug] [ThreadPool]: On list_external_db: Close
[0m07:25:53.778249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m07:25:53.787936 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m07:25:53.788478 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m07:25:53.788837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:25:54.076433 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m07:25:54.078949 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m07:25:54.181015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '388961f3-e5ed-49c6-be44-5d17d8973591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fe7ec8b0>]}
[0m07:25:54.182271 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:25:54.182873 [info ] [MainThread]: 
[0m07:25:54.188441 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m07:25:54.189147 [info ] [Thread-1  ]: 1 of 37 START sql incremental model final_sales.bronze_customers ............... [RUN]
[0m07:25:54.190034 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m07:25:54.190483 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m07:25:54.195205 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m07:25:54.196079 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 07:25:54.190785 => 07:25:54.195775
[0m07:25:54.196512 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m07:25:54.253281 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:25:54.253942 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_timestamp('2023-06-22') as run_ts  from external_db.stage.customers
)

select * from customers
  );
[0m07:25:54.254383 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:25:54.747526 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:25:54.758303 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:25:54.758943 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m07:25:54.827419 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:25:54.833548 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:25:54.834175 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m07:25:54.901992 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:25:54.912084 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:25:54.912644 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m07:25:54.973730 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m07:25:55.012315 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m07:25:55.014415 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:25:55.015097 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m07:25:55.094970 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:25:55.095652 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:25:55.096126 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_TS")
    values
        ("VALUE", "CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_TS")

;
[0m07:25:56.012202 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m07:25:56.012986 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:25:56.013445 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m07:25:56.207694 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:25:56.219626 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m07:25:56.220347 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m07:25:56.316631 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:25:56.344496 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 07:25:54.196778 => 07:25:56.344208
[0m07:25:56.345097 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m07:25:56.434848 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '388961f3-e5ed-49c6-be44-5d17d8973591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fc506250>]}
[0m07:25:56.436079 [info ] [Thread-1  ]: 1 of 37 OK created sql incremental model final_sales.bronze_customers .......... [[32mSUCCESS 50[0m in 2.24s]
[0m07:25:56.437019 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m07:25:56.438100 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m07:25:56.439060 [info ] [Thread-1  ]: 2 of 37 START sql incremental model final_sales.bronze_orders .................. [RUN]
[0m07:25:56.440400 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m07:25:56.440950 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m07:25:56.447299 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m07:25:56.448285 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 07:25:56.441321 => 07:25:56.447978
[0m07:25:56.448947 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m07:25:56.455909 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:25:56.456424 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.orders
)

select * from orders
  );
[0m07:25:56.456932 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:25:56.822432 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:25:56.826858 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:25:56.827437 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m07:25:56.904002 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:25:56.912889 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:25:56.913525 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m07:25:56.977925 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:25:56.984581 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:25:56.985169 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m07:25:57.050296 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:25:57.054876 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m07:25:57.056628 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:25:57.057126 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m07:25:57.149275 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:25:57.150033 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:25:57.150554 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_TS")
    values
        ("VALUE", "ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_TS")

;
[0m07:25:57.889242 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m07:25:57.890300 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:25:57.890884 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m07:25:58.077126 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:25:58.081504 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m07:25:58.082019 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m07:25:58.176037 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:25:58.179640 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 07:25:56.449339 => 07:25:58.179377
[0m07:25:58.180149 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m07:25:58.281626 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '388961f3-e5ed-49c6-be44-5d17d8973591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fc4ced30>]}
[0m07:25:58.282708 [info ] [Thread-1  ]: 2 of 37 OK created sql incremental model final_sales.bronze_orders ............. [[32mSUCCESS 50[0m in 1.84s]
[0m07:25:58.283931 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m07:25:58.284641 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m07:25:58.285501 [info ] [Thread-1  ]: 3 of 37 START sql incremental model final_sales.bronze_payments ................ [RUN]
[0m07:25:58.286888 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m07:25:58.287402 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m07:25:58.292652 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m07:25:58.293497 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 07:25:58.287811 => 07:25:58.293192
[0m07:25:58.293915 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m07:25:58.298361 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:25:58.299020 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.payments
)

select * from payments
  );
[0m07:25:58.299523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:25:58.654489 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:25:58.658538 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:25:58.659118 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m07:25:58.724828 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:25:58.729686 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:25:58.730334 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m07:25:58.794881 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:25:58.799812 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:25:58.800404 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m07:25:58.866411 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:25:58.873274 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m07:25:58.875026 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:25:58.875519 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m07:25:58.953526 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:25:58.954233 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:25:58.954733 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_TS")
    values
        ("VALUE", "PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_TS")

;
[0m07:25:59.711034 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m07:25:59.711814 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:25:59.712266 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m07:25:59.918047 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:25:59.924885 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m07:25:59.925498 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m07:26:00.011251 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:00.014687 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 07:25:58.294176 => 07:26:00.014387
[0m07:26:00.015235 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m07:26:00.118297 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '388961f3-e5ed-49c6-be44-5d17d8973591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fc47e3a0>]}
[0m07:26:00.119459 [info ] [Thread-1  ]: 3 of 37 OK created sql incremental model final_sales.bronze_payments ........... [[32mSUCCESS 50[0m in 1.83s]
[0m07:26:00.120314 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m07:26:00.120858 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m07:26:00.121695 [info ] [Thread-1  ]: 4 of 37 START sql incremental model final_sales.bronze_products ................ [RUN]
[0m07:26:00.122880 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m07:26:00.123412 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m07:26:00.128097 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m07:26:00.129803 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 07:26:00.123761 => 07:26:00.129504
[0m07:26:00.130320 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m07:26:00.135017 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:26:00.135628 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.products
)

select * from products
  );
[0m07:26:00.136123 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:00.501005 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:00.505363 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:26:00.506160 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m07:26:00.578899 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:26:00.583927 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:26:00.584475 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m07:26:00.643458 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:26:00.648358 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:26:00.649020 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m07:26:00.709267 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:26:00.713796 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m07:26:00.715486 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:26:00.715996 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m07:26:00.802720 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:00.803408 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:26:00.803872 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "PRODUCT_ID", "PRICE", "RUN_TS")
    values
        ("VALUE", "PRODUCT_ID", "PRICE", "RUN_TS")

;
[0m07:26:01.392606 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m07:26:01.393620 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:26:01.394440 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m07:26:01.593806 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:01.598558 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m07:26:01.599134 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m07:26:01.692334 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:01.695899 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 07:26:00.130699 => 07:26:01.695480
[0m07:26:01.696430 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m07:26:01.794410 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '388961f3-e5ed-49c6-be44-5d17d8973591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fc46ec70>]}
[0m07:26:01.795538 [info ] [Thread-1  ]: 4 of 37 OK created sql incremental model final_sales.bronze_products ........... [[32mSUCCESS 50[0m in 1.67s]
[0m07:26:01.796376 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m07:26:01.796925 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:26:01.797589 [info ] [Thread-1  ]: 5 of 37 START test not_null_bronze_customers_customer_id ....................... [RUN]
[0m07:26:01.798657 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now test.development.not_null_bronze_customers_customer_id.254c74eb6e)
[0m07:26:01.799210 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:26:01.810171 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_customers_customer_id.254c74eb6e"
[0m07:26:01.811033 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_customer_id.254c74eb6e (compile): 07:26:01.799567 => 07:26:01.810742
[0m07:26:01.811473 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:26:01.831357 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_customers_customer_id.254c74eb6e"
[0m07:26:01.832589 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_customers_customer_id.254c74eb6e"
[0m07:26:01.833087 [debug] [Thread-1  ]: On test.development.not_null_bronze_customers_customer_id.254c74eb6e: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_customers_customer_id.254c74eb6e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from external_db.final_sales.bronze_customers
where customer_id is null



      
    ) dbt_internal_test
[0m07:26:01.833496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:02.153252 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:02.157974 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_customer_id.254c74eb6e (execute): 07:26:01.811829 => 07:26:02.157616
[0m07:26:02.158522 [debug] [Thread-1  ]: On test.development.not_null_bronze_customers_customer_id.254c74eb6e: Close
[0m07:26:02.262864 [info ] [Thread-1  ]: 5 of 37 PASS not_null_bronze_customers_customer_id ............................. [[32mPASS[0m in 0.46s]
[0m07:26:02.264188 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m07:26:02.264788 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:26:02.265262 [info ] [Thread-1  ]: 6 of 37 START test not_null_bronze_customers_first_name ........................ [RUN]
[0m07:26:02.266112 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_customers_customer_id.254c74eb6e, now test.development.not_null_bronze_customers_first_name.22deabc315)
[0m07:26:02.266558 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:26:02.272224 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_customers_first_name.22deabc315"
[0m07:26:02.273364 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_first_name.22deabc315 (compile): 07:26:02.266855 => 07:26:02.273083
[0m07:26:02.273778 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:26:02.276951 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_customers_first_name.22deabc315"
[0m07:26:02.277980 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_customers_first_name.22deabc315"
[0m07:26:02.278424 [debug] [Thread-1  ]: On test.development.not_null_bronze_customers_first_name.22deabc315: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_customers_first_name.22deabc315"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select first_name
from external_db.final_sales.bronze_customers
where first_name is null



      
    ) dbt_internal_test
[0m07:26:02.278844 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:02.612781 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:02.615891 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_first_name.22deabc315 (execute): 07:26:02.274046 => 07:26:02.615561
[0m07:26:02.616397 [debug] [Thread-1  ]: On test.development.not_null_bronze_customers_first_name.22deabc315: Close
[0m07:26:02.735238 [info ] [Thread-1  ]: 6 of 37 PASS not_null_bronze_customers_first_name .............................. [[32mPASS[0m in 0.47s]
[0m07:26:02.736481 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_customers_first_name.22deabc315
[0m07:26:02.737144 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:26:02.737678 [info ] [Thread-1  ]: 7 of 37 START test unique_bronze_customers_customer_id ......................... [RUN]
[0m07:26:02.738953 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_customers_first_name.22deabc315, now test.development.unique_bronze_customers_customer_id.f8660c11fe)
[0m07:26:02.739490 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:26:02.749726 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_customers_customer_id.f8660c11fe"
[0m07:26:02.751037 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_customers_customer_id.f8660c11fe (compile): 07:26:02.739840 => 07:26:02.750711
[0m07:26:02.751867 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:26:02.755793 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_bronze_customers_customer_id.f8660c11fe"
[0m07:26:02.758337 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_bronze_customers_customer_id.f8660c11fe"
[0m07:26:02.758869 [debug] [Thread-1  ]: On test.development.unique_bronze_customers_customer_id.f8660c11fe: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_bronze_customers_customer_id.f8660c11fe"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from external_db.final_sales.bronze_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:26:02.759327 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:03.251069 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:03.254189 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_customers_customer_id.f8660c11fe (execute): 07:26:02.752259 => 07:26:03.253847
[0m07:26:03.254726 [debug] [Thread-1  ]: On test.development.unique_bronze_customers_customer_id.f8660c11fe: Close
[0m07:26:03.360523 [info ] [Thread-1  ]: 7 of 37 PASS unique_bronze_customers_customer_id ............................... [[32mPASS[0m in 0.62s]
[0m07:26:03.362110 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m07:26:03.362783 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:26:03.364702 [info ] [Thread-1  ]: 8 of 37 START test not_null_bronze_orders_customer_id .......................... [RUN]
[0m07:26:03.365815 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_customers_customer_id.f8660c11fe, now test.development.not_null_bronze_orders_customer_id.660ce070b4)
[0m07:26:03.366269 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:26:03.372087 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_customer_id.660ce070b4"
[0m07:26:03.372954 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_customer_id.660ce070b4 (compile): 07:26:03.366548 => 07:26:03.372652
[0m07:26:03.373388 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:26:03.376684 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_orders_customer_id.660ce070b4"
[0m07:26:03.377747 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_orders_customer_id.660ce070b4"
[0m07:26:03.378185 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_customer_id.660ce070b4: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_orders_customer_id.660ce070b4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from external_db.final_sales.bronze_orders
where customer_id is null



      
    ) dbt_internal_test
[0m07:26:03.378584 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:03.878086 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:03.881307 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_customer_id.660ce070b4 (execute): 07:26:03.373662 => 07:26:03.880945
[0m07:26:03.881864 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_customer_id.660ce070b4: Close
[0m07:26:03.986640 [info ] [Thread-1  ]: 8 of 37 PASS not_null_bronze_orders_customer_id ................................ [[32mPASS[0m in 0.62s]
[0m07:26:03.988132 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m07:26:03.988687 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:26:03.989709 [info ] [Thread-1  ]: 9 of 37 START test not_null_bronze_orders_order_date ........................... [RUN]
[0m07:26:03.993156 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_customer_id.660ce070b4, now test.development.not_null_bronze_orders_order_date.d63cfe6df9)
[0m07:26:03.993715 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:26:04.001472 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_order_date.d63cfe6df9"
[0m07:26:04.002345 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_date.d63cfe6df9 (compile): 07:26:03.994075 => 07:26:04.002045
[0m07:26:04.007182 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:26:04.011291 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_orders_order_date.d63cfe6df9"
[0m07:26:04.012785 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_orders_order_date.d63cfe6df9"
[0m07:26:04.013324 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_order_date.d63cfe6df9: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_orders_order_date.d63cfe6df9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from external_db.final_sales.bronze_orders
where order_date is null



      
    ) dbt_internal_test
[0m07:26:04.013823 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:04.307088 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:04.310180 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_date.d63cfe6df9 (execute): 07:26:04.007644 => 07:26:04.309833
[0m07:26:04.310712 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_order_date.d63cfe6df9: Close
[0m07:26:04.415154 [info ] [Thread-1  ]: 9 of 37 PASS not_null_bronze_orders_order_date ................................. [[32mPASS[0m in 0.42s]
[0m07:26:04.416273 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m07:26:04.416875 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:26:04.417755 [info ] [Thread-1  ]: 10 of 37 START test not_null_bronze_orders_order_id ............................ [RUN]
[0m07:26:04.418733 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_order_date.d63cfe6df9, now test.development.not_null_bronze_orders_order_id.24f68d0dd3)
[0m07:26:04.419223 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:26:04.424924 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_order_id.24f68d0dd3"
[0m07:26:04.425722 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_id.24f68d0dd3 (compile): 07:26:04.419520 => 07:26:04.425448
[0m07:26:04.426162 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:26:04.429354 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_orders_order_id.24f68d0dd3"
[0m07:26:04.430414 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_orders_order_id.24f68d0dd3"
[0m07:26:04.430871 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_order_id.24f68d0dd3: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_orders_order_id.24f68d0dd3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from external_db.final_sales.bronze_orders
where order_id is null



      
    ) dbt_internal_test
[0m07:26:04.431273 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:04.714320 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:04.717770 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_id.24f68d0dd3 (execute): 07:26:04.426430 => 07:26:04.717388
[0m07:26:04.718329 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_order_id.24f68d0dd3: Close
[0m07:26:04.818770 [info ] [Thread-1  ]: 10 of 37 PASS not_null_bronze_orders_order_id .................................. [[32mPASS[0m in 0.40s]
[0m07:26:04.819813 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m07:26:04.820354 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:26:04.821265 [info ] [Thread-1  ]: 11 of 37 START test not_null_bronze_orders_product_id .......................... [RUN]
[0m07:26:04.822169 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_order_id.24f68d0dd3, now test.development.not_null_bronze_orders_product_id.354934acfc)
[0m07:26:04.822615 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:26:04.828505 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_product_id.354934acfc"
[0m07:26:04.829366 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_product_id.354934acfc (compile): 07:26:04.822913 => 07:26:04.829070
[0m07:26:04.829824 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:26:04.833113 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_orders_product_id.354934acfc"
[0m07:26:04.834143 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_orders_product_id.354934acfc"
[0m07:26:04.834573 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_product_id.354934acfc: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_orders_product_id.354934acfc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from external_db.final_sales.bronze_orders
where product_id is null



      
    ) dbt_internal_test
[0m07:26:04.835001 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:05.276385 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:05.279496 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_product_id.354934acfc (execute): 07:26:04.830092 => 07:26:05.279157
[0m07:26:05.280001 [debug] [Thread-1  ]: On test.development.not_null_bronze_orders_product_id.354934acfc: Close
[0m07:26:05.394194 [info ] [Thread-1  ]: 11 of 37 PASS not_null_bronze_orders_product_id ................................ [[32mPASS[0m in 0.57s]
[0m07:26:05.395652 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_product_id.354934acfc
[0m07:26:05.396815 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:26:05.397498 [info ] [Thread-1  ]: 12 of 37 START test unique_bronze_orders_order_id .............................. [RUN]
[0m07:26:05.398610 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_product_id.354934acfc, now test.development.unique_bronze_orders_order_id.eec6e86d13)
[0m07:26:05.399454 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:26:05.405614 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_orders_order_id.eec6e86d13"
[0m07:26:05.407699 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_orders_order_id.eec6e86d13 (compile): 07:26:05.399878 => 07:26:05.407020
[0m07:26:05.408247 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:26:05.411609 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_bronze_orders_order_id.eec6e86d13"
[0m07:26:05.412767 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_bronze_orders_order_id.eec6e86d13"
[0m07:26:05.413205 [debug] [Thread-1  ]: On test.development.unique_bronze_orders_order_id.eec6e86d13: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_bronze_orders_order_id.eec6e86d13"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from external_db.final_sales.bronze_orders
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:26:05.413607 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:05.982387 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:26:05.985872 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_orders_order_id.eec6e86d13 (execute): 07:26:05.408598 => 07:26:05.985466
[0m07:26:05.986471 [debug] [Thread-1  ]: On test.development.unique_bronze_orders_order_id.eec6e86d13: Close
[0m07:26:06.096802 [info ] [Thread-1  ]: 12 of 37 PASS unique_bronze_orders_order_id .................................... [[32mPASS[0m in 0.70s]
[0m07:26:06.099448 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m07:26:06.100277 [debug] [Thread-1  ]: Began running node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:26:06.105749 [info ] [Thread-1  ]: 13 of 37 START test accepted_values_bronze_payments_payment_method__debit__credit__upi__cash  [RUN]
[0m07:26:06.106971 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_orders_order_id.eec6e86d13, now test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8)
[0m07:26:06.107746 [debug] [Thread-1  ]: Began compiling node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:26:06.118159 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"
[0m07:26:06.119185 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8 (compile): 07:26:06.108204 => 07:26:06.118847
[0m07:26:06.119664 [debug] [Thread-1  ]: Began executing node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:26:06.209346 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"
[0m07:26:06.210844 [debug] [Thread-1  ]: Using snowflake connection "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"
[0m07:26:06.211377 [debug] [Thread-1  ]: On test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        payment_method as value_field,
        count(*) as n_records

    from external_db.final_sales.bronze_payments
    group by payment_method

)

select *
from all_values
where value_field not in (
    'debit','credit','upi','cash'
)



      
    ) dbt_internal_test
[0m07:26:06.211808 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:06.587206 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:06.590549 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8 (execute): 07:26:06.119961 => 07:26:06.590178
[0m07:26:06.591156 [debug] [Thread-1  ]: On test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8: Close
[0m07:26:06.690005 [info ] [Thread-1  ]: 13 of 37 PASS accepted_values_bronze_payments_payment_method__debit__credit__upi__cash  [[32mPASS[0m in 0.58s]
[0m07:26:06.691583 [debug] [Thread-1  ]: Finished running node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m07:26:06.692790 [debug] [Thread-1  ]: Began running node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:26:06.693548 [info ] [Thread-1  ]: 14 of 37 START test accepted_values_bronze_payments_status__fail__success ...... [RUN]
[0m07:26:06.694839 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8, now test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f)
[0m07:26:06.695464 [debug] [Thread-1  ]: Began compiling node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:26:06.703202 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"
[0m07:26:06.704206 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f (compile): 07:26:06.695893 => 07:26:06.703870
[0m07:26:06.704677 [debug] [Thread-1  ]: Began executing node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:26:06.708050 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"
[0m07:26:06.709263 [debug] [Thread-1  ]: Using snowflake connection "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"
[0m07:26:06.709711 [debug] [Thread-1  ]: On test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from external_db.final_sales.bronze_payments
    group by status

)

select *
from all_values
where value_field not in (
    'fail','success'
)



      
    ) dbt_internal_test
[0m07:26:06.710121 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:07.071985 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:07.075242 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f (execute): 07:26:06.704949 => 07:26:07.074855
[0m07:26:07.075825 [debug] [Thread-1  ]: On test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f: Close
[0m07:26:07.183963 [info ] [Thread-1  ]: 14 of 37 PASS accepted_values_bronze_payments_status__fail__success ............ [[32mPASS[0m in 0.49s]
[0m07:26:07.185385 [debug] [Thread-1  ]: Finished running node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m07:26:07.185951 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:26:07.186453 [info ] [Thread-1  ]: 15 of 37 START test not_null_bronze_payments_order_id .......................... [RUN]
[0m07:26:07.187748 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f, now test.development.not_null_bronze_payments_order_id.50ed7cbd9a)
[0m07:26:07.188192 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:26:07.194098 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"
[0m07:26:07.194994 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_order_id.50ed7cbd9a (compile): 07:26:07.188463 => 07:26:07.194695
[0m07:26:07.195440 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:26:07.198749 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"
[0m07:26:07.199803 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"
[0m07:26:07.200262 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_order_id.50ed7cbd9a: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from external_db.final_sales.bronze_payments
where order_id is null



      
    ) dbt_internal_test
[0m07:26:07.200665 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:07.503316 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:07.506780 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_order_id.50ed7cbd9a (execute): 07:26:07.195715 => 07:26:07.506375
[0m07:26:07.507359 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_order_id.50ed7cbd9a: Close
[0m07:26:07.607050 [info ] [Thread-1  ]: 15 of 37 PASS not_null_bronze_payments_order_id ................................ [[32mPASS[0m in 0.42s]
[0m07:26:07.608190 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m07:26:07.608801 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:26:07.609462 [info ] [Thread-1  ]: 16 of 37 START test not_null_bronze_payments_payment_id ........................ [RUN]
[0m07:26:07.610953 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_order_id.50ed7cbd9a, now test.development.not_null_bronze_payments_payment_id.3473ab0f1f)
[0m07:26:07.611467 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:26:07.617687 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"
[0m07:26:07.618572 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_id.3473ab0f1f (compile): 07:26:07.611871 => 07:26:07.618274
[0m07:26:07.619027 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:26:07.622328 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"
[0m07:26:07.623458 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"
[0m07:26:07.623910 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_payment_id.3473ab0f1f: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from external_db.final_sales.bronze_payments
where payment_id is null



      
    ) dbt_internal_test
[0m07:26:07.624317 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:07.924035 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:07.927582 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_id.3473ab0f1f (execute): 07:26:07.619297 => 07:26:07.927167
[0m07:26:07.928213 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_payment_id.3473ab0f1f: Close
[0m07:26:08.032132 [info ] [Thread-1  ]: 16 of 37 PASS not_null_bronze_payments_payment_id .............................. [[32mPASS[0m in 0.42s]
[0m07:26:08.033293 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m07:26:08.033886 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:26:08.034679 [info ] [Thread-1  ]: 17 of 37 START test not_null_bronze_payments_payment_method .................... [RUN]
[0m07:26:08.035680 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_payment_id.3473ab0f1f, now test.development.not_null_bronze_payments_payment_method.e5fe6e820b)
[0m07:26:08.036115 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:26:08.044051 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"
[0m07:26:08.045088 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_method.e5fe6e820b (compile): 07:26:08.036381 => 07:26:08.044720
[0m07:26:08.045569 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:26:08.048963 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"
[0m07:26:08.050096 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"
[0m07:26:08.050544 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_payment_method.e5fe6e820b: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_method
from external_db.final_sales.bronze_payments
where payment_method is null



      
    ) dbt_internal_test
[0m07:26:08.050988 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:08.362073 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:08.365358 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_method.e5fe6e820b (execute): 07:26:08.045846 => 07:26:08.365012
[0m07:26:08.365880 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_payment_method.e5fe6e820b: Close
[0m07:26:08.476664 [info ] [Thread-1  ]: 17 of 37 PASS not_null_bronze_payments_payment_method .......................... [[32mPASS[0m in 0.44s]
[0m07:26:08.477689 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m07:26:08.478245 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:26:08.478873 [info ] [Thread-1  ]: 18 of 37 START test not_null_bronze_payments_status ............................ [RUN]
[0m07:26:08.479898 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_payment_method.e5fe6e820b, now test.development.not_null_bronze_payments_status.4258d38f0c)
[0m07:26:08.480339 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:26:08.486334 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_status.4258d38f0c"
[0m07:26:08.487302 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_status.4258d38f0c (compile): 07:26:08.480610 => 07:26:08.486967
[0m07:26:08.487740 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:26:08.491071 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_payments_status.4258d38f0c"
[0m07:26:08.492174 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_payments_status.4258d38f0c"
[0m07:26:08.492617 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_status.4258d38f0c: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_payments_status.4258d38f0c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select status
from external_db.final_sales.bronze_payments
where status is null



      
    ) dbt_internal_test
[0m07:26:08.493025 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:08.873663 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:08.876928 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_status.4258d38f0c (execute): 07:26:08.488013 => 07:26:08.876564
[0m07:26:08.877494 [debug] [Thread-1  ]: On test.development.not_null_bronze_payments_status.4258d38f0c: Close
[0m07:26:08.983936 [info ] [Thread-1  ]: 18 of 37 PASS not_null_bronze_payments_status .................................. [[32mPASS[0m in 0.50s]
[0m07:26:08.985347 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_status.4258d38f0c
[0m07:26:08.986074 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:26:08.986940 [info ] [Thread-1  ]: 19 of 37 START test unique_bronze_payments_payment_id .......................... [RUN]
[0m07:26:08.988033 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_status.4258d38f0c, now test.development.unique_bronze_payments_payment_id.537151412e)
[0m07:26:08.988531 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:26:08.995023 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_payments_payment_id.537151412e"
[0m07:26:08.995914 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_payments_payment_id.537151412e (compile): 07:26:08.988919 => 07:26:08.995585
[0m07:26:08.996338 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:26:08.999663 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_bronze_payments_payment_id.537151412e"
[0m07:26:09.000880 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_bronze_payments_payment_id.537151412e"
[0m07:26:09.001334 [debug] [Thread-1  ]: On test.development.unique_bronze_payments_payment_id.537151412e: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_bronze_payments_payment_id.537151412e"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    payment_id as unique_field,
    count(*) as n_records

from external_db.final_sales.bronze_payments
where payment_id is not null
group by payment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:26:09.001752 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:09.344476 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:09.347988 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_payments_payment_id.537151412e (execute): 07:26:08.996603 => 07:26:09.347604
[0m07:26:09.348556 [debug] [Thread-1  ]: On test.development.unique_bronze_payments_payment_id.537151412e: Close
[0m07:26:09.454046 [info ] [Thread-1  ]: 19 of 37 PASS unique_bronze_payments_payment_id ................................ [[32mPASS[0m in 0.47s]
[0m07:26:09.456268 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_payments_payment_id.537151412e
[0m07:26:09.456992 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_products_price.e208481306
[0m07:26:09.457659 [info ] [Thread-1  ]: 20 of 37 START test not_null_bronze_products_price ............................. [RUN]
[0m07:26:09.459204 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_payments_payment_id.537151412e, now test.development.not_null_bronze_products_price.e208481306)
[0m07:26:09.459718 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_products_price.e208481306
[0m07:26:09.466405 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_products_price.e208481306"
[0m07:26:09.467293 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_price.e208481306 (compile): 07:26:09.460050 => 07:26:09.466997
[0m07:26:09.467719 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_products_price.e208481306
[0m07:26:09.470978 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_products_price.e208481306"
[0m07:26:09.472030 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_products_price.e208481306"
[0m07:26:09.472476 [debug] [Thread-1  ]: On test.development.not_null_bronze_products_price.e208481306: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_products_price.e208481306"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from external_db.final_sales.bronze_products
where price is null



      
    ) dbt_internal_test
[0m07:26:09.472875 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:09.762464 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:09.765961 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_price.e208481306 (execute): 07:26:09.467986 => 07:26:09.765572
[0m07:26:09.766546 [debug] [Thread-1  ]: On test.development.not_null_bronze_products_price.e208481306: Close
[0m07:26:09.867235 [info ] [Thread-1  ]: 20 of 37 PASS not_null_bronze_products_price ................................... [[32mPASS[0m in 0.41s]
[0m07:26:09.868543 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_products_price.e208481306
[0m07:26:09.869198 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:26:09.869791 [info ] [Thread-1  ]: 21 of 37 START test not_null_bronze_products_product_id ........................ [RUN]
[0m07:26:09.870646 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_products_price.e208481306, now test.development.not_null_bronze_products_product_id.0e447b9d33)
[0m07:26:09.871108 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:26:09.878582 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_products_product_id.0e447b9d33"
[0m07:26:09.879477 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_product_id.0e447b9d33 (compile): 07:26:09.871374 => 07:26:09.879168
[0m07:26:09.879901 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:26:09.883045 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_bronze_products_product_id.0e447b9d33"
[0m07:26:09.884106 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_bronze_products_product_id.0e447b9d33"
[0m07:26:09.884543 [debug] [Thread-1  ]: On test.development.not_null_bronze_products_product_id.0e447b9d33: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_bronze_products_product_id.0e447b9d33"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from external_db.final_sales.bronze_products
where product_id is null



      
    ) dbt_internal_test
[0m07:26:09.884944 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:10.203762 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:10.209094 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_product_id.0e447b9d33 (execute): 07:26:09.880162 => 07:26:10.208688
[0m07:26:10.209717 [debug] [Thread-1  ]: On test.development.not_null_bronze_products_product_id.0e447b9d33: Close
[0m07:26:10.313437 [info ] [Thread-1  ]: 21 of 37 PASS not_null_bronze_products_product_id .............................. [[32mPASS[0m in 0.44s]
[0m07:26:10.314454 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m07:26:10.315050 [debug] [Thread-1  ]: Began running node test.development.products_price_lower_than_threshold
[0m07:26:10.315880 [info ] [Thread-1  ]: 22 of 37 START test products_price_lower_than_threshold ........................ [RUN]
[0m07:26:10.316748 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_products_product_id.0e447b9d33, now test.development.products_price_lower_than_threshold)
[0m07:26:10.317180 [debug] [Thread-1  ]: Began compiling node test.development.products_price_lower_than_threshold
[0m07:26:10.321230 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.products_price_lower_than_threshold"
[0m07:26:10.322058 [debug] [Thread-1  ]: Timing info for test.development.products_price_lower_than_threshold (compile): 07:26:10.317445 => 07:26:10.321761
[0m07:26:10.322481 [debug] [Thread-1  ]: Began executing node test.development.products_price_lower_than_threshold
[0m07:26:10.325656 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.products_price_lower_than_threshold"
[0m07:26:10.326688 [debug] [Thread-1  ]: Using snowflake connection "test.development.products_price_lower_than_threshold"
[0m07:26:10.327127 [debug] [Thread-1  ]: On test.development.products_price_lower_than_threshold: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.products_price_lower_than_threshold"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
*
FROM
external_db.final_sales.bronze_products
WHERE price < 10
      
    ) dbt_internal_test
[0m07:26:10.327520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:10.606938 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:10.610423 [debug] [Thread-1  ]: Timing info for test.development.products_price_lower_than_threshold (execute): 07:26:10.322770 => 07:26:10.610022
[0m07:26:10.611051 [debug] [Thread-1  ]: On test.development.products_price_lower_than_threshold: Close
[0m07:26:10.712248 [info ] [Thread-1  ]: 22 of 37 PASS products_price_lower_than_threshold .............................. [[32mPASS[0m in 0.40s]
[0m07:26:10.713671 [debug] [Thread-1  ]: Finished running node test.development.products_price_lower_than_threshold
[0m07:26:10.714391 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:26:10.715117 [info ] [Thread-1  ]: 23 of 37 START test unique_bronze_products_product_id .......................... [RUN]
[0m07:26:10.716062 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.products_price_lower_than_threshold, now test.development.unique_bronze_products_product_id.c17035ba1c)
[0m07:26:10.716500 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:26:10.722485 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_products_product_id.c17035ba1c"
[0m07:26:10.723374 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_products_product_id.c17035ba1c (compile): 07:26:10.716769 => 07:26:10.723063
[0m07:26:10.723796 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:26:10.727106 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_bronze_products_product_id.c17035ba1c"
[0m07:26:10.728280 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_bronze_products_product_id.c17035ba1c"
[0m07:26:10.728729 [debug] [Thread-1  ]: On test.development.unique_bronze_products_product_id.c17035ba1c: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_bronze_products_product_id.c17035ba1c"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    product_id as unique_field,
    count(*) as n_records

from external_db.final_sales.bronze_products
where product_id is not null
group by product_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:26:10.729147 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:11.060442 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:11.064468 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_products_product_id.c17035ba1c (execute): 07:26:10.724062 => 07:26:11.064017
[0m07:26:11.065308 [debug] [Thread-1  ]: On test.development.unique_bronze_products_product_id.c17035ba1c: Close
[0m07:26:11.163317 [info ] [Thread-1  ]: 23 of 37 PASS unique_bronze_products_product_id ................................ [[32mPASS[0m in 0.45s]
[0m07:26:11.166095 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_products_product_id.c17035ba1c
[0m07:26:11.166957 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m07:26:11.168047 [info ] [Thread-1  ]: 24 of 37 START sql incremental model final_sales.fct_payment_details ........... [RUN]
[0m07:26:11.169769 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_products_product_id.c17035ba1c, now model.development.fct_payment_details)
[0m07:26:11.179019 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m07:26:11.185062 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m07:26:11.188573 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 07:26:11.179597 => 07:26:11.188146
[0m07:26:11.189196 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m07:26:11.195148 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:26:11.195834 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_ts

    from payments where status = 'success'
)

select * from final
  );
[0m07:26:11.196394 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:11.541810 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:11.548316 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:26:11.548947 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m07:26:11.615820 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:26:11.621000 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:26:11.621605 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m07:26:11.692552 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:26:11.697986 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:26:11.698633 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m07:26:11.759046 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m07:26:11.763204 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m07:26:11.764812 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:26:11.765283 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m07:26:11.861041 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:11.862111 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:26:11.862600 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_TS")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_TS")

;
[0m07:26:18.228034 [debug] [Thread-1  ]: SQL status: SUCCESS 36 in 6.0 seconds
[0m07:26:18.228856 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:26:18.229584 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m07:26:18.432708 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:18.437439 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m07:26:18.437938 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m07:26:18.523239 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:18.526903 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 07:26:11.189563 => 07:26:18.526580
[0m07:26:18.527458 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m07:26:18.629255 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '388961f3-e5ed-49c6-be44-5d17d8973591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fd55a790>]}
[0m07:26:18.630455 [info ] [Thread-1  ]: 24 of 37 OK created sql incremental model final_sales.fct_payment_details ...... [[32mSUCCESS 36[0m in 7.46s]
[0m07:26:18.631970 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m07:26:18.632602 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m07:26:18.633677 [info ] [Thread-1  ]: 25 of 37 START sql incremental model final_sales.fct_order_detail .............. [RUN]
[0m07:26:18.634805 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m07:26:18.635245 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m07:26:18.641842 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m07:26:18.642640 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 07:26:18.635512 => 07:26:18.642359
[0m07:26:18.643081 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m07:26:18.648280 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:26:18.648776 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace  temporary view external_db.final_sales.fct_order_detail__dbt_tmp
  
   as (
    
with orders as (
    select * from external_db.final_sales.bronze_orders
   
        where run_ts = to_timestamp('2023-06-22')
    
),

products as (
    select * from external_db.final_sales.bronze_products
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_ts
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m07:26:18.649203 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:19.166905 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m07:26:19.171456 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:26:19.172161 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail__dbt_tmp
[0m07:26:19.246208 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:26:19.252005 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:26:19.252614 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail
[0m07:26:19.314476 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:26:19.321350 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:26:19.321984 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_ORDER_DETAIL"
[0m07:26:19.390067 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m07:26:19.394437 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m07:26:19.396218 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:26:19.396672 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
-- back compat for old kwarg name
  
  begin;
[0m07:26:19.495160 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:19.495840 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:26:19.496528 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
merge into external_db.final_sales.fct_order_detail as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_order_detail__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_TS")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_TS")

;
[0m07:26:19.902129 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 0.0 seconds
[0m07:26:19.903358 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:26:19.903954 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
COMMIT
[0m07:26:20.106446 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:20.111207 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m07:26:20.111715 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m07:26:20.207668 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:20.211221 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 07:26:18.643343 => 07:26:20.210952
[0m07:26:20.211768 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m07:26:20.327887 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '388961f3-e5ed-49c6-be44-5d17d8973591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fc3a1d00>]}
[0m07:26:20.328916 [info ] [Thread-1  ]: 25 of 37 OK created sql incremental model final_sales.fct_order_detail ......... [[32mSUCCESS 50[0m in 1.69s]
[0m07:26:20.329760 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m07:26:20.330316 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:26:20.331012 [info ] [Thread-1  ]: 26 of 37 START test not_null_fct_payment_details_order_id ...................... [RUN]
[0m07:26:20.332167 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now test.development.not_null_fct_payment_details_order_id.7bb58db616)
[0m07:26:20.332701 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:26:20.338810 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_payment_details_order_id.7bb58db616"
[0m07:26:20.383551 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_order_id.7bb58db616 (compile): 07:26:20.333055 => 07:26:20.382964
[0m07:26:20.384253 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:26:20.388512 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_payment_details_order_id.7bb58db616"
[0m07:26:20.389649 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_payment_details_order_id.7bb58db616"
[0m07:26:20.390113 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_order_id.7bb58db616: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_payment_details_order_id.7bb58db616"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from external_db.final_sales.fct_payment_details
where order_id is null



      
    ) dbt_internal_test
[0m07:26:20.390533 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:20.870083 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:20.873276 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_order_id.7bb58db616 (execute): 07:26:20.384595 => 07:26:20.872915
[0m07:26:20.873812 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_order_id.7bb58db616: Close
[0m07:26:20.980474 [info ] [Thread-1  ]: 26 of 37 PASS not_null_fct_payment_details_order_id ............................ [[32mPASS[0m in 0.65s]
[0m07:26:20.981804 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m07:26:20.982433 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:26:20.982932 [info ] [Thread-1  ]: 27 of 37 START test not_null_fct_payment_details_payment_id .................... [RUN]
[0m07:26:20.984080 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_payment_details_order_id.7bb58db616, now test.development.not_null_fct_payment_details_payment_id.d55bc575d7)
[0m07:26:20.984532 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:26:20.990396 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_payment_details_payment_id.d55bc575d7"
[0m07:26:20.991278 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_id.d55bc575d7 (compile): 07:26:20.984802 => 07:26:20.990980
[0m07:26:20.991707 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:26:20.994962 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_payment_details_payment_id.d55bc575d7"
[0m07:26:20.995994 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_payment_details_payment_id.d55bc575d7"
[0m07:26:20.996434 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_payment_id.d55bc575d7: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_payment_details_payment_id.d55bc575d7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_id
from external_db.final_sales.fct_payment_details
where payment_id is null



      
    ) dbt_internal_test
[0m07:26:20.996843 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:21.291095 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:21.294729 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_id.d55bc575d7 (execute): 07:26:20.991976 => 07:26:21.294159
[0m07:26:21.295364 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_payment_id.d55bc575d7: Close
[0m07:26:21.398973 [info ] [Thread-1  ]: 27 of 37 PASS not_null_fct_payment_details_payment_id .......................... [[32mPASS[0m in 0.42s]
[0m07:26:21.400513 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m07:26:21.401238 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:26:21.401954 [info ] [Thread-1  ]: 28 of 37 START test not_null_fct_payment_details_payment_method ................ [RUN]
[0m07:26:21.403113 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_payment_details_payment_id.d55bc575d7, now test.development.not_null_fct_payment_details_payment_method.62d221c77e)
[0m07:26:21.403948 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:26:21.410223 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_payment_details_payment_method.62d221c77e"
[0m07:26:21.411485 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_method.62d221c77e (compile): 07:26:21.404489 => 07:26:21.411172
[0m07:26:21.412018 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:26:21.417438 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_payment_details_payment_method.62d221c77e"
[0m07:26:21.419018 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_payment_details_payment_method.62d221c77e"
[0m07:26:21.419568 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_payment_method.62d221c77e: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_payment_details_payment_method.62d221c77e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select payment_method
from external_db.final_sales.fct_payment_details
where payment_method is null



      
    ) dbt_internal_test
[0m07:26:21.420073 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:21.727987 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:21.731215 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_method.62d221c77e (execute): 07:26:21.412372 => 07:26:21.730861
[0m07:26:21.731742 [debug] [Thread-1  ]: On test.development.not_null_fct_payment_details_payment_method.62d221c77e: Close
[0m07:26:21.839433 [info ] [Thread-1  ]: 28 of 37 PASS not_null_fct_payment_details_payment_method ...................... [[32mPASS[0m in 0.44s]
[0m07:26:21.840855 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m07:26:21.841422 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:26:21.842032 [info ] [Thread-1  ]: 29 of 37 START test not_null_fct_order_detail_customer_id ...................... [RUN]
[0m07:26:21.843133 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_payment_details_payment_method.62d221c77e, now test.development.not_null_fct_order_detail_customer_id.44d928392b)
[0m07:26:21.843586 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:26:21.851635 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_customer_id.44d928392b"
[0m07:26:21.852594 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_customer_id.44d928392b (compile): 07:26:21.843870 => 07:26:21.852279
[0m07:26:21.853040 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:26:21.856333 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_order_detail_customer_id.44d928392b"
[0m07:26:21.857409 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_order_detail_customer_id.44d928392b"
[0m07:26:21.857879 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_customer_id.44d928392b: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_order_detail_customer_id.44d928392b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from external_db.final_sales.fct_order_detail
where customer_id is null



      
    ) dbt_internal_test
[0m07:26:21.858301 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:22.202371 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:22.205542 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_customer_id.44d928392b (execute): 07:26:21.853311 => 07:26:22.205197
[0m07:26:22.206062 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_customer_id.44d928392b: Close
[0m07:26:22.310108 [info ] [Thread-1  ]: 29 of 37 PASS not_null_fct_order_detail_customer_id ............................ [[32mPASS[0m in 0.47s]
[0m07:26:22.311604 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m07:26:22.312184 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:26:22.312759 [info ] [Thread-1  ]: 30 of 37 START test not_null_fct_order_detail_order_date ....................... [RUN]
[0m07:26:22.313823 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_customer_id.44d928392b, now test.development.not_null_fct_order_detail_order_date.c6f89a052d)
[0m07:26:22.314260 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:26:22.320130 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_order_date.c6f89a052d"
[0m07:26:22.320955 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_date.c6f89a052d (compile): 07:26:22.314620 => 07:26:22.320673
[0m07:26:22.321376 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:26:22.324569 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_order_detail_order_date.c6f89a052d"
[0m07:26:22.325610 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_order_detail_order_date.c6f89a052d"
[0m07:26:22.326043 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_order_date.c6f89a052d: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_order_detail_order_date.c6f89a052d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_date
from external_db.final_sales.fct_order_detail
where order_date is null



      
    ) dbt_internal_test
[0m07:26:22.326438 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:22.631150 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:22.634713 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_date.c6f89a052d (execute): 07:26:22.321640 => 07:26:22.634303
[0m07:26:22.635351 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_order_date.c6f89a052d: Close
[0m07:26:22.733881 [info ] [Thread-1  ]: 30 of 37 PASS not_null_fct_order_detail_order_date ............................. [[32mPASS[0m in 0.42s]
[0m07:26:22.735023 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m07:26:22.735596 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:26:22.736217 [info ] [Thread-1  ]: 31 of 37 START test not_null_fct_order_detail_order_id ......................... [RUN]
[0m07:26:22.737085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_order_date.c6f89a052d, now test.development.not_null_fct_order_detail_order_id.47ace119a7)
[0m07:26:22.737520 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:26:22.743449 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_order_id.47ace119a7"
[0m07:26:22.744345 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_id.47ace119a7 (compile): 07:26:22.737790 => 07:26:22.744043
[0m07:26:22.744779 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:26:22.748095 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_order_detail_order_id.47ace119a7"
[0m07:26:22.749128 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_order_detail_order_id.47ace119a7"
[0m07:26:22.749567 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_order_id.47ace119a7: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_order_detail_order_id.47ace119a7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from external_db.final_sales.fct_order_detail
where order_id is null



      
    ) dbt_internal_test
[0m07:26:22.749968 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:23.081183 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:23.084493 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_id.47ace119a7 (execute): 07:26:22.745049 => 07:26:23.084087
[0m07:26:23.085105 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_order_id.47ace119a7: Close
[0m07:26:23.193803 [info ] [Thread-1  ]: 31 of 37 PASS not_null_fct_order_detail_order_id ............................... [[32mPASS[0m in 0.46s]
[0m07:26:23.194966 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m07:26:23.195542 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:26:23.196174 [info ] [Thread-1  ]: 32 of 37 START test not_null_fct_order_detail_price ............................ [RUN]
[0m07:26:23.197065 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_order_id.47ace119a7, now test.development.not_null_fct_order_detail_price.c149ee0e5c)
[0m07:26:23.197506 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:26:23.203461 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_price.c149ee0e5c"
[0m07:26:23.204360 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_price.c149ee0e5c (compile): 07:26:23.197782 => 07:26:23.204051
[0m07:26:23.204813 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:26:23.208173 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_order_detail_price.c149ee0e5c"
[0m07:26:23.209259 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_order_detail_price.c149ee0e5c"
[0m07:26:23.209720 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_price.c149ee0e5c: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_order_detail_price.c149ee0e5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select price
from external_db.final_sales.fct_order_detail
where price is null



      
    ) dbt_internal_test
[0m07:26:23.210145 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:23.508031 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:23.511547 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_price.c149ee0e5c (execute): 07:26:23.205088 => 07:26:23.511138
[0m07:26:23.512175 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_price.c149ee0e5c: Close
[0m07:26:23.619760 [info ] [Thread-1  ]: 32 of 37 PASS not_null_fct_order_detail_price .................................. [[32mPASS[0m in 0.42s]
[0m07:26:23.620881 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m07:26:23.621482 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:26:23.621987 [info ] [Thread-1  ]: 33 of 37 START test not_null_fct_order_detail_product_id ....................... [RUN]
[0m07:26:23.622930 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_price.c149ee0e5c, now test.development.not_null_fct_order_detail_product_id.73135971e6)
[0m07:26:23.623599 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:26:23.631474 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_product_id.73135971e6"
[0m07:26:23.632333 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_product_id.73135971e6 (compile): 07:26:23.623928 => 07:26:23.632033
[0m07:26:23.632766 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:26:23.635994 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_fct_order_detail_product_id.73135971e6"
[0m07:26:23.637045 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_fct_order_detail_product_id.73135971e6"
[0m07:26:23.637486 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_product_id.73135971e6: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_fct_order_detail_product_id.73135971e6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from external_db.final_sales.fct_order_detail
where product_id is null



      
    ) dbt_internal_test
[0m07:26:23.637888 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:23.966254 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:23.969893 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_product_id.73135971e6 (execute): 07:26:23.633038 => 07:26:23.969460
[0m07:26:23.970541 [debug] [Thread-1  ]: On test.development.not_null_fct_order_detail_product_id.73135971e6: Close
[0m07:26:24.064962 [info ] [Thread-1  ]: 33 of 37 PASS not_null_fct_order_detail_product_id ............................. [[32mPASS[0m in 0.44s]
[0m07:26:24.066046 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m07:26:24.066615 [debug] [Thread-1  ]: Began running node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:26:24.067292 [info ] [Thread-1  ]: 34 of 37 START test unique_fct_order_detail_order_id ........................... [RUN]
[0m07:26:24.068323 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_product_id.73135971e6, now test.development.unique_fct_order_detail_order_id.256da980ed)
[0m07:26:24.068796 [debug] [Thread-1  ]: Began compiling node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:26:24.075192 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_fct_order_detail_order_id.256da980ed"
[0m07:26:24.076175 [debug] [Thread-1  ]: Timing info for test.development.unique_fct_order_detail_order_id.256da980ed (compile): 07:26:24.069076 => 07:26:24.075851
[0m07:26:24.076638 [debug] [Thread-1  ]: Began executing node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:26:24.080165 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.unique_fct_order_detail_order_id.256da980ed"
[0m07:26:24.081587 [debug] [Thread-1  ]: Using snowflake connection "test.development.unique_fct_order_detail_order_id.256da980ed"
[0m07:26:24.082079 [debug] [Thread-1  ]: On test.development.unique_fct_order_detail_order_id.256da980ed: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.unique_fct_order_detail_order_id.256da980ed"} */
select
      count(*) as failures,
      count(*) >10 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from external_db.final_sales.fct_order_detail
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m07:26:24.082495 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:24.450073 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:24.453393 [debug] [Thread-1  ]: Timing info for test.development.unique_fct_order_detail_order_id.256da980ed (execute): 07:26:24.076914 => 07:26:24.453001
[0m07:26:24.453982 [debug] [Thread-1  ]: On test.development.unique_fct_order_detail_order_id.256da980ed: Close
[0m07:26:24.591928 [info ] [Thread-1  ]: 34 of 37 PASS unique_fct_order_detail_order_id ................................. [[32mPASS[0m in 0.52s]
[0m07:26:24.593632 [debug] [Thread-1  ]: Finished running node test.development.unique_fct_order_detail_order_id.256da980ed
[0m07:26:24.594883 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m07:26:24.598642 [info ] [Thread-1  ]: 35 of 37 START sql incremental model final_sales.product_sales ................. [RUN]
[0m07:26:24.601830 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_fct_order_detail_order_id.256da980ed, now model.development.product_sales)
[0m07:26:24.602455 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m07:26:24.610199 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m07:26:24.611256 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 07:26:24.602778 => 07:26:24.610913
[0m07:26:24.611734 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m07:26:24.616983 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:26:24.617511 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace  temporary view external_db.final_sales.product_sales__dbt_tmp
  
   as (
    

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
        where run_ts = to_timestamp('2023-06-22')
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
        where run_ts = to_timestamp('2023-06-22')
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as (

    select
        order_details.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m07:26:24.617949 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:25.099343 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:25.103419 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:26:25.103982 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales__dbt_tmp
[0m07:26:25.178647 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m07:26:25.185187 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:26:25.185820 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales
[0m07:26:25.256234 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m07:26:25.261168 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:26:25.261780 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."PRODUCT_SALES"
[0m07:26:25.328074 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m07:26:25.332157 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m07:26:25.334035 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:26:25.334588 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
-- back compat for old kwarg name
  
  begin;
[0m07:26:25.420581 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:25.421383 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:26:25.421861 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
merge into external_db.final_sales.product_sales as DBT_INTERNAL_DEST
        using external_db.final_sales.product_sales__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","ORDER_AMOUNT" = DBT_INTERNAL_SOURCE."ORDER_AMOUNT"
    

    when not matched then insert
        ("CUSTOMER_ID", "ORDER_AMOUNT")
    values
        ("CUSTOMER_ID", "ORDER_AMOUNT")

;
[0m07:26:25.855621 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 0.0 seconds
[0m07:26:25.856385 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:26:25.856835 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
COMMIT
[0m07:26:26.061158 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:26.066334 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m07:26:26.066944 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m07:26:26.156147 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:26.159844 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 07:26:24.612017 => 07:26:26.159554
[0m07:26:26.160381 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m07:26:26.269157 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '388961f3-e5ed-49c6-be44-5d17d8973591', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fd543250>]}
[0m07:26:26.270484 [info ] [Thread-1  ]: 35 of 37 OK created sql incremental model final_sales.product_sales ............ [[32mSUCCESS 50[0m in 1.67s]
[0m07:26:26.272708 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m07:26:26.273971 [debug] [Thread-1  ]: Began running node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m07:26:26.275237 [info ] [Thread-1  ]: 36 of 37 START test not_null_product_sales_customer_id ......................... [RUN]
[0m07:26:26.276911 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.product_sales, now test.development.not_null_product_sales_customer_id.acc9e6dd8e)
[0m07:26:26.278025 [debug] [Thread-1  ]: Began compiling node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m07:26:26.285230 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_product_sales_customer_id.acc9e6dd8e"
[0m07:26:26.286537 [debug] [Thread-1  ]: Timing info for test.development.not_null_product_sales_customer_id.acc9e6dd8e (compile): 07:26:26.278392 => 07:26:26.286027
[0m07:26:26.287501 [debug] [Thread-1  ]: Began executing node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m07:26:26.291626 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_product_sales_customer_id.acc9e6dd8e"
[0m07:26:26.293006 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_product_sales_customer_id.acc9e6dd8e"
[0m07:26:26.293599 [debug] [Thread-1  ]: On test.development.not_null_product_sales_customer_id.acc9e6dd8e: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_product_sales_customer_id.acc9e6dd8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from external_db.final_sales.product_sales
where customer_id is null



      
    ) dbt_internal_test
[0m07:26:26.294476 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:26.606008 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:26.609505 [debug] [Thread-1  ]: Timing info for test.development.not_null_product_sales_customer_id.acc9e6dd8e (execute): 07:26:26.287838 => 07:26:26.609121
[0m07:26:26.610086 [debug] [Thread-1  ]: On test.development.not_null_product_sales_customer_id.acc9e6dd8e: Close
[0m07:26:26.711254 [info ] [Thread-1  ]: 36 of 37 PASS not_null_product_sales_customer_id ............................... [[32mPASS[0m in 0.43s]
[0m07:26:26.712740 [debug] [Thread-1  ]: Finished running node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m07:26:26.713466 [debug] [Thread-1  ]: Began running node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m07:26:26.714153 [info ] [Thread-1  ]: 37 of 37 START test not_null_product_sales_order_amount ........................ [RUN]
[0m07:26:26.715259 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_product_sales_customer_id.acc9e6dd8e, now test.development.not_null_product_sales_order_amount.b9ffa2ea2b)
[0m07:26:26.715765 [debug] [Thread-1  ]: Began compiling node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m07:26:26.721651 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_product_sales_order_amount.b9ffa2ea2b"
[0m07:26:26.722470 [debug] [Thread-1  ]: Timing info for test.development.not_null_product_sales_order_amount.b9ffa2ea2b (compile): 07:26:26.716047 => 07:26:26.722191
[0m07:26:26.722950 [debug] [Thread-1  ]: Began executing node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m07:26:26.726240 [debug] [Thread-1  ]: Writing runtime sql for node "test.development.not_null_product_sales_order_amount.b9ffa2ea2b"
[0m07:26:26.727351 [debug] [Thread-1  ]: Using snowflake connection "test.development.not_null_product_sales_order_amount.b9ffa2ea2b"
[0m07:26:26.727857 [debug] [Thread-1  ]: On test.development.not_null_product_sales_order_amount.b9ffa2ea2b: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "test.development.not_null_product_sales_order_amount.b9ffa2ea2b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_amount
from external_db.final_sales.product_sales
where order_amount is null



      
    ) dbt_internal_test
[0m07:26:26.728286 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:26:27.039449 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m07:26:27.042539 [debug] [Thread-1  ]: Timing info for test.development.not_null_product_sales_order_amount.b9ffa2ea2b (execute): 07:26:26.723222 => 07:26:27.042175
[0m07:26:27.043085 [debug] [Thread-1  ]: On test.development.not_null_product_sales_order_amount.b9ffa2ea2b: Close
[0m07:26:27.145205 [info ] [Thread-1  ]: 37 of 37 PASS not_null_product_sales_order_amount .............................. [[32mPASS[0m in 0.43s]
[0m07:26:27.146345 [debug] [Thread-1  ]: Finished running node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m07:26:27.148901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:26:27.149402 [debug] [MainThread]: Connection 'test.development.not_null_product_sales_order_amount.b9ffa2ea2b' was properly closed.
[0m07:26:27.149994 [info ] [MainThread]: 
[0m07:26:27.150996 [info ] [MainThread]: Finished running 7 incremental models, 30 tests in 0 hours 0 minutes and 34.39 seconds (34.39s).
[0m07:26:27.157767 [debug] [MainThread]: Command end result
[0m07:26:27.171190 [info ] [MainThread]: 
[0m07:26:27.171850 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:26:27.172323 [info ] [MainThread]: 
[0m07:26:27.172754 [info ] [MainThread]: Done. PASS=37 WARN=0 ERROR=0 SKIP=0 TOTAL=37
[0m07:26:27.173696 [debug] [MainThread]: Command `dbt build` succeeded at 07:26:27.173547 after 35.91 seconds
[0m07:26:27.174138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb40574d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ff9451f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3ff9451c0>]}
[0m07:26:27.174591 [debug] [MainThread]: Flushing usage events
[0m06:33:53.963510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f296622b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2964b308b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2964b30160>]}


============================== 06:33:53.967916 | 97546bd5-bf55-4d29-b9dd-f3366fef2f32 ==============================
[0m06:33:53.967916 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:33:53.968564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/dbt_project/dbt/dbt', 'log_path': '/home/satyam/dbt_project/dbt/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:33:55.615544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97546bd5-bf55-4d29-b9dd-f3366fef2f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295f39cd90>]}
[0m06:33:55.637407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97546bd5-bf55-4d29-b9dd-f3366fef2f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295f383ca0>]}
[0m06:33:55.656770 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:33:55.746085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:33:55.746662 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:33:55.747660 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.silver
- models.development.gold
[0m06:33:55.755899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97546bd5-bf55-4d29-b9dd-f3366fef2f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295f277d60>]}
[0m06:33:55.768120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97546bd5-bf55-4d29-b9dd-f3366fef2f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295f368b20>]}
[0m06:33:55.768816 [info ] [MainThread]: Found 7 models, 30 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m06:33:55.769307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97546bd5-bf55-4d29-b9dd-f3366fef2f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295f368ca0>]}
[0m06:33:55.771828 [info ] [MainThread]: 
[0m06:33:55.772788 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:33:55.774512 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m06:33:55.792040 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m06:33:55.792609 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m06:33:55.792954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:33:57.264895 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m06:33:57.268109 [debug] [ThreadPool]: On list_external_db: Close
[0m06:33:57.370590 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now create_external_db_final_sales)
[0m06:33:57.371722 [debug] [ThreadPool]: Creating schema "database: "external_db"
schema: "final_sales"
"
[0m06:33:57.378724 [debug] [ThreadPool]: Using snowflake connection "create_external_db_final_sales"
[0m06:33:57.379182 [debug] [ThreadPool]: On create_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "create_external_db_final_sales"} */
create schema if not exists external_db.final_sales
[0m06:33:57.379562 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:33:57.686732 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:33:57.688280 [debug] [ThreadPool]: On create_external_db_final_sales: Close
[0m06:33:57.784088 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_external_db_final_sales, now list_external_db_final_sales)
[0m06:33:57.796002 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m06:33:57.796909 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m06:33:57.797301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:33:58.253880 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m06:33:58.255852 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m06:33:58.364845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97546bd5-bf55-4d29-b9dd-f3366fef2f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295f3830a0>]}
[0m06:33:58.366334 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:33:58.367096 [info ] [MainThread]: 
[0m06:33:58.378268 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m06:33:58.379491 [info ] [Thread-1  ]: 1 of 7 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m06:33:58.380425 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m06:33:58.380875 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m06:33:58.385781 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m06:33:58.386716 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 06:33:58.381163 => 06:33:58.386418
[0m06:33:58.387146 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m06:33:58.452986 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m06:33:58.454478 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:33:58.455005 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace transient table external_db.final_sales.bronze_customers
         as
        (

with customers as (
     select *, 
     to_timestamp('2023-06-22') as run_ts  from external_db.stage.customers
)

select * from customers
        );
[0m06:33:58.455444 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:00.744105 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m06:34:00.754266 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:34:00.754810 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m06:34:00.816082 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:34:00.840773 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 06:33:58.387430 => 06:34:00.840491
[0m06:34:00.841356 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m06:34:00.941251 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97546bd5-bf55-4d29-b9dd-f3366fef2f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295f3830a0>]}
[0m06:34:00.942383 [info ] [Thread-1  ]: 1 of 7 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 1[0m in 2.56s]
[0m06:34:00.943363 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m06:34:00.943968 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m06:34:00.944793 [info ] [Thread-1  ]: 2 of 7 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m06:34:00.945880 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m06:34:00.946320 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m06:34:00.950901 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m06:34:00.951671 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 06:34:00.946591 => 06:34:00.951396
[0m06:34:00.952086 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m06:34:00.956334 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m06:34:00.957336 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:34:00.957772 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace transient table external_db.final_sales.bronze_orders
         as
        (

with orders as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.orders
)

select * from orders
        );
[0m06:34:00.958169 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:02.506612 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.0 seconds
[0m06:34:02.511577 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:34:02.512141 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m06:34:02.578180 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:34:02.581548 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 06:34:00.952347 => 06:34:02.581268
[0m06:34:02.582044 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m06:34:02.691595 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97546bd5-bf55-4d29-b9dd-f3366fef2f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295e9d3670>]}
[0m06:34:02.692624 [info ] [Thread-1  ]: 2 of 7 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 1[0m in 1.75s]
[0m06:34:02.693446 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m06:34:02.693972 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m06:34:02.694675 [info ] [Thread-1  ]: 3 of 7 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m06:34:02.695599 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m06:34:02.696036 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m06:34:02.700670 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m06:34:02.701428 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 06:34:02.696308 => 06:34:02.701154
[0m06:34:02.701846 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m06:34:02.706238 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m06:34:02.707277 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:34:02.707715 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace transient table external_db.final_sales.bronze_payments
         as
        (

with payments as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.payments
)

select * from payments
        );
[0m06:34:02.708129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:03.629070 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:34:03.714995 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:34:03.715655 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m06:34:03.771439 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:34:03.775138 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 06:34:02.702107 => 06:34:03.774845
[0m06:34:03.775717 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m06:34:03.875636 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97546bd5-bf55-4d29-b9dd-f3366fef2f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295c9aaa60>]}
[0m06:34:03.876658 [info ] [Thread-1  ]: 3 of 7 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 1[0m in 1.18s]
[0m06:34:03.877508 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m06:34:03.878043 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m06:34:03.878838 [info ] [Thread-1  ]: 4 of 7 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m06:34:03.879890 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m06:34:03.880324 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m06:34:03.884618 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m06:34:03.885344 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 06:34:03.880589 => 06:34:03.885077
[0m06:34:03.885750 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m06:34:03.889765 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m06:34:03.890749 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:34:03.891171 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace transient table external_db.final_sales.bronze_products
         as
        (

with products as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.products
)

select * from products
        );
[0m06:34:03.891583 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:04.982340 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:34:04.986982 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:34:04.987567 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m06:34:05.064097 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:34:05.067746 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 06:34:03.886009 => 06:34:05.067479
[0m06:34:05.068259 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m06:34:05.188111 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97546bd5-bf55-4d29-b9dd-f3366fef2f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295ca27220>]}
[0m06:34:05.189127 [info ] [Thread-1  ]: 4 of 7 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 1[0m in 1.31s]
[0m06:34:05.189985 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m06:34:05.190507 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m06:34:05.191378 [info ] [Thread-1  ]: 5 of 7 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m06:34:05.192715 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.fct_payment_details)
[0m06:34:05.193165 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m06:34:05.203074 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m06:34:05.204170 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 06:34:05.193445 => 06:34:05.203838
[0m06:34:05.204660 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m06:34:05.209076 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m06:34:05.210376 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:34:05.210829 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace transient table external_db.final_sales.fct_payment_details
         as
        (

with payments as (
    select * from external_db.final_sales.bronze_payments
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_ts

    from payments where status = 'success'
)

select * from final
        );
[0m06:34:05.211233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:06.081174 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:34:06.086684 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:34:06.087289 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m06:34:06.153992 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:34:06.157379 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 06:34:05.204936 => 06:34:06.157113
[0m06:34:06.157891 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m06:34:06.259176 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97546bd5-bf55-4d29-b9dd-f3366fef2f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295ca27310>]}
[0m06:34:06.260297 [info ] [Thread-1  ]: 5 of 7 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 1[0m in 1.07s]
[0m06:34:06.261175 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m06:34:06.261713 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m06:34:06.262429 [info ] [Thread-1  ]: 6 of 7 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m06:34:06.263360 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m06:34:06.263800 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m06:34:06.269891 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m06:34:06.270756 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 06:34:06.264067 => 06:34:06.270463
[0m06:34:06.271208 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m06:34:06.277417 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m06:34:06.278959 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:34:06.279471 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace transient table external_db.final_sales.fct_order_detail
         as
        (
with orders as (
    select * from external_db.final_sales.bronze_orders
   
),

products as (
    select * from external_db.final_sales.bronze_products
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_ts
    from orders
    left join products using (product_id)
)
select * from final
        );
[0m06:34:06.279905 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:07.213308 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:34:07.218400 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:34:07.218969 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m06:34:07.294774 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:34:07.298196 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 06:34:06.271535 => 06:34:07.297937
[0m06:34:07.298714 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m06:34:07.406475 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97546bd5-bf55-4d29-b9dd-f3366fef2f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295c9e2fd0>]}
[0m06:34:07.407566 [info ] [Thread-1  ]: 6 of 7 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 1[0m in 1.14s]
[0m06:34:07.408411 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m06:34:07.409781 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m06:34:07.410422 [info ] [Thread-1  ]: 7 of 7 START sql incremental model final_sales.product_sales ................... [RUN]
[0m06:34:07.411398 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m06:34:07.411887 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m06:34:07.419149 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m06:34:07.420120 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 06:34:07.412183 => 06:34:07.419848
[0m06:34:07.420537 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m06:34:07.425131 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m06:34:07.426900 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:34:07.427372 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace transient table external_db.final_sales.product_sales
         as
        (

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
),

final as (

    select
        order_details.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
        );
[0m06:34:07.427792 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:34:08.522134 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:34:08.527236 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:34:08.527843 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m06:34:08.588351 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:34:08.593479 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 06:34:07.420801 => 06:34:08.593194
[0m06:34:08.594088 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m06:34:08.693068 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97546bd5-bf55-4d29-b9dd-f3366fef2f32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295ca38070>]}
[0m06:34:08.694298 [info ] [Thread-1  ]: 7 of 7 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 1[0m in 1.28s]
[0m06:34:08.695425 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m06:34:08.697579 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:34:08.697989 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m06:34:08.698503 [info ] [MainThread]: 
[0m06:34:08.699087 [info ] [MainThread]: Finished running 7 incremental models in 0 hours 0 minutes and 12.93 seconds (12.93s).
[0m06:34:08.700934 [debug] [MainThread]: Command end result
[0m06:34:08.711890 [info ] [MainThread]: 
[0m06:34:08.712650 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:34:08.713122 [info ] [MainThread]: 
[0m06:34:08.713564 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m06:34:08.714572 [debug] [MainThread]: Command `dbt run` succeeded at 06:34:08.714409 after 14.77 seconds
[0m06:34:08.715029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f296622b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295ca12a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295f368be0>]}
[0m06:34:08.715504 [debug] [MainThread]: Flushing usage events
[0m06:35:32.841193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d72bc90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d714da8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d714da0d0>]}


============================== 06:35:32.844626 | c85fc025-9d03-4c94-af64-c78567f33ba1 ==============================
[0m06:35:32.844626 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:35:32.845259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/dbt_project/dbt/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/dbt_project/dbt/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:35:33.129476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c85fc025-9d03-4c94-af64-c78567f33ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6bd30df0>]}
[0m06:35:33.147471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c85fc025-9d03-4c94-af64-c78567f33ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6bd08910>]}
[0m06:35:33.162754 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:35:33.188185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:35:33.188740 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:35:33.189637 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.development.gold
- models.development.silver
- models.development.bronze
- models.development.staging
[0m06:35:33.197432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c85fc025-9d03-4c94-af64-c78567f33ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6bbf8d90>]}
[0m06:35:33.209100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c85fc025-9d03-4c94-af64-c78567f33ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6bcb8c40>]}
[0m06:35:33.209784 [info ] [MainThread]: Found 7 models, 30 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m06:35:33.210274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c85fc025-9d03-4c94-af64-c78567f33ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6bcb8cd0>]}
[0m06:35:33.213219 [info ] [MainThread]: 
[0m06:35:33.214170 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:35:33.215986 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m06:35:33.236589 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m06:35:33.237166 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m06:35:33.237526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:35:33.924731 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m06:35:33.927989 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m06:35:34.039600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c85fc025-9d03-4c94-af64-c78567f33ba1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6bd23730>]}
[0m06:35:34.040880 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:35:34.041457 [info ] [MainThread]: 
[0m06:35:34.046291 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m06:35:34.047064 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m06:35:34.047534 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m06:35:34.053747 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m06:35:34.054615 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 06:35:34.047817 => 06:35:34.054287
[0m06:35:34.055055 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m06:35:34.055621 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 06:35:34.055348 => 06:35:34.055384
[0m06:35:34.056645 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m06:35:34.057140 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m06:35:34.058076 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m06:35:34.058653 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m06:35:34.062974 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m06:35:34.063778 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 06:35:34.059026 => 06:35:34.063487
[0m06:35:34.064202 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m06:35:34.064700 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 06:35:34.064464 => 06:35:34.064478
[0m06:35:34.065682 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m06:35:34.066167 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m06:35:34.067072 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m06:35:34.067726 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m06:35:34.072037 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m06:35:34.072822 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 06:35:34.068018 => 06:35:34.072533
[0m06:35:34.073230 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m06:35:34.073724 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 06:35:34.073487 => 06:35:34.073500
[0m06:35:34.074681 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m06:35:34.075163 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m06:35:34.076094 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m06:35:34.076720 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m06:35:34.080915 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m06:35:34.081693 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 06:35:34.077028 => 06:35:34.081403
[0m06:35:34.082104 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m06:35:34.082599 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 06:35:34.082360 => 06:35:34.082373
[0m06:35:34.083580 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m06:35:34.084085 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m06:35:34.084968 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now test.development.not_null_bronze_customers_customer_id.254c74eb6e)
[0m06:35:34.085399 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m06:35:34.100722 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_customers_customer_id.254c74eb6e"
[0m06:35:34.101720 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_customer_id.254c74eb6e (compile): 06:35:34.085852 => 06:35:34.101402
[0m06:35:34.102187 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m06:35:34.102691 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_customer_id.254c74eb6e (execute): 06:35:34.102451 => 06:35:34.102467
[0m06:35:34.103717 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m06:35:34.104211 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_customers_first_name.22deabc315
[0m06:35:34.105070 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_customers_customer_id.254c74eb6e, now test.development.not_null_bronze_customers_first_name.22deabc315)
[0m06:35:34.105490 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_customers_first_name.22deabc315
[0m06:35:34.110335 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_customers_first_name.22deabc315"
[0m06:35:34.111053 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_first_name.22deabc315 (compile): 06:35:34.105746 => 06:35:34.110798
[0m06:35:34.111483 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_customers_first_name.22deabc315
[0m06:35:34.111987 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_first_name.22deabc315 (execute): 06:35:34.111749 => 06:35:34.111762
[0m06:35:34.112917 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_customers_first_name.22deabc315
[0m06:35:34.113404 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m06:35:34.114206 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_customers_first_name.22deabc315, now test.development.unique_bronze_customers_customer_id.f8660c11fe)
[0m06:35:34.114620 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m06:35:34.122666 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_customers_customer_id.f8660c11fe"
[0m06:35:34.123409 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_customers_customer_id.f8660c11fe (compile): 06:35:34.114871 => 06:35:34.123121
[0m06:35:34.123826 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m06:35:34.124326 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_customers_customer_id.f8660c11fe (execute): 06:35:34.124087 => 06:35:34.124100
[0m06:35:34.125266 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m06:35:34.125752 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m06:35:34.126558 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_customers_customer_id.f8660c11fe, now test.development.not_null_bronze_orders_customer_id.660ce070b4)
[0m06:35:34.126978 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m06:35:34.131844 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_customer_id.660ce070b4"
[0m06:35:34.132560 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_customer_id.660ce070b4 (compile): 06:35:34.127234 => 06:35:34.132301
[0m06:35:34.132966 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m06:35:34.133465 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_customer_id.660ce070b4 (execute): 06:35:34.133226 => 06:35:34.133240
[0m06:35:34.134397 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m06:35:34.134881 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m06:35:34.135713 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_customer_id.660ce070b4, now test.development.not_null_bronze_orders_order_date.d63cfe6df9)
[0m06:35:34.136135 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m06:35:34.142250 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_order_date.d63cfe6df9"
[0m06:35:34.142953 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_date.d63cfe6df9 (compile): 06:35:34.136400 => 06:35:34.142695
[0m06:35:34.143370 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m06:35:34.143871 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_date.d63cfe6df9 (execute): 06:35:34.143636 => 06:35:34.143647
[0m06:35:34.144811 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m06:35:34.145287 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m06:35:34.146100 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_order_date.d63cfe6df9, now test.development.not_null_bronze_orders_order_id.24f68d0dd3)
[0m06:35:34.146520 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m06:35:34.151565 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_order_id.24f68d0dd3"
[0m06:35:34.152270 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_id.24f68d0dd3 (compile): 06:35:34.146777 => 06:35:34.152014
[0m06:35:34.152673 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m06:35:34.153169 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_id.24f68d0dd3 (execute): 06:35:34.152934 => 06:35:34.152945
[0m06:35:34.154095 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m06:35:34.154571 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_product_id.354934acfc
[0m06:35:34.155336 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_order_id.24f68d0dd3, now test.development.not_null_bronze_orders_product_id.354934acfc)
[0m06:35:34.155758 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_product_id.354934acfc
[0m06:35:34.160497 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_product_id.354934acfc"
[0m06:35:34.161184 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_product_id.354934acfc (compile): 06:35:34.156022 => 06:35:34.160932
[0m06:35:34.161579 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_product_id.354934acfc
[0m06:35:34.162067 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_product_id.354934acfc (execute): 06:35:34.161834 => 06:35:34.161847
[0m06:35:34.163052 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_product_id.354934acfc
[0m06:35:34.163564 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m06:35:34.164308 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_product_id.354934acfc, now test.development.unique_bronze_orders_order_id.eec6e86d13)
[0m06:35:34.164720 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m06:35:34.169827 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_orders_order_id.eec6e86d13"
[0m06:35:34.170548 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_orders_order_id.eec6e86d13 (compile): 06:35:34.164977 => 06:35:34.170287
[0m06:35:34.171406 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m06:35:34.171943 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_orders_order_id.eec6e86d13 (execute): 06:35:34.171694 => 06:35:34.171706
[0m06:35:34.172884 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m06:35:34.173380 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m06:35:34.174127 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_orders_order_id.eec6e86d13, now model.development.fct_payment_details)
[0m06:35:34.174544 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m06:35:34.185045 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m06:35:34.185928 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 06:35:34.174811 => 06:35:34.185606
[0m06:35:34.186367 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m06:35:34.186879 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 06:35:34.186636 => 06:35:34.186650
[0m06:35:34.187885 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m06:35:34.188398 [debug] [Thread-1  ]: Began running node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m06:35:34.189059 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8)
[0m06:35:34.189647 [debug] [Thread-1  ]: Began compiling node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m06:35:34.201730 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"
[0m06:35:34.202672 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8 (compile): 06:35:34.189923 => 06:35:34.202349
[0m06:35:34.203138 [debug] [Thread-1  ]: Began executing node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m06:35:34.203688 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8 (execute): 06:35:34.203433 => 06:35:34.203448
[0m06:35:34.204681 [debug] [Thread-1  ]: Finished running node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m06:35:34.205189 [debug] [Thread-1  ]: Began running node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m06:35:34.205974 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8, now test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f)
[0m06:35:34.206404 [debug] [Thread-1  ]: Began compiling node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m06:35:34.212379 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"
[0m06:35:34.213158 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f (compile): 06:35:34.206665 => 06:35:34.212877
[0m06:35:34.213574 [debug] [Thread-1  ]: Began executing node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m06:35:34.214074 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f (execute): 06:35:34.213836 => 06:35:34.213849
[0m06:35:34.215033 [debug] [Thread-1  ]: Finished running node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m06:35:34.215557 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m06:35:34.216340 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f, now test.development.not_null_bronze_payments_order_id.50ed7cbd9a)
[0m06:35:34.216762 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m06:35:34.221632 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"
[0m06:35:34.222357 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_order_id.50ed7cbd9a (compile): 06:35:34.217024 => 06:35:34.222098
[0m06:35:34.222768 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m06:35:34.223279 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_order_id.50ed7cbd9a (execute): 06:35:34.223026 => 06:35:34.223038
[0m06:35:34.224249 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m06:35:34.224735 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m06:35:34.225507 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_order_id.50ed7cbd9a, now test.development.not_null_bronze_payments_payment_id.3473ab0f1f)
[0m06:35:34.225922 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m06:35:34.232417 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"
[0m06:35:34.233153 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_id.3473ab0f1f (compile): 06:35:34.226174 => 06:35:34.232891
[0m06:35:34.233558 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m06:35:34.234055 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_id.3473ab0f1f (execute): 06:35:34.233818 => 06:35:34.233832
[0m06:35:34.235003 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m06:35:34.235511 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m06:35:34.236333 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_payment_id.3473ab0f1f, now test.development.not_null_bronze_payments_payment_method.e5fe6e820b)
[0m06:35:34.236759 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m06:35:34.320255 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"
[0m06:35:34.321171 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_method.e5fe6e820b (compile): 06:35:34.237019 => 06:35:34.320861
[0m06:35:34.321611 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m06:35:34.322117 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_method.e5fe6e820b (execute): 06:35:34.321877 => 06:35:34.321892
[0m06:35:34.323094 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m06:35:34.323608 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_status.4258d38f0c
[0m06:35:34.324404 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_payment_method.e5fe6e820b, now test.development.not_null_bronze_payments_status.4258d38f0c)
[0m06:35:34.324823 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_status.4258d38f0c
[0m06:35:34.329686 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_status.4258d38f0c"
[0m06:35:34.330421 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_status.4258d38f0c (compile): 06:35:34.325080 => 06:35:34.330152
[0m06:35:34.330824 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_status.4258d38f0c
[0m06:35:34.331354 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_status.4258d38f0c (execute): 06:35:34.331086 => 06:35:34.331100
[0m06:35:34.332546 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_status.4258d38f0c
[0m06:35:34.333041 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_payments_payment_id.537151412e
[0m06:35:34.333816 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_status.4258d38f0c, now test.development.unique_bronze_payments_payment_id.537151412e)
[0m06:35:34.334240 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_payments_payment_id.537151412e
[0m06:35:34.339417 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_payments_payment_id.537151412e"
[0m06:35:34.340133 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_payments_payment_id.537151412e (compile): 06:35:34.334501 => 06:35:34.339873
[0m06:35:34.340540 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_payments_payment_id.537151412e
[0m06:35:34.341042 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_payments_payment_id.537151412e (execute): 06:35:34.340801 => 06:35:34.340814
[0m06:35:34.341981 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_payments_payment_id.537151412e
[0m06:35:34.342476 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m06:35:34.343236 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_payments_payment_id.537151412e, now model.development.fct_order_detail)
[0m06:35:34.343682 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m06:35:34.349100 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m06:35:34.349898 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 06:35:34.343940 => 06:35:34.349602
[0m06:35:34.350306 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m06:35:34.350801 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 06:35:34.350564 => 06:35:34.350576
[0m06:35:34.351759 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m06:35:34.352246 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_products_price.e208481306
[0m06:35:34.353057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now test.development.not_null_bronze_products_price.e208481306)
[0m06:35:34.353667 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_products_price.e208481306
[0m06:35:34.358572 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_products_price.e208481306"
[0m06:35:34.359286 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_price.e208481306 (compile): 06:35:34.353945 => 06:35:34.359011
[0m06:35:34.359689 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_products_price.e208481306
[0m06:35:34.360178 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_price.e208481306 (execute): 06:35:34.359947 => 06:35:34.359958
[0m06:35:34.361097 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_products_price.e208481306
[0m06:35:34.361573 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m06:35:34.362315 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_products_price.e208481306, now test.development.not_null_bronze_products_product_id.0e447b9d33)
[0m06:35:34.362726 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m06:35:34.367652 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_products_product_id.0e447b9d33"
[0m06:35:34.368471 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_product_id.0e447b9d33 (compile): 06:35:34.362980 => 06:35:34.368183
[0m06:35:34.368891 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m06:35:34.369388 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_product_id.0e447b9d33 (execute): 06:35:34.369152 => 06:35:34.369167
[0m06:35:34.370343 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m06:35:34.370854 [debug] [Thread-1  ]: Began running node test.development.products_price_lower_than_threshold
[0m06:35:34.371640 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_products_product_id.0e447b9d33, now test.development.products_price_lower_than_threshold)
[0m06:35:34.372060 [debug] [Thread-1  ]: Began compiling node test.development.products_price_lower_than_threshold
[0m06:35:34.375364 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.products_price_lower_than_threshold"
[0m06:35:34.376116 [debug] [Thread-1  ]: Timing info for test.development.products_price_lower_than_threshold (compile): 06:35:34.372316 => 06:35:34.375858
[0m06:35:34.376522 [debug] [Thread-1  ]: Began executing node test.development.products_price_lower_than_threshold
[0m06:35:34.377030 [debug] [Thread-1  ]: Timing info for test.development.products_price_lower_than_threshold (execute): 06:35:34.376790 => 06:35:34.376801
[0m06:35:34.377971 [debug] [Thread-1  ]: Finished running node test.development.products_price_lower_than_threshold
[0m06:35:34.378456 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_products_product_id.c17035ba1c
[0m06:35:34.379199 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.products_price_lower_than_threshold, now test.development.unique_bronze_products_product_id.c17035ba1c)
[0m06:35:34.379636 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_products_product_id.c17035ba1c
[0m06:35:34.384797 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_products_product_id.c17035ba1c"
[0m06:35:34.385479 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_products_product_id.c17035ba1c (compile): 06:35:34.379890 => 06:35:34.385226
[0m06:35:34.385882 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_products_product_id.c17035ba1c
[0m06:35:34.386380 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_products_product_id.c17035ba1c (execute): 06:35:34.386148 => 06:35:34.386159
[0m06:35:34.387346 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_products_product_id.c17035ba1c
[0m06:35:34.387839 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m06:35:34.388468 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_products_product_id.c17035ba1c, now test.development.not_null_fct_payment_details_order_id.7bb58db616)
[0m06:35:34.388866 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m06:35:34.393700 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_payment_details_order_id.7bb58db616"
[0m06:35:34.394552 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_order_id.7bb58db616 (compile): 06:35:34.389108 => 06:35:34.394279
[0m06:35:34.394963 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m06:35:34.395491 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_order_id.7bb58db616 (execute): 06:35:34.395223 => 06:35:34.395236
[0m06:35:34.396456 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m06:35:34.396960 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m06:35:34.397683 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_payment_details_order_id.7bb58db616, now test.development.not_null_fct_payment_details_payment_id.d55bc575d7)
[0m06:35:34.398103 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m06:35:34.404559 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_payment_details_payment_id.d55bc575d7"
[0m06:35:34.405315 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_id.d55bc575d7 (compile): 06:35:34.398359 => 06:35:34.405046
[0m06:35:34.405725 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m06:35:34.406217 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_id.d55bc575d7 (execute): 06:35:34.405982 => 06:35:34.405995
[0m06:35:34.407164 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m06:35:34.407684 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m06:35:34.408442 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_payment_details_payment_id.d55bc575d7, now test.development.not_null_fct_payment_details_payment_method.62d221c77e)
[0m06:35:34.408860 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m06:35:34.413869 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_payment_details_payment_method.62d221c77e"
[0m06:35:34.414593 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_method.62d221c77e (compile): 06:35:34.409117 => 06:35:34.414334
[0m06:35:34.414999 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m06:35:34.415529 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_method.62d221c77e (execute): 06:35:34.415282 => 06:35:34.415297
[0m06:35:34.416473 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m06:35:34.416962 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m06:35:34.417724 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_payment_details_payment_method.62d221c77e, now model.development.product_sales)
[0m06:35:34.418145 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m06:35:34.424620 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m06:35:34.425456 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 06:35:34.418404 => 06:35:34.425153
[0m06:35:34.425878 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m06:35:34.426376 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 06:35:34.426142 => 06:35:34.426155
[0m06:35:34.427367 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m06:35:34.427873 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m06:35:34.428712 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.product_sales, now test.development.not_null_fct_order_detail_customer_id.44d928392b)
[0m06:35:34.429141 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m06:35:34.434262 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_customer_id.44d928392b"
[0m06:35:34.435230 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_customer_id.44d928392b (compile): 06:35:34.429408 => 06:35:34.434954
[0m06:35:34.435679 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m06:35:34.436184 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_customer_id.44d928392b (execute): 06:35:34.435944 => 06:35:34.435957
[0m06:35:34.437132 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m06:35:34.437622 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m06:35:34.438372 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_customer_id.44d928392b, now test.development.not_null_fct_order_detail_order_date.c6f89a052d)
[0m06:35:34.438790 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m06:35:34.443970 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_order_date.c6f89a052d"
[0m06:35:34.444732 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_date.c6f89a052d (compile): 06:35:34.439054 => 06:35:34.444460
[0m06:35:34.445150 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m06:35:34.445646 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_date.c6f89a052d (execute): 06:35:34.445407 => 06:35:34.445421
[0m06:35:34.446598 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m06:35:34.447086 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m06:35:34.447867 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_order_date.c6f89a052d, now test.development.not_null_fct_order_detail_order_id.47ace119a7)
[0m06:35:34.448290 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m06:35:34.453124 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_order_id.47ace119a7"
[0m06:35:34.453838 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_id.47ace119a7 (compile): 06:35:34.448545 => 06:35:34.453581
[0m06:35:34.454238 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m06:35:34.454729 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_id.47ace119a7 (execute): 06:35:34.454494 => 06:35:34.454508
[0m06:35:34.455691 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m06:35:34.456170 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m06:35:34.456934 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_order_id.47ace119a7, now test.development.not_null_fct_order_detail_price.c149ee0e5c)
[0m06:35:34.457356 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m06:35:34.462328 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_price.c149ee0e5c"
[0m06:35:34.463070 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_price.c149ee0e5c (compile): 06:35:34.457610 => 06:35:34.462800
[0m06:35:34.463506 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m06:35:34.464009 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_price.c149ee0e5c (execute): 06:35:34.463771 => 06:35:34.463785
[0m06:35:34.464956 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m06:35:34.465441 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m06:35:34.466209 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_price.c149ee0e5c, now test.development.not_null_fct_order_detail_product_id.73135971e6)
[0m06:35:34.466630 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m06:35:34.471744 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_product_id.73135971e6"
[0m06:35:34.472455 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_product_id.73135971e6 (compile): 06:35:34.466887 => 06:35:34.472194
[0m06:35:34.472857 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m06:35:34.473353 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_product_id.73135971e6 (execute): 06:35:34.473117 => 06:35:34.473130
[0m06:35:34.474286 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m06:35:34.474772 [debug] [Thread-1  ]: Began running node test.development.unique_fct_order_detail_order_id.256da980ed
[0m06:35:34.475566 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_product_id.73135971e6, now test.development.unique_fct_order_detail_order_id.256da980ed)
[0m06:35:34.475987 [debug] [Thread-1  ]: Began compiling node test.development.unique_fct_order_detail_order_id.256da980ed
[0m06:35:34.481104 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_fct_order_detail_order_id.256da980ed"
[0m06:35:34.481829 [debug] [Thread-1  ]: Timing info for test.development.unique_fct_order_detail_order_id.256da980ed (compile): 06:35:34.476243 => 06:35:34.481570
[0m06:35:34.482237 [debug] [Thread-1  ]: Began executing node test.development.unique_fct_order_detail_order_id.256da980ed
[0m06:35:34.482732 [debug] [Thread-1  ]: Timing info for test.development.unique_fct_order_detail_order_id.256da980ed (execute): 06:35:34.482495 => 06:35:34.482507
[0m06:35:34.483686 [debug] [Thread-1  ]: Finished running node test.development.unique_fct_order_detail_order_id.256da980ed
[0m06:35:34.484169 [debug] [Thread-1  ]: Began running node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m06:35:34.484913 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_fct_order_detail_order_id.256da980ed, now test.development.not_null_product_sales_customer_id.acc9e6dd8e)
[0m06:35:34.485331 [debug] [Thread-1  ]: Began compiling node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m06:35:34.492036 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_product_sales_customer_id.acc9e6dd8e"
[0m06:35:34.492824 [debug] [Thread-1  ]: Timing info for test.development.not_null_product_sales_customer_id.acc9e6dd8e (compile): 06:35:34.485586 => 06:35:34.492548
[0m06:35:34.493243 [debug] [Thread-1  ]: Began executing node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m06:35:34.493739 [debug] [Thread-1  ]: Timing info for test.development.not_null_product_sales_customer_id.acc9e6dd8e (execute): 06:35:34.493502 => 06:35:34.493514
[0m06:35:34.494688 [debug] [Thread-1  ]: Finished running node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m06:35:34.495175 [debug] [Thread-1  ]: Began running node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m06:35:34.495970 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_product_sales_customer_id.acc9e6dd8e, now test.development.not_null_product_sales_order_amount.b9ffa2ea2b)
[0m06:35:34.496403 [debug] [Thread-1  ]: Began compiling node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m06:35:34.501461 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_product_sales_order_amount.b9ffa2ea2b"
[0m06:35:34.502169 [debug] [Thread-1  ]: Timing info for test.development.not_null_product_sales_order_amount.b9ffa2ea2b (compile): 06:35:34.496661 => 06:35:34.501911
[0m06:35:34.502579 [debug] [Thread-1  ]: Began executing node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m06:35:34.503078 [debug] [Thread-1  ]: Timing info for test.development.not_null_product_sales_order_amount.b9ffa2ea2b (execute): 06:35:34.502841 => 06:35:34.502853
[0m06:35:34.504035 [debug] [Thread-1  ]: Finished running node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m06:35:34.505190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:35:34.505536 [debug] [MainThread]: Connection 'test.development.not_null_product_sales_order_amount.b9ffa2ea2b' was properly closed.
[0m06:35:34.511461 [debug] [MainThread]: Command end result
[0m06:35:34.522410 [debug] [MainThread]: Command `dbt compile` succeeded at 06:35:34.522179 after 1.70 seconds
[0m06:35:34.522962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d72bc90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6af3af40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d6af3ab80>]}
[0m06:35:34.523462 [debug] [MainThread]: Flushing usage events
[0m06:39:13.836408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe10a4f90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe108dfe8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe108dfe280>]}


============================== 06:39:13.839928 | 722784e4-6de6-4c4d-85d9-04c5772f14fb ==============================
[0m06:39:13.839928 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:39:13.840588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/satyam/dbt_project/dbt/dbt/logs', 'debug': 'False', 'profiles_dir': '/home/satyam/dbt_project/dbt/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:39:14.126857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '722784e4-6de6-4c4d-85d9-04c5772f14fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe104680cd0>]}
[0m06:39:14.144693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '722784e4-6de6-4c4d-85d9-04c5772f14fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe10465aa60>]}
[0m06:39:14.159773 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:39:14.185329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m06:39:14.186171 [debug] [MainThread]: Partial parsing: added file: development://models/sales/test/test.sql
[0m06:39:14.212439 [debug] [MainThread]: 1699: static parser successfully parsed sales/test/test.sql
[0m06:39:14.234361 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.development.silver
- models.development.gold
- models.development.staging
- models.development.bronze
[0m06:39:14.241743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '722784e4-6de6-4c4d-85d9-04c5772f14fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe10353a3a0>]}
[0m06:39:14.253193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '722784e4-6de6-4c4d-85d9-04c5772f14fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe103521bb0>]}
[0m06:39:14.253842 [info ] [MainThread]: Found 8 models, 30 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m06:39:14.254302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '722784e4-6de6-4c4d-85d9-04c5772f14fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe103521fd0>]}
[0m06:39:14.256684 [info ] [MainThread]: 
[0m06:39:14.257575 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:39:14.259131 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m06:39:14.274735 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m06:39:14.275235 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m06:39:14.275617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:14.958012 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m06:39:14.960855 [debug] [ThreadPool]: On list_external_db: Close
[0m06:39:15.066343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m06:39:15.076675 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m06:39:15.077222 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m06:39:15.077759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:39:15.387914 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m06:39:15.390151 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m06:39:15.495220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '722784e4-6de6-4c4d-85d9-04c5772f14fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1046eb8e0>]}
[0m06:39:15.496469 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:39:15.497066 [info ] [MainThread]: 
[0m06:39:15.502058 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m06:39:15.502717 [info ] [Thread-1  ]: 1 of 8 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m06:39:15.503555 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m06:39:15.504006 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m06:39:15.508534 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m06:39:15.509342 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 06:39:15.504287 => 06:39:15.509032
[0m06:39:15.509768 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m06:39:15.567920 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:39:15.568565 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_timestamp('2023-06-22') as run_ts  from external_db.stage.customers
)

select * from customers
  );
[0m06:39:15.569007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:15.949279 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:15.960412 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:39:15.960994 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m06:39:16.032041 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:39:16.037472 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:39:16.038004 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m06:39:16.114667 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:39:16.125285 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:39:16.125868 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m06:39:16.185915 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:39:16.223092 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m06:39:16.224849 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:39:16.225349 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m06:39:16.306741 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:16.307506 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:39:16.308032 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_TS")
    values
        ("VALUE", "CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_TS")

;
[0m06:39:17.310943 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:39:17.311745 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:39:17.312190 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m06:39:17.506704 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:17.517017 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:39:17.517516 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m06:39:17.615568 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:17.641179 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 06:39:15.510032 => 06:39:17.640900
[0m06:39:17.641744 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m06:39:17.740337 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722784e4-6de6-4c4d-85d9-04c5772f14fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe100aaf610>]}
[0m06:39:17.741491 [info ] [Thread-1  ]: 1 of 8 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 50[0m in 2.24s]
[0m06:39:17.742406 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m06:39:17.742957 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m06:39:17.743701 [info ] [Thread-1  ]: 2 of 8 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m06:39:17.744639 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m06:39:17.745077 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m06:39:17.824195 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m06:39:17.825179 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 06:39:17.745342 => 06:39:17.824859
[0m06:39:17.825635 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m06:39:17.829890 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:39:17.830318 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.orders
)

select * from orders
  );
[0m06:39:17.830712 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:18.208764 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:18.213145 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:39:18.213708 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m06:39:18.290940 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:18.295771 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:39:18.296314 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m06:39:18.363131 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:18.368690 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:39:18.369258 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m06:39:18.448518 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:18.453153 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m06:39:18.454812 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:39:18.455290 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m06:39:18.541295 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:18.542032 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:39:18.542591 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_TS")
    values
        ("VALUE", "ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_TS")

;
[0m06:39:19.128859 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:39:19.129678 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:39:19.130171 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m06:39:19.344609 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:19.349483 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:39:19.350210 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m06:39:19.439092 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:19.443088 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 06:39:17.825905 => 06:39:19.442800
[0m06:39:19.443658 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m06:39:19.550353 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722784e4-6de6-4c4d-85d9-04c5772f14fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1024789d0>]}
[0m06:39:19.551393 [info ] [Thread-1  ]: 2 of 8 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 50[0m in 1.81s]
[0m06:39:19.552226 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m06:39:19.552844 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m06:39:19.553382 [info ] [Thread-1  ]: 3 of 8 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m06:39:19.554765 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m06:39:19.555335 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m06:39:19.559711 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m06:39:19.560473 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 06:39:19.555629 => 06:39:19.560207
[0m06:39:19.560895 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m06:39:19.567227 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:39:19.567718 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.payments
)

select * from payments
  );
[0m06:39:19.568294 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:19.956516 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:19.961231 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:39:19.961774 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m06:39:20.035354 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:20.041375 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:39:20.041980 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m06:39:20.113714 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:20.119010 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:39:20.119563 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m06:39:20.182863 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:20.187344 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m06:39:20.189141 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:39:20.189645 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m06:39:20.272572 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:20.273266 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:39:20.273735 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_TS")
    values
        ("VALUE", "PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_TS")

;
[0m06:39:21.120992 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:39:21.121967 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:39:21.122523 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m06:39:21.312419 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:21.317130 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:39:21.317622 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m06:39:21.403254 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:21.406898 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 06:39:19.561157 => 06:39:21.406638
[0m06:39:21.407438 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m06:39:21.519756 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722784e4-6de6-4c4d-85d9-04c5772f14fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1023541f0>]}
[0m06:39:21.520766 [info ] [Thread-1  ]: 3 of 8 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 50[0m in 1.97s]
[0m06:39:21.521600 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m06:39:21.522239 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m06:39:21.522973 [info ] [Thread-1  ]: 4 of 8 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m06:39:21.524204 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m06:39:21.524637 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m06:39:21.529753 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m06:39:21.530524 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 06:39:21.524967 => 06:39:21.530253
[0m06:39:21.530937 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m06:39:21.535561 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:39:21.535999 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.products
)

select * from products
  );
[0m06:39:21.536388 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:22.068619 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:39:22.072805 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:39:22.073396 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m06:39:22.143908 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:39:22.150317 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:39:22.150837 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m06:39:22.218215 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:39:22.223509 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:39:22.224008 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m06:39:22.281125 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:39:22.285453 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m06:39:22.287007 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:39:22.287484 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m06:39:22.361358 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:22.362048 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:39:22.362509 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "PRODUCT_ID", "PRICE", "RUN_TS")
    values
        ("VALUE", "PRODUCT_ID", "PRICE", "RUN_TS")

;
[0m06:39:22.956452 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:39:22.957361 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:39:22.958125 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m06:39:23.151629 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:23.156292 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:39:23.156776 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m06:39:23.242353 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:23.245793 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 06:39:21.531199 => 06:39:23.245528
[0m06:39:23.246287 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m06:39:23.337209 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722784e4-6de6-4c4d-85d9-04c5772f14fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe100a49550>]}
[0m06:39:23.338507 [info ] [Thread-1  ]: 4 of 8 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 50[0m in 1.81s]
[0m06:39:23.339470 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m06:39:23.340016 [debug] [Thread-1  ]: Began running node model.development.test
[0m06:39:23.340840 [info ] [Thread-1  ]: 5 of 8 START sql view model final_sales.test ................................... [RUN]
[0m06:39:23.341898 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.test)
[0m06:39:23.342534 [debug] [Thread-1  ]: Began compiling node model.development.test
[0m06:39:23.345311 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.test"
[0m06:39:23.346175 [debug] [Thread-1  ]: Timing info for model.development.test (compile): 06:39:23.342908 => 06:39:23.345911
[0m06:39:23.346651 [debug] [Thread-1  ]: Began executing node model.development.test
[0m06:39:23.371557 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.test"
[0m06:39:23.373128 [debug] [Thread-1  ]: Using snowflake connection "model.development.test"
[0m06:39:23.373681 [debug] [Thread-1  ]: On model.development.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.test"} */
create or replace   view external_db.final_sales.test
  
   as (
    select 1;
[0m06:39:23.374189 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:23.692051 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad546f-0000-fb4f-0001-937e0001a506
[0m06:39:23.692720 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 4 at position 12 unexpected ';'.
[0m06:39:23.693428 [debug] [Thread-1  ]: Timing info for model.development.test (execute): 06:39:23.347051 => 06:39:23.693155
[0m06:39:23.694035 [debug] [Thread-1  ]: On model.development.test: Close
[0m06:39:23.812249 [debug] [Thread-1  ]: Database Error in model test (models/sales/test/test.sql)
  001003 (42000): SQL compilation error:
  syntax error line 4 at position 12 unexpected ';'.
  compiled Code at target/run/development/models/sales/test/test.sql
[0m06:39:23.813079 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722784e4-6de6-4c4d-85d9-04c5772f14fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1024900d0>]}
[0m06:39:23.813894 [error] [Thread-1  ]: 5 of 8 ERROR creating sql view model final_sales.test .......................... [[31mERROR[0m in 0.47s]
[0m06:39:23.814812 [debug] [Thread-1  ]: Finished running node model.development.test
[0m06:39:23.815427 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m06:39:23.816246 [info ] [Thread-1  ]: 6 of 8 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m06:39:23.817108 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.test, now model.development.fct_payment_details)
[0m06:39:23.817538 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m06:39:23.826916 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m06:39:23.827815 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 06:39:23.817803 => 06:39:23.827530
[0m06:39:23.828229 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m06:39:23.833102 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:39:23.833548 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_ts

    from payments where status = 'success'
)

select * from final
  );
[0m06:39:23.833950 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:24.223067 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:24.230385 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:39:24.230966 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m06:39:24.302213 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:39:24.308499 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:39:24.309073 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m06:39:24.384840 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:39:24.389710 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:39:24.390236 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m06:39:24.468449 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:39:24.472596 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m06:39:24.474197 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:39:24.474654 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m06:39:24.558958 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:24.559672 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:39:24.560131 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_TS")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_TS")

;
[0m06:39:24.981946 [debug] [Thread-1  ]: SQL status: SUCCESS 36 in 0.0 seconds
[0m06:39:24.982720 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:39:24.983163 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m06:39:25.190780 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:25.196105 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:39:25.196831 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m06:39:25.281274 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:25.284843 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 06:39:23.828492 => 06:39:25.284583
[0m06:39:25.285345 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m06:39:25.391553 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722784e4-6de6-4c4d-85d9-04c5772f14fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe100ad02e0>]}
[0m06:39:25.392661 [info ] [Thread-1  ]: 6 of 8 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 36[0m in 1.57s]
[0m06:39:25.393592 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m06:39:25.394200 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m06:39:25.395035 [info ] [Thread-1  ]: 7 of 8 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m06:39:25.396008 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m06:39:25.396448 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m06:39:25.402918 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m06:39:25.403835 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 06:39:25.396721 => 06:39:25.403534
[0m06:39:25.404299 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m06:39:25.409303 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:39:25.409767 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace  temporary view external_db.final_sales.fct_order_detail__dbt_tmp
  
   as (
    
with orders as (
    select * from external_db.final_sales.bronze_orders
   
        where run_ts = to_timestamp('2023-06-22')
    
),

products as (
    select * from external_db.final_sales.bronze_products
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_ts
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m06:39:25.410181 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:25.826151 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:25.830400 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:39:25.830910 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail__dbt_tmp
[0m06:39:25.916992 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:25.922259 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:39:25.922766 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail
[0m06:39:25.999804 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:26.006814 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:39:26.007377 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_ORDER_DETAIL"
[0m06:39:26.078521 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:26.083305 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m06:39:26.085122 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:39:26.085630 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
-- back compat for old kwarg name
  
  begin;
[0m06:39:26.176008 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:26.176731 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:39:26.177252 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
merge into external_db.final_sales.fct_order_detail as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_order_detail__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_TS")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_TS")

;
[0m06:39:26.627850 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 0.0 seconds
[0m06:39:26.628578 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:39:26.629028 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
COMMIT
[0m06:39:26.841647 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:26.846542 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:39:26.847021 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m06:39:26.943795 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:26.947080 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 06:39:25.404568 => 06:39:26.946825
[0m06:39:26.947598 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m06:39:27.060434 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722784e4-6de6-4c4d-85d9-04c5772f14fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe100941fd0>]}
[0m06:39:27.061484 [info ] [Thread-1  ]: 7 of 8 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 50[0m in 1.66s]
[0m06:39:27.062671 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m06:39:27.063886 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m06:39:27.064546 [info ] [Thread-1  ]: 8 of 8 START sql incremental model final_sales.product_sales ................... [RUN]
[0m06:39:27.065433 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m06:39:27.065990 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m06:39:27.079148 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m06:39:27.080085 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 06:39:27.066293 => 06:39:27.079784
[0m06:39:27.080523 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m06:39:27.085658 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:39:27.086134 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace  temporary view external_db.final_sales.product_sales__dbt_tmp
  
   as (
    

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
        where run_ts = to_timestamp('2023-06-22')
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
        where run_ts = to_timestamp('2023-06-22')
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as (

    select
        order_details.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m06:39:27.086605 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:27.623804 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:39:27.629077 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:39:27.629635 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales__dbt_tmp
[0m06:39:27.705065 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:39:27.709981 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:39:27.710512 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales
[0m06:39:27.781584 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:39:27.786263 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:39:27.786782 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."PRODUCT_SALES"
[0m06:39:27.850246 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:39:27.854261 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m06:39:27.855893 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:39:27.856431 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
-- back compat for old kwarg name
  
  begin;
[0m06:39:27.949610 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:27.950299 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:39:27.950780 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
merge into external_db.final_sales.product_sales as DBT_INTERNAL_DEST
        using external_db.final_sales.product_sales__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","ORDER_AMOUNT" = DBT_INTERNAL_SOURCE."ORDER_AMOUNT"
    

    when not matched then insert
        ("CUSTOMER_ID", "ORDER_AMOUNT")
    values
        ("CUSTOMER_ID", "ORDER_AMOUNT")

;
[0m06:39:28.781209 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:39:28.782229 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:39:28.782953 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
COMMIT
[0m06:39:28.995584 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:29.002871 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:39:29.004020 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m06:39:29.093141 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:29.100756 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 06:39:27.080785 => 06:39:29.100360
[0m06:39:29.101438 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m06:39:29.200411 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '722784e4-6de6-4c4d-85d9-04c5772f14fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe100916880>]}
[0m06:39:29.201448 [info ] [Thread-1  ]: 8 of 8 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 50[0m in 2.14s]
[0m06:39:29.202280 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m06:39:29.204408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:39:29.204781 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m06:39:29.205194 [info ] [MainThread]: 
[0m06:39:29.205639 [info ] [MainThread]: Finished running 7 incremental models, 1 view model in 0 hours 0 minutes and 14.95 seconds (14.95s).
[0m06:39:29.207569 [debug] [MainThread]: Command end result
[0m06:39:29.218898 [info ] [MainThread]: 
[0m06:39:29.219452 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:39:29.219859 [info ] [MainThread]: 
[0m06:39:29.220246 [error] [MainThread]: [33mDatabase Error in model test (models/sales/test/test.sql)[0m
[0m06:39:29.220815 [error] [MainThread]:   001003 (42000): SQL compilation error:
[0m06:39:29.221310 [error] [MainThread]:   syntax error line 4 at position 12 unexpected ';'.
[0m06:39:29.221679 [error] [MainThread]:   compiled Code at target/run/development/models/sales/test/test.sql
[0m06:39:29.222063 [info ] [MainThread]: 
[0m06:39:29.222498 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:39:29.223588 [debug] [MainThread]: Command `dbt run` failed at 06:39:29.223440 after 15.40 seconds
[0m06:39:29.224055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe10a4f90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe10466d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe102344f10>]}
[0m06:39:29.224504 [debug] [MainThread]: Flushing usage events
[0m06:39:41.502049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aab6260a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa9f338e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa9f33280>]}


============================== 06:39:41.505527 | 5dfd957f-27b7-49c0-a67a-00a6ebdea285 ==============================
[0m06:39:41.505527 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:39:41.506189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/satyam/dbt_project/dbt/dbt', 'log_path': '/home/satyam/dbt_project/dbt/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:39:41.786890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dfd957f-27b7-49c0-a67a-00a6ebdea285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa47b2e20>]}
[0m06:39:41.804499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dfd957f-27b7-49c0-a67a-00a6ebdea285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa47826a0>]}
[0m06:39:41.819647 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:39:41.844956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:39:41.845822 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/test/test.sql
[0m06:39:41.871918 [debug] [MainThread]: 1699: static parser successfully parsed sales/test/test.sql
[0m06:39:41.894062 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.development.gold
- models.development.bronze
- models.development.silver
- models.development.staging
[0m06:39:41.900767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dfd957f-27b7-49c0-a67a-00a6ebdea285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa467d460>]}
[0m06:39:41.912108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dfd957f-27b7-49c0-a67a-00a6ebdea285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa4607df0>]}
[0m06:39:41.912731 [info ] [MainThread]: Found 8 models, 30 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m06:39:41.913192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dfd957f-27b7-49c0-a67a-00a6ebdea285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa471b0a0>]}
[0m06:39:41.915672 [info ] [MainThread]: 
[0m06:39:41.916536 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:39:41.918739 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m06:39:41.934300 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m06:39:41.934874 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m06:39:41.935327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:39:42.598962 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m06:39:42.601779 [debug] [ThreadPool]: On list_external_db: Close
[0m06:39:42.702978 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m06:39:42.712473 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m06:39:42.713045 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m06:39:42.713403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:39:43.148273 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m06:39:43.153876 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m06:39:43.252658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dfd957f-27b7-49c0-a67a-00a6ebdea285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa5820910>]}
[0m06:39:43.253969 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:39:43.254547 [info ] [MainThread]: 
[0m06:39:43.259436 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m06:39:43.260120 [info ] [Thread-1  ]: 1 of 8 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m06:39:43.260978 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m06:39:43.261439 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m06:39:43.266251 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m06:39:43.267121 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 06:39:43.261727 => 06:39:43.266778
[0m06:39:43.267579 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m06:39:43.325018 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:39:43.325690 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_timestamp('2023-06-22') as run_ts  from external_db.stage.customers
)

select * from customers
  );
[0m06:39:43.326117 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:43.701884 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:43.713148 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:39:43.713769 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m06:39:43.791433 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:39:43.796922 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:39:43.797522 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m06:39:43.864246 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:39:43.874465 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:39:43.875090 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m06:39:43.940719 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:39:43.977247 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m06:39:43.978998 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:39:43.979540 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m06:39:44.061743 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:44.062516 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:39:44.063056 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_TS")
    values
        ("VALUE", "CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_TS")

;
[0m06:39:44.751673 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:39:44.752523 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:39:44.753025 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m06:39:44.980785 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:44.991933 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:39:44.992476 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m06:39:45.090906 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:45.190701 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 06:39:43.267844 => 06:39:45.190418
[0m06:39:45.191276 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m06:39:45.309882 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dfd957f-27b7-49c0-a67a-00a6ebdea285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa9399d30>]}
[0m06:39:45.310995 [info ] [Thread-1  ]: 1 of 8 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 50[0m in 2.05s]
[0m06:39:45.311979 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m06:39:45.312554 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m06:39:45.313150 [info ] [Thread-1  ]: 2 of 8 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m06:39:45.313992 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m06:39:45.314640 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m06:39:45.319047 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m06:39:45.319857 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 06:39:45.314917 => 06:39:45.319567
[0m06:39:45.320266 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m06:39:45.324715 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:39:45.325163 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.orders
)

select * from orders
  );
[0m06:39:45.325582 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:45.737422 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:45.741812 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:39:45.742360 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m06:39:45.820353 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:45.825421 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:39:45.825952 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m06:39:45.892925 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:45.897882 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:39:45.898400 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m06:39:45.962976 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:45.968112 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m06:39:45.969807 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:39:45.970272 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m06:39:46.051475 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:46.052165 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:39:46.052635 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_TS")
    values
        ("VALUE", "ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_TS")

;
[0m06:39:46.757455 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:39:46.758434 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:39:46.758943 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m06:39:46.968173 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:46.973167 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:39:46.973703 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m06:39:47.070248 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:47.074402 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 06:39:45.320526 => 06:39:47.074106
[0m06:39:47.074964 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m06:39:47.178790 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dfd957f-27b7-49c0-a67a-00a6ebdea285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a97480670>]}
[0m06:39:47.179894 [info ] [Thread-1  ]: 2 of 8 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 50[0m in 1.86s]
[0m06:39:47.180835 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m06:39:47.181394 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m06:39:47.182176 [info ] [Thread-1  ]: 3 of 8 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m06:39:47.183210 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m06:39:47.183717 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m06:39:47.189911 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m06:39:47.190711 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 06:39:47.184015 => 06:39:47.190438
[0m06:39:47.191149 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m06:39:47.195370 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:39:47.195823 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.payments
)

select * from payments
  );
[0m06:39:47.196213 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:47.552109 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:47.556551 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:39:47.557087 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m06:39:47.633729 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:47.638859 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:39:47.639454 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m06:39:47.699557 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:47.704617 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:39:47.705261 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m06:39:47.765394 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:47.769696 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m06:39:47.771350 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:39:47.771803 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m06:39:47.848121 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:47.848783 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:39:47.849352 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_TS")
    values
        ("VALUE", "PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_TS")

;
[0m06:39:48.562026 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:39:48.563012 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:39:48.563557 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m06:39:48.767495 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:48.772123 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:39:48.772926 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m06:39:48.862630 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:48.865974 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 06:39:47.191452 => 06:39:48.865711
[0m06:39:48.866474 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m06:39:48.966281 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dfd957f-27b7-49c0-a67a-00a6ebdea285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a97480220>]}
[0m06:39:48.967527 [info ] [Thread-1  ]: 3 of 8 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 50[0m in 1.78s]
[0m06:39:48.968399 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m06:39:48.969021 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m06:39:48.969828 [info ] [Thread-1  ]: 4 of 8 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m06:39:48.971017 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m06:39:48.971585 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m06:39:48.976348 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m06:39:48.977127 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 06:39:48.972006 => 06:39:48.976854
[0m06:39:48.977627 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m06:39:48.982344 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:39:48.982798 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.products
)

select * from products
  );
[0m06:39:48.983205 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:49.337530 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:49.344744 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:39:49.345635 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m06:39:49.421630 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:39:49.426411 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:39:49.426954 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m06:39:49.488544 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:39:49.493406 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:39:49.493942 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m06:39:49.562576 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:39:49.567656 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m06:39:49.569231 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:39:49.569671 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m06:39:49.649924 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:49.650607 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:39:49.651070 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "PRODUCT_ID", "PRICE", "RUN_TS")
    values
        ("VALUE", "PRODUCT_ID", "PRICE", "RUN_TS")

;
[0m06:39:50.345970 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:39:50.346991 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:39:50.347652 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m06:39:50.558397 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:50.564123 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:39:50.564716 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m06:39:50.647900 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:50.651524 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 06:39:48.977898 => 06:39:50.651219
[0m06:39:50.652123 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m06:39:50.757684 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dfd957f-27b7-49c0-a67a-00a6ebdea285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a95b89430>]}
[0m06:39:50.758674 [info ] [Thread-1  ]: 4 of 8 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 50[0m in 1.79s]
[0m06:39:50.759528 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m06:39:50.760047 [debug] [Thread-1  ]: Began running node model.development.test
[0m06:39:50.760901 [info ] [Thread-1  ]: 5 of 8 START sql view model final_sales.test ................................... [RUN]
[0m06:39:50.761740 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.test)
[0m06:39:50.762149 [debug] [Thread-1  ]: Began compiling node model.development.test
[0m06:39:50.764658 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.test"
[0m06:39:50.765532 [debug] [Thread-1  ]: Timing info for model.development.test (compile): 06:39:50.762397 => 06:39:50.765266
[0m06:39:50.765935 [debug] [Thread-1  ]: Began executing node model.development.test
[0m06:39:50.785780 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.test"
[0m06:39:50.786828 [debug] [Thread-1  ]: Using snowflake connection "model.development.test"
[0m06:39:50.787313 [debug] [Thread-1  ]: On model.development.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.test"} */
create or replace   view external_db.final_sales.test
  
   as (
    select 1
  );
[0m06:39:50.787709 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:51.094044 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad546f-0000-fb4f-0001-937e0001a576
[0m06:39:51.094673 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m06:39:51.095561 [debug] [Thread-1  ]: Timing info for model.development.test (execute): 06:39:50.766196 => 06:39:51.095193
[0m06:39:51.096125 [debug] [Thread-1  ]: On model.development.test: Close
[0m06:39:51.205961 [debug] [Thread-1  ]: Database Error in model test (models/sales/test/test.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled Code at target/run/development/models/sales/test/test.sql
[0m06:39:51.206994 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dfd957f-27b7-49c0-a67a-00a6ebdea285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa5820280>]}
[0m06:39:51.207938 [error] [Thread-1  ]: 5 of 8 ERROR creating sql view model final_sales.test .......................... [[31mERROR[0m in 0.45s]
[0m06:39:51.208577 [debug] [Thread-1  ]: Finished running node model.development.test
[0m06:39:51.209236 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m06:39:51.210049 [info ] [Thread-1  ]: 6 of 8 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m06:39:51.211192 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.test, now model.development.fct_payment_details)
[0m06:39:51.211645 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m06:39:51.222509 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m06:39:51.223459 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 06:39:51.211967 => 06:39:51.223110
[0m06:39:51.224055 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m06:39:51.229735 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:39:51.230187 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_ts

    from payments where status = 'success'
)

select * from final
  );
[0m06:39:51.230595 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:51.554372 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:51.560854 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:39:51.561414 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m06:39:51.630283 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:39:51.635102 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:39:51.635671 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m06:39:51.695989 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:39:51.701015 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:39:51.701556 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m06:39:51.762798 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:39:51.767167 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m06:39:51.768713 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:39:51.769154 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m06:39:51.852385 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:51.853067 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:39:51.853552 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_TS")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_TS")

;
[0m06:39:52.183594 [debug] [Thread-1  ]: SQL status: SUCCESS 36 in 0.0 seconds
[0m06:39:52.184379 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:39:52.184825 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m06:39:52.385671 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:52.390576 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:39:52.391125 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m06:39:52.480102 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:52.483983 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 06:39:51.224626 => 06:39:52.483708
[0m06:39:52.484494 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m06:39:52.579197 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dfd957f-27b7-49c0-a67a-00a6ebdea285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa47a0970>]}
[0m06:39:52.580247 [info ] [Thread-1  ]: 6 of 8 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 36[0m in 1.37s]
[0m06:39:52.581398 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m06:39:52.581960 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m06:39:52.582846 [info ] [Thread-1  ]: 7 of 8 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m06:39:52.583928 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m06:39:52.584362 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m06:39:52.590635 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m06:39:52.591468 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 06:39:52.584653 => 06:39:52.591157
[0m06:39:52.591893 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m06:39:52.596848 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:39:52.597317 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace  temporary view external_db.final_sales.fct_order_detail__dbt_tmp
  
   as (
    
with orders as (
    select * from external_db.final_sales.bronze_orders
   
        where run_ts = to_timestamp('2023-06-22')
    
),

products as (
    select * from external_db.final_sales.bronze_products
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_ts
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m06:39:52.597737 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:52.975406 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:52.979362 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:39:52.979867 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail__dbt_tmp
[0m06:39:53.042926 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:53.048420 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:39:53.048981 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail
[0m06:39:53.110747 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:53.120662 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:39:53.121333 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_ORDER_DETAIL"
[0m06:39:53.183102 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:39:53.187648 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m06:39:53.189285 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:39:53.189736 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
-- back compat for old kwarg name
  
  begin;
[0m06:39:53.263053 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:53.263798 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:39:53.264284 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
merge into external_db.final_sales.fct_order_detail as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_order_detail__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_TS")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_TS")

;
[0m06:39:53.649884 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 0.0 seconds
[0m06:39:53.650809 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:39:53.651257 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
COMMIT
[0m06:39:53.842420 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:53.847783 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:39:53.848344 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m06:39:53.936520 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:53.940525 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 06:39:52.592158 => 06:39:53.940255
[0m06:39:53.941063 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m06:39:54.040808 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dfd957f-27b7-49c0-a67a-00a6ebdea285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa9399d30>]}
[0m06:39:54.041849 [info ] [Thread-1  ]: 7 of 8 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 50[0m in 1.46s]
[0m06:39:54.042690 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m06:39:54.043987 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m06:39:54.044553 [info ] [Thread-1  ]: 8 of 8 START sql incremental model final_sales.product_sales ................... [RUN]
[0m06:39:54.045423 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m06:39:54.045846 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m06:39:54.053091 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m06:39:54.054047 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 06:39:54.046115 => 06:39:54.053660
[0m06:39:54.054492 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m06:39:54.059604 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:39:54.060084 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace  temporary view external_db.final_sales.product_sales__dbt_tmp
  
   as (
    

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
        where run_ts = to_timestamp('2023-06-22')
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
        where run_ts = to_timestamp('2023-06-22')
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as (

    select
        order_details.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m06:39:54.060520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:39:54.589800 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:39:54.594334 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:39:54.595134 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales__dbt_tmp
[0m06:39:54.665703 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:39:54.671197 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:39:54.671786 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales
[0m06:39:54.735240 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:39:54.740379 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:39:54.740946 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."PRODUCT_SALES"
[0m06:39:54.811470 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:39:54.815468 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m06:39:54.816928 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:39:54.817360 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
-- back compat for old kwarg name
  
  begin;
[0m06:39:54.899409 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:54.900106 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:39:54.900575 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
merge into external_db.final_sales.product_sales as DBT_INTERNAL_DEST
        using external_db.final_sales.product_sales__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","ORDER_AMOUNT" = DBT_INTERNAL_SOURCE."ORDER_AMOUNT"
    

    when not matched then insert
        ("CUSTOMER_ID", "ORDER_AMOUNT")
    values
        ("CUSTOMER_ID", "ORDER_AMOUNT")

;
[0m06:39:55.379519 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 0.0 seconds
[0m06:39:55.380251 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:39:55.380870 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
COMMIT
[0m06:39:55.605032 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:55.611655 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:39:55.612179 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m06:39:55.700920 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:39:55.704906 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 06:39:54.054762 => 06:39:55.704591
[0m06:39:55.705419 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m06:39:55.815431 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dfd957f-27b7-49c0-a67a-00a6ebdea285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa41e9d00>]}
[0m06:39:55.816437 [info ] [Thread-1  ]: 8 of 8 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 50[0m in 1.77s]
[0m06:39:55.817266 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m06:39:55.819162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:39:55.819565 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m06:39:55.819969 [info ] [MainThread]: 
[0m06:39:55.820409 [info ] [MainThread]: Finished running 7 incremental models, 1 view model in 0 hours 0 minutes and 13.90 seconds (13.90s).
[0m06:39:55.822237 [debug] [MainThread]: Command end result
[0m06:39:55.834130 [info ] [MainThread]: 
[0m06:39:55.834724 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:39:55.835143 [info ] [MainThread]: 
[0m06:39:55.835567 [error] [MainThread]: [33mDatabase Error in model test (models/sales/test/test.sql)[0m
[0m06:39:55.835946 [error] [MainThread]:   002022 (42601): SQL compilation error:
[0m06:39:55.836307 [error] [MainThread]:   Missing column specification
[0m06:39:55.836662 [error] [MainThread]:   compiled Code at target/run/development/models/sales/test/test.sql
[0m06:39:55.837045 [info ] [MainThread]: 
[0m06:39:55.837462 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:39:55.838281 [debug] [MainThread]: Command `dbt run` failed at 06:39:55.838136 after 14.35 seconds
[0m06:39:55.838751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aab6260a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa47b2ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a97597190>]}
[0m06:39:55.839819 [debug] [MainThread]: Flushing usage events
[0m06:40:15.148459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb481e54130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb480759130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb480759400>]}


============================== 06:40:15.152009 | 73c43642-4b6b-4523-afad-333897d913d2 ==============================
[0m06:40:15.152009 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:40:15.152644 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/dbt_project/dbt/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/dbt_project/dbt/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:40:15.437642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73c43642-4b6b-4523-afad-333897d913d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb47af95d00>]}
[0m06:40:15.455364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73c43642-4b6b-4523-afad-333897d913d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb47af87b50>]}
[0m06:40:15.470568 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:40:15.496222 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:40:15.497110 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/test/test.sql
[0m06:40:15.523152 [debug] [MainThread]: 1699: static parser successfully parsed sales/test/test.sql
[0m06:40:15.545608 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.development.staging
- models.development.bronze
- models.development.gold
- models.development.silver
[0m06:40:15.552311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73c43642-4b6b-4523-afad-333897d913d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb47ae7a4f0>]}
[0m06:40:15.563796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73c43642-4b6b-4523-afad-333897d913d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb47af2e070>]}
[0m06:40:15.564452 [info ] [MainThread]: Found 8 models, 30 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m06:40:15.564918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73c43642-4b6b-4523-afad-333897d913d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb47af2e130>]}
[0m06:40:15.567287 [info ] [MainThread]: 
[0m06:40:15.568199 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:40:15.569964 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m06:40:15.587142 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m06:40:15.587818 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m06:40:15.588272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:40:16.259460 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m06:40:16.262760 [debug] [ThreadPool]: On list_external_db: Close
[0m06:40:16.374645 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m06:40:16.384428 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m06:40:16.384990 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m06:40:16.385372 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:40:16.859213 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m06:40:16.861914 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m06:40:16.977142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73c43642-4b6b-4523-afad-333897d913d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb47c040400>]}
[0m06:40:16.978421 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:40:16.978976 [info ] [MainThread]: 
[0m06:40:16.983159 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m06:40:16.983846 [info ] [Thread-1  ]: 1 of 8 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m06:40:16.984671 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m06:40:16.985108 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m06:40:16.990377 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m06:40:16.991322 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 06:40:16.985385 => 06:40:16.990981
[0m06:40:16.991838 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m06:40:17.049626 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:40:17.050298 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_timestamp('2023-06-22') as run_ts  from external_db.stage.customers
)

select * from customers
  );
[0m06:40:17.050750 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:40:17.443763 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:17.454480 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:40:17.455081 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m06:40:17.539439 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:40:17.545064 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:40:17.545708 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m06:40:17.612503 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:40:17.623448 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:40:17.624035 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m06:40:17.695256 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:40:17.733002 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m06:40:17.734773 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:40:17.735290 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m06:40:17.820335 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:17.821085 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:40:17.821610 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_TS")
    values
        ("VALUE", "CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_TS")

;
[0m06:40:18.578916 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:40:18.579749 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:40:18.580254 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m06:40:18.777016 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:18.786529 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:40:18.787034 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m06:40:18.883239 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:18.908268 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 06:40:16.992188 => 06:40:18.907990
[0m06:40:18.908849 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m06:40:19.020056 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c43642-4b6b-4523-afad-333897d913d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb479dbe490>]}
[0m06:40:19.021114 [info ] [Thread-1  ]: 1 of 8 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 50[0m in 2.04s]
[0m06:40:19.022345 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m06:40:19.022918 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m06:40:19.023516 [info ] [Thread-1  ]: 2 of 8 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m06:40:19.024374 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m06:40:19.024814 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m06:40:19.106345 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m06:40:19.107427 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 06:40:19.025081 => 06:40:19.107031
[0m06:40:19.107916 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m06:40:19.112475 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:40:19.112943 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.orders
)

select * from orders
  );
[0m06:40:19.113345 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:40:19.505973 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:19.510229 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:40:19.510787 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m06:40:19.584463 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:40:19.590832 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:40:19.591386 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m06:40:19.653140 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:40:19.658682 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:40:19.659332 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m06:40:19.722247 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:40:19.726885 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m06:40:19.728591 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:40:19.729062 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m06:40:19.808305 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:19.809058 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:40:19.809599 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_TS")
    values
        ("VALUE", "ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_TS")

;
[0m06:40:20.520266 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:40:20.521076 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:40:20.521586 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m06:40:20.748255 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:20.752822 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:40:20.753294 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m06:40:20.838507 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:20.842641 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 06:40:19.108196 => 06:40:20.842351
[0m06:40:20.843194 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m06:40:20.937965 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c43642-4b6b-4523-afad-333897d913d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb479cd5190>]}
[0m06:40:20.939062 [info ] [Thread-1  ]: 2 of 8 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 50[0m in 1.91s]
[0m06:40:20.940053 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m06:40:20.940626 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m06:40:20.941437 [info ] [Thread-1  ]: 3 of 8 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m06:40:20.942570 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m06:40:20.943052 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m06:40:20.947823 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m06:40:20.948609 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 06:40:20.943444 => 06:40:20.948321
[0m06:40:20.949015 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m06:40:20.954720 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:40:20.955151 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.payments
)

select * from payments
  );
[0m06:40:20.955564 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:40:21.356864 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:21.361305 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:40:21.361912 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m06:40:21.448916 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:40:21.454146 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:40:21.454726 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m06:40:21.523865 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:40:21.529440 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:40:21.530095 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m06:40:21.601828 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:40:21.606207 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m06:40:21.608002 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:40:21.608497 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m06:40:21.690334 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:21.691016 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:40:21.691530 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_TS")
    values
        ("VALUE", "PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_TS")

;
[0m06:40:22.420251 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:40:22.421287 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:40:22.421860 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m06:40:22.640070 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:22.644773 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:40:22.645246 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m06:40:22.740299 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:22.744018 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 06:40:20.949274 => 06:40:22.743728
[0m06:40:22.744592 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m06:40:22.857578 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c43642-4b6b-4523-afad-333897d913d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb478487d90>]}
[0m06:40:22.858603 [info ] [Thread-1  ]: 3 of 8 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 50[0m in 1.92s]
[0m06:40:22.859462 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m06:40:22.859986 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m06:40:22.860938 [info ] [Thread-1  ]: 4 of 8 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m06:40:22.862050 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m06:40:22.862480 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m06:40:22.866980 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m06:40:22.867780 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 06:40:22.862748 => 06:40:22.867485
[0m06:40:22.868189 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m06:40:22.872448 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:40:22.872902 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.products
)

select * from products
  );
[0m06:40:22.873299 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:40:23.263498 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:23.267897 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:40:23.268482 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m06:40:23.349069 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:40:23.355514 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:40:23.356066 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m06:40:23.418417 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:40:23.423473 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:40:23.423992 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m06:40:23.498374 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:40:23.502518 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m06:40:23.504141 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:40:23.504601 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m06:40:23.596026 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:23.596751 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:40:23.597313 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "PRODUCT_ID", "PRICE", "RUN_TS")
    values
        ("VALUE", "PRODUCT_ID", "PRICE", "RUN_TS")

;
[0m06:40:24.135431 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:40:24.136295 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:40:24.136820 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m06:40:24.337881 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:24.343013 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:40:24.343599 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m06:40:24.436049 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:24.439513 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 06:40:22.868452 => 06:40:24.439205
[0m06:40:24.440038 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m06:40:24.544354 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c43642-4b6b-4523-afad-333897d913d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4783a65b0>]}
[0m06:40:24.545669 [info ] [Thread-1  ]: 4 of 8 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 50[0m in 1.68s]
[0m06:40:24.546817 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m06:40:24.547392 [debug] [Thread-1  ]: Began running node model.development.test
[0m06:40:24.547958 [info ] [Thread-1  ]: 5 of 8 START sql view model final_sales.test ................................... [RUN]
[0m06:40:24.549424 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.test)
[0m06:40:24.549896 [debug] [Thread-1  ]: Began compiling node model.development.test
[0m06:40:24.552646 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.test"
[0m06:40:24.553382 [debug] [Thread-1  ]: Timing info for model.development.test (compile): 06:40:24.550236 => 06:40:24.553120
[0m06:40:24.553866 [debug] [Thread-1  ]: Began executing node model.development.test
[0m06:40:24.575094 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.test"
[0m06:40:24.576210 [debug] [Thread-1  ]: Using snowflake connection "model.development.test"
[0m06:40:24.576957 [debug] [Thread-1  ]: On model.development.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.test"} */
create or replace   view external_db.final_sales.test
  
   as (
    select (1)
  );
[0m06:40:24.577353 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:40:24.873668 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad5470-0000-fb4f-0001-937e0001a5f2
[0m06:40:24.874348 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m06:40:24.875096 [debug] [Thread-1  ]: Timing info for model.development.test (execute): 06:40:24.554137 => 06:40:24.874809
[0m06:40:24.875798 [debug] [Thread-1  ]: On model.development.test: Close
[0m06:40:24.986491 [debug] [Thread-1  ]: Database Error in model test (models/sales/test/test.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled Code at target/run/development/models/sales/test/test.sql
[0m06:40:24.987512 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c43642-4b6b-4523-afad-333897d913d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb47ae7a6a0>]}
[0m06:40:24.988638 [error] [Thread-1  ]: 5 of 8 ERROR creating sql view model final_sales.test .......................... [[31mERROR[0m in 0.44s]
[0m06:40:24.989570 [debug] [Thread-1  ]: Finished running node model.development.test
[0m06:40:24.990111 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m06:40:24.991005 [info ] [Thread-1  ]: 6 of 8 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m06:40:24.991971 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.test, now model.development.fct_payment_details)
[0m06:40:24.992396 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m06:40:25.003151 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m06:40:25.004561 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 06:40:24.992842 => 06:40:25.004157
[0m06:40:25.005040 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m06:40:25.010359 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:40:25.010825 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_ts

    from payments where status = 'success'
)

select * from final
  );
[0m06:40:25.011233 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:40:25.369768 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:25.377705 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:40:25.378531 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m06:40:25.450929 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:40:25.456888 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:40:25.457629 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m06:40:25.531725 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:40:25.536785 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:40:25.537335 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m06:40:25.603903 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:40:25.608445 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m06:40:25.610123 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:40:25.610623 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m06:40:25.695766 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:25.696513 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:40:25.696989 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_TS")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_TS")

;
[0m06:40:26.124905 [debug] [Thread-1  ]: SQL status: SUCCESS 36 in 0.0 seconds
[0m06:40:26.125671 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:40:26.126138 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m06:40:26.342016 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:26.347300 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:40:26.347807 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m06:40:26.447647 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:26.451443 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 06:40:25.005375 => 06:40:26.451119
[0m06:40:26.451968 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m06:40:26.556779 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c43642-4b6b-4523-afad-333897d913d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb479e0b820>]}
[0m06:40:26.557818 [info ] [Thread-1  ]: 6 of 8 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 36[0m in 1.57s]
[0m06:40:26.558664 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m06:40:26.559186 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m06:40:26.559918 [info ] [Thread-1  ]: 7 of 8 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m06:40:26.560848 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m06:40:26.561271 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m06:40:26.567409 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m06:40:26.568150 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 06:40:26.561533 => 06:40:26.567890
[0m06:40:26.568566 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m06:40:26.573329 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:40:26.573787 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace  temporary view external_db.final_sales.fct_order_detail__dbt_tmp
  
   as (
    
with orders as (
    select * from external_db.final_sales.bronze_orders
   
        where run_ts = to_timestamp('2023-06-22')
    
),

products as (
    select * from external_db.final_sales.bronze_products
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_ts
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m06:40:26.574199 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:40:27.109803 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:40:27.114026 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:40:27.114532 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail__dbt_tmp
[0m06:40:27.190715 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:40:27.195607 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:40:27.196157 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail
[0m06:40:27.257709 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:40:27.265231 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:40:27.265877 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_ORDER_DETAIL"
[0m06:40:27.330981 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:40:27.335678 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m06:40:27.337474 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:40:27.337986 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
-- back compat for old kwarg name
  
  begin;
[0m06:40:27.415761 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:27.416509 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:40:27.417043 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
merge into external_db.final_sales.fct_order_detail as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_order_detail__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_TS")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_TS")

;
[0m06:40:27.970436 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:40:27.971555 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:40:27.972155 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
COMMIT
[0m06:40:28.174199 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:28.179181 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:40:28.179782 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m06:40:28.268837 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:28.272514 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 06:40:26.568832 => 06:40:28.272224
[0m06:40:28.273055 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m06:40:28.380296 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c43642-4b6b-4523-afad-333897d913d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4782c9670>]}
[0m06:40:28.381403 [info ] [Thread-1  ]: 7 of 8 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 50[0m in 1.82s]
[0m06:40:28.382346 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m06:40:28.383637 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m06:40:28.384397 [info ] [Thread-1  ]: 8 of 8 START sql incremental model final_sales.product_sales ................... [RUN]
[0m06:40:28.385349 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m06:40:28.385833 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m06:40:28.393096 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m06:40:28.393900 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 06:40:28.386139 => 06:40:28.393627
[0m06:40:28.394345 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m06:40:28.399412 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:40:28.399887 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace  temporary view external_db.final_sales.product_sales__dbt_tmp
  
   as (
    

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
        where run_ts = to_timestamp('2023-06-22')
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
        where run_ts = to_timestamp('2023-06-22')
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as (

    select
        order_details.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m06:40:28.400331 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:40:28.795488 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:28.799619 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:40:28.800177 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales__dbt_tmp
[0m06:40:28.874981 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:40:28.879552 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:40:28.880067 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales
[0m06:40:28.949631 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:40:28.954332 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:40:28.954819 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."PRODUCT_SALES"
[0m06:40:29.018800 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:40:29.022938 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m06:40:29.024554 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:40:29.024989 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
-- back compat for old kwarg name
  
  begin;
[0m06:40:29.109734 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:29.110661 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:40:29.111254 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
merge into external_db.final_sales.product_sales as DBT_INTERNAL_DEST
        using external_db.final_sales.product_sales__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","ORDER_AMOUNT" = DBT_INTERNAL_SOURCE."ORDER_AMOUNT"
    

    when not matched then insert
        ("CUSTOMER_ID", "ORDER_AMOUNT")
    values
        ("CUSTOMER_ID", "ORDER_AMOUNT")

;
[0m06:40:29.858175 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:40:29.859163 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:40:29.860184 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
COMMIT
[0m06:40:30.061869 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:30.068873 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:40:30.069467 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m06:40:30.154626 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:40:30.158257 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 06:40:28.394609 => 06:40:30.157976
[0m06:40:30.158792 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m06:40:30.270862 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73c43642-4b6b-4523-afad-333897d913d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb478273fa0>]}
[0m06:40:30.272045 [info ] [Thread-1  ]: 8 of 8 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 50[0m in 1.89s]
[0m06:40:30.273015 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m06:40:30.275094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:40:30.275492 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m06:40:30.275887 [info ] [MainThread]: 
[0m06:40:30.276326 [info ] [MainThread]: Finished running 7 incremental models, 1 view model in 0 hours 0 minutes and 14.71 seconds (14.71s).
[0m06:40:30.278139 [debug] [MainThread]: Command end result
[0m06:40:30.288460 [info ] [MainThread]: 
[0m06:40:30.289001 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:40:30.289395 [info ] [MainThread]: 
[0m06:40:30.289787 [error] [MainThread]: [33mDatabase Error in model test (models/sales/test/test.sql)[0m
[0m06:40:30.290167 [error] [MainThread]:   002022 (42601): SQL compilation error:
[0m06:40:30.290531 [error] [MainThread]:   Missing column specification
[0m06:40:30.290882 [error] [MainThread]:   compiled Code at target/run/development/models/sales/test/test.sql
[0m06:40:30.291283 [info ] [MainThread]: 
[0m06:40:30.291718 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:40:30.292578 [debug] [MainThread]: Command `dbt run` failed at 06:40:30.292439 after 15.16 seconds
[0m06:40:30.293032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb481e54130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb47af95a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb47821b3a0>]}
[0m06:40:30.293476 [debug] [MainThread]: Flushing usage events
[0m06:41:17.906378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd222260100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd220b65940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd220b651f0>]}


============================== 06:41:17.909764 | 0e67dc2f-5b3b-4e6b-8d2c-c7e3636f8e41 ==============================
[0m06:41:17.909764 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:41:17.910389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/satyam/dbt_project/dbt/dbt/logs', 'profiles_dir': '/home/satyam/dbt_project/dbt/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:41:18.190672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e67dc2f-5b3b-4e6b-8d2c-c7e3636f8e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21b3b9e20>]}
[0m06:41:18.208498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e67dc2f-5b3b-4e6b-8d2c-c7e3636f8e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21b389ac0>]}
[0m06:41:18.224008 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:41:18.250157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:41:18.251146 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/test/test.sql
[0m06:41:18.277785 [debug] [MainThread]: 1699: static parser successfully parsed sales/test/test.sql
[0m06:41:18.299949 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.development.bronze
- models.development.silver
- models.development.gold
- models.development.staging
[0m06:41:18.306718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e67dc2f-5b3b-4e6b-8d2c-c7e3636f8e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21b27e4c0>]}
[0m06:41:18.318470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e67dc2f-5b3b-4e6b-8d2c-c7e3636f8e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21b31c040>]}
[0m06:41:18.319163 [info ] [MainThread]: Found 8 models, 30 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m06:41:18.319669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e67dc2f-5b3b-4e6b-8d2c-c7e3636f8e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21b31c100>]}
[0m06:41:18.322038 [info ] [MainThread]: 
[0m06:41:18.322930 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:41:18.325214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m06:41:18.341605 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m06:41:18.342271 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m06:41:18.342732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:41:19.015191 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m06:41:19.018058 [debug] [ThreadPool]: On list_external_db: Close
[0m06:41:19.114898 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m06:41:19.124703 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m06:41:19.125259 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m06:41:19.125786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:41:19.558447 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m06:41:19.560790 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m06:41:19.661887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e67dc2f-5b3b-4e6b-8d2c-c7e3636f8e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21c454430>]}
[0m06:41:19.663196 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:41:19.663839 [info ] [MainThread]: 
[0m06:41:19.668314 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m06:41:19.669044 [info ] [Thread-1  ]: 1 of 8 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m06:41:19.669925 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m06:41:19.670388 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m06:41:19.675236 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m06:41:19.676130 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 06:41:19.670676 => 06:41:19.675827
[0m06:41:19.676602 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m06:41:19.734982 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:41:19.735688 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_timestamp('2023-06-22') as run_ts  from external_db.stage.customers
)

select * from customers
  );
[0m06:41:19.736119 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:41:20.122344 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:20.133726 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:41:20.134348 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m06:41:20.203815 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:41:20.209344 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:41:20.209963 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m06:41:20.275916 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:41:20.286821 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:41:20.287452 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m06:41:20.355722 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:41:20.392273 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m06:41:20.393994 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:41:20.394484 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m06:41:20.471447 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:20.472198 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:41:20.472718 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_TS")
    values
        ("VALUE", "CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_TS")

;
[0m06:41:21.173050 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:41:21.174105 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:41:21.174684 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m06:41:21.388454 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:21.399681 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:41:21.400233 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m06:41:21.487743 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:21.593130 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 06:41:19.676872 => 06:41:21.592859
[0m06:41:21.593828 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m06:41:21.705263 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e67dc2f-5b3b-4e6b-8d2c-c7e3636f8e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21a18e580>]}
[0m06:41:21.706344 [info ] [Thread-1  ]: 1 of 8 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 50[0m in 2.04s]
[0m06:41:21.707626 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m06:41:21.708200 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m06:41:21.709096 [info ] [Thread-1  ]: 2 of 8 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m06:41:21.710254 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m06:41:21.710704 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m06:41:21.717314 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m06:41:21.718227 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 06:41:21.711468 => 06:41:21.717915
[0m06:41:21.718758 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m06:41:21.724067 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:41:21.724612 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.orders
)

select * from orders
  );
[0m06:41:21.725068 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:41:22.108904 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:22.113349 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:41:22.113962 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m06:41:22.194049 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:41:22.200324 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:41:22.200937 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m06:41:22.278393 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:41:22.283581 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:41:22.284160 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m06:41:22.351421 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:41:22.356094 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m06:41:22.357722 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:41:22.358169 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m06:41:22.438114 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:22.438866 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:41:22.439410 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_TS")
    values
        ("VALUE", "ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_TS")

;
[0m06:41:23.033419 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:41:23.034484 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:41:23.035039 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m06:41:23.283254 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:23.288066 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:41:23.288607 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m06:41:23.387590 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:23.391734 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 06:41:21.719062 => 06:41:23.391456
[0m06:41:23.392300 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m06:41:23.502849 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e67dc2f-5b3b-4e6b-8d2c-c7e3636f8e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21a0bb760>]}
[0m06:41:23.504039 [info ] [Thread-1  ]: 2 of 8 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 50[0m in 1.79s]
[0m06:41:23.504985 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m06:41:23.505556 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m06:41:23.506366 [info ] [Thread-1  ]: 3 of 8 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m06:41:23.507516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m06:41:23.508001 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m06:41:23.515388 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m06:41:23.516444 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 06:41:23.508278 => 06:41:23.516046
[0m06:41:23.516920 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m06:41:23.523155 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:41:23.523698 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.payments
)

select * from payments
  );
[0m06:41:23.524101 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:41:23.921537 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:23.925804 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:41:23.926364 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m06:41:24.001520 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:41:24.006949 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:41:24.007603 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m06:41:24.082546 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:41:24.088175 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:41:24.088805 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m06:41:24.159111 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:41:24.163628 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m06:41:24.165439 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:41:24.165945 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m06:41:24.249544 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:24.250294 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:41:24.250807 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_TS")
    values
        ("VALUE", "PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_TS")

;
[0m06:41:25.021137 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:41:25.021944 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:41:25.022424 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m06:41:25.221383 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:25.226582 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:41:25.227159 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m06:41:25.327740 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:25.331550 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 06:41:23.517185 => 06:41:25.331215
[0m06:41:25.332156 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m06:41:25.440053 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e67dc2f-5b3b-4e6b-8d2c-c7e3636f8e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21a0bb2b0>]}
[0m06:41:25.441188 [info ] [Thread-1  ]: 3 of 8 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 50[0m in 1.93s]
[0m06:41:25.442142 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m06:41:25.442738 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m06:41:25.443832 [info ] [Thread-1  ]: 4 of 8 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m06:41:25.445383 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m06:41:25.446061 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m06:41:25.450804 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m06:41:25.451637 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 06:41:25.446390 => 06:41:25.451337
[0m06:41:25.452056 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m06:41:25.456357 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:41:25.456798 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.products
)

select * from products
  );
[0m06:41:25.457191 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:41:25.841123 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:25.847981 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:41:25.848622 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m06:41:25.927977 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:41:25.933315 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:41:25.933928 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m06:41:26.013041 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:41:26.018214 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:41:26.018758 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m06:41:26.086594 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:41:26.091147 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m06:41:26.093037 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:41:26.093538 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m06:41:26.173115 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:26.173834 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:41:26.174342 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "PRODUCT_ID", "PRICE", "RUN_TS")
    values
        ("VALUE", "PRODUCT_ID", "PRICE", "RUN_TS")

;
[0m06:41:26.746744 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:41:26.747550 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:41:26.748029 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m06:41:26.941941 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:26.946949 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:41:26.947726 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m06:41:27.038896 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:27.042285 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 06:41:25.452322 => 06:41:27.042025
[0m06:41:27.042888 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m06:41:27.148224 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e67dc2f-5b3b-4e6b-8d2c-c7e3636f8e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2187c5490>]}
[0m06:41:27.149236 [info ] [Thread-1  ]: 4 of 8 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 50[0m in 1.70s]
[0m06:41:27.150073 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m06:41:27.150610 [debug] [Thread-1  ]: Began running node model.development.test
[0m06:41:27.151444 [info ] [Thread-1  ]: 5 of 8 START sql view model final_sales.test ................................... [RUN]
[0m06:41:27.152516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.test)
[0m06:41:27.152952 [debug] [Thread-1  ]: Began compiling node model.development.test
[0m06:41:27.155445 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.test"
[0m06:41:27.156214 [debug] [Thread-1  ]: Timing info for model.development.test (compile): 06:41:27.153218 => 06:41:27.155948
[0m06:41:27.156624 [debug] [Thread-1  ]: Began executing node model.development.test
[0m06:41:27.175923 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.test"
[0m06:41:27.177048 [debug] [Thread-1  ]: Using snowflake connection "model.development.test"
[0m06:41:27.177532 [debug] [Thread-1  ]: On model.development.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.test"} */
create or replace   view external_db.final_sales.test
  
   as (
    select CURRENT_TIMESTAMP
  );
[0m06:41:27.177928 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:41:27.467075 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01ad5471-0000-fb4f-0001-937e0001a672
[0m06:41:27.467953 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m06:41:27.468766 [debug] [Thread-1  ]: Timing info for model.development.test (execute): 06:41:27.156881 => 06:41:27.468492
[0m06:41:27.469224 [debug] [Thread-1  ]: On model.development.test: Close
[0m06:41:27.567254 [debug] [Thread-1  ]: Database Error in model test (models/sales/test/test.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled Code at target/run/development/models/sales/test/test.sql
[0m06:41:27.568701 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e67dc2f-5b3b-4e6b-8d2c-c7e3636f8e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21c45c460>]}
[0m06:41:27.569756 [error] [Thread-1  ]: 5 of 8 ERROR creating sql view model final_sales.test .......................... [[31mERROR[0m in 0.42s]
[0m06:41:27.570415 [debug] [Thread-1  ]: Finished running node model.development.test
[0m06:41:27.570946 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m06:41:27.571641 [info ] [Thread-1  ]: 6 of 8 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m06:41:27.572976 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.test, now model.development.fct_payment_details)
[0m06:41:27.573568 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m06:41:27.585319 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m06:41:27.586289 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 06:41:27.573848 => 06:41:27.585919
[0m06:41:27.586809 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m06:41:27.592446 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:41:27.592918 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_ts

    from payments where status = 'success'
)

select * from final
  );
[0m06:41:27.593337 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:41:27.990927 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:27.997866 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:41:27.998631 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m06:41:28.081810 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:41:28.087240 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:41:28.087824 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m06:41:28.161232 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:41:28.166257 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:41:28.166826 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m06:41:28.238811 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:41:28.243315 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m06:41:28.244925 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:41:28.245395 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m06:41:28.343099 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:28.343849 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:41:28.344509 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_TS")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_TS")

;
[0m06:41:28.954252 [debug] [Thread-1  ]: SQL status: SUCCESS 36 in 1.0 seconds
[0m06:41:28.955211 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:41:28.955736 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m06:41:29.168391 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:29.173213 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:41:29.173759 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m06:41:29.266053 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:29.269378 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 06:41:27.587087 => 06:41:29.269125
[0m06:41:29.269867 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m06:41:29.389677 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e67dc2f-5b3b-4e6b-8d2c-c7e3636f8e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21c45c460>]}
[0m06:41:29.390864 [info ] [Thread-1  ]: 6 of 8 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 36[0m in 1.82s]
[0m06:41:29.391936 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m06:41:29.392573 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m06:41:29.393446 [info ] [Thread-1  ]: 7 of 8 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m06:41:29.394348 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m06:41:29.394789 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m06:41:29.401254 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m06:41:29.402145 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 06:41:29.395056 => 06:41:29.401845
[0m06:41:29.402587 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m06:41:29.407687 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:41:29.408186 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace  temporary view external_db.final_sales.fct_order_detail__dbt_tmp
  
   as (
    
with orders as (
    select * from external_db.final_sales.bronze_orders
   
        where run_ts = to_timestamp('2023-06-22')
    
),

products as (
    select * from external_db.final_sales.bronze_products
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_ts
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m06:41:29.408608 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:41:29.960183 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:41:29.965129 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:41:29.965776 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail__dbt_tmp
[0m06:41:30.042170 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:41:30.047740 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:41:30.048279 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail
[0m06:41:30.116750 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:41:30.125084 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:41:30.125739 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_ORDER_DETAIL"
[0m06:41:30.202206 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:41:30.207293 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m06:41:30.209530 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:41:30.210030 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
-- back compat for old kwarg name
  
  begin;
[0m06:41:30.292381 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:30.293496 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:41:30.294078 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
merge into external_db.final_sales.fct_order_detail as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_order_detail__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_TS")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_TS")

;
[0m06:41:30.955864 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:41:30.956616 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:41:30.957049 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
COMMIT
[0m06:41:31.192003 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:31.197185 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:41:31.197724 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m06:41:31.293729 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:31.297646 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 06:41:29.402851 => 06:41:31.297379
[0m06:41:31.298166 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m06:41:31.401408 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e67dc2f-5b3b-4e6b-8d2c-c7e3636f8e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2186bf790>]}
[0m06:41:31.402471 [info ] [Thread-1  ]: 7 of 8 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 50[0m in 2.01s]
[0m06:41:31.403362 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m06:41:31.404665 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m06:41:31.405381 [info ] [Thread-1  ]: 8 of 8 START sql incremental model final_sales.product_sales ................... [RUN]
[0m06:41:31.406415 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m06:41:31.406917 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m06:41:31.414521 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m06:41:31.415452 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 06:41:31.407225 => 06:41:31.415101
[0m06:41:31.415887 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m06:41:31.421338 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:41:31.421840 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace  temporary view external_db.final_sales.product_sales__dbt_tmp
  
   as (
    

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
        where run_ts = to_timestamp('2023-06-22')
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
        where run_ts = to_timestamp('2023-06-22')
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as (

    select
        order_details.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m06:41:31.422274 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:41:31.949133 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:41:31.953433 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:41:31.953978 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales__dbt_tmp
[0m06:41:32.021371 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:41:32.026235 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:41:32.026767 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales
[0m06:41:32.086184 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:41:32.090981 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:41:32.091576 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."PRODUCT_SALES"
[0m06:41:32.156266 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:41:32.160537 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m06:41:32.162035 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:41:32.162483 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
-- back compat for old kwarg name
  
  begin;
[0m06:41:32.243664 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:32.244407 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:41:32.244910 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
merge into external_db.final_sales.product_sales as DBT_INTERNAL_DEST
        using external_db.final_sales.product_sales__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","ORDER_AMOUNT" = DBT_INTERNAL_SOURCE."ORDER_AMOUNT"
    

    when not matched then insert
        ("CUSTOMER_ID", "ORDER_AMOUNT")
    values
        ("CUSTOMER_ID", "ORDER_AMOUNT")

;
[0m06:41:32.973279 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:41:32.974100 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:41:32.974582 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
COMMIT
[0m06:41:33.171149 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:33.177916 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:41:33.178562 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m06:41:33.272520 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:41:33.276223 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 06:41:31.416153 => 06:41:33.275960
[0m06:41:33.276715 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m06:41:33.380914 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e67dc2f-5b3b-4e6b-8d2c-c7e3636f8e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd218699af0>]}
[0m06:41:33.382016 [info ] [Thread-1  ]: 8 of 8 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 50[0m in 1.97s]
[0m06:41:33.382960 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m06:41:33.385084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:41:33.385454 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m06:41:33.386061 [info ] [MainThread]: 
[0m06:41:33.386660 [info ] [MainThread]: Finished running 7 incremental models, 1 view model in 0 hours 0 minutes and 15.06 seconds (15.06s).
[0m06:41:33.391707 [debug] [MainThread]: Command end result
[0m06:41:33.403481 [info ] [MainThread]: 
[0m06:41:33.404144 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:41:33.404556 [info ] [MainThread]: 
[0m06:41:33.405031 [error] [MainThread]: [33mDatabase Error in model test (models/sales/test/test.sql)[0m
[0m06:41:33.405417 [error] [MainThread]:   002022 (42601): SQL compilation error:
[0m06:41:33.405781 [error] [MainThread]:   Missing column specification
[0m06:41:33.406131 [error] [MainThread]:   compiled Code at target/run/development/models/sales/test/test.sql
[0m06:41:33.406510 [info ] [MainThread]: 
[0m06:41:33.406923 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:41:33.407769 [debug] [MainThread]: Command `dbt run` failed at 06:41:33.407613 after 15.52 seconds
[0m06:41:33.408243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd222260100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21b3b9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd21a0aec40>]}
[0m06:41:33.408958 [debug] [MainThread]: Flushing usage events
[0m06:42:51.236407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb8439070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb6d478b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb6d47250>]}


============================== 06:42:51.239957 | eb562f1c-eced-49ec-a60c-bc2e03e7477f ==============================
[0m06:42:51.239957 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:42:51.240626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/satyam/dbt_project/dbt/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/satyam/dbt_project/dbt/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:42:51.527658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb562f1c-eced-49ec-a60c-bc2e03e7477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb159ccd0>]}
[0m06:42:51.545431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb562f1c-eced-49ec-a60c-bc2e03e7477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb1583a30>]}
[0m06:42:51.560905 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:42:51.586646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:42:51.587597 [debug] [MainThread]: Partial parsing: updated file: development://models/sales/test/test.sql
[0m06:42:51.613876 [debug] [MainThread]: 1699: static parser successfully parsed sales/test/test.sql
[0m06:42:51.636589 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.development.gold
- models.development.silver
- models.development.bronze
- models.development.staging
[0m06:42:51.643616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb562f1c-eced-49ec-a60c-bc2e03e7477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb147d490>]}
[0m06:42:51.655517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb562f1c-eced-49ec-a60c-bc2e03e7477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb151c1f0>]}
[0m06:42:51.656219 [info ] [MainThread]: Found 8 models, 30 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m06:42:51.656712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb562f1c-eced-49ec-a60c-bc2e03e7477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb1407dc0>]}
[0m06:42:51.659113 [info ] [MainThread]: 
[0m06:42:51.660090 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:42:51.661891 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db'
[0m06:42:51.678332 [debug] [ThreadPool]: Using snowflake connection "list_external_db"
[0m06:42:51.679042 [debug] [ThreadPool]: On list_external_db: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db"} */
show terse schemas in database external_db
    limit 10000
[0m06:42:51.679528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:52.271998 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m06:42:52.274914 [debug] [ThreadPool]: On list_external_db: Close
[0m06:42:52.377776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_external_db, now list_external_db_final_sales)
[0m06:42:52.387142 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m06:42:52.387728 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m06:42:52.388106 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:42:52.720137 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m06:42:52.722616 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m06:42:52.835144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb562f1c-eced-49ec-a60c-bc2e03e7477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb262ed30>]}
[0m06:42:52.836658 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:42:52.837260 [info ] [MainThread]: 
[0m06:42:52.844348 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m06:42:52.845237 [info ] [Thread-1  ]: 1 of 8 START sql incremental model final_sales.bronze_customers ................ [RUN]
[0m06:42:52.846560 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m06:42:52.847034 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m06:42:52.851748 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m06:42:52.852572 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 06:42:52.847419 => 06:42:52.852283
[0m06:42:52.853007 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m06:42:52.914259 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:42:52.914954 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
create or replace  temporary view external_db.final_sales.bronze_customers__dbt_tmp
  
   as (
    

with customers as (
     select *, 
     to_timestamp('2023-06-22') as run_ts  from external_db.stage.customers
)

select * from customers
  );
[0m06:42:52.915420 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:42:53.290687 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:42:53.301754 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:42:53.302409 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers__dbt_tmp
[0m06:42:53.373312 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:42:53.379780 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:42:53.380377 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table external_db.final_sales.bronze_customers
[0m06:42:53.442269 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:42:53.453136 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:42:53.455159 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_CUSTOMERS"
[0m06:42:53.514758 [debug] [Thread-1  ]: SQL status: SUCCESS 5 in 0.0 seconds
[0m06:42:53.553189 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_customers"
[0m06:42:53.554958 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:42:53.555499 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
-- back compat for old kwarg name
  
  begin;
[0m06:42:53.647654 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:42:53.648408 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:42:53.648945 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
merge into external_db.final_sales.bronze_customers as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_customers__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","FIRST_NAME" = DBT_INTERNAL_SOURCE."FIRST_NAME","LAST_NAME" = DBT_INTERNAL_SOURCE."LAST_NAME","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_TS")
    values
        ("VALUE", "CUSTOMER_ID", "FIRST_NAME", "LAST_NAME", "RUN_TS")

;
[0m06:42:54.362306 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:42:54.363127 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:42:54.363615 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
COMMIT
[0m06:42:54.578169 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:42:54.588623 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_customers"
[0m06:42:54.589387 [debug] [Thread-1  ]: On model.development.bronze_customers: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_customers"} */
drop view if exists external_db.final_sales.bronze_customers__dbt_tmp cascade
[0m06:42:54.771081 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:42:54.797077 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 06:42:52.853270 => 06:42:54.796802
[0m06:42:54.797643 [debug] [Thread-1  ]: On model.development.bronze_customers: Close
[0m06:42:54.895031 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb562f1c-eced-49ec-a60c-bc2e03e7477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb03f39d0>]}
[0m06:42:54.896387 [info ] [Thread-1  ]: 1 of 8 OK created sql incremental model final_sales.bronze_customers ........... [[32mSUCCESS 50[0m in 2.05s]
[0m06:42:54.897772 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m06:42:54.898313 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m06:42:54.899024 [info ] [Thread-1  ]: 2 of 8 START sql incremental model final_sales.bronze_orders ................... [RUN]
[0m06:42:54.900150 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m06:42:54.900579 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m06:42:54.984226 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m06:42:54.985278 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 06:42:54.900842 => 06:42:54.984935
[0m06:42:54.985762 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m06:42:54.990360 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:42:54.990865 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
create or replace  temporary view external_db.final_sales.bronze_orders__dbt_tmp
  
   as (
    

with orders as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.orders
)

select * from orders
  );
[0m06:42:54.991306 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:42:55.623183 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.0 seconds
[0m06:42:55.627621 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:42:55.628207 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders__dbt_tmp
[0m06:42:55.706727 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:42:55.711681 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:42:55.712541 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table external_db.final_sales.bronze_orders
[0m06:42:55.788871 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:42:55.795333 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:42:55.795936 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_ORDERS"
[0m06:42:55.863592 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:42:55.868587 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_orders"
[0m06:42:55.870402 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:42:55.870962 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
-- back compat for old kwarg name
  
  begin;
[0m06:42:55.951915 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:42:55.952596 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:42:55.953065 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
merge into external_db.final_sales.bronze_orders as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_orders__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_TS")
    values
        ("VALUE", "ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "RUN_TS")

;
[0m06:42:56.590732 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:42:56.591598 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:42:56.592117 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
COMMIT
[0m06:42:56.790634 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:42:56.795299 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_orders"
[0m06:42:56.795805 [debug] [Thread-1  ]: On model.development.bronze_orders: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_orders"} */
drop view if exists external_db.final_sales.bronze_orders__dbt_tmp cascade
[0m06:42:56.883736 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:42:56.888955 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 06:42:54.986029 => 06:42:56.888643
[0m06:42:56.889594 [debug] [Thread-1  ]: On model.development.bronze_orders: Close
[0m06:42:56.986008 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb562f1c-eced-49ec-a60c-bc2e03e7477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb0263160>]}
[0m06:42:56.987097 [info ] [Thread-1  ]: 2 of 8 OK created sql incremental model final_sales.bronze_orders .............. [[32mSUCCESS 50[0m in 2.09s]
[0m06:42:56.988628 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m06:42:56.989197 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m06:42:56.989914 [info ] [Thread-1  ]: 3 of 8 START sql incremental model final_sales.bronze_payments ................. [RUN]
[0m06:42:56.990754 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m06:42:56.991181 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m06:42:56.996011 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m06:42:56.996966 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 06:42:56.991575 => 06:42:56.996694
[0m06:42:56.997409 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m06:42:57.003663 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:42:57.004169 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
create or replace  temporary view external_db.final_sales.bronze_payments__dbt_tmp
  
   as (
    

with payments as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.payments
)

select * from payments
  );
[0m06:42:57.004565 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:42:57.392503 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:42:57.396938 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:42:57.397542 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments__dbt_tmp
[0m06:42:57.481550 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:42:57.486522 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:42:57.487139 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table external_db.final_sales.bronze_payments
[0m06:42:57.572022 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:42:57.577327 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:42:57.577925 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PAYMENTS"
[0m06:42:57.642008 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:42:57.646773 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_payments"
[0m06:42:57.648559 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:42:57.649063 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
-- back compat for old kwarg name
  
  begin;
[0m06:42:57.734751 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:42:57.735502 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:42:57.736010 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
merge into external_db.final_sales.bronze_payments as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_payments__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","STATUS" = DBT_INTERNAL_SOURCE."STATUS","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_TS")
    values
        ("VALUE", "PAYMENT_ID", "ORDER_ID", "PAYMENT_METHOD", "STATUS", "RUN_TS")

;
[0m06:42:58.443424 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:42:58.444364 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:42:58.446839 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
COMMIT
[0m06:42:58.672697 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:42:58.677691 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_payments"
[0m06:42:58.678233 [debug] [Thread-1  ]: On model.development.bronze_payments: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_payments"} */
drop view if exists external_db.final_sales.bronze_payments__dbt_tmp cascade
[0m06:42:58.799347 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:42:58.802680 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 06:42:56.997670 => 06:42:58.802424
[0m06:42:58.803167 [debug] [Thread-1  ]: On model.development.bronze_payments: Close
[0m06:42:58.914569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb562f1c-eced-49ec-a60c-bc2e03e7477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb02992e0>]}
[0m06:42:58.915847 [info ] [Thread-1  ]: 3 of 8 OK created sql incremental model final_sales.bronze_payments ............ [[32mSUCCESS 50[0m in 1.92s]
[0m06:42:58.916935 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m06:42:58.917587 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m06:42:58.918574 [info ] [Thread-1  ]: 4 of 8 START sql incremental model final_sales.bronze_products ................. [RUN]
[0m06:42:58.919662 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m06:42:58.920143 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m06:42:58.924698 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m06:42:58.925473 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 06:42:58.920422 => 06:42:58.925201
[0m06:42:58.925894 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m06:42:58.931413 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:42:58.931873 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
create or replace  temporary view external_db.final_sales.bronze_products__dbt_tmp
  
   as (
    

with products as (
     select *, 
     to_timestamp('2023-06-22') as run_ts from external_db.stage.products
)

select * from products
  );
[0m06:42:58.932271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:42:59.326337 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:42:59.331694 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:42:59.332658 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products__dbt_tmp
[0m06:42:59.405495 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:42:59.412154 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:42:59.412710 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table external_db.final_sales.bronze_products
[0m06:42:59.482332 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:42:59.487555 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:42:59.488092 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."BRONZE_PRODUCTS"
[0m06:42:59.547815 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:42:59.552397 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.bronze_products"
[0m06:42:59.554469 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:42:59.554961 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
-- back compat for old kwarg name
  
  begin;
[0m06:42:59.640508 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:42:59.641421 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:42:59.642078 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
merge into external_db.final_sales.bronze_products as DBT_INTERNAL_DEST
        using external_db.final_sales.bronze_products__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.product_id = DBT_INTERNAL_DEST.product_id
            )

    
    when matched then update set
        "VALUE" = DBT_INTERNAL_SOURCE."VALUE","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("VALUE", "PRODUCT_ID", "PRICE", "RUN_TS")
    values
        ("VALUE", "PRODUCT_ID", "PRICE", "RUN_TS")

;
[0m06:43:00.346580 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:43:00.347488 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:43:00.347980 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
COMMIT
[0m06:43:00.557696 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:43:00.562992 [debug] [Thread-1  ]: Using snowflake connection "model.development.bronze_products"
[0m06:43:00.563527 [debug] [Thread-1  ]: On model.development.bronze_products: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.bronze_products"} */
drop view if exists external_db.final_sales.bronze_products__dbt_tmp cascade
[0m06:43:00.672595 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:43:00.676511 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 06:42:58.926157 => 06:43:00.676229
[0m06:43:00.677042 [debug] [Thread-1  ]: On model.development.bronze_products: Close
[0m06:43:00.786067 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb562f1c-eced-49ec-a60c-bc2e03e7477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb01944f0>]}
[0m06:43:00.787101 [info ] [Thread-1  ]: 4 of 8 OK created sql incremental model final_sales.bronze_products ............ [[32mSUCCESS 50[0m in 1.87s]
[0m06:43:00.787976 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m06:43:00.788485 [debug] [Thread-1  ]: Began running node model.development.test
[0m06:43:00.789450 [info ] [Thread-1  ]: 5 of 8 START sql view model final_sales.test ................................... [RUN]
[0m06:43:00.790709 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.test)
[0m06:43:00.791137 [debug] [Thread-1  ]: Began compiling node model.development.test
[0m06:43:00.795126 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.test"
[0m06:43:00.796197 [debug] [Thread-1  ]: Timing info for model.development.test (compile): 06:43:00.791487 => 06:43:00.795917
[0m06:43:00.796613 [debug] [Thread-1  ]: Began executing node model.development.test
[0m06:43:00.818090 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.test"
[0m06:43:00.819253 [debug] [Thread-1  ]: Using snowflake connection "model.development.test"
[0m06:43:00.819789 [debug] [Thread-1  ]: On model.development.test: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.test"} */
create or replace   view external_db.final_sales.test
  
   as (
    select * from external_db.stage.customers
  );
[0m06:43:00.820175 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:43:01.176518 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:43:01.180090 [debug] [Thread-1  ]: Timing info for model.development.test (execute): 06:43:00.796876 => 06:43:01.179827
[0m06:43:01.180607 [debug] [Thread-1  ]: On model.development.test: Close
[0m06:43:01.280413 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb562f1c-eced-49ec-a60c-bc2e03e7477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb0278550>]}
[0m06:43:01.281435 [info ] [Thread-1  ]: 5 of 8 OK created sql view model final_sales.test .............................. [[32mSUCCESS 1[0m in 0.49s]
[0m06:43:01.282289 [debug] [Thread-1  ]: Finished running node model.development.test
[0m06:43:01.282827 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m06:43:01.283551 [info ] [Thread-1  ]: 6 of 8 START sql incremental model final_sales.fct_payment_details ............. [RUN]
[0m06:43:01.284429 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.test, now model.development.fct_payment_details)
[0m06:43:01.284868 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m06:43:01.295013 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m06:43:01.295987 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 06:43:01.285138 => 06:43:01.295676
[0m06:43:01.296449 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m06:43:01.301383 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:43:01.301919 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
create or replace  temporary view external_db.final_sales.fct_payment_details__dbt_tmp
  
   as (
    

with payments as (
    select * from external_db.final_sales.bronze_payments
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as(
    select 
    payment_id,
    payment_method,
    order_id,
    run_ts

    from payments where status = 'success'
)

select * from final
  );
[0m06:43:01.302338 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:43:01.717516 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:43:01.724548 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:43:01.725227 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details__dbt_tmp
[0m06:43:01.810681 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:43:01.816953 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:43:01.817646 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table external_db.final_sales.fct_payment_details
[0m06:43:01.884349 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:43:01.889555 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:43:01.890161 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_PAYMENT_DETAILS"
[0m06:43:01.960568 [debug] [Thread-1  ]: SQL status: SUCCESS 4 in 0.0 seconds
[0m06:43:01.965085 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_payment_details"
[0m06:43:01.966783 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:43:01.967323 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
-- back compat for old kwarg name
  
  begin;
[0m06:43:02.051434 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:43:02.052327 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:43:02.052839 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
merge into external_db.final_sales.fct_payment_details as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_payment_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.payment_id = DBT_INTERNAL_DEST.payment_id
            )

    
    when matched then update set
        "PAYMENT_ID" = DBT_INTERNAL_SOURCE."PAYMENT_ID","PAYMENT_METHOD" = DBT_INTERNAL_SOURCE."PAYMENT_METHOD","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_TS")
    values
        ("PAYMENT_ID", "PAYMENT_METHOD", "ORDER_ID", "RUN_TS")

;
[0m06:43:02.525232 [debug] [Thread-1  ]: SQL status: SUCCESS 36 in 0.0 seconds
[0m06:43:02.527123 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:43:02.527727 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
COMMIT
[0m06:43:02.726457 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:43:02.731821 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_payment_details"
[0m06:43:02.732462 [debug] [Thread-1  ]: On model.development.fct_payment_details: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_payment_details"} */
drop view if exists external_db.final_sales.fct_payment_details__dbt_tmp cascade
[0m06:43:02.825187 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:43:02.828615 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 06:43:01.296722 => 06:43:02.828355
[0m06:43:02.829106 [debug] [Thread-1  ]: On model.development.fct_payment_details: Close
[0m06:43:02.936571 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb562f1c-eced-49ec-a60c-bc2e03e7477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb15a5730>]}
[0m06:43:02.937653 [info ] [Thread-1  ]: 6 of 8 OK created sql incremental model final_sales.fct_payment_details ........ [[32mSUCCESS 36[0m in 1.65s]
[0m06:43:02.938513 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m06:43:02.939444 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m06:43:02.940411 [info ] [Thread-1  ]: 7 of 8 START sql incremental model final_sales.fct_order_detail ................ [RUN]
[0m06:43:02.941516 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now model.development.fct_order_detail)
[0m06:43:02.941961 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m06:43:02.949024 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m06:43:02.949873 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 06:43:02.942237 => 06:43:02.949594
[0m06:43:02.950498 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m06:43:02.955847 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:43:02.956338 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
create or replace  temporary view external_db.final_sales.fct_order_detail__dbt_tmp
  
   as (
    
with orders as (
    select * from external_db.final_sales.bronze_orders
   
        where run_ts = to_timestamp('2023-06-22')
    
),

products as (
    select * from external_db.final_sales.bronze_products
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as (
     select
        orders.order_id,
        orders.customer_id,
        orders.product_id,
        orders.order_date,
        products.price,
        products.run_ts
    from orders
    left join products using (product_id)
)
select * from final
  );
[0m06:43:02.956768 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:43:03.454822 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:43:03.459163 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:43:03.459927 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail__dbt_tmp
[0m06:43:03.526619 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:43:03.531544 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:43:03.532087 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table external_db.final_sales.fct_order_detail
[0m06:43:03.591980 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:43:03.599818 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:43:03.604054 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."FCT_ORDER_DETAIL"
[0m06:43:03.672026 [debug] [Thread-1  ]: SQL status: SUCCESS 6 in 0.0 seconds
[0m06:43:03.676774 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.fct_order_detail"
[0m06:43:03.679077 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:43:03.679618 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
-- back compat for old kwarg name
  
  begin;
[0m06:43:03.762912 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:43:03.763709 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:43:03.764212 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
merge into external_db.final_sales.fct_order_detail as DBT_INTERNAL_DEST
        using external_db.final_sales.fct_order_detail__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.order_id = DBT_INTERNAL_DEST.order_id
            )

    
    when matched then update set
        "ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","ORDER_DATE" = DBT_INTERNAL_SOURCE."ORDER_DATE","PRICE" = DBT_INTERNAL_SOURCE."PRICE","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_TS")
    values
        ("ORDER_ID", "CUSTOMER_ID", "PRODUCT_ID", "ORDER_DATE", "PRICE", "RUN_TS")

;
[0m06:43:04.421943 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:43:04.422930 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:43:04.423480 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
COMMIT
[0m06:43:04.655965 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:43:04.660494 [debug] [Thread-1  ]: Using snowflake connection "model.development.fct_order_detail"
[0m06:43:04.661082 [debug] [Thread-1  ]: On model.development.fct_order_detail: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.fct_order_detail"} */
drop view if exists external_db.final_sales.fct_order_detail__dbt_tmp cascade
[0m06:43:04.753901 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:43:04.757363 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 06:43:02.950777 => 06:43:04.757097
[0m06:43:04.757868 [debug] [Thread-1  ]: On model.development.fct_order_detail: Close
[0m06:43:04.848964 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb562f1c-eced-49ec-a60c-bc2e03e7477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb0150850>]}
[0m06:43:04.850101 [info ] [Thread-1  ]: 7 of 8 OK created sql incremental model final_sales.fct_order_detail ........... [[32mSUCCESS 50[0m in 1.91s]
[0m06:43:04.851068 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m06:43:04.853375 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m06:43:04.853981 [info ] [Thread-1  ]: 8 of 8 START sql incremental model final_sales.product_sales ................... [RUN]
[0m06:43:04.854875 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now model.development.product_sales)
[0m06:43:04.855336 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m06:43:04.862862 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m06:43:04.863871 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 06:43:04.855613 => 06:43:04.863522
[0m06:43:04.864328 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m06:43:04.869723 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:43:04.870379 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
create or replace  temporary view external_db.final_sales.product_sales__dbt_tmp
  
   as (
    

with order_details as (
    select * from external_db.final_sales.fct_order_detail
    
        where run_ts = to_timestamp('2023-06-22')
    
), 
customer as (
    select * from external_db.final_sales.bronze_customers
    
        where run_ts = to_timestamp('2023-06-22')
    
),
payments as (
    select * from external_db.final_sales.fct_payment_details
    
        where run_ts = to_timestamp('2023-06-22')
    
),

final as (

    select
        order_details.customer_id,
        sum(order_details.price) as order_amount

    from order_details
    left join customer using (customer_id)

    left join payments using (order_id)

    group by 1
)
select * from final
  );
[0m06:43:04.870924 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m06:43:05.259708 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:43:05.264072 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:43:05.264608 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales__dbt_tmp
[0m06:43:05.334298 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:43:05.339057 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:43:05.339667 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table external_db.final_sales.product_sales
[0m06:43:05.420033 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:43:05.425350 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:43:05.425972 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
describe table "EXTERNAL_DB"."FINAL_SALES"."PRODUCT_SALES"
[0m06:43:05.491758 [debug] [Thread-1  ]: SQL status: SUCCESS 2 in 0.0 seconds
[0m06:43:05.496289 [debug] [Thread-1  ]: Writing runtime sql for node "model.development.product_sales"
[0m06:43:05.498005 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:43:05.498480 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
-- back compat for old kwarg name
  
  begin;
[0m06:43:05.581972 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:43:05.582713 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:43:05.583213 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
merge into external_db.final_sales.product_sales as DBT_INTERNAL_DEST
        using external_db.final_sales.product_sales__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.customer_id = DBT_INTERNAL_DEST.customer_id
            )

    
    when matched then update set
        "CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","ORDER_AMOUNT" = DBT_INTERNAL_SOURCE."ORDER_AMOUNT"
    

    when not matched then insert
        ("CUSTOMER_ID", "ORDER_AMOUNT")
    values
        ("CUSTOMER_ID", "ORDER_AMOUNT")

;
[0m06:43:06.269690 [debug] [Thread-1  ]: SQL status: SUCCESS 50 in 1.0 seconds
[0m06:43:06.270693 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:43:06.271220 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
COMMIT
[0m06:43:06.471109 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:43:06.477710 [debug] [Thread-1  ]: Using snowflake connection "model.development.product_sales"
[0m06:43:06.478244 [debug] [Thread-1  ]: On model.development.product_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "node_id": "model.development.product_sales"} */
drop view if exists external_db.final_sales.product_sales__dbt_tmp cascade
[0m06:43:06.565376 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.0 seconds
[0m06:43:06.568813 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 06:43:04.864595 => 06:43:06.568553
[0m06:43:06.569331 [debug] [Thread-1  ]: On model.development.product_sales: Close
[0m06:43:06.677150 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb562f1c-eced-49ec-a60c-bc2e03e7477f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb03ce550>]}
[0m06:43:06.678231 [info ] [Thread-1  ]: 8 of 8 OK created sql incremental model final_sales.product_sales .............. [[32mSUCCESS 50[0m in 1.82s]
[0m06:43:06.679175 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m06:43:06.681285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:43:06.681695 [debug] [MainThread]: Connection 'model.development.product_sales' was properly closed.
[0m06:43:06.682352 [info ] [MainThread]: 
[0m06:43:06.682966 [info ] [MainThread]: Finished running 7 incremental models, 1 view model in 0 hours 0 minutes and 15.02 seconds (15.02s).
[0m06:43:06.686399 [debug] [MainThread]: Command end result
[0m06:43:06.697018 [info ] [MainThread]: 
[0m06:43:06.697651 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:43:06.698086 [info ] [MainThread]: 
[0m06:43:06.698603 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m06:43:06.699575 [debug] [MainThread]: Command `dbt run` succeeded at 06:43:06.699426 after 15.48 seconds
[0m06:43:06.700023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb8439070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb1583a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb03d8a30>]}
[0m06:43:06.700527 [debug] [MainThread]: Flushing usage events
[0m06:43:22.331317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca7970a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37c90a48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37c90a42e0>]}


============================== 06:43:22.334934 | 3c617684-790b-4755-aaf1-eba9972f9768 ==============================
[0m06:43:22.334934 [info ] [MainThread]: Running with dbt=1.5.1
[0m06:43:22.335654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/satyam/dbt_project/dbt/dbt', 'log_path': '/home/satyam/dbt_project/dbt/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m06:43:22.629754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c617684-790b-4755-aaf1-eba9972f9768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37c49288b0>]}
[0m06:43:22.647691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c617684-790b-4755-aaf1-eba9972f9768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37c48fba60>]}
[0m06:43:22.663857 [debug] [MainThread]: checksum: 51f6b581eba8f8101bc020bf9faf8f96af641e2da86d581f66e2bdf0ff384b1c, vars: {}, profile: , target: , version: 1.5.1
[0m06:43:22.690200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:43:22.690779 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:43:22.691836 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 4 unused configuration paths:
- models.development.staging
- models.development.gold
- models.development.bronze
- models.development.silver
[0m06:43:22.699957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c617684-790b-4755-aaf1-eba9972f9768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37c37bc250>]}
[0m06:43:22.712525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c617684-790b-4755-aaf1-eba9972f9768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37c37a2a90>]}
[0m06:43:22.713305 [info ] [MainThread]: Found 8 models, 30 tests, 0 snapshots, 0 analyses, 321 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics, 0 groups
[0m06:43:22.713810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c617684-790b-4755-aaf1-eba9972f9768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37c4894220>]}
[0m06:43:22.716926 [info ] [MainThread]: 
[0m06:43:22.717948 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:43:22.719634 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_external_db_final_sales'
[0m06:43:22.736419 [debug] [ThreadPool]: Using snowflake connection "list_external_db_final_sales"
[0m06:43:22.737131 [debug] [ThreadPool]: On list_external_db_final_sales: /* {"app": "dbt", "dbt_version": "1.5.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_external_db_final_sales"} */
show terse objects in external_db.final_sales
[0m06:43:22.737615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:23.380441 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m06:43:23.385835 [debug] [ThreadPool]: On list_external_db_final_sales: Close
[0m06:43:23.498468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c617684-790b-4755-aaf1-eba9972f9768', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37c498ebb0>]}
[0m06:43:23.499746 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:43:23.500303 [info ] [MainThread]: 
[0m06:43:23.508687 [debug] [Thread-1  ]: Began running node model.development.bronze_customers
[0m06:43:23.509823 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_external_db_final_sales, now model.development.bronze_customers)
[0m06:43:23.510337 [debug] [Thread-1  ]: Began compiling node model.development.bronze_customers
[0m06:43:23.516977 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_customers"
[0m06:43:23.517908 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (compile): 06:43:23.510626 => 06:43:23.517586
[0m06:43:23.518354 [debug] [Thread-1  ]: Began executing node model.development.bronze_customers
[0m06:43:23.518883 [debug] [Thread-1  ]: Timing info for model.development.bronze_customers (execute): 06:43:23.518623 => 06:43:23.518655
[0m06:43:23.520043 [debug] [Thread-1  ]: Finished running node model.development.bronze_customers
[0m06:43:23.520559 [debug] [Thread-1  ]: Began running node model.development.bronze_orders
[0m06:43:23.521509 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_customers, now model.development.bronze_orders)
[0m06:43:23.522106 [debug] [Thread-1  ]: Began compiling node model.development.bronze_orders
[0m06:43:23.526398 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_orders"
[0m06:43:23.527128 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (compile): 06:43:23.522462 => 06:43:23.526874
[0m06:43:23.527558 [debug] [Thread-1  ]: Began executing node model.development.bronze_orders
[0m06:43:23.528055 [debug] [Thread-1  ]: Timing info for model.development.bronze_orders (execute): 06:43:23.527816 => 06:43:23.527831
[0m06:43:23.529020 [debug] [Thread-1  ]: Finished running node model.development.bronze_orders
[0m06:43:23.529499 [debug] [Thread-1  ]: Began running node model.development.bronze_payments
[0m06:43:23.530371 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_orders, now model.development.bronze_payments)
[0m06:43:23.530978 [debug] [Thread-1  ]: Began compiling node model.development.bronze_payments
[0m06:43:23.535307 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_payments"
[0m06:43:23.536059 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (compile): 06:43:23.531354 => 06:43:23.535801
[0m06:43:23.536463 [debug] [Thread-1  ]: Began executing node model.development.bronze_payments
[0m06:43:23.536954 [debug] [Thread-1  ]: Timing info for model.development.bronze_payments (execute): 06:43:23.536720 => 06:43:23.536734
[0m06:43:23.537930 [debug] [Thread-1  ]: Finished running node model.development.bronze_payments
[0m06:43:23.538413 [debug] [Thread-1  ]: Began running node model.development.bronze_products
[0m06:43:23.539255 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_payments, now model.development.bronze_products)
[0m06:43:23.539928 [debug] [Thread-1  ]: Began compiling node model.development.bronze_products
[0m06:43:23.544170 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.bronze_products"
[0m06:43:23.544928 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (compile): 06:43:23.540218 => 06:43:23.544667
[0m06:43:23.545350 [debug] [Thread-1  ]: Began executing node model.development.bronze_products
[0m06:43:23.545850 [debug] [Thread-1  ]: Timing info for model.development.bronze_products (execute): 06:43:23.545613 => 06:43:23.545626
[0m06:43:23.546838 [debug] [Thread-1  ]: Finished running node model.development.bronze_products
[0m06:43:23.547363 [debug] [Thread-1  ]: Began running node model.development.test
[0m06:43:23.548218 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.bronze_products, now model.development.test)
[0m06:43:23.548822 [debug] [Thread-1  ]: Began compiling node model.development.test
[0m06:43:23.552387 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.test"
[0m06:43:23.553145 [debug] [Thread-1  ]: Timing info for model.development.test (compile): 06:43:23.549121 => 06:43:23.552883
[0m06:43:23.553546 [debug] [Thread-1  ]: Began executing node model.development.test
[0m06:43:23.554037 [debug] [Thread-1  ]: Timing info for model.development.test (execute): 06:43:23.553802 => 06:43:23.553816
[0m06:43:23.555031 [debug] [Thread-1  ]: Finished running node model.development.test
[0m06:43:23.555556 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m06:43:23.556354 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.test, now test.development.not_null_bronze_customers_customer_id.254c74eb6e)
[0m06:43:23.556777 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m06:43:23.571810 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_customers_customer_id.254c74eb6e"
[0m06:43:23.572793 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_customer_id.254c74eb6e (compile): 06:43:23.557037 => 06:43:23.572463
[0m06:43:23.573254 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m06:43:23.573766 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_customer_id.254c74eb6e (execute): 06:43:23.573522 => 06:43:23.573542
[0m06:43:23.574783 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_customers_customer_id.254c74eb6e
[0m06:43:23.575303 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_customers_first_name.22deabc315
[0m06:43:23.575978 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_customers_customer_id.254c74eb6e, now test.development.not_null_bronze_customers_first_name.22deabc315)
[0m06:43:23.576544 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_customers_first_name.22deabc315
[0m06:43:23.581628 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_customers_first_name.22deabc315"
[0m06:43:23.582429 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_first_name.22deabc315 (compile): 06:43:23.576813 => 06:43:23.582159
[0m06:43:23.582853 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_customers_first_name.22deabc315
[0m06:43:23.583379 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_customers_first_name.22deabc315 (execute): 06:43:23.583113 => 06:43:23.583129
[0m06:43:23.584362 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_customers_first_name.22deabc315
[0m06:43:23.584855 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m06:43:23.585649 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_customers_first_name.22deabc315, now test.development.unique_bronze_customers_customer_id.f8660c11fe)
[0m06:43:23.586069 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m06:43:23.594668 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_customers_customer_id.f8660c11fe"
[0m06:43:23.595780 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_customers_customer_id.f8660c11fe (compile): 06:43:23.586341 => 06:43:23.595484
[0m06:43:23.596217 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m06:43:23.596727 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_customers_customer_id.f8660c11fe (execute): 06:43:23.596484 => 06:43:23.596500
[0m06:43:23.597744 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_customers_customer_id.f8660c11fe
[0m06:43:23.598266 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m06:43:23.599298 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_customers_customer_id.f8660c11fe, now test.development.not_null_bronze_orders_customer_id.660ce070b4)
[0m06:43:23.599741 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m06:43:23.606260 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_customer_id.660ce070b4"
[0m06:43:23.607089 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_customer_id.660ce070b4 (compile): 06:43:23.600003 => 06:43:23.606806
[0m06:43:23.607542 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m06:43:23.608051 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_customer_id.660ce070b4 (execute): 06:43:23.607810 => 06:43:23.607828
[0m06:43:23.609046 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_customer_id.660ce070b4
[0m06:43:23.609539 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m06:43:23.610319 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_customer_id.660ce070b4, now test.development.not_null_bronze_orders_order_date.d63cfe6df9)
[0m06:43:23.610734 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m06:43:23.615816 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_order_date.d63cfe6df9"
[0m06:43:23.616571 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_date.d63cfe6df9 (compile): 06:43:23.610987 => 06:43:23.616309
[0m06:43:23.616980 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m06:43:23.617479 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_date.d63cfe6df9 (execute): 06:43:23.617241 => 06:43:23.617255
[0m06:43:23.618427 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_order_date.d63cfe6df9
[0m06:43:23.618911 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m06:43:23.619681 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_order_date.d63cfe6df9, now test.development.not_null_bronze_orders_order_id.24f68d0dd3)
[0m06:43:23.620100 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m06:43:23.625101 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_order_id.24f68d0dd3"
[0m06:43:23.625883 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_id.24f68d0dd3 (compile): 06:43:23.620351 => 06:43:23.625619
[0m06:43:23.626297 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m06:43:23.626799 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_order_id.24f68d0dd3 (execute): 06:43:23.626562 => 06:43:23.626576
[0m06:43:23.627812 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_order_id.24f68d0dd3
[0m06:43:23.628297 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_orders_product_id.354934acfc
[0m06:43:23.629072 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_order_id.24f68d0dd3, now test.development.not_null_bronze_orders_product_id.354934acfc)
[0m06:43:23.629486 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_orders_product_id.354934acfc
[0m06:43:23.634544 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_orders_product_id.354934acfc"
[0m06:43:23.635357 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_product_id.354934acfc (compile): 06:43:23.629749 => 06:43:23.635059
[0m06:43:23.635773 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_orders_product_id.354934acfc
[0m06:43:23.636276 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_orders_product_id.354934acfc (execute): 06:43:23.636037 => 06:43:23.636052
[0m06:43:23.637260 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_orders_product_id.354934acfc
[0m06:43:23.637749 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m06:43:23.638537 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_orders_product_id.354934acfc, now test.development.unique_bronze_orders_order_id.eec6e86d13)
[0m06:43:23.638963 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m06:43:23.644361 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_orders_order_id.eec6e86d13"
[0m06:43:23.645110 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_orders_order_id.eec6e86d13 (compile): 06:43:23.639219 => 06:43:23.644854
[0m06:43:23.645512 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m06:43:23.646009 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_orders_order_id.eec6e86d13 (execute): 06:43:23.645774 => 06:43:23.645789
[0m06:43:23.646958 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_orders_order_id.eec6e86d13
[0m06:43:23.647480 [debug] [Thread-1  ]: Began running node model.development.fct_payment_details
[0m06:43:23.648245 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_orders_order_id.eec6e86d13, now model.development.fct_payment_details)
[0m06:43:23.648659 [debug] [Thread-1  ]: Began compiling node model.development.fct_payment_details
[0m06:43:23.659252 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_payment_details"
[0m06:43:23.660118 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (compile): 06:43:23.648914 => 06:43:23.659839
[0m06:43:23.660540 [debug] [Thread-1  ]: Began executing node model.development.fct_payment_details
[0m06:43:23.661040 [debug] [Thread-1  ]: Timing info for model.development.fct_payment_details (execute): 06:43:23.660800 => 06:43:23.660818
[0m06:43:23.662020 [debug] [Thread-1  ]: Finished running node model.development.fct_payment_details
[0m06:43:23.662526 [debug] [Thread-1  ]: Began running node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m06:43:23.663377 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_payment_details, now test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8)
[0m06:43:23.663958 [debug] [Thread-1  ]: Began compiling node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m06:43:23.675735 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8"
[0m06:43:23.676758 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8 (compile): 06:43:23.664250 => 06:43:23.676414
[0m06:43:23.677232 [debug] [Thread-1  ]: Began executing node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m06:43:23.677751 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8 (execute): 06:43:23.677502 => 06:43:23.677519
[0m06:43:23.678769 [debug] [Thread-1  ]: Finished running node test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8
[0m06:43:23.679313 [debug] [Thread-1  ]: Began running node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m06:43:23.680142 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.accepted_values_bronze_payments_payment_method__debit__credit__upi__cash.7f876a38c8, now test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f)
[0m06:43:23.680575 [debug] [Thread-1  ]: Began compiling node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m06:43:23.686507 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f"
[0m06:43:23.687294 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f (compile): 06:43:23.680834 => 06:43:23.687011
[0m06:43:23.687709 [debug] [Thread-1  ]: Began executing node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m06:43:23.688209 [debug] [Thread-1  ]: Timing info for test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f (execute): 06:43:23.687972 => 06:43:23.687986
[0m06:43:23.689179 [debug] [Thread-1  ]: Finished running node test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f
[0m06:43:23.689667 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m06:43:23.690450 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.accepted_values_bronze_payments_status__fail__success.54d54e4a1f, now test.development.not_null_bronze_payments_order_id.50ed7cbd9a)
[0m06:43:23.690871 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m06:43:23.695963 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_order_id.50ed7cbd9a"
[0m06:43:23.696746 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_order_id.50ed7cbd9a (compile): 06:43:23.691125 => 06:43:23.696474
[0m06:43:23.697155 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m06:43:23.697655 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_order_id.50ed7cbd9a (execute): 06:43:23.697416 => 06:43:23.697433
[0m06:43:23.698621 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_order_id.50ed7cbd9a
[0m06:43:23.699107 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m06:43:23.699913 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_order_id.50ed7cbd9a, now test.development.not_null_bronze_payments_payment_id.3473ab0f1f)
[0m06:43:23.700332 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m06:43:23.788497 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_payment_id.3473ab0f1f"
[0m06:43:23.789600 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_id.3473ab0f1f (compile): 06:43:23.700587 => 06:43:23.789242
[0m06:43:23.790082 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m06:43:23.790591 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_id.3473ab0f1f (execute): 06:43:23.790349 => 06:43:23.790367
[0m06:43:23.791699 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_payment_id.3473ab0f1f
[0m06:43:23.792198 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m06:43:23.793062 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_payment_id.3473ab0f1f, now test.development.not_null_bronze_payments_payment_method.e5fe6e820b)
[0m06:43:23.793489 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m06:43:23.798864 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_payment_method.e5fe6e820b"
[0m06:43:23.799691 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_method.e5fe6e820b (compile): 06:43:23.793748 => 06:43:23.799412
[0m06:43:23.800110 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m06:43:23.800617 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_payment_method.e5fe6e820b (execute): 06:43:23.800371 => 06:43:23.800387
[0m06:43:23.801606 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_payment_method.e5fe6e820b
[0m06:43:23.802100 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_payments_status.4258d38f0c
[0m06:43:23.802899 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_payment_method.e5fe6e820b, now test.development.not_null_bronze_payments_status.4258d38f0c)
[0m06:43:23.803342 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_payments_status.4258d38f0c
[0m06:43:23.808737 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_payments_status.4258d38f0c"
[0m06:43:23.809528 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_status.4258d38f0c (compile): 06:43:23.803610 => 06:43:23.809260
[0m06:43:23.809951 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_payments_status.4258d38f0c
[0m06:43:23.810451 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_payments_status.4258d38f0c (execute): 06:43:23.810214 => 06:43:23.810229
[0m06:43:23.811458 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_payments_status.4258d38f0c
[0m06:43:23.811955 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_payments_payment_id.537151412e
[0m06:43:23.812737 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_payments_status.4258d38f0c, now test.development.unique_bronze_payments_payment_id.537151412e)
[0m06:43:23.813157 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_payments_payment_id.537151412e
[0m06:43:23.818433 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_payments_payment_id.537151412e"
[0m06:43:23.819243 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_payments_payment_id.537151412e (compile): 06:43:23.813418 => 06:43:23.818971
[0m06:43:23.819702 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_payments_payment_id.537151412e
[0m06:43:23.820213 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_payments_payment_id.537151412e (execute): 06:43:23.819970 => 06:43:23.819987
[0m06:43:23.821190 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_payments_payment_id.537151412e
[0m06:43:23.821695 [debug] [Thread-1  ]: Began running node model.development.fct_order_detail
[0m06:43:23.822463 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_payments_payment_id.537151412e, now model.development.fct_order_detail)
[0m06:43:23.822877 [debug] [Thread-1  ]: Began compiling node model.development.fct_order_detail
[0m06:43:23.829289 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.fct_order_detail"
[0m06:43:23.830139 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (compile): 06:43:23.823130 => 06:43:23.829852
[0m06:43:23.830568 [debug] [Thread-1  ]: Began executing node model.development.fct_order_detail
[0m06:43:23.831074 [debug] [Thread-1  ]: Timing info for model.development.fct_order_detail (execute): 06:43:23.830834 => 06:43:23.830850
[0m06:43:23.832112 [debug] [Thread-1  ]: Finished running node model.development.fct_order_detail
[0m06:43:23.832625 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_products_price.e208481306
[0m06:43:23.833506 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.fct_order_detail, now test.development.not_null_bronze_products_price.e208481306)
[0m06:43:23.834140 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_products_price.e208481306
[0m06:43:23.839741 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_products_price.e208481306"
[0m06:43:23.840708 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_price.e208481306 (compile): 06:43:23.834428 => 06:43:23.840406
[0m06:43:23.841154 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_products_price.e208481306
[0m06:43:23.841670 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_price.e208481306 (execute): 06:43:23.841425 => 06:43:23.841443
[0m06:43:23.842684 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_products_price.e208481306
[0m06:43:23.843181 [debug] [Thread-1  ]: Began running node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m06:43:23.844017 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_products_price.e208481306, now test.development.not_null_bronze_products_product_id.0e447b9d33)
[0m06:43:23.844435 [debug] [Thread-1  ]: Began compiling node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m06:43:23.849566 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_bronze_products_product_id.0e447b9d33"
[0m06:43:23.850389 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_product_id.0e447b9d33 (compile): 06:43:23.844689 => 06:43:23.850112
[0m06:43:23.850811 [debug] [Thread-1  ]: Began executing node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m06:43:23.851335 [debug] [Thread-1  ]: Timing info for test.development.not_null_bronze_products_product_id.0e447b9d33 (execute): 06:43:23.851072 => 06:43:23.851088
[0m06:43:23.852334 [debug] [Thread-1  ]: Finished running node test.development.not_null_bronze_products_product_id.0e447b9d33
[0m06:43:23.852843 [debug] [Thread-1  ]: Began running node test.development.products_price_lower_than_threshold
[0m06:43:23.853638 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_bronze_products_product_id.0e447b9d33, now test.development.products_price_lower_than_threshold)
[0m06:43:23.854057 [debug] [Thread-1  ]: Began compiling node test.development.products_price_lower_than_threshold
[0m06:43:23.857542 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.products_price_lower_than_threshold"
[0m06:43:23.858319 [debug] [Thread-1  ]: Timing info for test.development.products_price_lower_than_threshold (compile): 06:43:23.854314 => 06:43:23.858055
[0m06:43:23.858731 [debug] [Thread-1  ]: Began executing node test.development.products_price_lower_than_threshold
[0m06:43:23.859231 [debug] [Thread-1  ]: Timing info for test.development.products_price_lower_than_threshold (execute): 06:43:23.858992 => 06:43:23.859006
[0m06:43:23.860259 [debug] [Thread-1  ]: Finished running node test.development.products_price_lower_than_threshold
[0m06:43:23.860758 [debug] [Thread-1  ]: Began running node test.development.unique_bronze_products_product_id.c17035ba1c
[0m06:43:23.861582 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.products_price_lower_than_threshold, now test.development.unique_bronze_products_product_id.c17035ba1c)
[0m06:43:23.862010 [debug] [Thread-1  ]: Began compiling node test.development.unique_bronze_products_product_id.c17035ba1c
[0m06:43:23.867730 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_bronze_products_product_id.c17035ba1c"
[0m06:43:23.868599 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_products_product_id.c17035ba1c (compile): 06:43:23.862268 => 06:43:23.868306
[0m06:43:23.869030 [debug] [Thread-1  ]: Began executing node test.development.unique_bronze_products_product_id.c17035ba1c
[0m06:43:23.869532 [debug] [Thread-1  ]: Timing info for test.development.unique_bronze_products_product_id.c17035ba1c (execute): 06:43:23.869294 => 06:43:23.869310
[0m06:43:23.870556 [debug] [Thread-1  ]: Finished running node test.development.unique_bronze_products_product_id.c17035ba1c
[0m06:43:23.871065 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m06:43:23.871911 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_bronze_products_product_id.c17035ba1c, now test.development.not_null_fct_payment_details_order_id.7bb58db616)
[0m06:43:23.872336 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m06:43:23.879408 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_payment_details_order_id.7bb58db616"
[0m06:43:23.880328 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_order_id.7bb58db616 (compile): 06:43:23.872598 => 06:43:23.880011
[0m06:43:23.880778 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m06:43:23.881290 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_order_id.7bb58db616 (execute): 06:43:23.881046 => 06:43:23.881066
[0m06:43:23.882301 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_order_id.7bb58db616
[0m06:43:23.882778 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m06:43:23.883442 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_payment_details_order_id.7bb58db616, now test.development.not_null_fct_payment_details_payment_id.d55bc575d7)
[0m06:43:23.883850 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m06:43:23.889176 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_payment_details_payment_id.d55bc575d7"
[0m06:43:23.889950 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_id.d55bc575d7 (compile): 06:43:23.884241 => 06:43:23.889689
[0m06:43:23.890361 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m06:43:23.890864 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_id.d55bc575d7 (execute): 06:43:23.890624 => 06:43:23.890641
[0m06:43:23.891859 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_payment_id.d55bc575d7
[0m06:43:23.892338 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m06:43:23.893109 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_payment_details_payment_id.d55bc575d7, now test.development.not_null_fct_payment_details_payment_method.62d221c77e)
[0m06:43:23.893526 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m06:43:23.898743 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_payment_details_payment_method.62d221c77e"
[0m06:43:23.899560 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_method.62d221c77e (compile): 06:43:23.893782 => 06:43:23.899285
[0m06:43:23.899975 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m06:43:23.900482 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_payment_details_payment_method.62d221c77e (execute): 06:43:23.900237 => 06:43:23.900252
[0m06:43:23.901448 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_payment_details_payment_method.62d221c77e
[0m06:43:23.901943 [debug] [Thread-1  ]: Began running node model.development.product_sales
[0m06:43:23.902714 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_payment_details_payment_method.62d221c77e, now model.development.product_sales)
[0m06:43:23.903128 [debug] [Thread-1  ]: Began compiling node model.development.product_sales
[0m06:43:23.909768 [debug] [Thread-1  ]: Writing injected SQL for node "model.development.product_sales"
[0m06:43:23.910594 [debug] [Thread-1  ]: Timing info for model.development.product_sales (compile): 06:43:23.903407 => 06:43:23.910308
[0m06:43:23.911009 [debug] [Thread-1  ]: Began executing node model.development.product_sales
[0m06:43:23.911541 [debug] [Thread-1  ]: Timing info for model.development.product_sales (execute): 06:43:23.911293 => 06:43:23.911309
[0m06:43:23.912526 [debug] [Thread-1  ]: Finished running node model.development.product_sales
[0m06:43:23.913031 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m06:43:23.913864 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.development.product_sales, now test.development.not_null_fct_order_detail_customer_id.44d928392b)
[0m06:43:23.914428 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m06:43:23.919685 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_customer_id.44d928392b"
[0m06:43:23.920482 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_customer_id.44d928392b (compile): 06:43:23.914726 => 06:43:23.920219
[0m06:43:23.920906 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m06:43:23.921408 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_customer_id.44d928392b (execute): 06:43:23.921169 => 06:43:23.921184
[0m06:43:23.922384 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_customer_id.44d928392b
[0m06:43:23.922873 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m06:43:23.923671 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_customer_id.44d928392b, now test.development.not_null_fct_order_detail_order_date.c6f89a052d)
[0m06:43:23.924093 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m06:43:23.929341 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_order_date.c6f89a052d"
[0m06:43:23.930118 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_date.c6f89a052d (compile): 06:43:23.924352 => 06:43:23.929855
[0m06:43:23.930527 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m06:43:23.931025 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_date.c6f89a052d (execute): 06:43:23.930788 => 06:43:23.930802
[0m06:43:23.932009 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_order_date.c6f89a052d
[0m06:43:23.932494 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m06:43:23.933258 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_order_date.c6f89a052d, now test.development.not_null_fct_order_detail_order_id.47ace119a7)
[0m06:43:23.933678 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m06:43:23.938680 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_order_id.47ace119a7"
[0m06:43:23.939503 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_id.47ace119a7 (compile): 06:43:23.933933 => 06:43:23.939209
[0m06:43:23.939920 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m06:43:23.940421 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_order_id.47ace119a7 (execute): 06:43:23.940180 => 06:43:23.940197
[0m06:43:23.941404 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_order_id.47ace119a7
[0m06:43:23.941888 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m06:43:23.942529 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_order_id.47ace119a7, now test.development.not_null_fct_order_detail_price.c149ee0e5c)
[0m06:43:23.943083 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m06:43:23.948230 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_price.c149ee0e5c"
[0m06:43:23.949011 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_price.c149ee0e5c (compile): 06:43:23.943367 => 06:43:23.948748
[0m06:43:23.949422 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m06:43:23.949928 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_price.c149ee0e5c (execute): 06:43:23.949686 => 06:43:23.949702
[0m06:43:23.950903 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_price.c149ee0e5c
[0m06:43:23.951420 [debug] [Thread-1  ]: Began running node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m06:43:23.952197 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_price.c149ee0e5c, now test.development.not_null_fct_order_detail_product_id.73135971e6)
[0m06:43:23.952613 [debug] [Thread-1  ]: Began compiling node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m06:43:23.957897 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_fct_order_detail_product_id.73135971e6"
[0m06:43:23.958656 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_product_id.73135971e6 (compile): 06:43:23.952870 => 06:43:23.958392
[0m06:43:23.959072 [debug] [Thread-1  ]: Began executing node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m06:43:23.959600 [debug] [Thread-1  ]: Timing info for test.development.not_null_fct_order_detail_product_id.73135971e6 (execute): 06:43:23.959357 => 06:43:23.959372
[0m06:43:23.960571 [debug] [Thread-1  ]: Finished running node test.development.not_null_fct_order_detail_product_id.73135971e6
[0m06:43:23.961061 [debug] [Thread-1  ]: Began running node test.development.unique_fct_order_detail_order_id.256da980ed
[0m06:43:23.961833 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_fct_order_detail_product_id.73135971e6, now test.development.unique_fct_order_detail_order_id.256da980ed)
[0m06:43:23.962252 [debug] [Thread-1  ]: Began compiling node test.development.unique_fct_order_detail_order_id.256da980ed
[0m06:43:23.969422 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.unique_fct_order_detail_order_id.256da980ed"
[0m06:43:23.970355 [debug] [Thread-1  ]: Timing info for test.development.unique_fct_order_detail_order_id.256da980ed (compile): 06:43:23.962518 => 06:43:23.970044
[0m06:43:23.970793 [debug] [Thread-1  ]: Began executing node test.development.unique_fct_order_detail_order_id.256da980ed
[0m06:43:23.971336 [debug] [Thread-1  ]: Timing info for test.development.unique_fct_order_detail_order_id.256da980ed (execute): 06:43:23.971063 => 06:43:23.971079
[0m06:43:23.972358 [debug] [Thread-1  ]: Finished running node test.development.unique_fct_order_detail_order_id.256da980ed
[0m06:43:23.972852 [debug] [Thread-1  ]: Began running node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m06:43:23.973657 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.unique_fct_order_detail_order_id.256da980ed, now test.development.not_null_product_sales_customer_id.acc9e6dd8e)
[0m06:43:23.974078 [debug] [Thread-1  ]: Began compiling node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m06:43:23.979498 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_product_sales_customer_id.acc9e6dd8e"
[0m06:43:23.980375 [debug] [Thread-1  ]: Timing info for test.development.not_null_product_sales_customer_id.acc9e6dd8e (compile): 06:43:23.974337 => 06:43:23.980086
[0m06:43:23.980811 [debug] [Thread-1  ]: Began executing node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m06:43:23.981329 [debug] [Thread-1  ]: Timing info for test.development.not_null_product_sales_customer_id.acc9e6dd8e (execute): 06:43:23.981080 => 06:43:23.981097
[0m06:43:23.982332 [debug] [Thread-1  ]: Finished running node test.development.not_null_product_sales_customer_id.acc9e6dd8e
[0m06:43:23.982828 [debug] [Thread-1  ]: Began running node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m06:43:23.983669 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.development.not_null_product_sales_customer_id.acc9e6dd8e, now test.development.not_null_product_sales_order_amount.b9ffa2ea2b)
[0m06:43:23.984098 [debug] [Thread-1  ]: Began compiling node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m06:43:23.989326 [debug] [Thread-1  ]: Writing injected SQL for node "test.development.not_null_product_sales_order_amount.b9ffa2ea2b"
[0m06:43:23.990117 [debug] [Thread-1  ]: Timing info for test.development.not_null_product_sales_order_amount.b9ffa2ea2b (compile): 06:43:23.984358 => 06:43:23.989849
[0m06:43:23.990527 [debug] [Thread-1  ]: Began executing node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m06:43:23.991024 [debug] [Thread-1  ]: Timing info for test.development.not_null_product_sales_order_amount.b9ffa2ea2b (execute): 06:43:23.990788 => 06:43:23.990804
[0m06:43:23.992015 [debug] [Thread-1  ]: Finished running node test.development.not_null_product_sales_order_amount.b9ffa2ea2b
[0m06:43:23.993172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:43:23.993527 [debug] [MainThread]: Connection 'test.development.not_null_product_sales_order_amount.b9ffa2ea2b' was properly closed.
[0m06:43:23.999719 [debug] [MainThread]: Command end result
[0m06:43:24.011214 [debug] [MainThread]: Command `dbt compile` succeeded at 06:43:24.010952 after 1.70 seconds
[0m06:43:24.011858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37ca7970a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37c49288b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37c4894130>]}
[0m06:43:24.012346 [debug] [MainThread]: Flushing usage events
