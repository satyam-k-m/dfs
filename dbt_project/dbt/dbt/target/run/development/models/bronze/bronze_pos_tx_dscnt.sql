-- back compat for old kwarg name
  
  begin;
    
        
            
            
        
    

    

    merge into insight_dev.INS_BKP.bronze_pos_tx_dscnt as DBT_INTERNAL_DEST
        using insight_dev.INS_BKP.bronze_pos_tx_dscnt__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.surr_key = DBT_INTERNAL_DEST.surr_key
            )

    
    when matched then update set
        "DSCNT_LINE_NBR" = DBT_INTERNAL_SOURCE."DSCNT_LINE_NBR","SALE_LINE_NBR" = DBT_INTERNAL_SOURCE."SALE_LINE_NBR","TX_NBR" = DBT_INTERNAL_SOURCE."TX_NBR","POS_LOC_ID" = DBT_INTERNAL_SOURCE."POS_LOC_ID","TERM_NBR" = DBT_INTERNAL_SOURCE."TERM_NBR","DIV_NBR" = DBT_INTERNAL_SOURCE."DIV_NBR","BIZ_DT" = DBT_INTERNAL_SOURCE."BIZ_DT","ADJ_FLG" = DBT_INTERNAL_SOURCE."ADJ_FLG","STORE_ID" = DBT_INTERNAL_SOURCE."STORE_ID","DSCNT_ID_NBR" = DBT_INTERNAL_SOURCE."DSCNT_ID_NBR","DIV_DSCNT_CD" = DBT_INTERNAL_SOURCE."DIV_DSCNT_CD","DIV_DSCNT_TYPE" = DBT_INTERNAL_SOURCE."DIV_DSCNT_TYPE","MERCH_DSCNT_CD" = DBT_INTERNAL_SOURCE."MERCH_DSCNT_CD","LOCAL_DSCNT_AMT" = DBT_INTERNAL_SOURCE."LOCAL_DSCNT_AMT","HOST_DSCNT_AMT" = DBT_INTERNAL_SOURCE."HOST_DSCNT_AMT","DSCNT_PERCENT" = DBT_INTERNAL_SOURCE."DSCNT_PERCENT","RTL_DSCNT_EMBED_TAX" = DBT_INTERNAL_SOURCE."RTL_DSCNT_EMBED_TAX","COUP_CD" = DBT_INTERNAL_SOURCE."COUP_CD","COUP_NBR" = DBT_INTERNAL_SOURCE."COUP_NBR","DSCNT_REAS_CD" = DBT_INTERNAL_SOURCE."DSCNT_REAS_CD","RCPT_SEQ_NBR" = DBT_INTERNAL_SOURCE."RCPT_SEQ_NBR","DIVISION" = DBT_INTERNAL_SOURCE."DIVISION","RUN_DT" = DBT_INTERNAL_SOURCE."RUN_DT","SURR_KEY" = DBT_INTERNAL_SOURCE."SURR_KEY","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("DSCNT_LINE_NBR", "SALE_LINE_NBR", "TX_NBR", "POS_LOC_ID", "TERM_NBR", "DIV_NBR", "BIZ_DT", "ADJ_FLG", "STORE_ID", "DSCNT_ID_NBR", "DIV_DSCNT_CD", "DIV_DSCNT_TYPE", "MERCH_DSCNT_CD", "LOCAL_DSCNT_AMT", "HOST_DSCNT_AMT", "DSCNT_PERCENT", "RTL_DSCNT_EMBED_TAX", "COUP_CD", "COUP_NBR", "DSCNT_REAS_CD", "RCPT_SEQ_NBR", "DIVISION", "RUN_DT", "SURR_KEY", "RUN_TS")
    values
        ("DSCNT_LINE_NBR", "SALE_LINE_NBR", "TX_NBR", "POS_LOC_ID", "TERM_NBR", "DIV_NBR", "BIZ_DT", "ADJ_FLG", "STORE_ID", "DSCNT_ID_NBR", "DIV_DSCNT_CD", "DIV_DSCNT_TYPE", "MERCH_DSCNT_CD", "LOCAL_DSCNT_AMT", "HOST_DSCNT_AMT", "DSCNT_PERCENT", "RTL_DSCNT_EMBED_TAX", "COUP_CD", "COUP_NBR", "DSCNT_REAS_CD", "RCPT_SEQ_NBR", "DIVISION", "RUN_DT", "SURR_KEY", "RUN_TS")

;
    commit;