-- back compat for old kwarg name
  
  begin;
    
        
            
            
        
    

    

    merge into DFS_POC_DB.P_DATA.bronze_pos_tx_line as DBT_INTERNAL_DEST
        using DFS_POC_DB.P_DATA.bronze_pos_tx_line__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.surr_key = DBT_INTERNAL_DEST.surr_key
            )

    
    when matched then update set
        "SALE_LINE_NBR" = DBT_INTERNAL_SOURCE."SALE_LINE_NBR","PROCESS_DT" = DBT_INTERNAL_SOURCE."PROCESS_DT","DIVISON_NUMBER" = DBT_INTERNAL_SOURCE."DIVISON_NUMBER","TX_NBR" = DBT_INTERNAL_SOURCE."TX_NBR","DIV_NBR" = DBT_INTERNAL_SOURCE."DIV_NBR","POS_LOC_ID" = DBT_INTERNAL_SOURCE."POS_LOC_ID","TERM_NBR" = DBT_INTERNAL_SOURCE."TERM_NBR","BIZ_DT" = DBT_INTERNAL_SOURCE."BIZ_DT","ADJ_FLG" = DBT_INTERNAL_SOURCE."ADJ_FLG","STORE_ID" = DBT_INTERNAL_SOURCE."STORE_ID","PROMO_CD" = DBT_INTERNAL_SOURCE."PROMO_CD","DSKU_ID" = DBT_INTERNAL_SOURCE."DSKU_ID","CSKU_ID" = DBT_INTERNAL_SOURCE."CSKU_ID","LINE_GRP_NBR" = DBT_INTERNAL_SOURCE."LINE_GRP_NBR","PREORD_FLG" = DBT_INTERNAL_SOURCE."PREORD_FLG","INV_RLS_LOC" = DBT_INTERNAL_SOURCE."INV_RLS_LOC","UNIT_PRICE" = DBT_INTERNAL_SOURCE."UNIT_PRICE","ITEM_QTY" = DBT_INTERNAL_SOURCE."ITEM_QTY","EXT_RTL" = DBT_INTERNAL_SOURCE."EXT_RTL","PRICE_OVERRIDE" = DBT_INTERNAL_SOURCE."PRICE_OVERRIDE","ORIG_PRICE" = DBT_INTERNAL_SOURCE."ORIG_PRICE","POST_TO_MCS" = DBT_INTERNAL_SOURCE."POST_TO_MCS","DUTY_TYPE" = DBT_INTERNAL_SOURCE."DUTY_TYPE","TAX_FLG_1" = DBT_INTERNAL_SOURCE."TAX_FLG_1","TAX_FLG_2" = DBT_INTERNAL_SOURCE."TAX_FLG_2","TAX_FLG_3" = DBT_INTERNAL_SOURCE."TAX_FLG_3","TAX_FLG_4" = DBT_INTERNAL_SOURCE."TAX_FLG_4","LOCAL_TAX_1" = DBT_INTERNAL_SOURCE."LOCAL_TAX_1","LOCAL_TAX_2" = DBT_INTERNAL_SOURCE."LOCAL_TAX_2","LOCAL_TAX_3" = DBT_INTERNAL_SOURCE."LOCAL_TAX_3","LOCAL_TAX_4" = DBT_INTERNAL_SOURCE."LOCAL_TAX_4","RTL_EMBED_TAX" = DBT_INTERNAL_SOURCE."RTL_EMBED_TAX","RTL_EMBED_TAX_RATE" = DBT_INTERNAL_SOURCE."RTL_EMBED_TAX_RATE","LOCAL_NET_AMT" = DBT_INTERNAL_SOURCE."LOCAL_NET_AMT","HOST_NET_AMT" = DBT_INTERNAL_SOURCE."HOST_NET_AMT","HOST_TAX_1" = DBT_INTERNAL_SOURCE."HOST_TAX_1","HOST_TAX_2" = DBT_INTERNAL_SOURCE."HOST_TAX_2","HOST_TAX_3" = DBT_INTERNAL_SOURCE."HOST_TAX_3","HOST_TAX_4" = DBT_INTERNAL_SOURCE."HOST_TAX_4","SA_ID" = DBT_INTERNAL_SOURCE."SA_ID","COUP_CD" = DBT_INTERNAL_SOURCE."COUP_CD","COUP_NBR" = DBT_INTERNAL_SOURCE."COUP_NBR","ORIG_SA_ID" = DBT_INTERNAL_SOURCE."ORIG_SA_ID","RCPT_SEQ_NBR" = DBT_INTERNAL_SOURCE."RCPT_SEQ_NBR","ENT_DATA" = DBT_INTERNAL_SOURCE."ENT_DATA","DIV_DATA_1" = DBT_INTERNAL_SOURCE."DIV_DATA_1","DIV_DATA_2" = DBT_INTERNAL_SOURCE."DIV_DATA_2","PLU_LOC_NBR" = DBT_INTERNAL_SOURCE."PLU_LOC_NBR","NOT_AUTH_FLG" = DBT_INTERNAL_SOURCE."NOT_AUTH_FLG","ITEM_PICK_TYPE" = DBT_INTERNAL_SOURCE."ITEM_PICK_TYPE","HOST_CURR_UNIT_PRICE" = DBT_INTERNAL_SOURCE."HOST_CURR_UNIT_PRICE","HOST_CURR_EXT_PRICE" = DBT_INTERNAL_SOURCE."HOST_CURR_EXT_PRICE","DUTY_PAY_AMT" = DBT_INTERNAL_SOURCE."DUTY_PAY_AMT","IGATE_REFERENCE" = DBT_INTERNAL_SOURCE."IGATE_REFERENCE","DIVISION" = DBT_INTERNAL_SOURCE."DIVISION","RUN_DT" = DBT_INTERNAL_SOURCE."RUN_DT","SURR_KEY" = DBT_INTERNAL_SOURCE."SURR_KEY","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("SALE_LINE_NBR", "PROCESS_DT", "DIVISON_NUMBER", "TX_NBR", "DIV_NBR", "POS_LOC_ID", "TERM_NBR", "BIZ_DT", "ADJ_FLG", "STORE_ID", "PROMO_CD", "DSKU_ID", "CSKU_ID", "LINE_GRP_NBR", "PREORD_FLG", "INV_RLS_LOC", "UNIT_PRICE", "ITEM_QTY", "EXT_RTL", "PRICE_OVERRIDE", "ORIG_PRICE", "POST_TO_MCS", "DUTY_TYPE", "TAX_FLG_1", "TAX_FLG_2", "TAX_FLG_3", "TAX_FLG_4", "LOCAL_TAX_1", "LOCAL_TAX_2", "LOCAL_TAX_3", "LOCAL_TAX_4", "RTL_EMBED_TAX", "RTL_EMBED_TAX_RATE", "LOCAL_NET_AMT", "HOST_NET_AMT", "HOST_TAX_1", "HOST_TAX_2", "HOST_TAX_3", "HOST_TAX_4", "SA_ID", "COUP_CD", "COUP_NBR", "ORIG_SA_ID", "RCPT_SEQ_NBR", "ENT_DATA", "DIV_DATA_1", "DIV_DATA_2", "PLU_LOC_NBR", "NOT_AUTH_FLG", "ITEM_PICK_TYPE", "HOST_CURR_UNIT_PRICE", "HOST_CURR_EXT_PRICE", "DUTY_PAY_AMT", "IGATE_REFERENCE", "DIVISION", "RUN_DT", "SURR_KEY", "RUN_TS")
    values
        ("SALE_LINE_NBR", "PROCESS_DT", "DIVISON_NUMBER", "TX_NBR", "DIV_NBR", "POS_LOC_ID", "TERM_NBR", "BIZ_DT", "ADJ_FLG", "STORE_ID", "PROMO_CD", "DSKU_ID", "CSKU_ID", "LINE_GRP_NBR", "PREORD_FLG", "INV_RLS_LOC", "UNIT_PRICE", "ITEM_QTY", "EXT_RTL", "PRICE_OVERRIDE", "ORIG_PRICE", "POST_TO_MCS", "DUTY_TYPE", "TAX_FLG_1", "TAX_FLG_2", "TAX_FLG_3", "TAX_FLG_4", "LOCAL_TAX_1", "LOCAL_TAX_2", "LOCAL_TAX_3", "LOCAL_TAX_4", "RTL_EMBED_TAX", "RTL_EMBED_TAX_RATE", "LOCAL_NET_AMT", "HOST_NET_AMT", "HOST_TAX_1", "HOST_TAX_2", "HOST_TAX_3", "HOST_TAX_4", "SA_ID", "COUP_CD", "COUP_NBR", "ORIG_SA_ID", "RCPT_SEQ_NBR", "ENT_DATA", "DIV_DATA_1", "DIV_DATA_2", "PLU_LOC_NBR", "NOT_AUTH_FLG", "ITEM_PICK_TYPE", "HOST_CURR_UNIT_PRICE", "HOST_CURR_EXT_PRICE", "DUTY_PAY_AMT", "IGATE_REFERENCE", "DIVISION", "RUN_DT", "SURR_KEY", "RUN_TS")

;
    commit;