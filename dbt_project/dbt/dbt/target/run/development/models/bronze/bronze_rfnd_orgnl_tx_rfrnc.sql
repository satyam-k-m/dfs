-- back compat for old kwarg name
  
  begin;
    
        
            
            
        
    

    

    merge into DFS_POC_DB.P_DATA.bronze_rfnd_orgnl_tx_rfrnc as DBT_INTERNAL_DEST
        using DFS_POC_DB.P_DATA.bronze_rfnd_orgnl_tx_rfrnc__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.surr_key = DBT_INTERNAL_DEST.surr_key
            )

    
    when matched then update set
        "ORIG_TX_NBR" = DBT_INTERNAL_SOURCE."ORIG_TX_NBR","ORIG_TERM_NBR" = DBT_INTERNAL_SOURCE."ORIG_TERM_NBR","ORIG_DIV_NBR" = DBT_INTERNAL_SOURCE."ORIG_DIV_NBR","ORIG_POS_LOC_ID" = DBT_INTERNAL_SOURCE."ORIG_POS_LOC_ID","ORIG_BIZ_DT" = DBT_INTERNAL_SOURCE."ORIG_BIZ_DT","ORIG_ADJ_FLG" = DBT_INTERNAL_SOURCE."ORIG_ADJ_FLG","ORIG_TX_DT" = DBT_INTERNAL_SOURCE."ORIG_TX_DT","RFND_TX_NBR" = DBT_INTERNAL_SOURCE."RFND_TX_NBR","RFND_TERM_NBR" = DBT_INTERNAL_SOURCE."RFND_TERM_NBR","RFND_DIV_NBR" = DBT_INTERNAL_SOURCE."RFND_DIV_NBR","RFND_POS_LOC_ID" = DBT_INTERNAL_SOURCE."RFND_POS_LOC_ID","RFND_BIZ_DT" = DBT_INTERNAL_SOURCE."RFND_BIZ_DT","RFND_ADJ_FLG" = DBT_INTERNAL_SOURCE."RFND_ADJ_FLG","RFND_TX_DT" = DBT_INTERNAL_SOURCE."RFND_TX_DT","DIVISION" = DBT_INTERNAL_SOURCE."DIVISION","RUN_DT" = DBT_INTERNAL_SOURCE."RUN_DT","SURR_KEY" = DBT_INTERNAL_SOURCE."SURR_KEY","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("ORIG_TX_NBR", "ORIG_TERM_NBR", "ORIG_DIV_NBR", "ORIG_POS_LOC_ID", "ORIG_BIZ_DT", "ORIG_ADJ_FLG", "ORIG_TX_DT", "RFND_TX_NBR", "RFND_TERM_NBR", "RFND_DIV_NBR", "RFND_POS_LOC_ID", "RFND_BIZ_DT", "RFND_ADJ_FLG", "RFND_TX_DT", "DIVISION", "RUN_DT", "SURR_KEY", "RUN_TS")
    values
        ("ORIG_TX_NBR", "ORIG_TERM_NBR", "ORIG_DIV_NBR", "ORIG_POS_LOC_ID", "ORIG_BIZ_DT", "ORIG_ADJ_FLG", "ORIG_TX_DT", "RFND_TX_NBR", "RFND_TERM_NBR", "RFND_DIV_NBR", "RFND_POS_LOC_ID", "RFND_BIZ_DT", "RFND_ADJ_FLG", "RFND_TX_DT", "DIVISION", "RUN_DT", "SURR_KEY", "RUN_TS")

;
    commit;