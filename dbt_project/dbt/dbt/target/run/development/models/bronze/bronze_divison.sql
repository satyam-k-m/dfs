-- back compat for old kwarg name
  
  begin;
    
        
            
            
        
    

    

    merge into insight_dev.INS_BKP.bronze_divison as DBT_INTERNAL_DEST
        using insight_dev.INS_BKP.bronze_divison__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.surr_key = DBT_INTERNAL_DEST.surr_key
            )

    
    when matched then update set
        "DIV_NBR" = DBT_INTERNAL_SOURCE."DIV_NBR","DIV_NAME" = DBT_INTERNAL_SOURCE."DIV_NAME","ADDR_LINE_1" = DBT_INTERNAL_SOURCE."ADDR_LINE_1","ADDR_LINE_2" = DBT_INTERNAL_SOURCE."ADDR_LINE_2","ADDR_LINE_3" = DBT_INTERNAL_SOURCE."ADDR_LINE_3","CITY" = DBT_INTERNAL_SOURCE."CITY","STATE" = DBT_INTERNAL_SOURCE."STATE","ZIP_CD" = DBT_INTERNAL_SOURCE."ZIP_CD","DVSN_RPT_HDNG" = DBT_INTERNAL_SOURCE."DVSN_RPT_HDNG","WRITE_OFF_DESC_1" = DBT_INTERNAL_SOURCE."WRITE_OFF_DESC_1","WRIRE_OFF_DESC_2" = DBT_INTERNAL_SOURCE."WRIRE_OFF_DESC_2","DT_FORMAT_CD" = DBT_INTERNAL_SOURCE."DT_FORMAT_CD","SALES_CTL_NBR" = DBT_INTERNAL_SOURCE."SALES_CTL_NBR","CNCL_PO_DAYS" = DBT_INTERNAL_SOURCE."CNCL_PO_DAYS","CNCL_PO_DAYS_PCT" = DBT_INTERNAL_SOURCE."CNCL_PO_DAYS_PCT","CURR_CD" = DBT_INTERNAL_SOURCE."CURR_CD","MULT_OTB_PRES" = DBT_INTERNAL_SOURCE."MULT_OTB_PRES","MULT_UNIT_RTL" = DBT_INTERNAL_SOURCE."MULT_UNIT_RTL","MULT_DEPT_IN_PO" = DBT_INTERNAL_SOURCE."MULT_DEPT_IN_PO","MOD_CHK_ROUTINE" = DBT_INTERNAL_SOURCE."MOD_CHK_ROUTINE","INV_VAR_PCT" = DBT_INTERNAL_SOURCE."INV_VAR_PCT","INV_VAR_AMT" = DBT_INTERNAL_SOURCE."INV_VAR_AMT","COST_REAVG" = DBT_INTERNAL_SOURCE."COST_REAVG","SALES_PROCESS_FLG" = DBT_INTERNAL_SOURCE."SALES_PROCESS_FLG","INV_MIN_CHGBCK_AMT" = DBT_INTERNAL_SOURCE."INV_MIN_CHGBCK_AMT","CUSTOMS_FLG" = DBT_INTERNAL_SOURCE."CUSTOMS_FLG","EXCH_RATE_VAR" = DBT_INTERNAL_SOURCE."EXCH_RATE_VAR","INV_CUTOFF_DAY" = DBT_INTERNAL_SOURCE."INV_CUTOFF_DAY","PLAN_LVL" = DBT_INTERNAL_SOURCE."PLAN_LVL","PRICE_LKUP_FLG" = DBT_INTERNAL_SOURCE."PRICE_LKUP_FLG","TRAD_COMP_CD" = DBT_INTERNAL_SOURCE."TRAD_COMP_CD","DB_COST_FLG" = DBT_INTERNAL_SOURCE."DB_COST_FLG","CREATE_PREORD_TRANS_AUD_REC" = DBT_INTERNAL_SOURCE."CREATE_PREORD_TRANS_AUD_REC","POPI_CNT_FLG" = DBT_INTERNAL_SOURCE."POPI_CNT_FLG","RCENT_CD" = DBT_INTERNAL_SOURCE."RCENT_CD","AUTO_WRITE_OFF_LIMIT" = DBT_INTERNAL_SOURCE."AUTO_WRITE_OFF_LIMIT","MRPU_ENTRY" = DBT_INTERNAL_SOURCE."MRPU_ENTRY","SCLS_REALIGN_DUR_PI" = DBT_INTERNAL_SOURCE."SCLS_REALIGN_DUR_PI","DIVISION" = DBT_INTERNAL_SOURCE."DIVISION","RUN_DT" = DBT_INTERNAL_SOURCE."RUN_DT","SURR_KEY" = DBT_INTERNAL_SOURCE."SURR_KEY","RUN_TS" = DBT_INTERNAL_SOURCE."RUN_TS"
    

    when not matched then insert
        ("DIV_NBR", "DIV_NAME", "ADDR_LINE_1", "ADDR_LINE_2", "ADDR_LINE_3", "CITY", "STATE", "ZIP_CD", "DVSN_RPT_HDNG", "WRITE_OFF_DESC_1", "WRIRE_OFF_DESC_2", "DT_FORMAT_CD", "SALES_CTL_NBR", "CNCL_PO_DAYS", "CNCL_PO_DAYS_PCT", "CURR_CD", "MULT_OTB_PRES", "MULT_UNIT_RTL", "MULT_DEPT_IN_PO", "MOD_CHK_ROUTINE", "INV_VAR_PCT", "INV_VAR_AMT", "COST_REAVG", "SALES_PROCESS_FLG", "INV_MIN_CHGBCK_AMT", "CUSTOMS_FLG", "EXCH_RATE_VAR", "INV_CUTOFF_DAY", "PLAN_LVL", "PRICE_LKUP_FLG", "TRAD_COMP_CD", "DB_COST_FLG", "CREATE_PREORD_TRANS_AUD_REC", "POPI_CNT_FLG", "RCENT_CD", "AUTO_WRITE_OFF_LIMIT", "MRPU_ENTRY", "SCLS_REALIGN_DUR_PI", "DIVISION", "RUN_DT", "SURR_KEY", "RUN_TS")
    values
        ("DIV_NBR", "DIV_NAME", "ADDR_LINE_1", "ADDR_LINE_2", "ADDR_LINE_3", "CITY", "STATE", "ZIP_CD", "DVSN_RPT_HDNG", "WRITE_OFF_DESC_1", "WRIRE_OFF_DESC_2", "DT_FORMAT_CD", "SALES_CTL_NBR", "CNCL_PO_DAYS", "CNCL_PO_DAYS_PCT", "CURR_CD", "MULT_OTB_PRES", "MULT_UNIT_RTL", "MULT_DEPT_IN_PO", "MOD_CHK_ROUTINE", "INV_VAR_PCT", "INV_VAR_AMT", "COST_REAVG", "SALES_PROCESS_FLG", "INV_MIN_CHGBCK_AMT", "CUSTOMS_FLG", "EXCH_RATE_VAR", "INV_CUTOFF_DAY", "PLAN_LVL", "PRICE_LKUP_FLG", "TRAD_COMP_CD", "DB_COST_FLG", "CREATE_PREORD_TRANS_AUD_REC", "POPI_CNT_FLG", "RCENT_CD", "AUTO_WRITE_OFF_LIMIT", "MRPU_ENTRY", "SCLS_REALIGN_DUR_PI", "DIVISION", "RUN_DT", "SURR_KEY", "RUN_TS")

;
    commit;